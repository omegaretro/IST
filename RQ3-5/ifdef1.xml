<rows>
  <row Id="136752" PostTypeId="1" CreationDate="2008-09-25T23:01:31.083" Score="2" ViewCount="4723" Body="&lt;p&gt;I have a C++ tool that walks the call stack at one point.  In the code, it first gets a copy of the live CPU registers (via RtlCaptureContext()), then uses a few &quot;&lt;code&gt;#ifdef ...&lt;/code&gt;&quot; blocks to save the CPU-specific register names into &lt;code&gt;stackframe.AddrPC.Offset&lt;/code&gt;, ...&lt;code&gt;AddrStack&lt;/code&gt;..., and ...&lt;code&gt;AddrFrame&lt;/code&gt;...; also, for each of the 3 &lt;code&gt;Addr&lt;/code&gt;... members above, it sets &lt;code&gt;stackframe.Addr&lt;/code&gt;...&lt;code&gt;.Mode = AddrModeFlat&lt;/code&gt;. (This was borrowed from some example code I came across a while back.)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;With an x86 binary, this works great.  With an x64 binary, though, StackWalk64() passes back bogus addresses.  &lt;i&gt;(The first time the API is called, the only blatantly bogus address value appears in &lt;code&gt;AddrReturn&lt;/code&gt; ( == &lt;code&gt;0xFFFFFFFF'FFFFFFFE&lt;/code&gt; -- aka StackWalk64()'s 3rd arg, the pseudo-handle returned by GetCurrentThread()).  If the API is called a second time, however, all &lt;code&gt;Addr&lt;/code&gt;... variables receive bogus addresses.)&lt;/i&gt;  This happens regardless of how &lt;code&gt;AddrFrame&lt;/code&gt; is set:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;using either of the recommended x64 &quot;base/frame pointer&quot; CPU registers: &lt;code&gt;rbp&lt;/code&gt; (= &lt;code&gt;0xf&lt;/code&gt;), or &lt;code&gt;rdi&lt;/code&gt; (= &lt;code&gt;0x0&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;using &lt;code&gt;rsp&lt;/code&gt; &lt;i&gt;(didn't expect it to work, but tried it anyway)&lt;/i&gt;&lt;/li&gt;&#xA;&lt;li&gt;setting &lt;code&gt;AddrPC&lt;/code&gt; and &lt;code&gt;AddrStack&lt;/code&gt; normally, but leaving &lt;code&gt;AddrFrame&lt;/code&gt; zeroed out &lt;i&gt;(seen in other example code)&lt;/i&gt;&lt;/li&gt;&#xA;&lt;li&gt;zeroing out all &lt;code&gt;Addr&lt;/code&gt;... values, to let StackWalk64() fill them in from the passed-in CPU-register context &lt;i&gt;(seen in other example code)&lt;/i&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;FWIW, the physical stack buffer's contents are also different on x64 vs. x86 (after accounting for different pointer widths &amp;amp; stack buffer locations, of course).  Regardless of the reason, StackWalk64() should still be able to walk the call stack correctly -- heck, the debugger is still able to walk the call stack, and it appears to use StackWalk64() itself behind the scenes.  The oddity there is that the (correct) call stack reported by the debugger contains base-address &amp;amp; return-address pointer values whose constituent bytes don't actually exist in the stack buffer (below or above the current stack pointer).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;i&gt;(FWIW #2: Given the stack-buffer strangeness above, I did try disabling ASLR (&lt;code&gt;/dynamicbase:no&lt;/code&gt;) to see if it made a difference, but the binary still exhibited the same behavior.)&lt;/i&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So.  Any ideas why this would work fine on x86, but have problems on x64?  Any suggestions on how to fix it?&lt;/p&gt;&#xA;" OwnerUserId="19505" OwnerDisplayName="Quasidart" LastEditorUserId="19505" LastEditorDisplayName="Quasidart" LastEditDate="2008-09-26T05:05:00.787" LastActivityDate="2010-10-07T04:30:21.713" Title="How do you make StackWalk64() work successfully on x64?" Tags="&lt;c++&gt;&lt;windows&gt;&lt;winapi&gt;&lt;64bit&gt;&lt;callstack&gt;" AnswerCount="2" CommentCount="1" FavoriteCount="1" />
  <row Id="414788" PostTypeId="1" AcceptedAnswerId="418615" CreationDate="2009-01-05T22:48:36.357" Score="1" ViewCount="600" Body="&lt;p&gt;In C++ you are able to compile files that are not included in the solution, with c# this is not the case.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there a way to keep a file in a project but not have the standard SCCI provider attempt to keep checking in the file?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Essentially what we are wanting to do is to create &quot;by developer&quot; code ability similar to how we code in c++, this allows for us to let our developers do nightly check-ins with pseudo code and by-developer utilities.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef (TOM)&#xA;#include &quot;Tom.h&quot;;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;EDIT&lt;/strong&gt; I don't want to create new configurations in the solution file either, I want these to be as machine specific as possible, without source control bindings to the user on the file/setting.&lt;/p&gt;&#xA;" OwnerUserId="13502" OwnerDisplayName="Tom Anderson" LastEditorUserId="13502" LastEditorDisplayName="Tom Anderson" LastEditDate="2009-01-06T23:28:17.867" LastActivityDate="2009-01-06T23:28:24.933" Title="How do I create compiled user files in Visual Studio 2008?" Tags="&lt;c#&gt;&lt;.net&gt;&lt;vb.net&gt;&lt;visual-studio-2008&gt;" AnswerCount="3" CommentCount="0" FavoriteCount="1" />
  <row Id="762833" PostTypeId="1" CreationDate="2009-04-18T03:40:59.377" Score="0" ViewCount="512" Body="&lt;p&gt;This version is working. I've made &lt;code&gt;//&lt;/code&gt; comments throughout my code to better illustrate what I am having trouble with. The program is dependent on reading a text file. In the format of paragraphs with punctuation included.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;One could copy this and the above into a text file and run the program.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;// Word.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define _CRT_SECURE_NO_WARNINGS // disable warnings for strcpy&#xA;#define ARRY_SZ 100&#xA;#include &amp;lt;iostream&amp;gt;&#xA;#include &amp;lt;fstream&amp;gt;&#xA;#include &quot;Word.h&quot;&#xA;&#xA;using namespace std;&#xA;&#xA;Word::Word( const char* word )&#xA;{&#xA;    ptr_ = new char[ strlen( word ) + 1 ];&#xA;    strcpy( ptr_, word  );  &#xA;    len_ = strlen( ptr_ );&#xA;}&#xA;&#xA;Word::Word( const Word* theObject ) &#xA;{&#xA;    ptr_ = theObject-&amp;gt;ptr_;&#xA;    len_ = theObject-&amp;gt;len_;&#xA;}&#xA;&#xA;Word::~Word()&#xA;{&#xA;    delete [] ptr_;&#xA;    ptr_ = NULL;&#xA;}&#xA;&#xA;char Word::GetFirstLetterLower()&#xA;{&#xA;    // I want to use ptr_ and len_ here&#xA;    // but the information is gone!&#xA;    char c = 0;&#xA;    return c;&#xA;}&#xA;&#xA;char* Word::GetWord()&#xA;{&#xA;    for (int x = 0; x &amp;lt; strlen( (char*)ptr_ ); x++)&#xA;        ptr_[x];  // Results in a crash.&#xA;&#xA;    return ptr_;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;// Word.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;const int FILE_PATH_SZ = 512;&#xA;class Word&#xA;{&#xA;private:&#xA;    char* ptr_;&#xA;    int len_;&#xA;public:&#xA;    Word( const Word* ); // an appropriate default constructor&#xA;    Word( const char* );&#xA;    ~Word( );&#xA;    char GetFirstLetterLower( );&#xA;    char* GetWord( );&#xA;    static char fileEntry[ FILE_PATH_SZ ];&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;// main.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  _DEBUG&#xA;#define _CRTDBG_MAP_ALLOC&#xA;#include &amp;lt;iostream&amp;gt;&#xA;#include &amp;lt;fstream&amp;gt;&#xA;#include &amp;lt;string&amp;gt;&#xA;#endif&#xA;#include &quot;Word.h&quot;&#xA;using namespace std;&#xA;&#xA;const int WORD_SZ = 100;&#xA;Word** g_wordArray;&#xA;int g_arrSz;&#xA;&#xA;static char filePath[ FILE_PATH_SZ ] = {};&#xA;void FreeWordArray();&#xA;&#xA;int main( const int argc, const char **argv )&#xA;{&#xA;    int     wrdCount = 0;&#xA;    char    usrMenuOption     = 0,&#xA;            getFirstLetter          = 0,&#xA;            tmpArray[WORD_SZ] = {},&#xA;            *getWord = 0;&#xA;    string  str, &#xA;            str2;&#xA;    ifstream  inFile, &#xA;              inFile2;&#xA;&#xA;    do &#xA;    {&#xA;        cout &amp;lt;&amp;lt; &quot;Please make a selection: \n\&#xA;a) Read a text file\n\&#xA;b) Remove words starting with letter\n\&#xA;c) Print words to console\n\&#xA;d) Quit\n&quot;;&#xA;        cin  &amp;gt;&amp;gt; usrMenuOption;&#xA;        switch( usrMenuOption )&#xA;        {&#xA;            case'A':&#xA;            case'a':&#xA;                cout &amp;lt;&amp;lt; &quot;Enter a file name: &quot;;&#xA;                cin.sync();&#xA;                cin  &amp;gt;&amp;gt; filePath;&#xA;                inFile.open( filePath );&#xA;                if ( !inFile ) return -1;&#xA;                inFile &amp;gt;&amp;gt; str; // prime the eof flag&#xA;                while ( !inFile.eof() )&#xA;                {        &#xA;                    inFile &amp;gt;&amp;gt; str;&#xA;                    wrdCount++;&#xA;                    g_wordArray = new Word *[wrdCount];&#xA;                }&#xA;                inFile.close();&#xA;                inFile2.open( filePath );&#xA;&#xA;                while( !inFile2.eof() )&#xA;                {&#xA;                    inFile2 &amp;gt;&amp;gt; str2;&#xA;                    for ( unsigned x = 0; x &amp;lt; str2.length(); x++ )&#xA;                    g_wordArray[x] = new Word( str2.c_str() );&#xA;                }&#xA;                cout &amp;lt;&amp;lt; wrdCount &amp;lt;&amp;lt; &quot; Words read from the file &quot; &amp;lt;&amp;lt; endl;&#xA;                inFile2.close();&#xA;                break;&#xA;            case'B':&#xA;            case'b':&#xA;                getFirstLetter = g_wordArray[wrdCount]-&amp;gt;GetFirstLetterLower();&#xA;                //getWord = g_wordArray[wrdCount]-&amp;gt;GetWord();&#xA;                cout &amp;lt;&amp;lt; getWord &amp;lt;&amp;lt; endl;&#xA;                break;&#xA;            case'C':&#xA;            case'c':&#xA;                break;&#xA;            case'D':&#xA;            case'd':&#xA;                cout &amp;lt;&amp;lt; &quot;Quit Requested. &quot; &amp;lt;&amp;lt; endl;&#xA;                break;&#xA;            default:&#xA;                cout &amp;lt;&amp;lt; '&quot;' &amp;lt;&amp;lt; usrMenuOption &amp;lt;&amp;lt; '&quot;' &amp;lt;&amp;lt; &quot; Not Defined! &quot; &amp;lt;&amp;lt; endl;&#xA;        }&#xA;    } while (usrMenuOption != 'D' &amp;amp;&amp;amp; usrMenuOption != 'd');&#xA;&#xA;#ifdef _DEBUG&#xA;    _CrtDumpMemoryLeaks();&#xA;#endif&#xA;    cin.ignore();&#xA;    return 0;&#xA;}&#xA;&#xA;void FreeWordArray()&#xA;{&#xA;    // free the memory that is allocated&#xA;    return;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="40120" LastEditorUserId="198633" LastEditDate="2012-10-11T19:41:18.820" LastActivityDate="2012-10-11T19:41:18.820" Title="Pointer Issues 2 [Valid C++ Syntax]" Tags="&lt;c++&gt;&lt;pointers&gt;" AnswerCount="3" CommentCount="2" />
  <row Id="764890" PostTypeId="1" CreationDate="2009-04-19T05:29:26.643" Score="0" ViewCount="318" Body="&lt;p&gt;Anyone know how to store pointers in a multi-dimensional array? I think that might be the problem that i am having in main:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// main.cpp&#xA;#ifdef  _DEBUG&#xA;#define _CRTDBG_MAP_ALLOC&#xA;#include &amp;lt;iostream&amp;gt;&#xA;#include &amp;lt;fstream&amp;gt;&#xA;#include &amp;lt;string&amp;gt;&#xA;#endif&#xA;#include &quot;Word.h&quot;&#xA;using namespace std;&#xA;&#xA;const int WORD_SZ = 100;&#xA;Word** g_wordArray;&#xA;int g_arrSz;&#xA;&#xA;static char filePath[ FILE_PATH_SZ ] = {};&#xA;void FreeWordArray();&#xA;&#xA;int main( const int argc, const char **argv )&#xA;{&#xA;    int &#xA;        wrdCount = 0;&#xA;    char &#xA;        usrMenuOption     = 0,&#xA;        getFirstLetter    = 0,&#xA;        tmpArray[WORD_SZ] = {},&#xA;        *getWord = new char;&#xA;    string &#xA;        str, &#xA;        str2;&#xA;    ifstream &#xA;        inFile, &#xA;        inFile2;&#xA;    do &#xA;    {&#xA;        cout &amp;lt;&amp;lt; &quot;Please make a selection: \n\&#xA;a) Read a text file\n\&#xA;b) Remove words starting with letter\n\&#xA;c) Print words to console\n\&#xA;d) Quit\n&quot;;&#xA;        cin  &amp;gt;&amp;gt; usrMenuOption;&#xA;        switch( usrMenuOption )&#xA;        {&#xA;        case'A':&#xA;        case'a':&#xA;            cout &amp;lt;&amp;lt; &quot;Enter a file name: &quot;;&#xA;            cin.sync();&#xA;            cin  &amp;gt;&amp;gt; filePath;&#xA;            inFile.open( filePath );&#xA;            if ( !inFile ) return -1;&#xA;            inFile &amp;gt;&amp;gt; tmpArray; // prime the eof flag.&#xA;            while ( !inFile.eof() )&#xA;            {   &#xA;                inFile &amp;gt;&amp;gt; tmpArray;&#xA;                wrdCount++;&#xA;                g_wordArray = new Word *[wrdCount];&#xA;&#xA;            }&#xA;        inFile.close();&#xA;        inFile2.open( filePath );&#xA;        while( !inFile2.eof()  )&#xA;        {   &#xA;            inFile2 &amp;gt;&amp;gt; tmpArray;&#xA;            // supplies the member functions with information from the file&#xA;            g_wordArray[wrdCount] = new Word( tmpArray );&#xA;            g_wordArray[wrdCount]-&amp;gt;GetFirstLetterLower();&#xA;            g_wordArray[wrdCount]-&amp;gt;GetWord();&#xA;        }&#xA;        cout &amp;lt;&amp;lt; wrdCount &amp;lt;&amp;lt; &quot; Words read from the file &quot; &amp;lt;&amp;lt; endl;&#xA;        inFile2.close();&#xA;        break;&#xA;        case'B':&#xA;        case'b':&#xA;        // information not found returning null&#xA;                g_wordArray[wrdCount]-&amp;gt;GetFirstLetterLower();&#xA;        break;&#xA;        case'C':&#xA;        case'c':&#xA;                g_wordArray[wrdCount]-&amp;gt;GetWord();&#xA;        break;&#xA;        case'D':&#xA;        case'd':&#xA;        cout &amp;lt;&amp;lt; &quot;Quit Requested. &quot; &amp;lt;&amp;lt; endl;&#xA;        break;&#xA;        default:&#xA;        cout &amp;lt;&amp;lt; '&quot;' &amp;lt;&amp;lt; usrMenuOption &amp;lt;&amp;lt; '&quot;' &amp;lt;&amp;lt; &quot; Not Defined! &quot; &amp;lt;&amp;lt; endl;&#xA;        }&#xA;&#xA;    } while ( usrMenuOption != 'D' &amp;amp;&amp;amp; usrMenuOption != 'd' );&#xA;&#xA;&#xA;#ifdef _DEBUG&#xA;    _CrtDumpMemoryLeaks();&#xA;#endif&#xA;    cin.ignore();&#xA;    return 0;&#xA;}&#xA;&#xA;void FreeWordArray()&#xA;{&#xA;    delete[ ] g_wordArray;&#xA;    return;&#xA;}&#xA;&#xA;&#xA;// Word.cpp&#xA;#define _CRT_SECURE_NO_WARNINGS // disable warnings for strcpy&#xA;#define ARRY_SZ 100&#xA;#include &amp;lt;iostream&amp;gt;&#xA;#include &amp;lt;fstream&amp;gt;&#xA;#include &quot;Word.h&quot;&#xA;#include &amp;lt;vector&amp;gt;&#xA;&#xA;&#xA;using namespace std;&#xA;&#xA;// No paramaters.&#xA;// Is this what im missing?&#xA;// I just threw it in because of an error.&#xA;Word::Word() &#xA;{&#xA;}&#xA;&#xA;Word::Word( const char* word )&#xA;{&#xA;    ptr_ = new char[ strlen( word ) + 1 ];&#xA;    strcpy( ptr_, word  ); &#xA;    len_ = strlen( ptr_ );&#xA;}&#xA;&#xA;Word::~Word()&#xA;{&#xA;    delete[ ] ptr_;&#xA;    ptr_ = NULL;&#xA;    len_ = NULL;&#xA;}&#xA;&#xA;char Word::GetFirstLetterLower()&#xA;{&#xA;    char myChar = tolower( ptr_[0] );&#xA;    return myChar;&#xA;&#xA;}&#xA;&#xA;char* Word::GetWord()&#xA;{&#xA;    Word *objectOne = new Word;&#xA;    objectOne-&amp;gt;ptr_ = ptr_;&#xA;    strcpy( objectOne-&amp;gt;ptr_, ptr_ );&#xA;    return objectOne-&amp;gt;ptr_;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;My Goal is to have all the words read from the file in my &lt;code&gt;g_wordArray[wrdCount]-&amp;gt;SomeFunction()&lt;/code&gt; without being dependent in the file reading loop.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What i've been trying to do:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;p&gt;In the Implementation File, under the &lt;code&gt;getFirstLetterLower&lt;/code&gt;: to add the &lt;code&gt;char *_ptr&lt;/code&gt; private member to a new variable each time. like &lt;code&gt;someCharVar[0] = firstWord&lt;/code&gt;, &lt;code&gt;someCharVar[1] = secondWord&lt;/code&gt;...&lt;/p&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;p&gt;Reading the contents of the file into a single varaible. Looping through that varaible in each case that i need.&lt;/p&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;I like that idea, but haven't figured out how to do it. Any suggestions?&lt;/p&gt;&#xA;" OwnerUserId="40120" LastEditorUserId="3146" LastEditDate="2009-04-19T05:40:35.087" LastActivityDate="2012-06-26T22:27:49.767" Title="Pointer Issues" Tags="&lt;c++&gt;&lt;pointers&gt;" AnswerCount="6" CommentCount="2" />
  <row Id="920560" PostTypeId="1" AcceptedAnswerId="920572" CreationDate="2009-05-28T12:17:08.817" Score="29" ViewCount="5629" Body="&lt;p&gt;I'm working on a large delphi 6 project with quite a lot of dependancies. It takes several minutes to compile the whole project. The recompilation after a few changes is sometimes much more longer so that it is quicker to terminate Delphi, erase all dcu files and recompile everything.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Does anyone know a way to identify, what makes the compiler slower and slower? Any tips how to organize the code to improve compiler performance?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have already tried following things:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Explicitly include most of the units in the dpr instead of relying on the search path: It didn't improve anything.&lt;/li&gt;&#xA;&lt;li&gt;Use the command line compiler dcc32: it isn't faster.&lt;/li&gt;&#xA;&lt;li&gt;Try to see what the compiler does (using ProcessExplorer from SysInternals): apparently it runs most of the time a function called 'KibitzGetOverloads'. But I can't do anything with this information...&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;EDIT, Summary of the answers until now:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The answer that worked best in my case:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The function &quot;Clean unused units references&quot; from &lt;a href=&quot;http://www.cnpack.org/index.php?lang=en&quot; rel=&quot;noreferrer&quot;&gt;cnpack&lt;/a&gt;. It almost automatically cleaned more than 1000 references, making a &quot;cold&quot; compilation about twice faster. (&quot;cold&quot; compilation = erase all dcu files before compiling). &lt;em&gt;It gets the reference list from the compiler. So if you have some {$IFDEF } check that all your configurations still compile.&lt;/em&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;The next thing I would like to try:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Refactoring the unit references manually (eventually using an abstract class)&#xA;but it is much more work, since I first need to identify where the problems are. Some tools that might help:&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&quot;http://www.gexperts.org/&quot; rel=&quot;noreferrer&quot;&gt;GExperts&lt;/a&gt; adds a project dependencies browser to the delphi IDE (but unfortunately it can not show the size of each branch)&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&quot;http://cc.embarcadero.com/Item/19441&quot; rel=&quot;noreferrer&quot;&gt;Delphi Unit Dependency Viewer V1.0&lt;/a&gt; do about the same thing but without Delphi. It can calculate some simple statistics (Which units is the most referenced, ...)&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&quot;http://www.peganza.com/products.htm&quot; rel=&quot;noreferrer&quot;&gt;Icarus&lt;/a&gt; which is referenced on &lt;a href=&quot;http://blog.fredrikhaglund.se/blog/2006/07/03/optimized-pascal-compilation-time/&quot; rel=&quot;noreferrer&quot;&gt;a link&lt;/a&gt; in one of the answer.&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;Things that didn't change anything in my case:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Putting every files from my program and all components in one folder without subfolders.&lt;/li&gt;&#xA;&lt;li&gt;Defragmenting the disk (I tried with a ramdisk)&lt;/li&gt;&#xA;&lt;li&gt;Using a ramdisk for the code source and output folders.&lt;/li&gt;&#xA;&lt;li&gt;Turning off the live scanning antivirus&lt;/li&gt;&#xA;&lt;li&gt;Listing all the units in the dpr file instead of relying on the search path.&lt;/li&gt;&#xA;&lt;li&gt;Using the command line compiler dcc32 or ecc32.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;Things that didn't apply to my case:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Avoiding having dependencies on network shares.&lt;/li&gt;&#xA;&lt;li&gt;Using &lt;a href=&quot;http://andy.jgknet.de/blog/?page%5Fid=8&quot; rel=&quot;noreferrer&quot;&gt;DelphiSpeedUp&lt;/a&gt;, because I already had it.&lt;/li&gt;&#xA;&lt;li&gt;Using a single folder for all dcu (I always do it)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;Things that I didn't try:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Upgrading to another Delphi version.&lt;/li&gt;&#xA;&lt;li&gt;Using dcc32speed.exe&lt;/li&gt;&#xA;&lt;li&gt;Using a solid-state drive (I didn't tried it, but I tried with a ramdisk where I put all the source code. But maybe I should have installed delphi on the ramdisk too)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;" OwnerUserId="32354" LastEditorUserId="32354" LastEditDate="2009-08-05T08:08:16.933" LastActivityDate="2015-11-23T16:55:07.487" Title="Delphi: How to organize source code to increase compiler performance?" Tags="&lt;delphi&gt;&lt;optimization&gt;&lt;compiler-construction&gt;" AnswerCount="17" CommentCount="2" FavoriteCount="8" />
  <row Id="1157069" PostTypeId="1" AcceptedAnswerId="1157084" CreationDate="2009-07-21T02:59:22.410" Score="1" ViewCount="3832" Body="&lt;p&gt;I am new to C, and I am maintaining someones code. I came across this in the header file. I can understand that if the source is compiled on the windows it will enter the if statement else if the code is compiled on a linux it will enter the else statement. Correct me if I am wrong.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;However, the question is why is # (hash) used in front of all the include headers?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Many thanks for any suggestions,&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef WIN32&#xA;#   include &amp;lt;conio.h&amp;gt;&#xA;#   include &amp;lt;process.h&amp;gt;&#xA;#   include &amp;lt;stdlib.h&amp;gt;&#xA;#   include &amp;lt;string.h&amp;gt;&#xA;#else&#xA;#   include &amp;lt;unistd.h&amp;gt;&#xA;#   include &amp;lt;termio.h&amp;gt;&#xA;#   include &amp;lt;sys/types.h&amp;gt;&#xA;#   include &amp;lt;sys/stat.h&amp;gt;&#xA;#   include &amp;lt;fcntl.h&amp;gt;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="70942" LastEditorUserId="1432" LastEditDate="2009-07-21T03:04:47.800" LastActivityDate="2009-07-21T03:21:34.960" Title="#ifdef #else #endif macro question" Tags="&lt;c&gt;&lt;code-formatting&gt;" AnswerCount="6" CommentCount="0" />
  <row Id="1163718" PostTypeId="1" AcceptedAnswerId="1163765" CreationDate="2009-07-22T07:53:26.247" Score="6" ViewCount="336" Body="&lt;p&gt;We branched off the main project about 6 months ago. In that time the master branch has had 100,000 more lines of code added or deleted. We on the other hand have added or changed about 50,000 lines of code since. Its currently time to merge, so we've made a copy of branch A and merged changes from their branch B into it and called it branch C.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Now we want to take all the merge changes in our branch C and merge it back into our original branch A. But we want to safe guard against something horribly going wrong so we want to use the preproccesor to enable it or disable it depending on our product release of beta or release.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For example.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#if _BETA_CODE&lt;br&gt;&#xA;.... their new code. (Merged)&lt;br&gt;&#xA;#else&lt;br&gt;&#xA;... our old code.&lt;br&gt;&#xA;#endif&lt;br&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Does anyone know of a tool that can take the Diff of two projects (branch A, and the beta branch C) and merge them together but mark the changes with using #ifdef #else #endif commands?&lt;/p&gt;&#xA;" OwnerUserId="17382" LastEditorUserId="17382" LastEditDate="2013-06-18T04:01:50.027" LastActivityDate="2014-11-24T14:32:05.667" Title="Modifying Git Diff files" Tags="&lt;c++&gt;&lt;c&gt;&lt;git&gt;&lt;diff&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="1196808" PostTypeId="1" AcceptedAnswerId="1196895" CreationDate="2009-07-28T21:21:08.953" Score="7" ViewCount="2415" Body="&lt;p&gt;For a static Win32 library, how can I detect that any of the &quot;Use MFC&quot; options is set?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;i.e.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef ---BuildingForMFC---&#xA;....&#xA;#else&#xA;...&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="31317" LastEditorUserId="31317" LastEditDate="2009-07-28T21:38:17.060" LastActivityDate="2015-04-30T07:30:10.840" Title="How to detect &quot;Use MFC&quot; in preprocessor" Tags="&lt;c++&gt;&lt;mfc&gt;&lt;visual-c++-2008&gt;" AnswerCount="3" CommentCount="0" FavoriteCount="2" />
  <row Id="1628588" PostTypeId="1" AcceptedAnswerId="1628617" CreationDate="2009-10-27T03:15:27.027" Score="0" ViewCount="254" Body="&lt;p&gt;I have a project that is C++ WIN32 project. I found a problem that &#xA;some symbol can be recognized by the windbg but some don't. I don't &#xA;know why. &#xA;The characteristics are:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;1) both are C++ method &lt;/p&gt;&#xA;&#xA;&lt;p&gt;2) both function are in one .cpp file &lt;/p&gt;&#xA;&#xA;&lt;p&gt;3) the two functions are very close in the source file and neither of &#xA;them are enclosed by a #ifdef &lt;/p&gt;&#xA;&#xA;&lt;p&gt;4) I have used dbh.exe to check the symbol, the symbol missing in the &#xA;windbg is also not in the pdb file. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I am guessing if the symbol missing may due to the inheritance of the &#xA;class? &#xA;Please suggest, thanks! &#xA;Bin &lt;/p&gt;&#xA;" OwnerUserId="197036" LastEditorUserId="294313" LastEditDate="2010-04-14T00:01:42.577" LastActivityDate="2010-04-14T00:01:42.577" Title="Finding symbols for C++ source file" Tags="&lt;c++&gt;&lt;winapi&gt;&lt;windbg&gt;&lt;pdb-files&gt;" AnswerCount="3" CommentCount="1" />
  <row Id="1802107" PostTypeId="1" AcceptedAnswerId="1802143" CreationDate="2009-11-26T07:36:43.257" Score="3" ViewCount="7896" Body="&lt;p&gt;I have the following code&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define PROC_ADD&#xA;&#xA;void main(void)&#xA;{&#xA;    while(1)&#xA;    {&#xA;#ifdef PROC_ADD&#xA;// Do this code here then undefined it to run the code in the else&#xA;// processing work&#xA;#undef PROC_ADD&#xA;#else&#xA;// now that PROC_ADD has been undefined run this code&#xA;// processing work&#xA;#endif&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;However, it will run the code. But it won't run the code in the &lt;code&gt;else&lt;/code&gt; after the &lt;code&gt;PROC_ADD&lt;/code&gt; has been undefined.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I think the reason could be that you can only define and undefine at compile time, and not at run-time. However, I am not really sure.&lt;/p&gt;&#xA;" OwnerUserId="70942" LastEditorUserId="4370109" LastEditDate="2016-02-19T22:04:02.837" LastActivityDate="2017-03-07T10:30:10.353" Title="#define, #ifdef #undef #endif" Tags="&lt;c&gt;&lt;visual-studio-2008&gt;&lt;c-preprocessor&gt;&lt;preprocessor-directive&gt;" AnswerCount="6" CommentCount="1" />
  <row Id="1813853" PostTypeId="1" AcceptedAnswerId="1813873" CreationDate="2009-11-28T21:38:27.913" Score="91" ViewCount="51468" Body="&lt;p&gt;I doubt if there is a way to make compile-time conditions in Java like #ifdef #ifndef in C++.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My problem is that have an algorithm written in Java, and I have different running time improves to that algorithm. So I want to measure how much time I save when each improve is used.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Right now I have a set of boolean variables that are used to decide during the running time which improve should be used and which not. But even testing those variables influences the total running time.  &lt;/p&gt;&#xA;&#xA;&lt;p&gt;So I want to find out a way to decide during the compilation time which parts of the program should be compiled and used.  &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Does someone knows a way to do it in Java. Or maybe someone knows that there is no such way (it also would be useful).&lt;/p&gt;&#xA;" OwnerUserId="188264" LastEditorUserId="171461" LastEditDate="2009-11-28T21:40:45.877" LastActivityDate="2016-03-03T07:59:46.563" Title="#ifdef #ifndef in Java" Tags="&lt;java&gt;&lt;compilation&gt;&lt;conditional&gt;&lt;conditional-compilation&gt;" AnswerCount="7" CommentCount="0" FavoriteCount="30" />
  <row Id="1862481" PostTypeId="1" CreationDate="2009-12-07T19:53:54.630" Score="1" ViewCount="189" Body="&lt;p&gt;I am using NI LabWindows CVI 8.1 to compile and build a executable program which I need to run on either Windows XP and Windows 2000 OS. I use Windows XP to compile and build the executable. The info I have so far is that I need to place some statement as follows:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef (windows xp)&#xA;//then specify path as C:\WINDOWS\system32&#xA;#elif (windows NT)&#xA;//then specify path as C:\WINNT\system32&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I need to know what is the exact syntax and where to place it (like which header or source file to place it).&lt;/p&gt;&#xA;" OwnerUserId="226627" LastEditorUserId="404469" LastEditDate="2012-01-14T16:55:07.830" LastActivityDate="2012-01-14T16:55:07.830" Title="How to detect Windows XP or Windows 2000 OS to run a CVI executable" Tags="&lt;compiler-construction&gt;&lt;cvi&gt;&lt;labwindows&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="2012496" PostTypeId="1" AcceptedAnswerId="2019014" CreationDate="2010-01-06T11:19:58.720" Score="6" ViewCount="1765" Body="&lt;p&gt;My &lt;strong&gt;C&lt;/strong&gt; project uses preprocessor directives to activate / deactivate some features. It's not unusual to find some of the less common configurations do not compile anymore due to a change made a few days ago within an &lt;code&gt;#ifdef&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;We use a script to compile the most common configurations, but I'm looking for a tool to ensure everything is compiled (testing is not a problem in our case, we just want to detect ASAP nothing stops compiling). Usually ifdefs / ifndefs are independent, so normally each module have to be compiled just twice (all symbols defined, all undefined). But sometimes the ifdefs are nested, so those modules have to be compiled more times.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Do you know of any tool to search all ifdef / ifndef (also nested ones) and gives how many times a module have to be compiled (with the set of preprocessor symbols to be defined in each one) to ensure every single source line of code is analyzed by the compiler?&lt;/p&gt;&#xA;" OwnerUserId="220816" LastEditorUserId="4370109" LastEditDate="2016-02-20T22:14:58.703" LastActivityDate="2016-02-20T22:14:58.703" Title="Tool for compiling automatically all ifdef / ifndef directives" Tags="&lt;c&gt;&lt;c-preprocessor&gt;&lt;conditional-compilation&gt;" AnswerCount="8" CommentCount="0" FavoriteCount="2" ClosedDate="2016-02-21T11:37:22.830" />
  <row Id="2623462" PostTypeId="1" AcceptedAnswerId="2623496" CreationDate="2010-04-12T16:04:48.600" Score="4" ViewCount="4300" Body="&lt;blockquote&gt;&#xA;  &lt;p&gt;&lt;strong&gt;Possible Duplicate:&lt;/strong&gt;&lt;br&gt;&#xA;  &lt;a href=&quot;http://stackoverflow.com/questions/2025471/do-i-need-to-disable-nslog-before-release-application&quot;&gt;Do I need to disable NSLog before release Application?&lt;/a&gt;  &lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&#xA;&#xA;&lt;p&gt;I wonder if someone could help me setup a number of NSLog statements so they print to console when executing in &quot;Debug Mode&quot; but don't print in &quot;Release Mode&quot;. I understand I need to add something like &lt;code&gt;DEBUG = 1&lt;/code&gt; to the debug config in Xcode but I can't find where. Also how do I utilise this in my code?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;NSLog(@&quot;Print Always&quot;);&#xA;if(DEBUG) NSLog(@&quot;Print only in debug&quot;);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Is there a simple way of doing this?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;EDIT_001:&lt;/strong&gt;&#xA;I tried following &lt;a href=&quot;http://iPhoneIncubator.com/blog/debugging/how-to-create-conditional-log-statements-in-xcode&quot; rel=&quot;nofollow noreferrer&quot;&gt;this&lt;/a&gt; but the keys now seem to be only listed under &quot;All Settings&quot;, and are presenting as nice names. The one I should be using is GCC_PREPROCESSOR_DEFINITIONS, so I needed to find &quot;Preprocessor Macros&quot;, select edit and add &lt;code&gt;DEBUG=1&lt;/code&gt;&#xA;&lt;img src=&quot;https://farm3.static.flickr.com/2712/4515311842_726722ef6e_o.png&quot; alt=&quot;alt text&quot;&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;When you come to use this its simply a case of adding (see below) or some marco to remove the messy #ifdef / #endif tags.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;NSLog(@&quot;You always see me?&quot;);&#xA;#ifdef DEBUG&#xA;NSLog(@&quot;Only in DEBUG&quot;);&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="164216" LastEditorUserId="-1" LastEditDate="2017-02-08T14:23:43.643" LastActivityDate="2010-04-12T21:17:00.233" Title="Suppressing NSLog statements for release?" Tags="&lt;iphone&gt;&lt;objective-c&gt;&lt;cocoa&gt;&lt;xcode&gt;" AnswerCount="4" CommentCount="1" FavoriteCount="1" ClosedDate="2010-04-13T01:40:10.323" />
  <row Id="2998864" PostTypeId="1" AcceptedAnswerId="2998876" CreationDate="2010-06-08T15:38:34.267" Score="99" ViewCount="40725" Body="&lt;p&gt;How can I add a 'or' condition in #ifdef ?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have tried &quot;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef CONDITION1 || CONDITION2&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This does not work.&lt;/p&gt;&#xA;" OwnerUserId="286802" LastActivityDate="2013-01-25T11:10:15.493" Title="How to add a 'or' condition in #ifdef" Tags="&lt;c++&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="12" />
  <row Id="3028691" PostTypeId="1" AcceptedAnswerId="3028859" CreationDate="2010-06-12T12:44:45.003" Score="0" ViewCount="513" Body="&lt;p&gt;While building an existing code base on Mac OS using its native build setup I am getting some basic strange error while compilation phase.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Does any of you have any idea, as I have seen it's been discussed earlier as well in this forum without any good reason. I can not see any conflicting files being included.&#xA;But still I am unable to compile the code because this error appears.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Source are like the code given below and compilation error appears&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ cat a.h&#xA;    #include &amp;lt;string&amp;gt;&#xA;    #include &amp;lt;sstream&amp;gt;&#xA;&#xA;    namespace brijesh {&#xA;        typedef std::string String;&#xA;&#xA;        template&amp;lt;class T&amp;gt;&#xA;        String toString(T value) {&#xA;            std::ostringstream buffer;&#xA;            buffer &amp;lt;&amp;lt; value;&#xA;            return buffer.str();&#xA;    }&#xA;&#xA;$ cat b.h&#xA;    #include &quot;a.h&quot;&#xA;    namespace brijesh {&#xA;        class Platform {&#xA;            public:&#xA;                static String getName();&#xA;        };&#xA;     }&#xA;&#xA;$ cat b.cpp&#xA;     #include &quot;b.h&quot;&#xA;&#xA;     namespace brijesh {&#xA;&#xA;         String Platform::getName()&#xA;         {&#xA;             String  name = &quot;UNKNOWN&quot;;&#xA;     #ifdef  LINUX&#xA;              name = &quot;linux&quot;;&#xA;     #endif&#xA;     #ifdef  MACOSX&#xA;              name = &quot;Mac&quot;;&#xA;     #endif&#xA;              return name;&#xA;         }&#xA;     }&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;flags used for compilation &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; g++ -c -o test.o -DRELEASE_VERSION -ggdb -arch ppc -mmacosx-version-min=10.4 -pipe -fpermiss    ive -nostdinc -nostdinc++ -isystem /Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3    .3 -I/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++ -I/Developer/SDKs/MacOS    X10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/ppc-darwin -isystem /Developer/SDKs/MacOSX10.3.9.    sdk/usr/include -F/Developer/SDKs/MacOSX10.3.9.sdk/System/Library/Frameworks -Wreturn-type -D_REENTRANT -D_GNU_SOURCE -D_LARGEFILE64_SOURCE -Wall -Wno-multichar -Wno-unk    nown-pragmas  -Wno-long-double -fconstant-cfstrings  -MP -MMD x.cpp&#xA;&#xA;&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/bits/locale_facets.h: In constructor 'std::collate_byname&amp;lt;_CharT&amp;gt;::collate_byname(const char*, size_t)':&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/bits/locale_facets.h:1072: error: '_M_c_locale_collate' was not declared in this scope&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/ppc-darwin/bits/messages_members.h: In constructor 'std::messages_byname&amp;lt;_CharT&amp;gt;::messages_byname(const char*, size_t)':&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/ppc-darwin/bits/messages_members.h:79: error: '_M_c_locale_messages' was not declared in this scope&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/limits: At global scope:&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/limits:897: error: 'float __builtin_huge_valf()' cannot appear in a constant-expression&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/limits:897: error: a function call cannot appear in a constant-expression&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/limits:897: error: 'float __builtin_huge_valf()' cannot appear in a constant-expression&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/limits:897: error: a function call cannot appear in a constant-expression&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/limits:899: error: 'float __builtin_nanf(const char*)' cannot appear in a constant-expression&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/limits:899: error: a function call cannot appear in a constant-expression&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/limits:899: error: 'float __builtin_nanf(const char*)' cannot appear in a constant-expression&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/limits:899: error: a function call cannot appear in a constant-expression&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/limits:900: error: field initializer is not constant&#xA;/Developer/SDKs/MacOSX10.3.9.sdk/usr/include/gcc/darwin/3.3/c++/limits:915: error: field initializer is not constant&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="344310" LastEditorUserId="3102264" LastEditDate="2014-08-19T21:03:37.130" LastActivityDate="2014-08-19T21:03:37.130" Title="Compilation error while compiling an existing code base" Tags="&lt;c++&gt;&lt;gcc&gt;&lt;g++&gt;" AnswerCount="1" CommentCount="6" />
  <row Id="3223753" PostTypeId="1" AcceptedAnswerId="3224595" CreationDate="2010-07-11T16:21:17.440" Score="4" ViewCount="3811" Body="&lt;p&gt;So I can write code like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef [whatever]&#xA;   // do stuff that will never show up in the production version&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="246568" LastActivityDate="2010-07-11T20:55:39.463" Title="Is there a macro that Xcode automatically sets in debug builds?" Tags="&lt;xcode&gt;&lt;debugging&gt;&lt;macros&gt;" AnswerCount="2" CommentCount="0" FavoriteCount="2" />
  <row Id="3232257" PostTypeId="1" AcceptedAnswerId="3232470" CreationDate="2010-07-12T21:03:10.960" Score="0" ViewCount="1819" Body="&lt;p&gt;I am using MinGW which does not have full functionality. eg. It has no wchar_t stream support. &#xA;I've managed to get around that by writing a mini-set of manipulators (the wcusT() in the code below).. but I find I'm getting stymied again with GetModuleFileNameEx.&#xA;I have not been able to natively run GetModuleFileNameEx()&#xA;This function is defined in &lt;code&gt;&amp;lt;psapi.h&amp;gt;&lt;/code&gt;, but there seems to be nothing for it to link to. That is my no.1 question: Can/does/is MinGW able to run GetModuleFileNameEx? What do I need to do? Am I missing something simple?&#xA;As a workaround, I've tried to run it indirectly via a call to its dll (psapi.dll) which is in the Windows system32 folder... but something is wrong.&#xA;I've got another no-go situation. I'd appreciate any comments on the code below .. thanks&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;int WINAPI WinMain (HINSTANCE hThisInstance, HINSTANCE hPrevInstance, LPSTR lpszArgument, int nCmdShow)&#xA;{ /// typedef and load a dll function&#xA;  /// ===============================&#xA;  typedef DWORD (__stdcall *foo)(HANDLE, HMODULE, LPTSTR, DWORD);&#xA;  LPTSTR  ptcPSAPI_DLL = _T(&quot;C:\\WINDOWS\\system32\\psapi.dll&quot;);&#xA;  HMODULE   hPSAPI_DLL = LoadLibrary(ptcPSAPI_DLL);&#xA;  if( !hPSAPI_DLL ) &#xA;  { std::cout&amp;lt;&amp;lt;&quot;ERROR: Failed to load &quot;&amp;lt;&amp;lt;wcusT(ptcPSAPI_DLL)&amp;lt;&amp;lt;std::endl;&#xA;    return 1;&#xA;  }&#xA;  foo GetModFnEx=(foo)GetProcAddress(hPSAPI_DLL,&#xA;                  #ifdef  UNICODE&#xA;                         &quot;GetModuleFileNameExW&quot;);&#xA;                  #else&#xA;                         &quot;GetModuleFileNameExA&quot;);&#xA;                  #endif&#xA;&#xA;  /// call the dll library function&#xA;  /// =============================&#xA;  HWND   hWndNPP = FindWindow(_T(&quot;Notepad++&quot;),NULL); // the window calass name&#xA;  TCHAR  ytcMFqFn[FILENAME_MAX]; // the buffer for the file name&#xA;  DWORD  dwBytes = (GetModFnEx)( hWndNPP, NULL, ytcMFqFn, sizeof(ytcMFqFn) );  &#xA;  DWORD  dwError = GetLastError();&#xA;&#xA;  std::cout&amp;lt;&amp;lt;wcusT(_T(&quot;hWndNPP  &quot;))&amp;lt;&amp;lt;&quot;=&quot;&amp;lt;&amp;lt;hWndNPP        &amp;lt;&amp;lt;&quot;=&quot;&amp;lt;&amp;lt;std::endl;&#xA;  std::cout&amp;lt;&amp;lt;wcusT(_T(&quot;ytcMFqFn &quot;))&amp;lt;&amp;lt;&quot;=&quot;&amp;lt;&amp;lt;wcusT(ytcMFqFn)&amp;lt;&amp;lt;&quot;=&quot;&amp;lt;&amp;lt;std::endl;&#xA;  std::cout&amp;lt;&amp;lt;wcusT(_T(&quot;dwBytes  &quot;))&amp;lt;&amp;lt;&quot;=&quot;&amp;lt;&amp;lt;dwBytes        &amp;lt;&amp;lt;&quot;=&quot;&amp;lt;&amp;lt;std::endl;&#xA;  std::cout&amp;lt;&amp;lt;wcusT(_T(&quot;dwError  &quot;))&amp;lt;&amp;lt;&quot;=&quot;&amp;lt;&amp;lt;dwBytes        &amp;lt;&amp;lt;&quot;=&quot;&amp;lt;&amp;lt;std::endl;&#xA;  return 0;&#xA;&#xA;  // Output ===============&#xA;  // SBCS &#xA;  //   hWndNPP  =0x320606=&#xA;  //   ytcMFqFn ==&#xA;  //   dwBytes  =0=&#xA;  //   dwError  =0=&#xA;  // UNICODE&#xA;  //   h W n d N P P     =0x320606=&#xA;  //   y t c M F q F n   =(☻æ|♀ =&#xA;  //   d w B y t e s     =0=&#xA;  //   d w E r r o r     =0=&#xA;  //  ======================&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="313821" LastEditorUserId="17034" LastEditDate="2010-07-12T21:31:46.580" LastActivityDate="2010-07-12T21:38:04.483" Title="calling GetModuleFileNameEx via psapi.dll is not working, but why?" Tags="&lt;c++&gt;&lt;dll&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="3336200" PostTypeId="1" CreationDate="2010-07-26T15:13:55.047" Score="0" ViewCount="1771" Body="&lt;p&gt;I want to undefine variable when compiling on SunOS. Therefore, i tried to put&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef SunOS&#xA;#undef FOO&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but it does not work. The problem is in #ifdef sunos ? Should i declarate it, or complier do it by itself ? &lt;/p&gt;&#xA;&#xA;&lt;p&gt;regards&#xA;S.&lt;/p&gt;&#xA;" OwnerUserId="402430" LastActivityDate="2010-07-26T17:47:43.100" Title="ifdef &amp; solaris" Tags="&lt;c&gt;&lt;solaris&gt;" AnswerCount="3" CommentCount="0" />
  <row Id="3399019" PostTypeId="1" CreationDate="2010-08-03T17:26:36.663" Score="1" ViewCount="599" Body="&lt;p&gt;I have the following assignment:&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;Write a function in C that allocates block of memory and returns a pointer to the start of the memory under these conditions:&lt;/p&gt;&#xA;  &#xA;  &lt;ol&gt;&#xA;  &lt;li&gt;All addresses in the block are divisible by 32&lt;/li&gt;&#xA;  &lt;li&gt;Allocated at least the number of the bytes required&lt;/li&gt;&#xA;  &lt;li&gt;Every cell in the block is initialized to zero &lt;/li&gt;&#xA;  &lt;li&gt;No global variants, minimum complexity&lt;/li&gt;&#xA;  &lt;/ol&gt;&#xA;  &#xA;  &lt;p&gt;Write another function that also releases the memory that you allocated. (You know that the aforesaid memory was allocated by the first function that you just wrote ).&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;Here is a debugging temporary solution:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&quot;aligned_malloc.h&quot;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef  __ALIGNED_MALLOC_H__&#xA;#define  __ALIGNED_MALLOC_H__&#xA;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;malloc.h&amp;gt;&#xA;&#xA;#define ALIGNMENT 16&#xA;&#xA;#if ALIGNMENT &amp;gt; 255&#xA;#error &quot;This 'void *aligned_malloc(size_t size)' function can only handle alignment &amp;lt; 256&quot;&#xA;#endif&#xA;&#xA;#if ALIGNMENT &amp;lt; 0&#xA;#error &quot;This 'void *aligned_malloc(size_t size)' function can only handle a non negative alignment&quot;&#xA;#endif&#xA;&#xA;void* aligned_malloc(size_t size);&#xA;void aligned_free(void *aligned_p);&#xA;&#xA;#endif /* __ALIGNED_MALLOC_H__ */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&quot;alligned_malloc.c&quot;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;aligned_malloc.h&quot;&#xA;&#xA;#undef  DEBUG&#xA;#define DEBUG 1&#xA;&#xA;int main()&#xA;{&#xA;    size_t size = 0;&#xA;    void *memblk = NULL;&#xA;&#xA;    do while (size &amp;gt; 0 )&#xA;    {&#xA;        printf(&quot;\nPlease enter in bytes the memory block size you want to allocate (0 to exit): &quot;);&#xA;        scanf(&quot;%d&quot;, &amp;amp;size);&#xA;        memblk = aligned_malloc(size);&#xA;&#xA;        #ifdef     DEBUG&#xA;            printf(&quot;%s[%d]: memblk = 0x%x\n&quot;, __FUNCTION__, __LINE__, memblk);&#xA;        #endif  /* DEBUG */&#xA;&#xA;    }&#xA;&#xA;    if (memblk != NULL)&#xA;        aligned_free(memblk);&#xA;&#xA;    return 0;&#xA;}&#xA;&#xA;void *aligned_malloc(size_t size)&#xA;{&#xA;    int i = 0;&#xA;    void* memblk = malloc(size + ALIGNMENT);&#xA;    printf (&quot;\n%ld&quot;,(long)memblk);&#xA;&#xA;    //offset is the start address of memblk (long=8digit) modulo the ALIGNMENT&#xA;    unsigned char offset = ALIGNMENT - ((long)memblk % ALIGNMENT);&#xA;    printf (&quot;\n%d&quot;,offset);&#xA;&#xA;    if (memblk == NULL)&#xA;        return NULL;&#xA;    /* O/W: */  &#xA;    #ifdef     DEBUG&#xA;    printf(&quot;%s[%d]: memblk = 0x%x\n&quot;, __FUNCTION__, __LINE__, memblk);&#xA;    #endif  /* DEBUG */&#xA;    for (i = offset; i &amp;lt; size + ALIGNMENT; i++) &#xA;    {&#xA;        printf(&quot;%02d: %08d\n&quot;, i, memblk+i);&#xA;        memblk[i] = 0;&#xA;    }&#xA;&#xA;    *(memblk + offset - 1) = offset;&#xA;&#xA;    return (void*)(memblk + offset);&#xA;}&#xA;&#xA;void aligned_free(void *aligned_p)&#xA;{&#xA;    unsigned char offset = (unsigned char)(*((unsigned char *)aligned_p-1));&#xA;    #ifdef     DEBUG&#xA;    printf(&quot;%s[%d]: offset = %d\n&quot;, __FUNCTION__, __LINE__, offset);&#xA;    printf(&quot;%s[%d]: aligned_p-1 = 0x%x\n&quot;, __FUNCTION__, __LINE__, (unsigned char *)aligned_p-1);&#xA;    printf(&quot;%s[%d]: aligned_p-offset = 0x%x\n&quot;, __FUNCTION__, __LINE__, aligned_p-offset);&#xA;    #endif  /* DEBUG */&#xA;    free(aligned_p-offset);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Now I have several problems here:&lt;/p&gt;&#xA;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;There is a compilation error in &lt;code&gt;main()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;I cannot catch how to use &lt;code&gt;calloc&lt;/code&gt; instead of &lt;code&gt;malloc&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;If I use the &lt;code&gt;void*&lt;/code&gt; is there an option to cast it to 32 bytes chunks?&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;" OwnerUserId="409821" LastEditorUserId="68204" LastEditDate="2010-08-05T05:22:00.890" LastActivityDate="2010-08-05T05:22:00.890" Title="Alligned memory allocation" Tags="&lt;c&gt;&lt;malloc&gt;" AnswerCount="3" CommentCount="2" />
  <row Id="3452355" PostTypeId="1" AcceptedAnswerId="3454055" CreationDate="2010-08-10T18:52:41.817" Score="1" ViewCount="507" Body="&lt;p&gt;This is a very strange problem...&#xA;removing the cout in the function below causes it to stop printing the correct/expected results and printing garbage values. (i.e. it still RUNS the data it outputs, though, is wrong).  Any ideas?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;bool extract_tension(std::vector&amp;lt;double&amp;gt; &amp;amp;interfacial_tension_trap,&#xA;       std::vector&amp;lt;double&amp;gt; &amp;amp;interfacial_tension_simp,&#xA;       const std::string data,&#xA;       const unsigned int num_slabs,&#xA;       const double z_min, const double z_max)&#xA;{&#xA;&#xA;   //start @ first number&#xA;   unsigned int start = 17;&#xA;   unsigned int end = 17;&#xA;&#xA;   std::vector&amp;lt;double&amp;gt; px;&#xA;   std::vector&amp;lt;double&amp;gt; py;&#xA;   std::vector&amp;lt;double&amp;gt; pz;&#xA;&#xA;   std::vector&amp;lt;double&amp;gt; pn_minus_pt;&#xA;&#xA;   double result_simp=0.0;&#xA;   double result_trap=0.0;&#xA;&#xA;   //skip timestep entry&#xA;   end=get_next_space(start, data);&#xA;&#xA;   for(unsigned int counter=0; counter&amp;lt;num_slabs;counter++)&#xA;   {&#xA;     start = end+2;&#xA;&#xA;     end=get_next_space(start, data);&#xA;     px.push_back(atof(data.substr(start,(end-start+1)).c_str()));&#xA;     //skip the space&#xA;     start = end+2;&#xA;     end=get_next_space(start, data);&#xA;     py.push_back(atof(data.substr(start,(end-start+1)).c_str()));&#xA;     //skip the space&#xA;     start = end+2;&#xA;     end=get_next_space(start, data);&#xA;     pz.push_back(atof(data.substr(start,(end-start+1)).c_str()));&#xA;&#xA;     //calculate pressure difference&#xA;     // WARNING : Unit conversion ahead&#xA;     // NAMD outputs pressure in bars and distance in Angstroms&#xA;     // we want an integrated result of mN/m, instead.&#xA;     // 1 Angstrom = 1e-10 m&#xA;     // 1 bar = 1e8 mN/m^2&#xA;     // net conversion -- 1e-2 &#xA;     pn_minus_pt.push_back((pz[counter]-0.5*(px[counter]+py[counter]))*0.01);&#xA;       std::cout &amp;lt;&amp;lt; &quot;Current del_P : &quot; &#xA;   &amp;lt;&amp;lt; (pz[counter]-0.5*(px[counter]+py[counter]))*0.01&#xA;   &amp;lt;&amp;lt; std::endl;&#xA;   }&#xA;   calculate_trapezoid(pn_minus_pt, num_slabs, z_min, z_max, result_trap);&#xA;   interfacial_tension_trap.push_back(result_trap);&#xA;   calculate_simpson(pn_minus_pt, num_slabs, z_min, z_max, result_simp);&#xA;   interfacial_tension_simp.push_back(result_simp);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Apparently just touching any of vectors with a print statement allows the program to execute correctly (i.e. a printout involving px, py, OR pz)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here's the full program:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/*********************************&#xA; *&#xA; * NAME: Interfacial Tension Calculator&#xA; * VERSION: 0.1&#xA; * AUTHOR: Jason R. Mick&#xA; * GROUP: Wayne State University, Potoff Group&#xA; * COPYRIGHT: (c) Jason R. Mick 2010&#xA; * DATE: August 9, 2010&#xA; *&#xA; * CHANGE LOG&#xA; * VERSION    DATE         COMMENTS&#xA; *----------------------------------------------------------------------&#xA; *  0.1   Aug. 9, 2010  Finished basic code, sans debugging  &#xA; *  0.5   Aug  10, 2010 Compiled and tested code fixed error in Simpson's&#xA; *                      method where results were being divided rather&#xA; *                      than multiplied.                       &#xA; *&#xA; *&#xA; * FULL NOTES:&#xA; *----------------------------------------------------------------------&#xA; * You can compile this program by typing:&#xA; * g++ main.cc -o it_util&#xA; *&#xA; * You can run this program by typing:&#xA; * it_util &amp;lt;filename&amp;gt;.log &amp;lt;# slabs&amp;gt; &amp;lt;z-min&amp;gt; &amp;lt;z-max&amp;gt;&#xA; *&#xA; * where z-min and z-max represent the z-axis boundaries of the system,&#xA; * e.g.--&#xA; * it_util my_file.log 140 0.0 80.0&#xA; *  &#xA; * This program only works with NAMD *.log file output&#xA; * The pressure profile MUST be turned on in your *.conf file&#xA; * for the pressure profile info to dump to the *.log file.  This&#xA; * program requires that info.&#xA; *&#xA; * This program can handle 1,000+ slabs, but it has a limit to the&#xA; * character buffer and thus VERY large slab counts may cause it to fail.&#xA; *&#xA; * A standard Composite Simpson numerical integration method is used,&#xA; * which assumes a non-smooth data set.&#xA; *&#xA; * The interfacial tension is integrated at each step and then averaged&#xA; * so pertinent statistics can be gathered.&#xA; *&#xA; * You can redirect the output to store the interfacial tension&#xA; * statistics as follows:&#xA; * it_util &amp;lt;filename&amp;gt;.log &amp;lt;# slabs&amp;gt; &amp;lt;z-min&amp;gt; &amp;lt;z-max&amp;gt; &amp;gt; &amp;lt;my_file&amp;gt;.out&#xA; * &#xA; *******************************************/&#xA;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;math.h&amp;gt;&#xA;&#xA;#include &amp;lt;iostream&amp;gt;&#xA;#include &amp;lt;vector&amp;gt;&#xA;#include &amp;lt;fstream&amp;gt;&#xA;&#xA;#include &amp;lt;sys/stat.h&amp;gt; &#xA;&#xA;//Turn on to enable all interfacial &#xA;//tension results to be printed, pre-averaging&#xA;//#define DEBUG true&#xA;&#xA;void start_integrations(const std::string filename, &#xA;   const unsigned int num_slabs,&#xA;   const double z_min, const double z_max);&#xA;&#xA;&#xA;int main ( int argc, char *argv[] )&#xA;{&#xA;  struct stat file_info; &#xA;  std::string filename = argv[1];&#xA;  int slab_count;&#xA;  double z_min;&#xA;  double z_max;&#xA;&#xA;  if ( argc != 5 ) /* argc should be 3 for correct execution */&#xA;  {&#xA;    /*Print out proper args syntax */&#xA;    std::cout &amp;lt;&amp;lt; &quot;ERROR: Missing arguments!&quot; &amp;lt;&amp;lt; std::endl &#xA;       &amp;lt;&amp;lt; &quot;Proper syntax:&quot; &amp;lt;&amp;lt; std::endl&#xA;       &amp;lt;&amp;lt; &quot;it_util &amp;lt;my_file&amp;gt;.log &amp;lt;# of slabs&amp;gt; &amp;lt;z-coord start&amp;gt;&quot;&#xA;       &amp;lt;&amp;lt; &quot;&amp;lt;z-coord end&amp;gt;&quot;&#xA;       &amp;lt;&amp;lt; std::endl;&#xA;  }&#xA;  if(stat(argv[1],&amp;amp;file_info)==0)&#xA;  {&#xA;    try&#xA;    {&#xA;      slab_count = atoi(argv[2]);&#xA;      if (slab_count &amp;gt; 2)&#xA;      {&#xA; try&#xA; {&#xA;   z_min = atof(argv[3]);&#xA;   try &#xA;   {&#xA;     z_max = atof(argv[4]);&#xA;     start_integrations(filename, &#xA;          static_cast&amp;lt;unsigned int&amp;gt;(slab_count),&#xA;          z_min,&#xA;          z_max);&#xA;   }&#xA;   catch( char * str ) &#xA;   {&#xA;     /*invalid integer third input*/&#xA;     std::cout &amp;lt;&amp;lt; &quot;Invalid input -- fourth argument was invalid &quot;&#xA;        &amp;lt;&amp;lt; &quot;decimal number, should be standard &quot; &amp;lt;&amp;lt; std::endl&#xA;        &amp;lt;&amp;lt; &quot;decimal type entry...&quot; &amp;lt;&amp;lt; std::endl&#xA;        &amp;lt;&amp;lt; &quot;I.E.&quot; &amp;lt;&amp;lt; std::endl&#xA;        &amp;lt;&amp;lt; &quot;it_util my_file.log 140 0.0 80.0&quot; &amp;lt;&amp;lt; std::endl;&#xA;&#xA;   }&#xA; }&#xA; catch( char * str ) &#xA; {&#xA;   /*invalid integer third input*/&#xA;   std::cout &amp;lt;&amp;lt; &quot;Invalid input -- third argument was invalid &quot;&#xA;      &amp;lt;&amp;lt; &quot;decimal number, should be standard &quot; &amp;lt;&amp;lt; std::endl&#xA;      &amp;lt;&amp;lt; &quot;decimal type entry...&quot; &amp;lt;&amp;lt; std::endl&#xA;      &amp;lt;&amp;lt; &quot;I.E.&quot; &amp;lt;&amp;lt; std::endl&#xA;      &amp;lt;&amp;lt; &quot;it_util my_file.log 140 0.0 80.0&quot; &amp;lt;&amp;lt; std::endl;&#xA;&#xA; }&#xA;      }&#xA;      else&#xA;      { &#xA; /*invalid integer secondary input*/&#xA; std::cout &amp;lt;&amp;lt; &quot;Invalid input -- second argument was invalid integer, &quot;&#xA;    &amp;lt;&amp;lt; &quot;should be unsigned integer 2 or greater...&quot; &amp;lt;&amp;lt; std::endl&#xA;    &amp;lt;&amp;lt; &quot;I.E.&quot; &amp;lt;&amp;lt; std::endl&#xA;    &amp;lt;&amp;lt; &quot;it_util my_file.log 140 0.0 80.0&quot; &amp;lt;&amp;lt; std::endl;&#xA;      }&#xA;    }&#xA;    catch( char * str ) &#xA;    {&#xA;      /*non integer secondary input*/&#xA;      std::cout &amp;lt;&amp;lt; &quot;Invalid input -- second argument was non-integer, &quot;&#xA;  &amp;lt;&amp;lt; &quot;should be unsigned integer 2 or greater...&quot; &amp;lt;&amp;lt; std::endl&#xA;  &amp;lt;&amp;lt; &quot;I.E.&quot; &amp;lt;&amp;lt; std::endl&#xA;  &amp;lt;&amp;lt; &quot;it_util my_file.log 140 0.0 80.0&quot; &amp;lt;&amp;lt; std::endl;&#xA;    }&#xA;  }&#xA;  else&#xA;  {&#xA;    /*invalid filename case...*/&#xA;    std::cout &amp;lt;&amp;lt; &quot;File &quot; &amp;lt;&amp;lt; filename &amp;lt;&amp;lt; &quot;does not exist!&quot; &amp;lt;&amp;lt; std::endl&#xA;       &amp;lt;&amp;lt; &quot;Please choose valid file!&quot; &amp;lt;&amp;lt; std::endl;&#xA;  }&#xA;&#xA;  return 1;&#xA;}&#xA;&#xA;bool calculate_simpson(const std::vector&amp;lt;double&amp;gt; my_values, &#xA;        const unsigned int num_points, &#xA;        const double x_min, const double x_max, &#xA;        double &amp;amp;results)&#xA;{&#xA;   bool ret_val = false;&#xA;   bool is_even = true;&#xA;   double h;&#xA;&#xA;   if (my_values.size() &amp;gt;= 2)&#xA;   {&#xA;      h = (x_max-x_min)/num_points;&#xA;      results+=my_values.front();&#xA;      for (unsigned int counter=1; counter&amp;lt;num_points-1;counter++)&#xA;      {&#xA;         if (is_even)&#xA;         {&#xA;            results+=4*my_values[counter];&#xA;         }&#xA;         else&#xA;         {&#xA;            results+=2*my_values[counter];&#xA;         }&#xA;         is_even = !is_even;&#xA;      }&#xA;      results+=my_values.back();&#xA;      results*=(h/3);&#xA;      ret_val=true;&#xA;   }&#xA;   return ret_val;&#xA;}&#xA;&#xA;bool calculate_trapezoid(const std::vector&amp;lt;double&amp;gt; my_values, &#xA;    const unsigned int num_points, &#xA;                         const double x_min, const double x_max, &#xA;    double &amp;amp;results)&#xA;{&#xA;   bool ret_val = false;&#xA;&#xA;   double x_incr = (x_max-x_min)/(num_points-1);&#xA;&#xA;   if (my_values.size() &amp;gt;= 2)&#xA;   {      &#xA;      for (unsigned int counter=1; counter&amp;lt;num_points-1; counter++)&#xA;      {&#xA;         results+=(x_incr/2)*(my_values[counter]+my_values[counter-1]);&#xA;      }&#xA;   }&#xA;   return ret_val;&#xA;}&#xA;&#xA;unsigned int get_next_space(const unsigned int start,&#xA;       const std::string data)&#xA;{&#xA;   unsigned int counter=start;&#xA;&#xA;   while (data.length() &amp;gt; counter &amp;amp;&amp;amp;&#xA;   data.substr(counter,1).compare(&quot; &quot;) != 0)&#xA;   {    &#xA;     counter++;&#xA;   }&#xA;&#xA;   //if end of string, add one&#xA;   if ( data.length() == counter)&#xA;     counter++;&#xA;   return (counter-1);&#xA;}&#xA;&#xA;bool extract_tension(std::vector&amp;lt;double&amp;gt; &amp;amp;interfacial_tension_trap,&#xA;       std::vector&amp;lt;double&amp;gt; &amp;amp;interfacial_tension_simp,&#xA;       const std::string data,&#xA;       const unsigned int num_slabs,&#xA;       const double z_min, const double z_max)&#xA;{&#xA;&#xA;   //start @ first number&#xA;   unsigned int start = 17;&#xA;   unsigned int end = 17;&#xA;&#xA;   std::vector&amp;lt;double&amp;gt; px;&#xA;   std::vector&amp;lt;double&amp;gt; py;&#xA;   std::vector&amp;lt;double&amp;gt; pz;&#xA;&#xA;   std::vector&amp;lt;double&amp;gt; pn_minus_pt;&#xA;&#xA;   double result_simp=0.0;&#xA;   double result_trap=0.0;&#xA;&#xA;   //skip timestep entry&#xA;   end=get_next_space(start, data);&#xA;&#xA;   for(unsigned int counter=0; counter&amp;lt;num_slabs;counter++)&#xA;   {&#xA;     start = end+2;&#xA;&#xA;     end=get_next_space(start, data);&#xA;     px.push_back(atof(data.substr(start,(end-start+1)).c_str()));&#xA;     //skip the space&#xA;     start = end+2;&#xA;     end=get_next_space(start, data);&#xA;     py.push_back(atof(data.substr(start,(end-start+1)).c_str()));&#xA;     //skip the space&#xA;     start = end+2;&#xA;     end=get_next_space(start, data);&#xA;     pz.push_back(atof(data.substr(start,(end-start+1)).c_str()));&#xA;&#xA;     //calculate pressure difference&#xA;     // WARNING : Unit conversion ahead&#xA;     // NAMD outputs pressure in bars and distance in Angstroms&#xA;     // we want an integrated result of mN/m, instead.&#xA;     // 1 Angstrom = 1e-10 m&#xA;     // 1 bar = 1e8 mN/m^2&#xA;     // net conversion -- 1e-2 &#xA;     pn_minus_pt.push_back((pz[counter]-0.5*(px[counter]+py[counter]))*0.01);&#xA;       std::cout &amp;lt;&amp;lt; &quot;Current del_P : &quot; &#xA;   &amp;lt;&amp;lt; (pz[counter]-0.5*(px[counter]+py[counter]))*0.01&#xA;   &amp;lt;&amp;lt; std::endl;&#xA;   }&#xA;   calculate_trapezoid(pn_minus_pt, num_slabs, z_min, z_max, result_trap);&#xA;   interfacial_tension_trap.push_back(result_trap);&#xA;   calculate_simpson(pn_minus_pt, num_slabs, z_min, z_max, result_simp);&#xA;   interfacial_tension_simp.push_back(result_simp);&#xA;}&#xA;&#xA;double average_vector(std::vector&amp;lt;double&amp;gt; my_vector)&#xA;{&#xA;   double average_val=0.0;&#xA;&#xA;   for(unsigned int counter=0; counter&amp;lt; my_vector.size(); counter++)&#xA;   {&#xA;     average_val+=my_vector[counter]/my_vector.size();&#xA;   }&#xA;&#xA;   return average_val;&#xA;}&#xA;&#xA;double std_dev_vector(std::vector&amp;lt;double&amp;gt; my_vector)&#xA;{&#xA;   double std_deviation=0.0;&#xA;   double average_val = average_vector(my_vector);&#xA;&#xA;   for(unsigned int counter=0; counter&amp;lt; my_vector.size(); counter++)&#xA;   {&#xA;     std_deviation+=(my_vector[counter]-average_val)*&#xA;       (my_vector[counter]-average_val);&#xA;   }&#xA;   std_deviation=sqrt(std_deviation);&#xA;&#xA;   return std_deviation;&#xA;}&#xA;&#xA;void start_integrations(const std::string filename, &#xA;   const unsigned int num_slabs,&#xA;   const double z_min, const double z_max)&#xA;{&#xA;   std::ifstream in_file;&#xA;   std::vector&amp;lt;double&amp;gt; interfacial_tension_trap;&#xA;   std::vector&amp;lt;double&amp;gt; interfacial_tension_simp;&#xA;   std::string current_line;&#xA;   char * cstr_line;&#xA;   bool data_grab_success = true;&#xA;&#xA;   in_file.open(filename.c_str(), std::ifstream::in);&#xA;   while (!in_file.eof() &amp;amp;&amp;amp; data_grab_success)&#xA;   {&#xA;     cstr_line=(char *) malloc(sizeof(char)*65536);&#xA;     //get new line&#xA;     in_file.getline(cstr_line,65536);&#xA;     current_line = cstr_line;&#xA;     free(cstr_line);&#xA;     if (current_line.substr(0,15).compare(&quot;PRESSUREPROFILE&quot;)==0)&#xA;     {&#xA;       //pressure profile found!&#xA;&#xA;       //process line to get the interfacial tension, check that it succeeded&#xA;       data_grab_success = extract_tension(interfacial_tension_trap,&#xA;       interfacial_tension_simp,&#xA;        current_line,&#xA;        num_slabs,&#xA;        z_min,&#xA;        z_max);&#xA;     }&#xA;   }&#xA;   in_file.close();&#xA;&#xA;   //print stats&#xA;   std::cout &amp;lt;&amp;lt; &quot;Interfacial Tension (Trapezoid Method): &quot; &#xA;      &amp;lt;&amp;lt; average_vector(interfacial_tension_trap) &amp;lt;&amp;lt; std::endl&#xA;      &amp;lt;&amp;lt; &quot;Standard Deviation (Trapezoid Method): &quot; &#xA;      &amp;lt;&amp;lt; std_dev_vector(interfacial_tension_trap) &amp;lt;&amp;lt; std::endl&#xA;      &amp;lt;&amp;lt; &quot;Interfacial Tension (Composite Simpson's Method): &quot; &#xA;      &amp;lt;&amp;lt; average_vector(interfacial_tension_simp) &amp;lt;&amp;lt; std::endl&#xA;      &amp;lt;&amp;lt; &quot;Standard Deviation (Composite Simpson's Method): &quot; &#xA;      &amp;lt;&amp;lt; std_dev_vector(interfacial_tension_simp) &amp;lt;&amp;lt; std::endl;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And here's a sample set of data:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Removed... see explanation at end of post for link to data to use.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Compile like so:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;g++ main.cc -o it_util&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Run using the command:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;it_util equil2_NVT_PP_318Slabs.log 318 0.0 318.0 &amp;gt; temp.out&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;FYI before someone comments on my #ifdef &quot;debug&quot; statements, please note that they are for data dumping.  I have used GDB before.  I'm guessing had I not said this, someone will comment &quot;Learn to use gdb.&quot;  In this case the program loops through so many iterations, GDB doesn't give me useful info, where printouts dumped to a output file DO.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;NOTE:&lt;br&gt;&#xA;Actually I discovered that if you use the chopped down version of the file being parsed (in the data section above) the program also doesn't output the correct data.  When I restored the original data file it worked, but the file is too large to post here (I tried...) so that is not an option....&#xA;Instead I've uploaded a full pastebin to here:&#xA;&lt;a href=&quot;http://pastebin.com/JasbSc7B&quot; rel=&quot;nofollow noreferrer&quot;&gt;http://pastebin.com/JasbSc7B&lt;/a&gt;&lt;/p&gt;&#xA;" OwnerUserId="375828" LastEditorUserId="21234" LastEditDate="2011-03-24T11:16:53.940" LastActivityDate="2011-03-24T11:16:53.940" Title="Weird Error in C++ Program: Removing Printout Breaks Program" Tags="&lt;c++&gt;&lt;printing&gt;&lt;cout&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="3571457" PostTypeId="1" AcceptedAnswerId="3571475" CreationDate="2010-08-26T01:27:57.953" Score="4" ViewCount="204" Body="&lt;p&gt;For C/C++, people use #ifdef .. #endif technique to prevent reloading libraries, and Objective-C uses import to do the same thing.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;How about lisp/elisp? If (require 'cl) is used before, and (require 'cl) is seen somewhere, lisp is clever enough not to load it again? Or, is there any way to prevent this reloading libraries?&lt;/p&gt;&#xA;" OwnerUserId="260127" LastEditorUserId="260127" LastEditDate="2010-08-26T01:47:33.220" LastActivityDate="2010-08-26T01:47:33.220" Title="Does 'require' in elisp/lisp prevent from reloading libraries?" Tags="&lt;lisp&gt;&lt;elisp&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="3720034" PostTypeId="1" AcceptedAnswerId="3720075" CreationDate="2010-09-15T17:11:43.507" Score="6" ViewCount="59797" Body="&lt;p&gt;I have this include file (&lt;code&gt;memory .h&lt;/code&gt;)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef MEMORY_H&#xA;#define MEMORY_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;    typedef struct mmemory {&#xA;        int* cells;&#xA;        int* current_cell;&#xA;        int cells_number;&#xA;    } memory;&#xA;&#xA;    void memory_init(memory* mymemory, int size);&#xA;    void step_left(memory* mymemory, int steps);&#xA;    void step_right(memory* mymemory, int steps);&#xA;    void cell_inc(memory* mymemory, int quantity);&#xA;    void print_cell(memory* mymemory);&#xA;    void get_char(memory* mymemory);&#xA;&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif  /* MEMORY_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And this implementation file (&lt;code&gt;memory.c&lt;/code&gt;)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &quot;memory.h&quot;&#xA;&#xA;void&#xA;memory_init (memory* mymemory, int size)&#xA;{&#xA;    mymemory-&amp;gt;cells = (int*) malloc (sizeof (int) * size);&#xA;    mymemory-&amp;gt;cells_number = size;&#xA;    mymemory-&amp;gt;current_cell = (int*) ((mymemory-&amp;gt;cells_number / 2) * sizeof (int));&#xA;}&#xA;... //other function definitions follow&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;When I try to compile &lt;code&gt;memory.c&lt;/code&gt; I get this error for each and every function definition&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;src/memory.c:5: error: expected ')' before '*' token&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;where line 5 is the function definition for &lt;code&gt;memory_init()&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Can someone please tell me why I'm getting this error?&lt;/p&gt;&#xA;" OwnerUserId="133203" LastActivityDate="2016-07-19T22:58:55.780" Title="error: expected ')' before '*' token" Tags="&lt;c&gt;" AnswerCount="3" CommentCount="3" FavoriteCount="4" />
  <row Id="3799091" PostTypeId="1" AcceptedAnswerId="3799180" CreationDate="2010-09-26T17:56:56.477" Score="1" ViewCount="242" Body="&lt;p&gt;I was wondering if there is some standardized way of getting type sizes in memory at the pre-processor stage - so in macro form, &lt;code&gt;sizeof()&lt;/code&gt; does not cut it.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;If their isn't a standardized method are their conventional methods that most IDE's use anyway?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Are there any other methods that anyone can think of to get such data?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I suppose I could do a two stage build kind of thing, get the output of a test program and feed it back into the IDE, but that's not really any easier than #defining them in myself.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thoughts?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;EDIT:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I just want to be able to swap code around with&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef / #endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Was it naive of me to think that an IDE or underlying compiler might define that information under some macro? Sure the pre-processor doesn't get information on any actual machine code generation functions, but the IDE and the Compiler do, and they call the pre-processor and declare stuff to it in advance.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;EDIT FURTHER&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What I imagined as a conceivable concept was this:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The C++ Committee has a standard that says for every type (perhaps only those native to C++) the compiler has to give to the IDE a header file, included by default that declares the size in memory that ever native type uses, like so:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define CHAR_SIZE 8&#xA;#define INT_SIZE 32&#xA;#define SHORT_INT_SIZE 16&#xA;#define FLOAT_SIZE 32&#xA;// etc&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Is there a flaw in this process somewhere?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;EDIT EVEN FURTHER&lt;/p&gt;&#xA;&#xA;&lt;p&gt;In order to get across the multi-platform build stage problem, perhaps this standard could mandate that a simple program like the one shown by lacqui would be required to compile and run be run by default, this way, whatever that gets type sizes will be the same machine that compiles the code in the second or 'normal' build stage.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Apologies:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I've been using 'Variable' instead of 'Type'&lt;/p&gt;&#xA;" OwnerUserId="328048" LastEditorUserId="2666859" LastEditDate="2016-06-18T12:18:22.757" LastActivityDate="2016-06-18T12:18:22.757" Title="Is there a standardised way to get type sizes in bytes in C++ Compilers?" Tags="&lt;c++&gt;&lt;compiler-construction&gt;&lt;c-preprocessor&gt;" AnswerCount="8" CommentCount="9" />
  <row Id="4469550" PostTypeId="1" AcceptedAnswerId="4469566" CreationDate="2010-12-17T10:23:41.290" Score="2" ViewCount="200" Body="&lt;p&gt;In Visual Studio 2008 (without SP1), I can compile and run this code&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// vcconsole.cpp : Defines the entry point for the console application.&#xA;//&#xA;&#xA;#include &quot;stdafx.h&quot;&#xA;#define NOERROR&#xA;#ifdef   /* &#xA;&#xA;   */  NOERROR&#xA;void pr() {&#xA; printf(&quot;hello world..\n&quot;);&#xA;} &#xA;#endif&#xA;&#xA;int _tmain(int argc, _TCHAR* argv[])&#xA;{&#xA; pr();&#xA; return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But if I manually replace the block comment with spaces :&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// vcconsole.cpp : Defines the entry point for the console application.&#xA;//&#xA;&#xA;#include &quot;stdafx.h&quot;&#xA;#define NOERROR&#xA;#ifdef      &#xA;&#xA;       NOERROR&#xA;void pr() {&#xA; printf(&quot;hello world..\n&quot;);&#xA;} &#xA;#endif&#xA;&#xA;int _tmain(int argc, _TCHAR* argv[])&#xA;{&#xA; pr();&#xA; return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;it fails to compile with error:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;1&amp;gt;------ Build started: Project: vcconsole, Configuration: Debug Win32 ------&#xA;1&amp;gt;Compiling...&#xA;1&amp;gt;vcconsole.cpp&#xA;1&amp;gt;c:\x64\winproj\vcconsole\vcconsole.cpp(6) : fatal error C1016: #if[n]def expected an identifier&#xA;1&amp;gt;Build log was saved at &quot;file://c:\x64\winproj\vcconsole\Debug\BuildLog.htm&quot;&#xA;1&amp;gt;vcconsole - 1 error(s), 0 warning(s)&#xA;========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Why the 2 are not equivalent?  &lt;/p&gt;&#xA;&#xA;&lt;p&gt;This concerns me because I am using a tool to remove all comments from my c++ source code (I need to do this for other reasons) before compiling them.  If the 2 are not equivalent somehow, my tool may fail.&lt;/p&gt;&#xA;" OwnerUserId="237575" LastEditorUserId="3043" LastEditDate="2011-12-21T15:03:41.093" LastActivityDate="2011-12-21T15:03:41.093" Title="Why Comment Cannot be Replaced by Spaces in Visual C++ 2008" Tags="&lt;c++&gt;&lt;comments&gt;" AnswerCount="4" CommentCount="5" />
  <row Id="4605842" PostTypeId="1" AcceptedAnswerId="4605893" CreationDate="2011-01-05T15:31:16.137" Score="94" ViewCount="80483" Body="&lt;p&gt;I'm writing a cross-platform code, which should compile at linux, windows, Mac OS. On windows, I must support visual studio and mingw.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;There are some pieces of platform-specific code, which I should place in &lt;code&gt;#ifdef .. #endif&lt;/code&gt; environment. For example, here I placed win32 specific code:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef WIN32&#xA;#include &amp;lt;windows.h&amp;gt;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But how do I recognize linux and mac OS? What are defines names (or etc.) I should use?&lt;/p&gt;&#xA;" OwnerUserId="424941" LastEditorUserId="4370109" LastEditDate="2016-06-19T14:19:01.373" LastActivityDate="2016-06-19T14:19:01.373" Title="How to identify platform/compiler from preprocessor macros?" Tags="&lt;c++&gt;&lt;macros&gt;&lt;cross-platform&gt;&lt;c-preprocessor&gt;" AnswerCount="4" CommentCount="9" FavoriteCount="47" />
  <row Id="4675481" PostTypeId="1" AcceptedAnswerId="6957013" CreationDate="2011-01-13T00:08:47.217" Score="1" ViewCount="46" Body="&lt;p&gt;I'm trying to convert a program and its plugin from custom Makefiles to CMake, with minimal changes to the code.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Both the plugin and the app share some code; #ifdef ... #else ... #endif blocks are used where there are differences, and I'm certain the code is compiled with the correct defines. The shared code includes a class called ToolImage. When the code is compiled for the app, the ToolImage constructor uses a different resource path than when it is compiled for the plugin.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef THE_APP&#xA; ToolImage::ToolImage(const wxString&amp;amp; name, bool full_path_given):wxImage(full_path_given?name:&#xA; (wxGetApp().GetResFolder() + _T(&quot;/bitmaps/&quot;) + name + _T(&quot;.png&quot;)), wxBITMAP_TYPE_PNG)&#xA;#else&#xA; ToolImage::ToolImage(const wxString&amp;amp; name, bool full_path_given):wxImage(full_path_given?name:&#xA; (theApp.GetResFolder() + _T(&quot;/bitmaps/&quot;) + name + _T(&quot;.png&quot;)), wxBITMAP_TYPE_PNG)&#xA;#endif&#xA;{&#xA; ...&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;When the program and its plugin have been compiled with the custom Makefiles, everything works as expected.  When both have been compiled with CMake, using a series of CMakeLists.txt files I created, there is an issue: the plugin isn't able to load the bitmaps for its toolbar. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I tracked the problem to the ToolImage class. The line number given by gdb tells me that the plugin is using the wrong constructor. strace tells me the same thing (the plugin is looking for its bitmaps in the app's resource dir rather than in the plugin's resource dir).  To ensure that I didn't have the defines screwed up, I put a #error in ToolImage.cpp, inside the part of the #ifdef that should only be compiled for the app - and the plugin still compiled without error. This tells me that the plugin is compiling with the correct code. Since it is using the wrong path, I think it is using the class and constructor compiled into the program instead of its own.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;How do I ensure that the plugin uses its own ToolImage class instead of the one in the app?! I don't own the project and don't want to make massive changes merely to support building with a different build system.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Using the precompiler to create two versions of a class seems like a poor choice to me.  If I must make changes to the code, do you have suggestions for a workaround?&lt;/p&gt;&#xA;" OwnerUserId="382458" LastActivityDate="2011-08-05T13:24:07.077" Title="identically-named classes in app and lib cause issues *after* converting from Makefile to cmake" Tags="&lt;plugins&gt;&lt;gcc&gt;&lt;makefile&gt;&lt;cmake&gt;&lt;name-conflict&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="4893681" PostTypeId="1" CreationDate="2011-02-04T01:30:26.903" Score="0" ViewCount="322" Body="&lt;p&gt;ListenSocket.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    //  class does not contain WSASTARTUP () and WSACLEANUP ()&#xA;&#xA;#ifndef LISTENTHREAD_H&#xA;#define LISTENTHREAD_H&#xA;#include &quot;includes.h&quot;&#xA;#include &quot;LOGMSGs.h&quot;&#xA;&#xA;// 1, CListenSocket: class is used to create the listener thread local variable.&#xA;// This class can be reused. When you call Close () is closed, re-calling Open () the new listening port. But the system did not use the feature.&#xA;class   CListenSocket&#xA;{&#xA;public:&#xA;    // main method:&#xA;    // BIND each object only to a port.&#xA;    CListenSocket(u_short nPort, int nSndSize = 0);&#xA;    // to release SOCKET&#xA;    ~CListenSocket(){};&#xA;    // Create server listening SOCKET, specific options see the code. Fails to return false.&#xA;    bool    Open();     // call can be repeated&#xA;    // error return INVALID_SOCKET&#xA;    SOCKET  Accept(u_long &amp;amp; nClientIP);&#xA;    // repeated calls. Usually not, can be used to take the initiative to close the SOCKET.&#xA;    // close the re-call after Open () re-use the object.&#xA;    void    Close();        // call can be repeated&#xA;    bool    IsOpen() { return m_bState; }&#xA;    bool    Rebuild();&#xA;public:&#xA;    SOCKET  Socket() { return m_sockListen; }&#xA;protected:&#xA;    // main member variables:&#xA;    const u_short   m_nPort;&#xA;    const int       m_nSndBuf;&#xA;    SOCKET  m_sockListen;&#xA;    // network status is normal sign.&#xA;    // When the value is false that the object is not available. May not have Open (), may also be a network error.&#xA;    bool    m_bState;&#xA;    time_t  m_tCloseTime;       // SOCKET last closed the time delay for the automatic re-SOCKET&#xA;};&#xA;&#xA;&#xA;&#xA;#endif  // LISTENTHREAD_H&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;ListenSocket.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;ListenSocket.h&quot;&#xA;long    s_nSocketCount = 0;&#xA;int     REBUILDLISTENDELAYSEC;&#xA;&#xA;CListenSocket::CListenSocket(u_short nPort, int nSndBuf /*= 0*/)    // 0: Default&#xA;         : m_nPort(nPort), m_nSndBuf(nSndBuf)&#xA;{&#xA;    m_sockListen    = INVALID_SOCKET;&#xA;    m_bState        = false;&#xA;//  m_nPort         = nPort;&#xA;    m_tCloseTime    = 0;&#xA;}&#xA;&#xA;//  Error returned INVALID_SOCKET&#xA;SOCKET  CListenSocket::Accept(u_long &amp;amp; nClientIP)&#xA;{&#xA;/*&#xA;    // Reconstruction SOCKET&#xA;    if(!m_bState)&#xA;    {&#xA;        if(clock() &amp;lt; m_tCloseTime + REBUILDLISTENDELAYSEC*CLOCKS_PER_SEC)&#xA;            return INVALID_SOCKET;&#xA;        else&#xA;        {&#xA;            LOGMSG(&quot;Anti-crash system start listening SOCKET [%d] re under construction...&quot;, m_nPort);&#xA;            if(Open())&#xA;            {&#xA;                LOGMSG(&quot;... listen SOCKET reconstruction success.&quot;);&#xA;                PrintText(&quot;Listen SOCKET [%d] failed to rebuild SOCKET success. Server continues to run in the ...&quot;, m_nPort);&#xA;            }&#xA;            else&#xA;            {&#xA;                Error(&quot;... listen SOCKET reconstruction has failed. Server will not accept new connections&quot;);&#xA;                PrintText(&quot;Listen SOCKET [%d] error, [%d] seconds after the re-SOCKET. Server continues to run in the ...&quot;, m_nPort, REBUILDLISTENDELAYSEC);        // nDelaySec);&#xA;            }&#xA;            m_tCloseTime = clock();&#xA;        }&#xA;    }&#xA;//*/&#xA;    if(!m_bState)&#xA;    {&#xA;        Error(&quot;ACCEPT inner exception a1&quot;);&#xA;        return INVALID_SOCKET;&#xA;    }&#xA;&#xA;    // ACCEPT&#xA;    struct sockaddr_in  addr;&#xA;    memset(&amp;amp;addr, 0, sizeof(addr));&#xA;    int    len = sizeof(addr);&#xA;    SOCKET newsock = accept(m_sockListen, (sockaddr*)&amp;amp;addr, (int*)&amp;amp;len);        // receive to the other side of the map, you can use&#xA;#ifdef  PROFILE_X&#xA;            // Analysis Accept speed (cycle speed)&#xA;            const int   nTimes2 = ACCEPTPROFILESEC;     // Statistics once every 30 seconds the speed ACCEPT&#xA;            static  clock_t tNextTime2 = clock() + nTimes2 * CLOCKS_PER_SEC;    //? Only one monitor thread, no sharing violation&#xA;            static long nCount2 = 0;                                //? Only one monitor thread, no sharing violation&#xA;            if(clock() &amp;gt;= tNextTime2)&#xA;            {&#xA;                PrintText(&quot;Each [%d] seconds to execute a [%d] times Accept ()&quot;, nTimes2, InterlockedExchange(&amp;amp;nCount2, 0));&#xA;                tNextTime2 = clock() + nTimes2 * CLOCKS_PER_SEC;&#xA;            }&#xA;            else&#xA;            {&#xA;                InterlockedIncrement(&amp;amp;nCount2);&#xA;            }&#xA;#endif  // PROFILE&#xA;    if(newsock == INVALID_SOCKET)&#xA;    {&#xA;        // Network Error&#xA;        int err = WSAGetLastError();&#xA;        if(err != WSAEWOULDBLOCK)&#xA;        {&#xA;            PrintText(&quot;Listen SOCKET %d failed, %s seconds after the re-SOCKET.&quot;, m_nPort, REBUILDLISTENDELAYSEC);&#xA;            Error(&quot;Listen SOCKET [%d] failed [%d], [%s] seconds after the re-SOCKET.&quot;, m_nPort, err, REBUILDLISTENDELAYSEC);&#xA;            Close();&#xA;        }&#xA;        else&#xA;            Error(&quot;ACCEPT inner exception a2&quot;);&#xA;            return INVALID_SOCKET;&#xA;    }&#xA;    else&#xA;    {&#xA;        nClientIP = addr.sin_addr.S_un.S_addr;&#xA;        InterlockedIncrement(&amp;amp;s_nSocketCount);&#xA;    }&#xA;&#xA;    // Check whether the SOCKET closed &#xA;    fd_set  readmask;&#xA;    FD_ZERO(&amp;amp;readmask);&#xA;    FD_SET(newsock, &amp;amp;readmask);&#xA;    struct timeval  timeout = {0, 0};&#xA;/*&#xA;    char nTemp;&#xA;    if(select(FD_SETSIZE, &amp;amp;readmask, (fd_set *) 0, (fd_set *) 0, &amp;amp;timeout) &#xA;            &amp;amp;&amp;amp; recv(newsock, &amp;amp;nTemp, 1, MSG_PEEK) == 0)&#xA;    {&#xA;#ifdef  ALPHA_X&#xA;        LOGMSG(&quot;ACCEPT a new SOCKET is invalid .&quot;);&#xA;#endif&#xA;        closesocket(newsock);&#xA;        InterlockedDecrement(&amp;amp;s_nSocketCount);&#xA;        return INVALID_SOCKET;&#xA;    }&#xA;//else*/&#xA;//*&#xA;    fd_set  exceptmask;&#xA;    FD_ZERO(&amp;amp;exceptmask);&#xA;    FD_SET(newsock, &amp;amp;exceptmask);&#xA;    int ret = select(FD_SETSIZE, &amp;amp;readmask, (fd_set *) 0, (fd_set *) &amp;amp;exceptmask, &amp;amp;timeout);&#xA;    if(ret &amp;lt; 0)&#xA;    {&#xA;        Error(&quot;ACCEPT a new SOCKET is invalid . can't read&quot;);       // Not trigger&#xA;        closesocket(newsock);&#xA;        InterlockedDecrement(&amp;amp;s_nSocketCount);&#xA;        return INVALID_SOCKET;&#xA;    }&#xA;    else if(ret &amp;gt; 0)&#xA;    {&#xA;        if(FD_ISSET(newsock, &amp;amp;exceptmask))&#xA;        {&#xA;            LOGMSG(&quot;ACCEPT a new SOCKET is invalid.except&quot;);        // Not trigger&#xA;            closesocket(newsock);&#xA;            InterlockedDecrement(&amp;amp;s_nSocketCount);&#xA;            return INVALID_SOCKET;&#xA;        }&#xA;        else if(FD_ISSET(newsock, &amp;amp;readmask))&#xA;        {&#xA;            char nTemp;&#xA;            if(recv(newsock, &amp;amp;nTemp, 1, MSG_PEEK) == 0)&#xA;            {&#xA;#ifdef  ALPHA_X&#xA;                LOGMSG(&quot;ACCEPT a new SOCKET is invalid. recv==0&quot;);      // Not trigger&#xA;#endif&#xA;                closesocket(newsock);&#xA;                InterlockedDecrement(&amp;amp;s_nSocketCount);&#xA;                return INVALID_SOCKET;&#xA;            }&#xA;        }&#xA;    }&#xA;//*/&#xA;#ifdef  PROFILE_X&#xA;            // analysis Accept speed (received valid SOCKET)&#xA;            const int   nTimes = ACCEPTPROFILESEC;      // Statistics once every 10 seconds the speed ACCEPT&#xA;            static  clock_t tNextTime = clock() + nTimes * CLOCKS_PER_SEC;      //? Only one monitor thread, no sharing violation&#xA;            static long nCount  = 0;                            //? Only one monitor thread, no sharing violation&#xA;            if(clock() &amp;gt;= tNextTime)&#xA;            {&#xA;                LOGPROFILE(&quot;Port [%d] for every [%d] seconds, the successful implementation of the [%d] times Accept()&quot;, &#xA;                            m_nPort, nTimes, InterlockedExchange(&amp;amp;nCount, 0));&#xA;                tNextTime = clock() + nTimes * CLOCKS_PER_SEC;&#xA;            }&#xA;            else&#xA;            {&#xA;                InterlockedIncrement(&amp;amp;nCount);&#xA;            }&#xA;#endif  // PROFILE&#xA;&#xA;    return newsock;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Main.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;includes.h&quot;&#xA;#include &quot;IniFile.h&quot;&#xA;#include &quot;LOGMSGs.h&quot;&#xA;#include &quot;ListenSocket.h&quot;&#xA;&#xA;CListenSocket Sock(9985);&#xA;int main()&#xA;{&#xA;    Sock.Open();&#xA;    if(!Sock.Open())&#xA;    {&#xA;        Sock.Rebuild();&#xA;    }&#xA;    if(Sock.IsOpen())&#xA;        PrintText(&quot;okey&quot;);&#xA;    Sock.Socket();&#xA;    u_long ip;&#xA;    Sock.Accept(ip);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but i always got this error : ACCEPT inner exception a2 while it should work anyclue why?&lt;/p&gt;&#xA;" OwnerUserId="584081" LastEditorUserId="584081" LastEditDate="2011-02-04T04:12:49.713" LastActivityDate="2011-02-04T04:12:49.713" Title="Socket class Error" Tags="&lt;c++&gt;" AnswerCount="1" CommentCount="5" />
  <row Id="4955965" PostTypeId="1" CreationDate="2011-02-10T10:31:42.710" Score="0" ViewCount="1444" Body="&lt;p&gt;RC5.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef RC5_H&#xA;#define RC5_H&#xA;&#xA;#define RC5_32          32&#xA;&#xA;#define RC5_12          12&#xA;#define RC5_SUB         (RC5_12*2 + 2)&#xA;&#xA;#define RC5_16          16&#xA;#define RC5_KEY         (RC5_16/4)&#xA;&#xA;const unsigned long RC5_PW32    = 0xB7E15163;&#xA;const unsigned long RC5_QW32    = 0x61C88647;&#xA;&#xA;const unsigned char RC5PASSWORD_KEY[16] = { 0x3C, 0xDC, 0xFE, 0xE8, 0xC4, 0x54, 0xD6, 0x7E, &#xA;                                            0x16, 0xA6, 0xF8, 0x1A, 0xE8, 0xD0, 0x38, 0xBE };&#xA;const unsigned char RC5BARPASSWORD_KEY[16] = {  0x44, 0xD0, 0xE2, 0xBA, 0x4A, 0x38, 0x14, 0x44, &#xA;                                                0x64, 0xE0, 0x12, 0xAE, 0xDA, 0x56, 0x1C, 0xF8 };&#xA;&#xA;////////////////////////////////////////////////////////////////////////////////////////////////&#xA;&#xA;class   CRc5&#xA;{&#xA;public:&#xA;    void Rc5InitKey(const unsigned char bufKey[RC5_16]);&#xA;    void Rc5Encrypt(void* buf, int nLen8);&#xA;    void Rc5Decrypt(void* buf, int nLen8);&#xA;&#xA;protected:&#xA;    unsigned long   m_bufKey[RC5_KEY];&#xA;    unsigned long   m_bufSub[RC5_SUB];&#xA;};&#xA;&#xA;#endif // RC5_H&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;RC5.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;string&amp;gt;&#xA;#include &amp;lt;assert.h&amp;gt;&#xA;&#xA;#include &quot;RC5.h&quot;&#xA;&#xA;&#xA;unsigned long   rotate_left(unsigned long nData, unsigned long nCount);&#xA;unsigned long   rotate_right(unsigned long nData, unsigned long nCount);&#xA;&#xA;void CRc5::Rc5InitKey(const unsigned char bufKey[RC5_16])&#xA;{&#xA;    try{&#xA;        memcpy(m_bufKey, bufKey, RC5_16);&#xA;    }catch(...) {&#xA;#ifdef  _DEBUG&#xA;        assert(!&quot;InitRc5Key()&quot;);&#xA;#endif&#xA;    }&#xA;    /*for (int i = 0; i &amp;lt; 4; i++)&#xA;    m_bufKey[i] = (long)(bufKey[i * 4] + (bufKey[i * 4 + 1] &amp;lt;&amp;lt; 8) + (bufKey[i * 4 + 2] &amp;lt;&amp;lt; 16) + (bufKey[i * 4 + 3] &amp;lt;&amp;lt; 24));&#xA;    m_bufSub[0] = RC5_PW32;*/&#xA;    m_bufSub[0] = RC5_PW32;&#xA;    for(int i = 1; i&amp;lt;26; i++)&#xA;    {&#xA;        m_bufSub[i] = m_bufSub[i-1] - RC5_QW32;&#xA;    }&#xA;    int             i, j;&#xA;    unsigned long   x, y;&#xA;    i = j = x = y = 0;&#xA;    for(int k = 0; k &amp;lt;=78; k++)&#xA;    {&#xA;        m_bufSub[i] = rotate_left((m_bufSub[i] + x + y), 3);&#xA;        x = m_bufSub[i];&#xA;        i = (i + 1) % 0x1A;&#xA;        m_bufKey[j] = rotate_left((m_bufKey[j] + x + y), (x + y));&#xA;        y = m_bufKey[j];&#xA;        j = (j + 1) % 4;&#xA;    }&#xA;}&#xA;&#xA;&#xA;void CRc5::Rc5Encrypt(void* buf, int nLen8)&#xA;{&#xA;    assert(nLen8 % 8 == 0);&#xA;    nLen8 = (nLen8/8) * 8;&#xA;    if(nLen8 &amp;lt;= 0)&#xA;        return;&#xA;&#xA;    unsigned long* bufData = (unsigned long*)buf;&#xA;    for(int k = 0; k &amp;lt; nLen8/8; k++)&#xA;    {&#xA;        unsigned long   a = bufData[2*k];&#xA;        unsigned long   b = bufData[2*k + 1];&#xA;&#xA;        unsigned long   le  = a + m_bufSub[0];&#xA;        unsigned long   re  = b + m_bufSub[1];&#xA;        for(int i = 1; i &amp;lt;= 12; i++)&#xA;        {&#xA;            le = rotate_left((le ^ re), re) + m_bufSub[2*i];&#xA;            re = rotate_left((re ^ le), le) + m_bufSub[2*i + 1];&#xA;        }&#xA;&#xA;        bufData[2*k]        = le;&#xA;        bufData[2*k + 1]    = re;&#xA;    }&#xA;}&#xA;&#xA;////////////////////////////////////////////////////////////////////////////////////////////////&#xA;void CRc5::Rc5Decrypt(void* buf, int nLen8)&#xA;{&#xA;    assert(nLen8 % 8 == 0);&#xA;    nLen8 = (nLen8/8) * 8;&#xA;    if(nLen8 &amp;lt;= 0)&#xA;        return;&#xA;&#xA;    unsigned long* bufData = (unsigned long*)buf;&#xA;    for(int k = 0; k &amp;lt; nLen8/8; k++)&#xA;    {&#xA;        unsigned long   ld  = bufData[2*k];&#xA;        unsigned long   rd  = bufData[2*k + 1];&#xA;        for(int i = 12; i &amp;gt;= 1; i--)&#xA;        {&#xA;            rd = rotate_right((rd - m_bufSub[2*i + 1]),  ld) ^ ld;&#xA;            ld = rotate_right((ld - m_bufSub[2*i]),  rd) ^ rd;&#xA;        }&#xA;&#xA;        unsigned long   b = rd - m_bufSub[1];&#xA;        unsigned long   a = ld - m_bufSub[0];&#xA;&#xA;        bufData[2*k]        = a;&#xA;        bufData[2*k + 1]    = b;&#xA;    }&#xA;}&#xA;&#xA;&#xA;&#xA;unsigned long   rotate_left(unsigned long nData, unsigned long nCount)&#xA;{&#xA;     return (nData &amp;lt;&amp;lt; (nCount &amp;amp; 0x1F) | nData &amp;gt;&amp;gt; 0x20 - (nCount &amp;amp; 0x1F));&#xA;}&#xA;&#xA;////////////////////////////////////////////////////////////////////////////////////////////////&#xA;unsigned long   rotate_right(unsigned long nData, unsigned long nCount)&#xA;{&#xA;    return (nData &amp;lt;&amp;lt; (nCount &amp;amp; 0x1F) | nData &amp;gt;&amp;gt; 0x20 - (nCount &amp;amp; 0x1F));&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;main.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//all the stuff&#xA;char buf[4000];&#xA;            char acc[16];&#xA;            char psw[16];&#xA;            recv(sConnect,buf,sizeof(buf),0);&#xA;            //dec.Rc5InitKey(RC5PASSWORD_KEY);&#xA;            dec.Rc5Decrypt(buf,16);&#xA;            cout &amp;lt;&amp;lt; buf;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;why did i post it here i cant decrypt the buf which i get from the client (but we dont play this game!) yes i know but am sure that am doing something wrong inside the code so maybe someone was dealing with RC5 knows what am doing wrong , if not it's okey . thnx&lt;/p&gt;&#xA;" OwnerUserId="584081" LastEditorUserId="402169" LastEditDate="2011-02-10T10:57:51.470" LastActivityDate="2011-02-10T10:57:51.470" Title="RC5 Decrypt/Encrypt for Conquer game client" Tags="&lt;c++&gt;&lt;encryption&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="0" />
  <row Id="5033666" PostTypeId="1" AcceptedAnswerId="5033684" CreationDate="2011-02-17T19:35:34.173" Score="6" ViewCount="5694" Body="&lt;p&gt;What is the importance of .pch file and what is the significance of&quot;#ifdef &lt;strong&gt;OBJC&lt;/strong&gt;&quot;?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Also, where do we define parameters like &quot;#ifdef IS_PRODUCTION&quot; which are checked in .pch file.&lt;/p&gt;&#xA;" OwnerUserId="418029" LastActivityDate="2013-06-04T07:34:29.947" Title="&lt;AppName&gt;.pch file usage" Tags="&lt;iphone&gt;&lt;cocoa&gt;&lt;ios&gt;&lt;pch&gt;" AnswerCount="2" CommentCount="0" FavoriteCount="5" />
  <row Id="5438302" PostTypeId="1" CreationDate="2011-03-25T21:26:59.543" Score="1" ViewCount="946" Body="&lt;p&gt;A while back I wrote an thin wrapper around a commercial DAQ library&#xA;using ctypes.  Since then I've come across Cython and wanted to give&#xA;it a go, thinking it might make it better/cleaner all around than what&#xA;I had before.  Most of the Cython documentation makes sense, and I've&#xA;found most of what I know but the library I'm wrapping is highly&#xA;windows specific and does things a little different than standard C/C+&#xA;+ code, at least as far as I can tell.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here's a couple of snippets from the header file, that I'm not exactly&#xA;sure how to wrap.&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef DAQ_H&#xA;#define DAQ_H&#xA;&#xA;#ifdef   __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;#if !defined(_DAQAPI32_)&#xA;  #define  DAQAPI   __declspec(dllimport)&#xA;#else&#xA;  #define  DAQAPI&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;From what I gather, I probably can ignore most of this in my cython&#xA;definition?  I've tried compiling C code with gcc, but it throws errors at every function definition.  With ctypes I accessed the library directly, and did not use the header file at all.&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* Handle Type Definition */&#xA;typedef  INT   DaqHandleT;&#xA;&#xA;/* Initialization and Locking Prototypes */&#xA;DAQAPI DaqHandleT WINAPI   daqOpen(LPSTR daqName);&#xA;DAQAPI DaqError WINAPI     daqClose(DaqHandleT handle);&#xA;DAQAPI DaqError WINAPI     daqOnline(DaqHandleT handle, PBOOL online);&#xA;&#xA;/* Error Handler Type Definitions */&#xA;typedef VOID CALLBACK      DaqErrorHandlerFT(DaqHandleT handle,&#xA;DaqError errCode);&#xA;typedef DaqErrorHandlerFT  *DaqErrorHandlerFPT;&#xA;&#xA;/* Error Handler Function Prototypes */&#xA;DAQAPI DaqError WINAPI  daqSetDefaultErrorHandler(DaqErrorHandlerFPT&#xA;handler);&#xA;DAQAPI DaqError WINAPI  daqSetErrorHandler(DaqHandleT handle,&#xA;DaqErrorHandlerFPT handler);&#xA;DAQAPI DaqError WINAPI  daqProcessError(DaqHandleT handle, DaqError&#xA;errCode);&#xA;DAQAPI DaqError WINAPI  daqGetLastError(DaqHandleT handle, DaqError&#xA;*errCode);&#xA;DAQAPI VOID CALLBACK    daqDefaultErrorHandler(DaqHandleT handle,&#xA;DaqError errCode);&#xA;DAQAPI DaqError WINAPI  daqFormatError(DaqError errorNum, PCHAR msg);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;This is basically how most functions are declared and operate.  They&#xA;only return error codes, all important information to get out of it is&#xA;done through pointers.  I couldn't find anything in the documentation&#xA;on how to work with pointers for return types, I probably didn't look&#xA;hard enough.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Can anyone point me in the right direction for wrapping these sorts of&#xA;functions?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Things like DaqError are actually enums declared in the header file,&#xA;they go abit enum crazy in this library, some 1500 lines of it.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks for any help,&lt;/p&gt;&#xA;" OwnerUserId="677469" LastActivityDate="2011-03-29T06:38:11.753" Title="Writing a Python wrapper for difficult C header file using Cython" Tags="&lt;python&gt;&lt;cython&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="5710635" PostTypeId="1" AcceptedAnswerId="5710818" CreationDate="2011-04-19T01:29:21.757" Score="1" ViewCount="847" Body="&lt;p&gt;When compiling with gcc we can view preprocessed source files with option -E. How can we apply this to the Makefile of kernel modules (external compile). The source files contain a lot of #ifdef #else #endif, is there a way to quick check which parts of code are actually included in the compiled file. Any suggestions are appreciated. Thanks in advanced.&lt;/p&gt;&#xA;" OwnerUserId="560431" LastActivityDate="2011-04-19T02:05:03.963" Title="View Linux module source file after preprocessed" Tags="&lt;linux&gt;&lt;gcc&gt;&lt;device-driver&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="5712253" PostTypeId="1" CreationDate="2011-04-19T06:07:40.473" Score="2" ViewCount="1067" Body="&lt;p&gt;I try to porting function on the OpenCL kernel, but compiler gave me next error:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;  cvmsErrorCompilerFailure: LLVM compiler has failed to compile a function.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Here is my kernel code:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//#pragma OPENCL EXTENSION cl_khr_byte_addressable_store : enable&#xA;&#xA;//##############################################################################&#xA;// Utils function&#xA;//##############################################################################&#xA;void mmemcpy(unsigned char *dst, const unsigned char *src, size_t len) {&#xA;    for (size_t i = 0; i &amp;lt; len; i++)&#xA;        dst[i] = src[i];&#xA;}&#xA;&#xA;&#xA;//##############################################################################&#xA;// Tree hashing constants definition&#xA;//##############################################################################&#xA;/* tweak word T[1]: bit field starting positions */&#xA;#define SKEIN_T1_BIT(BIT)       ((BIT) - 64)            /* offset 64 because it's the second word  */&#xA;&#xA;#define SKEIN_T1_POS_TREE_LVL   SKEIN_T1_BIT(112)       /* bits 112..118: level in hash tree       */&#xA;#define SKEIN_T1_POS_BIT_PAD    SKEIN_T1_BIT(119)       /* bit  119     : partial final input byte */&#xA;#define SKEIN_T1_POS_BLK_TYPE   SKEIN_T1_BIT(120)       /* bits 120..125: type field               */&#xA;#define SKEIN_T1_POS_FIRST      SKEIN_T1_BIT(126)       /* bits 126     : first block flag         */&#xA;#define SKEIN_T1_POS_FINAL      SKEIN_T1_BIT(127)       /* bit  127     : final block flag         */&#xA;&#xA;/* tweak word T[1]: flag bit definition(s) */&#xA;#define SKEIN_T1_FLAG_FIRST     (((unsigned long)  1 ) &amp;lt;&amp;lt; SKEIN_T1_POS_FIRST)&#xA;#define SKEIN_T1_FLAG_FINAL     (((unsigned long)  1 ) &amp;lt;&amp;lt; SKEIN_T1_POS_FINAL)&#xA;#define SKEIN_T1_FLAG_BIT_PAD   (((unsigned long)  1 ) &amp;lt;&amp;lt; SKEIN_T1_POS_BIT_PAD)&#xA;&#xA;//##############################################################################&#xA;// Skein macros&#xA;//##############################################################################&#xA;#ifndef RotL_64&#xA;#define RotL_64(x, N)    (((x) &amp;lt;&amp;lt; (N)) | ((x) &amp;gt;&amp;gt; (64-(N))))&#xA;#endif&#xA;&#xA;//##############################################################################&#xA;// Skein block&#xA;//##############################################################################&#xA;#ifndef SKEIN_USE_ASM&#xA;#define SKEIN_USE_ASM   (0)                     /* default is all C code (no ASM) */&#xA;#endif&#xA;&#xA;#ifndef SKEIN_LOOP&#xA;#define SKEIN_LOOP 001                          /* default: unroll 256 and 512, but not 1024 */&#xA;#endif&#xA;&#xA;#define BLK_BITS        (WCNT*64)               /* some useful definitions for code here */&#xA;#define KW_TWK_BASE     (0)&#xA;#define KW_KEY_BASE     (3)&#xA;#define ks              (kw + KW_KEY_BASE)                &#xA;#define ts              (kw + KW_TWK_BASE)&#xA;&#xA;//##############################################################################&#xA;// Port settings&#xA;//##############################################################################&#xA;/* Platform settings */&#xA;#define IS_BIG_ENDIAN      4321 /* byte 0 is most significant (mc68k) */&#xA;#define IS_LITTLE_ENDIAN   1234 /* byte 0 is least significant (i386) */&#xA;&#xA;/* Define platfor here */&#xA;#define PLATFORM_BYTE_ORDER IS_LITTLE_ENDIAN&#xA;&#xA;#if PLATFORM_BYTE_ORDER == IS_BIG_ENDIAN&#xA;/* here for big-endian */&#xA;#define SKEIN_NEED_SWAP (1)&#xA;#elif PLATFORM_BYTE_ORDER == IS_LITTLE_ENDIAN&#xA;/* here for little-endian */&#xA;#define SKEIN_NEED_SWAP (0)&#xA;#if PLATFORM_MUST_ALIGN == 0              /* ok to use &quot;fast&quot; versions? */&#xA;#define Skein_Put64_LSB_First(dst08, src64, bCnt) mmemcpy(dst08, src64, bCnt)&#xA;#define Skein_Get64_LSB_First(dst64, src08, wCnt) mmemcpy(dst64, src08, 8*(wCnt))&#xA;#endif&#xA;#endif&#xA;&#xA;//##############################################################################&#xA;// Skein.h&#xA;//##############################################################################&#xA;enum {   &#xA;    /* Skein_256 round rotation constants */&#xA;    R_256_0_0=14, R_256_0_1=16,&#xA;    R_256_1_0=52, R_256_1_1=57,&#xA;    R_256_2_0=23, R_256_2_1=40,&#xA;    R_256_3_0= 5, R_256_3_1=37,&#xA;    R_256_4_0=25, R_256_4_1=33,&#xA;    R_256_5_0=46, R_256_5_1=12,&#xA;    R_256_6_0=58, R_256_6_1=22,&#xA;    R_256_7_0=32, R_256_7_1=32,&#xA;&#xA;    /* Skein_512 round rotation constants */&#xA;    R_512_0_0=46, R_512_0_1=36, R_512_0_2=19, R_512_0_3=37,&#xA;    R_512_1_0=33, R_512_1_1=27, R_512_1_2=14, R_512_1_3=42,&#xA;    R_512_2_0=17, R_512_2_1=49, R_512_2_2=36, R_512_2_3=39,&#xA;    R_512_3_0=44, R_512_3_1= 9, R_512_3_2=54, R_512_3_3=56,&#xA;    R_512_4_0=39, R_512_4_1=30, R_512_4_2=34, R_512_4_3=24,&#xA;    R_512_5_0=13, R_512_5_1=50, R_512_5_2=10, R_512_5_3=17,&#xA;    R_512_6_0=25, R_512_6_1=29, R_512_6_2=39, R_512_6_3=43,&#xA;    R_512_7_0= 8, R_512_7_1=35, R_512_7_2=56, R_512_7_3=22,&#xA;&#xA;    /* Skein1024 round rotation constants */&#xA;    R1024_0_0=24, R1024_0_1=13, R1024_0_2= 8, R1024_0_3=47, R1024_0_4= 8, R1024_0_5=17, R1024_0_6=22, R1024_0_7=37,&#xA;    R1024_1_0=38, R1024_1_1=19, R1024_1_2=10, R1024_1_3=55, R1024_1_4=49, R1024_1_5=18, R1024_1_6=23, R1024_1_7=52,&#xA;    R1024_2_0=33, R1024_2_1= 4, R1024_2_2=51, R1024_2_3=13, R1024_2_4=34, R1024_2_5=41, R1024_2_6=59, R1024_2_7=17,&#xA;    R1024_3_0= 5, R1024_3_1=20, R1024_3_2=48, R1024_3_3=41, R1024_3_4=47, R1024_3_5=28, R1024_3_6=16, R1024_3_7=25,&#xA;    R1024_4_0=41, R1024_4_1= 9, R1024_4_2=37, R1024_4_3=31, R1024_4_4=12, R1024_4_5=47, R1024_4_6=44, R1024_4_7=30,&#xA;    R1024_5_0=16, R1024_5_1=34, R1024_5_2=56, R1024_5_3=51, R1024_5_4= 4, R1024_5_5=53, R1024_5_6=42, R1024_5_7=41,&#xA;    R1024_6_0=31, R1024_6_1=44, R1024_6_2=47, R1024_6_3=46, R1024_6_4=19, R1024_6_5=42, R1024_6_6=44, R1024_6_7=25,&#xA;    R1024_7_0= 9, R1024_7_1=48, R1024_7_2=35, R1024_7_3=52, R1024_7_4=23, R1024_7_5=31, R1024_7_6=37, R1024_7_7=20&#xA;};&#xA;&#xA;#ifndef SKEIN_ID_STRING_LE      /* allow compile-time personalization */&#xA;#define SKEIN_ID_STRING_LE      (0x33414853)            /* &quot;SHA3&quot; (little-endian)*/&#xA;#endif&#xA;&#xA;#define SKEIN_MK_64(hi32,lo32)  ((lo32) + (((unsigned long) (hi32)) &amp;lt;&amp;lt; 32))&#xA;#define SKEIN_SCHEMA_VER        SKEIN_MK_64(SKEIN_VERSION,SKEIN_ID_STRING_LE)&#xA;#define SKEIN_KS_PARITY         SKEIN_MK_64(0x1BD11BDA,0xA9FC1A22)&#xA;&#xA;//##############################################################################&#xA;// Skein structures&#xA;//##############################################################################&#xA;enum {&#xA;    SKEIN_SUCCESS         =      0,          /* return codes from Skein calls */&#xA;    SKEIN_FAIL            =      1,&#xA;    SKEIN_BAD_HASHLEN     =      2&#xA;};&#xA;&#xA;#define  SKEIN_MODIFIER_WORDS  ( 2)          /* number of modifier (tweak) words */&#xA;&#xA;#define  SKEIN_256_STATE_WORDS ( 4)&#xA;#define  SKEIN_512_STATE_WORDS ( 8)&#xA;#define  SKEIN1024_STATE_WORDS (16)&#xA;#define  SKEIN_MAX_STATE_WORDS (16)&#xA;&#xA;#define  SKEIN_256_STATE_BYTES ( 8*SKEIN_256_STATE_WORDS)&#xA;#define  SKEIN_512_STATE_BYTES ( 8*SKEIN_512_STATE_WORDS)&#xA;#define  SKEIN1024_STATE_BYTES ( 8*SKEIN1024_STATE_WORDS)&#xA;&#xA;#define  SKEIN_256_STATE_BITS  (64*SKEIN_256_STATE_WORDS)&#xA;#define  SKEIN_512_STATE_BITS  (64*SKEIN_512_STATE_WORDS)&#xA;#define  SKEIN1024_STATE_BITS  (64*SKEIN1024_STATE_WORDS)&#xA;&#xA;#define  SKEIN_256_BLOCK_BYTES ( 8*SKEIN_256_STATE_WORDS)&#xA;#define  SKEIN_512_BLOCK_BYTES ( 8*SKEIN_512_STATE_WORDS)&#xA;#define  SKEIN1024_BLOCK_BYTES ( 8*SKEIN1024_STATE_WORDS)&#xA;&#xA;#define SKEIN_256_ROUNDS_TOTAL (72)          /* number of rounds for the different block sizes */&#xA;#define SKEIN_512_ROUNDS_TOTAL (72)&#xA;#define SKEIN1024_ROUNDS_TOTAL (80)&#xA;&#xA;typedef struct {&#xA;    unsigned long  hashBitLen;                             /* size of hash result, in bits */&#xA;    unsigned long  bCnt;                                   /* current byte count in buffer b[] */&#xA;    unsigned long  T[SKEIN_MODIFIER_WORDS];         /* tweak words: T[0]=byte cnt, T[1]=flags */&#xA;} Skein_Ctxt_Hdr_t;&#xA;&#xA;typedef struct {                                    /*  256-bit Skein hash context structure */&#xA;    Skein_Ctxt_Hdr_t h;                             /* common header context variables */&#xA;    unsigned long  X[SKEIN_256_STATE_WORDS];        /* chaining variables */&#xA;    unsigned char  b[SKEIN_256_BLOCK_BYTES];        /* partial block buffer (8-byte aligned) */&#xA;} Skein_256_Ctxt_t;&#xA;&#xA;//##############################################################################&#xA;// 256-bit Skein &#xA;//##############################################################################&#xA;/*****************************  Skein_256 ******************************/&#xA;void Skein_256_Process_Block(Skein_256_Ctxt_t *ctx, const unsigned *blkPtr, unsigned long blkCnt, unsigned long byteCntAdd) { /* do it in C */&#xA;&#xA;    enum {&#xA;        WCNT = SKEIN_256_STATE_WORDS&#xA;    };&#xA;#undef  RCNT&#xA;#define RCNT (SKEIN_256_ROUNDS_TOTAL/8)&#xA;&#xA;#ifdef  SKEIN_LOOP                              /* configure how much to unroll the loop */&#xA;#define SKEIN_UNROLL_256 (((SKEIN_LOOP)/100)%10)&#xA;#else&#xA;#define SKEIN_UNROLL_256 (0)&#xA;#endif&#xA;&#xA;#if SKEIN_UNROLL_256&#xA;#if (RCNT % SKEIN_UNROLL_256)&#xA;#error &quot;Invalid SKEIN_UNROLL_256&quot;               /* sanity check on unroll count */&#xA;#endif&#xA;    unsigned long  r;&#xA;    unsigned long  kw[WCNT+4+RCNT*2];           /* key schedule words : chaining vars + tweak + &quot;rotation&quot;*/&#xA;#else&#xA;    unsigned long  kw[WCNT+4];                         /* key schedule words : chaining vars + tweak */&#xA;#endif&#xA;    unsigned long  X0, X1, X2, X3;                        /* local copy of context vars, for speed */&#xA;    unsigned long  w[WCNT];                           /* local copy of input block */&#xA;&#xA;   /* never call with blkCnt == 0! */&#xA;    if (!(blkCnt != 0))&#xA;        return;&#xA;&#xA;    ts[0] = ctx-&amp;gt;h.T[0];&#xA;    ts[1] = ctx-&amp;gt;h.T[1];&#xA;    do  {&#xA;        /* this implementation only supports 2**64 input bytes (no carry out here) */&#xA;        ts[0] += byteCntAdd;                    /* update processed length */&#xA;&#xA;        /* precompute the key schedule for this block */&#xA;        ks[0] = ctx-&amp;gt;X[0];     &#xA;        ks[1] = ctx-&amp;gt;X[1];&#xA;        ks[2] = ctx-&amp;gt;X[2];&#xA;        ks[3] = ctx-&amp;gt;X[3];&#xA;        ks[4] = ks[0] ^ ks[1] ^ ks[2] ^ ks[3] ^ SKEIN_KS_PARITY;&#xA;&#xA;        ts[2] = ts[0] ^ ts[1];&#xA;&#xA;        Skein_Get64_LSB_First(w, blkPtr, WCNT);   /* get input block in little-endian format */&#xA;&#xA;        X0 = w[0] + ks[0];                      /* do the first full key injection */&#xA;        X1 = w[1] + ks[1] + ts[0];&#xA;        X2 = w[2] + ks[2] + ts[1];&#xA;        X3 = w[3] + ks[3];&#xA;&#xA;        blkPtr += SKEIN_256_BLOCK_BYTES;&#xA;&#xA;        /* run the rounds */&#xA;&#xA;// IN THIS MACRO WHEN I EXCHANGED X##p1 and X##p in RotL_64 for numbers 1, 2, THEN COMPILATION IS OK&#xA;#define Round256(p0, p1, p2, p3, ROT, rNum)                     \&#xA;X##p0 += X##p1; X##p1 = RotL_64(X##p1, ROT##_0); X##p1 ^= X##p0; \&#xA;X##p2 += X##p3; X##p3 = RotL_64(X##p3, ROT##_1); X##p3 ^= X##p2; \&#xA;&#xA;#if SKEIN_UNROLL_256 == 0                       &#xA;#define R256(p0, p1, p2, p3, ROT, rNum)  /* fully unrolled */   \&#xA;Round256(p0, p1, p2, p3, ROT, rNum)&#xA;&#xA;#define I256(R)                                                 \&#xA;X0   += ks[((R)+1) % 5];    /* inject the key schedule value */ \&#xA;X1   += ks[((R)+2) % 5] + ts[((R)+1) % 3];                      \&#xA;X2   += ks[((R)+3) % 5] + ts[((R)+2) % 3];                      \&#xA;X3   += ks[((R)+4) % 5] +     (R)+1;&#xA;#else                                       /* looping version */&#xA;#define R256(p0, p1, p2, p3, ROT, rNum)                         \&#xA;Round256(p0, p1, p2, p3, ROT, rNum)                             \&#xA;&#xA;#define I256(R)                                                 \&#xA;X0   += ks[r+(R)+0];        /* inject the key schedule value */ \&#xA;X1   += ks[r+(R)+1] + ts[r+(R)+0];                              \&#xA;X2   += ks[r+(R)+2] + ts[r+(R)+1];                              \&#xA;X3   += ks[r+(R)+3] +    r+(R)   ;                              \&#xA;ks[r + (R)+4    ]   = ks[r+(R)-1];     /* rotate key schedule */\&#xA;ts[r + (R)+2    ]   = ts[r+(R)-1];                              &#xA;&#xA;        for (r = 1; r &amp;lt; 2*RCNT; r += 2*SKEIN_UNROLL_256)  /* loop thru it */&#xA;#endif  &#xA;        {    &#xA;#define R256_8_rounds(R)          \&#xA;R256(0,1,2,3,R_256_0,8*(R) + 1);  \&#xA;R256(0,3,2,1,R_256_1,8*(R) + 2);  \&#xA;R256(0,1,2,3,R_256_2,8*(R) + 3);  \&#xA;R256(0,3,2,1,R_256_3,8*(R) + 4);  \&#xA;I256(2*(R));                      \&#xA;R256(0,1,2,3,R_256_4,8*(R) + 5);  \&#xA;R256(0,3,2,1,R_256_5,8*(R) + 6);  \&#xA;R256(0,1,2,3,R_256_6,8*(R) + 7);  \&#xA;R256(0,3,2,1,R_256_7,8*(R) + 8);  \&#xA;I256(2*(R)+1);&#xA;&#xA;            R256_8_rounds( 0);&#xA;&#xA;#define R256_Unroll_R(NN) ((SKEIN_UNROLL_256 == 0 &amp;amp;&amp;amp; SKEIN_256_ROUNDS_TOTAL/8 &amp;gt; (NN)) || (SKEIN_UNROLL_256 &amp;gt; (NN)))&#xA;&#xA;#if   R256_Unroll_R( 1)&#xA;            R256_8_rounds( 1);&#xA;#endif&#xA;#if   R256_Unroll_R( 2)&#xA;            R256_8_rounds( 2);&#xA;#endif&#xA;#if   R256_Unroll_R( 3)&#xA;            R256_8_rounds( 3);&#xA;#endif&#xA;#if   R256_Unroll_R( 4)&#xA;            R256_8_rounds( 4);&#xA;#endif&#xA;#if   R256_Unroll_R( 5)&#xA;            R256_8_rounds( 5);&#xA;#endif&#xA;#if   R256_Unroll_R( 6)&#xA;            R256_8_rounds( 6);&#xA;#endif&#xA;#if   R256_Unroll_R( 7)&#xA;            R256_8_rounds( 7);&#xA;#endif&#xA;#if   R256_Unroll_R( 8)&#xA;            R256_8_rounds( 8);&#xA;#endif&#xA;#if   R256_Unroll_R( 9)&#xA;            R256_8_rounds( 9);&#xA;#endif&#xA;#if   R256_Unroll_R(10)&#xA;            R256_8_rounds(10);&#xA;#endif&#xA;#if   R256_Unroll_R(11)&#xA;            R256_8_rounds(11);&#xA;#endif&#xA;#if   R256_Unroll_R(12)&#xA;            R256_8_rounds(12);&#xA;#endif&#xA;#if   R256_Unroll_R(13)&#xA;            R256_8_rounds(13);&#xA;#endif&#xA;#if   R256_Unroll_R(14)&#xA;            R256_8_rounds(14);&#xA;#endif&#xA;#if  (SKEIN_UNROLL_256 &amp;gt; 14)&#xA;#error  &quot;need more unrolling in Skein_256_Process_Block&quot;&#xA;#endif&#xA;        }&#xA;&#xA;        // WHEN I COMMENT NEXT 4 LINES, THEN COMPILATION IS OK&#xA;        ctx-&amp;gt;X[0] = X0 ^ w[0]; &#xA;        ctx-&amp;gt;X[1] = X1 ^ w[1];&#xA;        ctx-&amp;gt;X[2] = X2 ^ w[2];&#xA;        ctx-&amp;gt;X[3] = X3 ^ w[3];&#xA;&#xA;        ts[1] &amp;amp;= ~SKEIN_T1_FLAG_FIRST;&#xA;    }&#xA;    while (--blkCnt);&#xA;    ctx-&amp;gt;h.T[0] = ts[0];&#xA;    ctx-&amp;gt;h.T[1] = ts[1];&#xA;}&#xA;&#xA;__kernel void update( __global Skein_256_Ctxt_t *gctx) {&#xA;    int glId = get_global_id(0);&#xA;    int lId = get_local_id(0);&#xA;    int grId = get_group_id(0);&#xA;&#xA;    // TODO now is one hashState per block, try one hs per thread to accelerate computing&#xA;    gctx += grId;&#xA;&#xA;    Skein_256_Ctxt_t ctx;&#xA;    ctx.h.hashBitLen = 256;&#xA;    Skein_256_Process_Block(&amp;amp;ctx, &amp;amp;ctx.b, 1, SKEIN_256_BLOCK_BYTES);&#xA;    *gctx = ctx;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;When I comment marked line (I wrote this line in capital letters) or change the values (not both) the compilation is ok. Can anyone help me?&lt;/p&gt;&#xA;" OwnerUserId="656934" LastEditorUserId="196561" LastEditDate="2011-04-25T16:28:24.207" LastActivityDate="2011-04-26T06:54:43.410" Title="OpenCL compiler has failed to compile a function" Tags="&lt;function&gt;&lt;compiler-construction&gt;&lt;opencl&gt;" AnswerCount="1" CommentCount="5" />
  <row Id="5754857" PostTypeId="1" AcceptedAnswerId="5754956" CreationDate="2011-04-22T11:16:36.343" Score="7" ViewCount="8196" Body="&lt;p&gt;Suppose my program is:  &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;typedef int MYINT;&#xA;&#xA;int main()  &#xA;{  &#xA;    MYINT x = 5;  &#xA;    ........  &#xA;    do_something()    &#xA;    ........    &#xA;    /* I wanna test whether MYINT is defined or not */&#xA;    /* I can't use: ifdef (MYINT), since MYINT is not a macro */&#xA;&#xA;    ........&#xA;    return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Actually, I encountered this problem while I was using a cross-compiler for vxworks. The cross-compiler header file included: typedef int INT.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;But, my stack's header file used:  &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; #ifndef INT  &#xA; #define int INT&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Can you please suggest how to test typedefs, whether they are defined previously or not?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks in advance.&lt;/p&gt;&#xA;" OwnerUserId="720094" LastEditorUserId="227665" LastEditDate="2011-04-22T11:18:34.940" LastActivityDate="2011-08-28T03:17:00.753" Title="Can we verify whether a typedef has been defined or not" Tags="&lt;c&gt;" AnswerCount="5" CommentCount="2" FavoriteCount="3" />
  <row Id="5781843" PostTypeId="1" AcceptedAnswerId="5782014" CreationDate="2011-04-25T18:45:31.210" Score="1" ViewCount="1857" Body="&lt;p&gt;In C to parallelize a loop with &lt;code&gt;schedule(static)&lt;/code&gt; would mean that the chunk size is quickly computed as &lt;strong&gt;&lt;code&gt;ceil&lt;/code&gt;&lt;/strong&gt;&lt;code&gt;(loops/threads)&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For my project I have to iterrate through 9 different chunk sizes, one of which is &quot;default&quot;. This is how I did it:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I wrote a perl loop that compiles my program with &lt;code&gt;-DCHUNKSIZE=$c&lt;/code&gt; and in the &lt;code&gt;omp&lt;/code&gt; code I specify &lt;code&gt;schedule(static, CHUNKSIZE)&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Question&lt;/strong&gt;: what can I do for default? Chunk size of 0 doesn't work :(&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;P.S.&#xA;I was hoping to avoid having &lt;code&gt;#ifdef ... #else ... #endif&lt;/code&gt; since I have very many loops that are parallelized&lt;/p&gt;&#xA;" OwnerUserId="425380" LastEditorUserId="425380" LastEditDate="2011-04-25T19:10:41.930" LastActivityDate="2012-12-03T03:11:58.837" Title="C OpenMP - Enforce default chunk size" Tags="&lt;c&gt;&lt;scheduling&gt;&lt;openmp&gt;" AnswerCount="3" CommentCount="0" />
  <row Id="5803819" PostTypeId="1" CreationDate="2011-04-27T12:06:50.923" Score="1" ViewCount="1393" Body="&lt;p&gt;I'm having some trouble getting a password protected PFX certificate to install through WiX.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I'm using WiX 3.5.2519.0.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I include a PFX file as follows:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;Binary Id=&quot;My.Binary&quot;&#xA; SourceFile=&quot;$(var.ProjectDir)MyProject$(var.ConfigSuffix).pfx&quot; /&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The value of $(var.ConfigSuffix) varies based on solution configuration (e.g. &quot; (Debug)&quot;, &quot; (Stage)&quot;). For &quot;Release&quot;, it is set to an empty string.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have various solution configurations, all but one use a non-password protected PFX certificate, &quot;Release&quot; uses a password protected PFX. I deal with this by conditionally defining $(var.PfxPassword) in &quot;Release&quot; configuration only, and then installing the certificate as follows:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?ifdef $(var.PfxPassword) ?&amp;gt;&#xA;    &amp;lt;iis:Certificate&#xA;    Id=&quot;My.Certificate&quot;&#xA;    StoreName=&quot;root&quot;&#xA;    Overwrite=&quot;yes&quot;&#xA;    Name=&quot;My Web Site$(var.ConfigSuffix)&quot;&#xA;    Request=&quot;no&quot;&#xA;    BinaryKey=&quot;MyCertificate.Binary&quot;&#xA;    StoreLocation=&quot;localMachine&quot;&#xA;    PFXPassword=&quot;$(var.PfxPassword)&quot; /&amp;gt;&#xA;&amp;lt;?else?&amp;gt;&#xA;    &amp;lt;iis:Certificate&#xA;    Id=&quot;My.Certificate&quot; &#xA;    StoreName=&quot;root&quot; &#xA;    Overwrite=&quot;yes&quot; &#xA;    Name=&quot;My Web Site$(var.ConfigSuffix)&quot; &#xA;    Request=&quot;no&quot; &#xA;    BinaryKey=&quot;MyCertificate.Binary&quot; &#xA;    StoreLocation=&quot;localMachine&quot; /&amp;gt;&#xA;&amp;lt;?endif?&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I have also tried replacing &quot;$(var.PfxPassword)&quot; with &quot;[PFXPASSWORD]&quot; (having defined this elsewhere), and the actual password in plain text. In every case, installation fails with the following log snippet:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Action start 12:29:02: InstallCertificates.&#xA;InstallCertificates:  Error 0x80070056: Failed to open PFX file.&#xA;InstallCertificates:  Error 0x80070056: Failed to get SHA1 hash of certificate.&#xA;InstallCertificates:  Error 0x80070056: Failed to resolve certificate: LinnRecords.Certificate&#xA;CustomAction InstallCertificates returned actual error code 1603 (note this may not be 100% accurate if translation happened inside sandbox)&#xA;Action ended 12:29:02: InstallCertificates. Return value 3.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I believe error 0x80070056 indicates an incorrect password, however I have used the &lt;a href=&quot;http://msdn.microsoft.com/en-us/library/dd347671.aspx&quot; rel=&quot;nofollow&quot;&gt;Get-PfxCertificate&lt;/a&gt; in PowerShell to verify that the password I am using is correct.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For all configurations where the PFX file does not use a password, the installation works without issue.&lt;/p&gt;&#xA;" OwnerUserId="392823" LastActivityDate="2011-05-05T22:02:33.113" Title="WiX: Problem installing password protected PFX certificate‏" Tags="&lt;wix&gt;&lt;certificate&gt;&lt;pfx&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="5836813" PostTypeId="1" AcceptedAnswerId="5836897" CreationDate="2011-04-29T20:03:10.647" Score="0" ViewCount="2875" Body="&lt;p&gt;i want to make a question about developing using #ifdef directive.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I want do make some code in objective-c only for debug use, for example:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;in main function do this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define DEBUG_LEVEL&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;in my interface do this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef DEBUG_LEVEL&#xA;BOOL editorIsDragged;&#xA;BOOL editorIsSelected;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;.... other property&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef #DEBUG_LEVEL&#xA;@property (nonatomic, readwrite) BOOL editorIsDragged;&#xA;@property (nonatomic, readwrite) BOOL editorIsSelected;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;then in my implementation do this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef #DEBUG_LEVEL&#xA;@synthetize editorIsDragged, editorIsSelected;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but i receve an error because in synthetize &lt;code&gt;editorIsDragged&lt;/code&gt; and &lt;code&gt;editorIsSelected&lt;/code&gt; are not defined.&#xA;If i try to define my own setter/getter method I receive the same error, because my vars (&lt;code&gt;editorIsDragged&lt;/code&gt; and &lt;code&gt;editorIsSelected&lt;/code&gt;) does not exist for XCode!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I in C use this method for write only debug code, but in obj-c what i must use??&lt;/p&gt;&#xA;&#xA;&lt;p&gt;thank you!&lt;/p&gt;&#xA;" OwnerUserId="697187" LastEditorUserId="596219" LastEditDate="2011-05-02T09:46:54.003" LastActivityDate="2011-05-02T09:46:54.003" Title="How to make debug code using #ifdef directive. Objective-c" Tags="&lt;objective-c&gt;&lt;debugging&gt;&lt;conditional-compilation&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="5946218" PostTypeId="1" AcceptedAnswerId="5946252" CreationDate="2011-05-10T06:47:57.047" Score="6" ViewCount="6575" Body="&lt;pre&gt;&lt;code&gt; #include &amp;lt; iostream &amp;gt;  &#xA;&#xA; #define MY_CHK_DEF(flag) \&#xA; #ifdef (flag) \&#xA;    std::cout&amp;lt;&amp;lt;#flag&amp;lt;&amp;lt;std::endl; \&#xA; #else \&#xA;    std::cout&amp;lt;&amp;lt;#flag&amp;lt;&amp;lt;&quot; ,flag not define&quot;&amp;lt;&amp;lt;std::endl; \&#xA; #endif &#xA;&#xA;&#xA; int main()&#xA; {&#xA;    MY_CHK_DEF(FLAG_1);&#xA;    MY_CHK_DEF(FLAG_2);&#xA;    MY_CHK_DEF(FLAG_3);&#xA;    ...  &#xA; }&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;complier report:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;main.cpp:3:24: error: '#' is not followed by a macro parameter&lt;/p&gt;&#xA;&#xA;&lt;p&gt;any ideas?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks&lt;/p&gt;&#xA;" OwnerUserId="440403" LastEditorUserId="1257035" LastEditDate="2015-04-16T08:21:47.723" LastActivityDate="2015-04-16T08:21:47.723" Title="how to use #if,#else,#endif... inside c macro" Tags="&lt;c++&gt;&lt;c&gt;&lt;c-preprocessor&gt;" AnswerCount="4" CommentCount="1" FavoriteCount="0" />
  <row Id="6041021" PostTypeId="1" CreationDate="2011-05-18T07:02:29.473" Score="1" ViewCount="555" Body="&lt;p&gt;I'm working with LKM outside the kernel tree and I want to use some compiling options for my module like MYLKM_CONFIG_{something}. I know that this can be done using the C preprocessing (#define // #ifdef // #endif). But I want to know is it possible to use Kbuild (Kconfig files or something related) for that purposes?..&lt;/p&gt;&#xA;&#xA;&lt;p&gt;And one more question. Is it possible to &lt;code&gt;make menuconfig&lt;/code&gt; for only my module, not for the whole kernel tree?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks.&lt;/p&gt;&#xA;" OwnerUserId="651394" LastEditorUserId="1880339" LastEditDate="2014-08-23T16:09:37.840" LastActivityDate="2014-08-23T16:09:37.840" Title="Kconfig and LKM" Tags="&lt;linux&gt;&lt;linux-kernel&gt;&lt;linux-device-driver&gt;&lt;kbuild&gt;" AnswerCount="1" CommentCount="1" FavoriteCount="2" />
  <row Id="6214690" PostTypeId="1" AcceptedAnswerId="6214782" CreationDate="2011-06-02T12:47:15.257" Score="3" ViewCount="584" Body="&lt;p&gt;According to &lt;a href=&quot;http://pubs.opengroup.org/onlinepubs/9699919799/idx/head.html&quot; rel=&quot;nofollow&quot;&gt;this&lt;/a&gt;, the POSIX library does not include &lt;code&gt;getopt.h&lt;/code&gt;. However, I found this in &lt;code&gt;unistd.h&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  __USE_POSIX2&#xA;/* Get definitions and prototypes for functions to process the&#xA;   arguments in ARGV (ARGC of them, minus the program name) for&#xA;   options given in OPTS.  */&#xA;# define __need_getopt&#xA;# include &amp;lt;getopt.h&amp;gt;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Does this mean that &lt;code&gt;getopt.h&lt;/code&gt; is implicitly included when you include &lt;code&gt;unistd.h&lt;/code&gt;? I mean, is the code above something I should expect from all implementations of the unistd header file, or is it just something that is in my particular version? Also, is the &lt;code&gt;__USE_POSIX2&lt;/code&gt; macro defined in POSIX.2 and onwards, or is it just for POSIX.2?&lt;/p&gt;&#xA;" OwnerUserId="293048" LastActivityDate="2011-06-02T12:57:19.703" Title="Should I expect POSIX to include getopt.h?" Tags="&lt;posix&gt;&lt;getopt-long&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="6234755" PostTypeId="1" AcceptedAnswerId="6234767" CreationDate="2011-06-04T04:46:42.923" Score="5" ViewCount="5372" Body="&lt;p&gt;Why doesn’t the following code work as expected?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;void foobar(int);&#xA;&#xA;#ifndef foobar&#xA;  printf(&quot;foobar exists&quot;);&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It &lt;em&gt;always&lt;/em&gt; prints the message; it obviously cannot detect the existence of a function as an entity. (Is it an over-loading issue?)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Why can’t &lt;code&gt;#ifdef&lt;/code&gt; (or its variants) detect function declarations? Declarations should be available at pre-processing, so it should work, shouldn’t it? If not, is there an alternative or work-around?&lt;/p&gt;&#xA;" OwnerUserId="119540" LastEditorUserId="4370109" LastEditDate="2016-03-14T19:54:43.803" LastActivityDate="2016-03-14T19:54:43.803" Title="Does #ifdef (or other Preprocessor Directives) Work for Function Declarations (to Test for Function Existence)?" Tags="&lt;c&gt;&lt;c-preprocessor&gt;&lt;declaration&gt;" AnswerCount="2" CommentCount="2" FavoriteCount="1" />
  <row Id="6346821" PostTypeId="1" AcceptedAnswerId="6346851" CreationDate="2011-06-14T16:27:49.103" Score="4" ViewCount="982" Body="&lt;p&gt;I need to log a lot of information in my software for debugging.&#xA;However I need this option only during development, I would prefer to exclude all this code in Release.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Of course I can surround the place I want to debug with &quot;if&quot;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;if (isDebugMode()) {&#xA;  Logger.log(blahblah);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But because my software is pretty time-critical, I want to avoid a lot of unnesseray &quot;if&quot; tests.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I.e. I think I need analog of c &quot;#define #ifdef #ifndef&quot;. Are there any technics in c# or .net to solve my task easily?&lt;/p&gt;&#xA;" OwnerUserId="93647" LastActivityDate="2013-09-09T22:35:24.633" Title="how to add debug code? (should go to Debug, shouldn't go to Release)" Tags="&lt;c#&gt;&lt;.net&gt;" AnswerCount="5" CommentCount="0" />
  <row Id="6522526" PostTypeId="1" AcceptedAnswerId="6579121" CreationDate="2011-06-29T14:41:13.290" Score="6" ViewCount="3288" Body="&lt;p&gt;I have seen partial solutions over the internet but none that really satisfied me: what do I have to put into my .vimrc (ideally I don't want to chance any syntax/*.vim file) such that in all .c/cpp/h files that I open, I get automatic folding of &lt;code&gt;#ifdef ... #endif&lt;/code&gt; sections?&lt;/p&gt;&#xA;" OwnerUserId="663030" LastActivityDate="2011-07-05T08:20:26.183" Title="Autofold #ifdef..#endif in vim via .vimrc" Tags="&lt;vim&gt;&lt;folding&gt;" AnswerCount="2" CommentCount="2" FavoriteCount="2" />
  <row Id="6706076" PostTypeId="1" AcceptedAnswerId="6706162" CreationDate="2011-07-15T11:04:26.263" Score="6" ViewCount="1715" Body="&lt;p&gt;I need to set &lt;code&gt; #ifdef &lt;/code&gt; - checks for conditional compile. I want to automate the process but cannot specify the target OS/machine. Is there some way that the pre-compiler can resolve whether it it is running on 32-bit or 64-bit?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;(Explanation) I need to define a type that is 64 bits in size. On 64bit OS it is a long, on most others it is a long long.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I found &lt;a href=&quot;http://stackoverflow.com/questions/735647/ifdef-for-32-bit-platform/735656#735656&quot;&gt;this answer&lt;/a&gt; - is this the correct way to go?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;[edit] a &lt;a href=&quot;http://sourceforge.net/apps/mediawiki/predef/index.php?title=Main_Page&quot; rel=&quot;nofollow&quot;&gt;handy reference for compiler macros&lt;/a&gt;&lt;/p&gt;&#xA;" OwnerUserId="15161" LastEditorUserId="15161" LastEditDate="2011-07-15T12:32:46.580" LastActivityDate="2011-07-15T12:35:42.290" Title="Is there a standard way to determine at compile-time if system is 32 or 64 bit?" Tags="&lt;c++&gt;&lt;compilation&gt;&lt;32bit-64bit&gt;" AnswerCount="8" CommentCount="5" />
  <row Id="6935080" PostTypeId="1" CreationDate="2011-08-04T01:03:49.503" Score="4" ViewCount="155" Body="&lt;p&gt;Let's say I've got a custom framework with a dozen classes and categories.  They all inherit from/extend standard cocoa classes.  For this reason, my framework links to &amp;lt; Cocoa &gt; during compile.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My question is, if I add a class which requires &amp;lt; QuartzCore &gt;, what is the recommended way to package that?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;1) If I simply add the class to the framework, and import QuartzCore, any consumer of my framework has to also import QuartzCore.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;2) If I move the class into another framework, any consumer has to import both my frameworks to get the full functionality, as well as QuartzCore.  No classes in the first framework can use the second framework.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;3) Is there a way to do #ifdef #endif or something similar and then weak-link the QuartzCore framework so that both Cocoa-standard classes and QuartzCore-dependent classes are in a single framework, but consumers don't have to add QuartzCore to their projects?  If QuartzCore is not present ideally the class/category simply wouldn't be available to the runtime.&lt;/p&gt;&#xA;" OwnerUserId="798645" LastEditorUserId="491980" LastEditDate="2011-08-19T09:45:49.063" LastActivityDate="2012-04-11T17:01:06.467" Title="Cocoa best practice for architecting a custom framework which requires an Apple framework" Tags="&lt;cocoa&gt;&lt;mac-frameworks&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="7002719" PostTypeId="1" AcceptedAnswerId="7002756" CreationDate="2011-08-09T20:43:12.830" Score="9" ViewCount="1985" Body="&lt;blockquote&gt;&#xA;  &lt;p&gt;&lt;strong&gt;Possible Duplicate:&lt;/strong&gt;&lt;br&gt;&#xA;  &lt;a href=&quot;http://stackoverflow.com/questions/2198950/why-is-void-0-a-no-operation-in-c-and-c&quot;&gt;Why is (void) 0 a no operation in C and C++?&lt;/a&gt;  &lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&#xA;&#xA;&lt;p&gt;On my implementation of C++ (Visual Studio 2008 implementation) I see the following line in &lt;code&gt;&amp;lt;cassert&amp;gt;&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  NDEBUG&#xA;#define assert(_Expression) ((void)0)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I do not understand the need to cast 0 to void. It seems to me that&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  NDEBUG&#xA;#define assert(_Expression) (0)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;or even simply&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  NDEBUG&#xA;#define assert(_Expression) 0&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;would do, considering the contexts in which &lt;code&gt;assert(expr)&lt;/code&gt; can be used.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So, what's the danger of 0 of type &lt;strong&gt;int&lt;/strong&gt; instead of 0 of type &lt;strong&gt;void&lt;/strong&gt; in this case? Any &lt;strong&gt;&lt;em&gt;realistic&lt;/em&gt;&lt;/strong&gt; examples?&lt;/p&gt;&#xA;" OwnerUserId="469935" LastActivityDate="2014-08-18T16:15:50.613" Title="casting 0 to void" Tags="&lt;c++&gt;&lt;c&gt;&lt;macros&gt;&lt;void&gt;" AnswerCount="1" CommentCount="1" FavoriteCount="1" />
  <row Id="7093663" PostTypeId="1" AcceptedAnswerId="7102578" CreationDate="2011-08-17T13:28:33.273" Score="1" ViewCount="6814" Body="&lt;p&gt;see in one code i have written &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;void my_function()&#xA;{&#xA;INT32 i;    /* Variable for iteration */ &#xA;/* If system is little-endian, store bytes in array as reverse order */&#xA;#ifdef LITTLE   &#xA;   {    &#xA;    // i m using i for operating one loop &#xA;   }&#xA;   #endif&#xA;&#xA; /* If the system is big-endian, store bytes in array as forward order */&#xA;#ifdef  BIG &#xA;   {&#xA;   // using i for loop&#xA;   }&#xA;   #endif&#xA;return;&#xA; }&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;by compiling this code with -Wall flag it shows &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; warning: unused variable ‘i’      &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;why?&#xA;how can i remove this?&lt;/p&gt;&#xA;" OwnerUserId="775964" LastEditorUserId="775964" LastEditDate="2011-08-17T13:35:26.030" LastActivityDate="2011-08-21T21:40:55.327" Title="warning: unused variable" Tags="&lt;c&gt;&lt;warnings&gt;" AnswerCount="5" CommentCount="7" FavoriteCount="1" />
  <row Id="7118314" PostTypeId="1" AcceptedAnswerId="7120431" CreationDate="2011-08-19T07:30:33.713" Score="2" ViewCount="5093" Body="&lt;p&gt;First of all - I know how to call unmanaged functions. I'm stuck with interface methods in unmanaged dll. I think, writing wrapper - is what I need.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Please, help me with real code.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;old DLL (C);&lt;/li&gt;&#xA;&lt;li&gt;2 header files;&lt;/li&gt;&#xA;&lt;li&gt;lib files (what for?).&lt;/li&gt;&#xA;&lt;li&gt;!NO SOURCES!&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;Here is some code in .h file (point of interest - DECLARE INTERFACE):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  __BUILD_DLL&#xA;#define BLNETPASS_EXPORT __declspec(dllexport)&#xA;#else&#xA;#define BLNETPASS_EXPORT&#xA;#endif&#xA;&#xA;#include &quot;BlNetpassUid.h&quot;&#xA;extern &quot;C&quot;&#xA;{&#xA; BLNETPASS_EXPORT HRESULT WINAPI BlNetPassCreateA&#xA;                 (LPCSTR pHostName, const GUID *, VOID **);&#xA;&#xA; BLNETPASS_EXPORT HRESULT WINAPI BlNetPassCreateW&#xA;                 (LPCWSTR pHostName, const GUID *, VOID **);&#xA;&#xA; BLNETPASS_EXPORT HRESULT WINAPI CanBeUnload (DWORD dTimeout );&#xA;&#xA;&#xA;...&#xA;&#xA;#ifdef  UNICODE&#xA;#define BlNetPassCreate BlNetPassCreateW&#xA;#else&#xA;#define BlNetPassCreate BlNetPassCreateA&#xA;#endif&#xA;&#xA;#undef INTERFACE&#xA;#define INTERFACE INetPass&#xA;DECLARE_INTERFACE_ (INetPass, IUnknown)&#xA;{&#xA;// IUnknown methods&#xA;&#xA; STDMETHOD  (    QueryInterface)(REFIID, VOID **)   PURE;&#xA; STDMETHOD_ (ULONG,      AddRef)()          PURE;&#xA; STDMETHOD_ (ULONG,     Release)()          PURE;&#xA;&#xA;// INetPass methods&#xA;&#xA; STDMETHOD  ( CreateNetPassEnum)(VOID **, REFIID cid,&#xA;                         REFIID iid)    PURE;&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It's not a COM object, i think, i can't use type library import for this dll&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What I need:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;call BlNetPassCreateA; &lt;/li&gt;&#xA;&lt;li&gt;get pointer to interface INetPass; &lt;/li&gt;&#xA;&lt;li&gt;call interface method CreateNetPassEnum.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;That's how i did it before (it's PInvoke):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;[DllImport(&quot;BlNetpassApi&quot;)] &#xA;public static extern int BlNetPassCreateA(string pHostName, ref Guid GUID, out IntPtr rINetPass);&#xA;&#xA;...&#xA;...&#xA;&#xA; IntPtr something; &#xA; Guid temp_guid = Guid.Empty;&#xA;&#xA; int temp_int = BlNetPassCreateA(null, ref temp_guid, out something);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Ok! IntPtr contains some data, but what's next - how do I describe the interface that is behind and call its method?&lt;/p&gt;&#xA;" OwnerUserId="901999" LastEditorUserId="113141" LastEditDate="2011-08-19T09:00:51.733" LastActivityDate="2011-08-19T15:51:00.377" Title="C# wrapper for unmanaged DLL" Tags="&lt;c#&gt;&lt;wrapper&gt;&lt;unmanaged&gt;" AnswerCount="2" CommentCount="6" />
  <row Id="7218671" PostTypeId="1" CreationDate="2011-08-28T02:29:45.847" Score="5" ViewCount="335" Body="&lt;p&gt;I 'm emacs cedet user. i got great help from cedet.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;but, I found some error prcessing #ifdef handling in cedet.&#xA;not sure it's from cedet internal or my mis-configuration.&#xA;I quote some code in Curl where this issue happens.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef CURL_DO_LINEEND_CONV&#xA;  if((data-&amp;gt;set.crlf) || (data-&amp;gt;set.prefer_ascii)) {&#xA;#else&#xA;  if(data-&amp;gt;set.crlf) {&#xA;#endif /* CURL_DO_LINEEND_CONV */&#xA;    endofline_native  = &quot;\n&quot;;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;With this code, there must be some mis-parenthesis match. Because I got errors using (eassist-list-methods) or other cedet-semantic functions (jump to definition).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I could easily guess this might be from two braces in #ifdef .. #endif block.&#xA;I contracted these to like this.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef CURL_DO_LINEEND_CONV&#xA;  if((data-&amp;gt;set.crlf) || (data-&amp;gt;set.prefer_ascii)) &#xA;#else&#xA;  if(data-&amp;gt;set.crlf) &#xA;#endif /* CURL_DO_LINEEND_CONV */&#xA;{&#xA;    endofline_native  = &quot;\n&quot;;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;after this, cedet semantic functions works well.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;any idea about this? is it from cedet parser problem? &lt;/p&gt;&#xA;&#xA;&lt;p&gt;if there is some point I have to configure in cedet, could you give me some insight ?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;thanks&lt;/p&gt;&#xA;" OwnerUserId="507229" LastActivityDate="2015-05-25T19:09:56.317" Title="cedet parsing issue on #ifdef" Tags="&lt;emacs&gt;&lt;cedet&gt;" AnswerCount="2" CommentCount="2" />
  <row Id="7358629" PostTypeId="1" AcceptedAnswerId="7358651" CreationDate="2011-09-09T07:53:00.413" Score="1" ViewCount="536" Body="&lt;p&gt;I am using the &lt;code&gt;-LITTLE&lt;/code&gt;  flag for choosing &lt;strong&gt;little endian&lt;/strong&gt; calculation and&lt;br&gt;&#xA;&lt;code&gt;-BIG&lt;/code&gt; for &lt;strong&gt;big endian&lt;/strong&gt; calculation in my project while compiling.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef LITTLE   &#xA;   {    &#xA;    // i'm using i for operating one loop &#xA;   }&#xA;   #endif&#xA;&#xA; /* If the system is big-endian, store bytes in array as forward order */&#xA;#ifdef  BIG &#xA;   {&#xA;   // using i for loop&#xA;   }&#xA;   #endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;like &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;gcc -LITTLE my_c_file.c&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I want to check if user hasn't given any of flag at compile time then compilation does not takes place and give an error. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;How can I do that?&lt;/p&gt;&#xA;" OwnerUserId="775964" LastEditorUserId="4370109" LastEditDate="2016-03-31T20:26:16.473" LastActivityDate="2016-03-31T20:26:16.473" Title="How can I check presence of flag at compile time?" Tags="&lt;c&gt;&lt;c-preprocessor&gt;" AnswerCount="3" CommentCount="0" />
  <row Id="7419167" PostTypeId="1" AcceptedAnswerId="7419339" CreationDate="2011-09-14T15:44:51.527" Score="3" ViewCount="1417" Body="&lt;p&gt;I'm trying to write a macro similar to the following:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef DEPRECATED_ATTRIBUTE_MESSAGE&#xA;  #define DEPRECATED_ATTRIBUTE_MESSAGE(message) __attribute__((deprecated (message)))&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And this works, but only with the Apple LLVM 3.0 compiler.  It breaks at compile time for anything else meaning I have to strip it down to&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef DEPRECATED_ATTRIBUTE_MESSAGE&#xA;  #define DEPRECATED_ATTRIBUTE_MESSAGE(message) __attribute__((deprecated))&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;which is much less useful.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My question:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I think the solution is to apply some macro to identify the version of the compiler at compile time.  Is there a way to identify the Apple LLVM 3.0 compiler versus LLVM GCC 4.2 or GCC 4.2 (or anything else)?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Ideally, I'd like to work out something like this, but I can't find the right macro to figure it out:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef [Apple LLVM 3.0]&#xA;  #ifndef DEPRECATED_ATTRIBUTE_MESSAGE&#xA;    #define DEPRECATED_ATTRIBUTE_MESSAGE(message) __attribute__((deprecated (message)))&#xA;  #endif&#xA;#else&#xA;  #ifndef DEPRECATED_ATTRIBUTE_MESSAGE&#xA;    #define DEPRECATED_ATTRIBUTE_MESSAGE(message) __attribute__((deprecated))&#xA;  #endif&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="280825" LastActivityDate="2011-09-14T16:04:38.807" Title="Determine LLVM versus GCC at compile time" Tags="&lt;gcc&gt;&lt;xcode4&gt;&lt;macros&gt;&lt;llvm&gt;&lt;conditional-compilation&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="7470537" PostTypeId="1" AcceptedAnswerId="7470586" CreationDate="2011-09-19T11:56:03.983" Score="13" ViewCount="7641" Body="&lt;p&gt;I have two targets in my iPhone iOS project: &lt;code&gt;Production&lt;/code&gt; and &lt;code&gt;Preview&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I now want to execute a line of code, only if I am in the target &lt;code&gt;Preview&lt;/code&gt;.&#xA;I guess this would have to be some sort of &lt;code&gt;#ifdef ...&lt;/code&gt;. I found &lt;a href=&quot;http://stackoverflow.com/questions/3657102/how-to-have-conditional-code-depending-on-active-configuration&quot;&gt;a solution&lt;/a&gt; which does almost the thing I want but it uses the &lt;em&gt;configuration&lt;/em&gt; and not the &lt;em&gt;target&lt;/em&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Example:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;-(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {&#xA;&#xA;  #ifdef MY_PREVIEW_TARGET&#xA;    [SomeLibraryWhichIsInPreviewTarget someMethod];&#xA;  #endif&#xA;&#xA;  // Code that applies for both targets ...&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Thanks for your help &lt;/p&gt;&#xA;" OwnerUserId="784318" LastEditorUserId="1324019" LastEditDate="2012-06-15T02:11:28.750" LastActivityDate="2012-06-15T02:11:28.750" Title="iOS: Conditional code depending on current target" Tags="&lt;objective-c&gt;&lt;ios&gt;&lt;xcode4&gt;" AnswerCount="2" CommentCount="0" FavoriteCount="3" />
  <row Id="7500911" PostTypeId="1" AcceptedAnswerId="7501038" CreationDate="2011-09-21T13:51:21.770" Score="2" ViewCount="618" Body="&lt;p&gt;Hey guys im working on creating a new function in legacy visual C++ 6.0 dll project, so that a C# dll can call into, however i unable to do so due to name mangling and it seems no matter what I do I can't stop it, (i used dumpbin to view the names) here is the relevant code &lt;/p&gt;&#xA;&#xA;&lt;p&gt;this is a really trimmed down verstion of the  header file&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  _V7SSCOMM_CPP_&#xA;#define _DECL_V7COMM_DLL    __declspec(dllexport)&#xA;#else&#xA;#define _DECL_V7COMM_DLL    __declspec(dllimport)&#xA;#endif&#xA;&#xA;#ifdef __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;_DECL_V7COMM_DLL    DWORD V7ssGetFileDirInfoUnicode(LPCSTR szSign, V7_FILE_LIST_TYPE eListType, LPCSTR szServer, LPCSTR szLibrary, LPCSTR szExt, DWORD *pdwFileCnt, wchar_t *pbyFileBuf, DWORD *pdwFileBufSize);&#xA;&#xA;#ifdef __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and for the cpp file&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;_DECL_V7COMM_DLL    DWORD V7ssGetFileDirInfoUnicode(LPCSTR szSign, &#xA;                                                         V7_FILE_LIST_TYPE eListType, &#xA;                                                         LPCSTR szServer, LPCSTR szLibrary, LPCSTR szExt, &#xA;                                                         DWORD *pdwFileCnt, wchar_t *pbyFileBuf, DWORD *pdwFileBufSize)&#xA;{&#xA;    if (!szSign || !szServer || !szLibrary || !szExt || !pdwFileCnt || !pbyFileBuf || !pdwFileBufSize)&#xA;        return (RPC_S_INVALID_ARG);&#xA;&#xA;    error_status_t Error = rpcGetFileDirInfoUnicode(&#xA;        /* [in] */ g_hRpcBinding, &#xA;        /* [in, string] */ (unsigned char *)szSign, &#xA;        /* [in] */ (unsigned long)eListType, &#xA;        /* [in, string] */ (unsigned char *)szServer,&#xA;        /* [in, string] */ (unsigned char *)szLibrary,&#xA;        /* [in, string] */ (unsigned char *)szExt,&#xA;        /* [out] */ (unsigned long *)pdwFileCnt, &#xA;        /* [out, size_is(*pdwFileBufSize)] */ (wchar_t *)pbyFileBuf, &#xA;        /* [in, out] */ (unsigned long *)pdwFileBufSize);&#xA;&#xA;    return (Error);&#xA;} // end V7ssGetFileDirInfoUnicode()&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;dumpbin returns the following&#xA;  1    0 00001401 ?V7ssGetFileDirInfoUnicode@@YAKPBDW4tag_V7_FILE_LIST_TYPE@@000PAKPAG2@Z&lt;/p&gt;&#xA;&#xA;&lt;p&gt;not what i wanted ideally it would only be V7ssGetFileDirInfoUnicode&lt;/p&gt;&#xA;&#xA;&lt;p&gt;As far as i can tell and from what i have been reading the way i trying to do this means i don't need to define this in the .def file. What is odd, is im following the same extact setup as pre-existing functions that show up correctly.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I would be grateful for any help.Thanks!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;the .def file option works as far as not name mangling, that being said the MIDL compiler is not creating the RPC stub, I think these two issues are related.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;also here is the MIDL version, taken from the C file iteself&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* this ALWAYS GENERATED file contains the RPC server stubs */&#xA;&#xA;&#xA;/* File created by MIDL compiler version 5.01.0164 */&#xA;/* at Wed Sep 21 08:57:22 2011&#xA; */&#xA;/* Compiler settings for V7Rpc.idl:&#xA;    Os (OptLev=s), W1, Zp8, env=Win32, ms_ext, c_ext&#xA;    error checks: allocation ref bounds_check enum stub_data &#xA;*/&#xA;//@@MIDL_FILE_HEADING(  )&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="184466" LastEditorUserId="184466" LastEditDate="2011-09-21T15:28:38.390" LastActivityDate="2011-09-21T15:28:38.390" Title="Visual C++ 6.0 Name mangling, even within extern &quot;C&quot; and dllexport, RPC Stubs not generating" Tags="&lt;visual-c++&gt;&lt;rpc&gt;&lt;extern&gt;&lt;dllexport&gt;&lt;name-mangling&gt;" AnswerCount="1" CommentCount="2" FavoriteCount="1" />
  <row Id="7548975" PostTypeId="1" AcceptedAnswerId="7654637" CreationDate="2011-09-25T22:10:26.710" Score="9" ViewCount="978" Body="&lt;p&gt;I have some classes implementing some computations which I have &#xA;to optimize for different SIMD implementations e.g. Altivec and &#xA;SSE. I don't want to polute the code with &lt;code&gt;#ifdef ... #endif&lt;/code&gt; blocks &#xA;for each method I have to optimize so I tried a couple of other &#xA;approaches, but unfotunately I'm not very satisfied of how it turned &#xA;out for reasons I'll try to clarify. So I'm looking for some advice &#xA;on how I could improve what I have already done.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;1.Different implementation files with crude includes&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have the same header file describing the class interface with different &#xA;&quot;pseudo&quot; implementation files for plain C++, Altivec and SSE only for the &#xA;relevant methods:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// Algo.h&#xA;#ifndef ALGO_H_INCLUDED_&#xA;#define ALGO_H_INCLUDED_&#xA;class Algo&#xA;{&#xA;public:&#xA;    Algo();&#xA;    ~Algo();&#xA;&#xA;    void process();&#xA;protected:&#xA;    void computeSome();&#xA;    void computeMore();&#xA;};&#xA;#endif&#xA;&#xA;// Algo.cpp&#xA;#include &quot;Algo.h&quot;&#xA;Algo::Algo() { }&#xA;&#xA;Algo::~Algo() { }&#xA;&#xA;void Algo::process()&#xA;{&#xA;    computeSome();&#xA;    computeMore();&#xA;}&#xA;&#xA;#if defined(ALTIVEC)&#xA;#include &quot;Algo_Altivec.cpp&quot; &#xA;#elif defined(SSE)&#xA;#include &quot;Algo_SSE.cpp&quot;&#xA;#else&#xA;#include &quot;Algo_Scalar.cpp&quot;&#xA;#endif&#xA;&#xA;// Algo_Altivec.cpp&#xA;void Algo::computeSome()&#xA;{&#xA;}&#xA;void Algo::computeMore()&#xA;{&#xA;}&#xA;... same for the other implementation files&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Pros:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;the split is quite straightforward and easy to do&lt;/li&gt;&#xA;&lt;li&gt;there is no &quot;overhead&quot;(don't know how to say it better) to objects of my class &#xA;by which I mean no extra inheritance, no addition of member variables etc. &lt;/li&gt;&#xA;&lt;li&gt;much cleaner than &lt;code&gt;#ifdef&lt;/code&gt;-ing all over the place&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;Cons:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;I have three additional files for maintenance; I could put the Scalar &#xA;implementation in the Algo.cpp file though and end up with just two but the &#xA;inclusion part will look and fell a bit dirtier&lt;/li&gt;&#xA;&lt;li&gt;they are not compilable units per-se and have to be excluded from the&#xA;project structure&lt;/li&gt;&#xA;&lt;li&gt;if I do not have the specific optimized implementation yet for let's say &#xA;SSE I would have to duplicate some code from the plain(Scalar) C++ implementation file&lt;/li&gt;&#xA;&lt;li&gt;I cannot fallback to the plain C++ implementation if nedded; ? is it even possible&#xA;to do that in the described scenario ?&lt;/li&gt;&#xA;&lt;li&gt;I do not feel any structural cohesion in the approach&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;2.Different implementation files with private inheritance&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// Algo.h&#xA;class Algo : private AlgoImpl&#xA;{&#xA; ... as before&#xA;}&#xA;&#xA;// AlgoImpl.h&#xA;#ifndef ALGOIMPL_H_INCLUDED_&#xA;#define ALGOIMPL_H_INCLUDED_&#xA;class AlgoImpl&#xA;{&#xA;protected:&#xA;    AlgoImpl();&#xA;    ~AlgoImpl();&#xA;&#xA;   void computeSomeImpl();&#xA;   void computeMoreImpl();&#xA;};&#xA;#endif&#xA;&#xA;// Algo.cpp&#xA;...&#xA;void Algo::computeSome()&#xA;{&#xA;    computeSomeImpl();&#xA;}&#xA;void Algo::computeMore()&#xA;{&#xA;    computeMoreImpl();&#xA;}&#xA;&#xA;// Algo_SSE.cpp&#xA;AlgoImpl::AlgoImpl()&#xA;{&#xA;}&#xA;AlgoImpl::~AlgoImpl()&#xA;{&#xA;}&#xA;void AlgoImpl::computeSomeImpl()&#xA;{&#xA;}&#xA;void AlgoImpl::computeMoreImpl()&#xA;{&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Pros:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;the split is quite straightforward and easy to do&lt;/li&gt;&#xA;&lt;li&gt;much cleaner than &lt;code&gt;#ifdef&lt;/code&gt;-ing all over the place&lt;/li&gt;&#xA;&lt;li&gt;still there is no &quot;overhead&quot; to my class - EBCO should kick in  &lt;/li&gt;&#xA;&lt;li&gt;the semantic of the class is much more cleaner at least comparing to the above &#xA;that is &lt;code&gt;private inheritance == is implemented in terms of&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;the different files are compilable, can be included in the project &#xA;and selected via the build system&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;Cons:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;I have three additional files for maintenance&lt;/li&gt;&#xA;&lt;li&gt;if I do not have the specific optimized implementation yet for let's say &#xA;SSE I would have to duplicate some code from the plain(Scalar) C++ implementation file&lt;/li&gt;&#xA;&lt;li&gt;I cannot fallback to the plain C++ implementation if nedded&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;3.Is basically method 2 but with virtual functions in the AlgoImpl&lt;/strong&gt; class. That &#xA;  would allow me to overcome the duplicate implementation of plain C++ code if needed &#xA;  by providing an empty implementation in the base class and override in the derived &#xA;  although I will have to disable that behavior when I actually implement the optimized &#xA;  version. Also the virtual functions will bring some &quot;overhead&quot; to objects of my class.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;4.A form of tag dispatching via enable_if&amp;lt;&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Pros:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;the split is quite straightforward and easy to do&lt;/li&gt;&#xA;&lt;li&gt;much cleaner than #ifdef ing all over the place&lt;/li&gt;&#xA;&lt;li&gt;still there is no &quot;overhead&quot; to my class  &lt;/li&gt;&#xA;&lt;li&gt;will eliminate the need for different files for different implementations&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;Cons:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;templates will be a bit more &quot;cryptic&quot; and seem to bring an unnecessary &#xA;overhead(at least for some people in some contexts)&lt;/li&gt;&#xA;&lt;li&gt;if I do not have the specific optimized implementation yet for let's say &#xA;SSE I would have to duplicate some code from the plain(Scalar) C++ implementation&lt;/li&gt;&#xA;&lt;li&gt;I cannot fallback to the plain C++ implementation if needed&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;What I couldn't figure out yet for any of the variants is how to properly and &#xA;cleanly fallback to the plain C++ implementation. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Also I don't want to over-engineer things and in that respect the first variant &#xA;seems the most &quot;KISS&quot; like even considering the disadvantages.&lt;/p&gt;&#xA;" OwnerUserId="59775" LastEditorUserId="59775" LastEditDate="2011-09-26T08:09:08.160" LastActivityDate="2011-10-04T23:02:20.330" Title="C++ handling specific impl - #ifdef vs private inheritance vs tag dispatch" Tags="&lt;c++&gt;&lt;oop&gt;&lt;design&gt;" AnswerCount="8" CommentCount="1" FavoriteCount="1" />
  <row Id="7555326" PostTypeId="1" AcceptedAnswerId="7556845" CreationDate="2011-09-26T12:50:24.720" Score="2" ViewCount="4535" Body="&lt;p&gt;How to deal with this warning from PC Lint?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have in several files the &lt;code&gt;#include &amp;lt;GenericTypeDefs.h&amp;gt;&lt;/code&gt;. PC Lint shows me the message &lt;code&gt;Warning 537: Repeated include file 'filepath\filename.h'&lt;/code&gt; If I delete this declaration I cannot compile. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I would like to suppress this warning if possible.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;You can see the same reported &lt;a href=&quot;http://www.gimpel.com/Discussion.cfm?ThreadMode=Next&amp;amp;ThreadID=3145&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This is my code, for which my compiler emits warnings:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;checksum.h&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef CHECKSUM_H&#xA;#define CHECKSUM_H&#xA;&#xA;#include &amp;lt;GenericTypeDefs.h&amp;gt;&#xA;&#xA;BOOL isCheckSumCorrect(const UINT8 *dataPointer, UINT8 len, UINT8 checkSumByte);&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;cryptography.h&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef CRYPTOGRAPHY_H&#xA;#define CRYPTOGRAPHY_H&#xA;&#xA;#include &amp;lt;GenericTypeDefs.h&amp;gt;&#xA;&#xA;UINT8 encrypt(UINT8 c);&#xA;UINT8 decrypt(UINT8 c);&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;crc8.h&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef CRC_H&#xA;#define CRC_H&#xA;&#xA;#include &amp;lt;GenericTypeDefs.h&amp;gt;&#xA;&#xA;UINT8 generateCRC(const UINT8 *ptr, UINT8 Len);&#xA;BOOL isCRCValid(const UINT8 *ptr, UINT8 Len, UINT8 CRCChar);&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Obviously, I didn't repeat &lt;code&gt;#include &amp;lt;GenericTypeDefs.h&amp;gt;&lt;/code&gt; on &lt;code&gt;checksum.c&lt;/code&gt;, &lt;code&gt;cryptography.c&lt;/code&gt; and &lt;code&gt;crc8.c&lt;/code&gt;&lt;/p&gt;&#xA;" OwnerUserId="116875" LastEditorUserId="116875" LastEditDate="2011-09-26T14:13:40.650" LastActivityDate="2014-10-29T13:04:14.800" Title="PC Lint Warning 537: Repeated include file" Tags="&lt;c&gt;&lt;lint&gt;" AnswerCount="3" CommentCount="7" />
  <row Id="7774623" PostTypeId="1" CreationDate="2011-10-14T23:30:41.570" Score="1" ViewCount="452" Body="&lt;p&gt;What's the equivalent of C++'s &lt;code&gt;#ifdef&lt;/code&gt; &lt;code&gt;#endif&lt;/code&gt; macro in JSP?&#xA;Is there such thing in JSP?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I want to conditionally include files in one JSP or another.&#xA;Reason for doing that is because I have a nested setup (nested jquery ui tabs). I prefer to include files in the outermost layer for the &quot;release&quot; version.  But for the &quot;debug&quot; version, I prefer to include file in the inner layers so I can debug individual pages. &#xA;I'm using &lt;code&gt;&amp;lt;%@ include ... %&amp;gt;&lt;/code&gt; to include files.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;If it's possible, how would you implement that?&#xA;I think JSP include action (&lt;code&gt;&amp;lt;jsp:include&amp;gt;&lt;/code&gt;) would work, but that's probably slower than JSP include directives.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks.&lt;/p&gt;&#xA;" OwnerUserId="996305" LastEditorUserId="6992" LastEditDate="2011-10-15T01:33:49.337" LastActivityDate="2011-10-15T01:44:02.873" Title="What's the equivalent of C++'s &quot;#ifdef #endif&quot; macro in JSP?" Tags="&lt;jsp&gt;&lt;jspinclude&gt;&lt;page-directives&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="8010234" PostTypeId="1" AcceptedAnswerId="8012461" CreationDate="2011-11-04T13:54:12.113" Score="12" ViewCount="5907" Body="&lt;p&gt;I have to use lot of #ifdef &lt;strong&gt;i386&lt;/strong&gt; and &lt;strong&gt;x86_64&lt;/strong&gt; for architecture specific code and some times #ifdef MAC or #ifdef WIN32... so on for platform specific code.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;We have to keep the common code base and portable.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;But we have to follow the guideline that use of #ifdef is strict no. I dont understand why?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;As a extension to this question I would also like to understand when to use #ifdef ?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For example, dlopen() cannot open 32 bit binary while running from 64 bit process and vice versa. Thus its more architecture specific. Can we use #ifdef in such situation?&lt;/p&gt;&#xA;" OwnerUserId="993179" LastEditorUserId="993179" LastEditDate="2011-11-04T14:32:43.937" LastActivityDate="2014-08-29T17:12:03.587" Title="Is it a bad practice to use #ifdef in code?" Tags="&lt;c++&gt;&lt;osx&gt;&lt;coding-style&gt;" AnswerCount="8" CommentCount="10" FavoriteCount="3" />
  <row Id="8042821" PostTypeId="1" CreationDate="2011-11-07T21:26:44.500" Score="0" ViewCount="328" Body="&lt;p&gt;So I have 2 targets: 1 is my application the other is for unit tests.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;In my code I need to know which target its running in order to skip a block if code while running unit tests. Is this possible?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef &quot;Some how figure out what target we are in&quot;&#xA;// run this code if we are not running the unit test target&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="242769" LastEditorUserId="557219" LastEditDate="2011-11-07T21:38:16.333" LastActivityDate="2011-11-07T22:07:40.557" Title="Checking which target is executing" Tags="&lt;objective-c&gt;&lt;xcode&gt;&lt;target&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="8539510" PostTypeId="1" AcceptedAnswerId="8539621" CreationDate="2011-12-16T20:04:58.140" Score="1" ViewCount="435" Body="&lt;p&gt;The author claims that his awk script will print out all the limits for a POSIX.1 and XSI compliant system. I am using Red Hat Enterprise Linux Server release 6.0 (Santiago). When I run his awk script it does not seem to be printing out the &lt;code&gt;#ifdef&lt;/code&gt; portion of the C program. My thoughts are that sysconf.sym do not exist on this distribution, therefore the while loops never run. Could someone please confirm that? If this is the case what changes would I need to make to the awk script to get it to print out the &lt;code&gt;#ifdef&lt;/code&gt; portion of the code? The awk script is:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;# Run with awk -f &amp;lt;awk_script&amp;gt;&#xA;&#xA;BEGIN   {&#xA;    printf(&quot;#include \&quot;apue.h\&quot;\n&quot;)&#xA;    printf(&quot;#include &amp;lt;errno.h&amp;gt;\n&quot;)&#xA;    printf(&quot;#include &amp;lt;limits.h&amp;gt;\n&quot;)&#xA;    printf(&quot;#include &amp;lt;stdio.h&amp;gt;\n&quot;)&#xA;    printf(&quot;\n&quot;)&#xA;&#xA;    printf(&quot;int log_to_stderr = 0;\n&quot;)&#xA;&#xA;    printf(&quot;static void pr_sysconf(char *, int);\n&quot;)&#xA;    printf(&quot;static void pr_pathconf(char *, char *, int);\n&quot;)&#xA;    printf(&quot;\n&quot;)&#xA;    printf(&quot;int\n&quot;)&#xA;    printf(&quot;main(int argc, char *argv[])\n&quot;)&#xA;    printf(&quot;{\n&quot;)&#xA;    printf(&quot; if (argc != 2)\n&quot;)&#xA;    printf(&quot;  err_quit(\&quot;usage: a.out &amp;lt;dirname&amp;gt;\&quot;);\n\n&quot;)&#xA;    FS=&quot;\t+&quot;&#xA;    while (getline &amp;lt;&quot;sysconf.sym&quot; &amp;gt; 0) {&#xA;        printf(&quot;#ifdef %s\n&quot;, $1)&#xA;        printf(&quot; printf(\&quot;%s defined to be %%d\\n\&quot;, %s+0);\n&quot;, $1, $1)&#xA;        printf(&quot;#else\n&quot;)&#xA;        printf(&quot; printf(\&quot;no symbol for %s\\n\&quot;);\n&quot;, $1)&#xA;        printf(&quot;#endif\n&quot;)&#xA;        printf(&quot;#ifdef %s\n&quot;, $2)&#xA;        printf(&quot; pr_sysconf(\&quot;%s =\&quot;, %s);\n&quot;, $1, $2)&#xA;        printf(&quot;#else\n&quot;)&#xA;        printf(&quot; printf(\&quot;no symbol for %s\\n\&quot;);\n&quot;, $2)&#xA;        printf(&quot;#endif\n&quot;)&#xA;    }&#xA;    close(&quot;sysconf.sym&quot;)&#xA;    while (getline &amp;lt;&quot;pathconf.sym&quot; &amp;gt; 0) {&#xA;        printf(&quot;#ifdef %s\n&quot;, $1)&#xA;        printf(&quot; printf(\&quot;%s defined to be %%d\\n\&quot;, %s+0);\n&quot;, $1, $1)&#xA;        printf(&quot;#else\n&quot;)&#xA;        printf(&quot; printf(\&quot;no symbol for %s\\n\&quot;);\n&quot;, $1)&#xA;        printf(&quot;#endif\n&quot;)&#xA;        printf(&quot;#ifdef %s\n&quot;, $2)&#xA;        printf(&quot; pr_pathconf(\&quot;%s =\&quot;, argv[1], %s);\n&quot;, $1, $2)&#xA;        printf(&quot;#else\n&quot;)&#xA;        printf(&quot; printf(\&quot;no symbol for %s\\n\&quot;);\n&quot;, $2)&#xA;        printf(&quot;#endif\n&quot;)&#xA;    }&#xA;    close(&quot;pathconf.sym&quot;)&#xA;    exit&#xA;}&#xA;END {&#xA;    printf(&quot; exit(0);\n&quot;)&#xA;    printf(&quot;}\n\n&quot;)&#xA;    printf(&quot;static void\n&quot;)&#xA;    printf(&quot;pr_sysconf(char *mesg, int name)\n&quot;)&#xA;    printf(&quot;{\n&quot;)&#xA;    printf(&quot; long val;\n\n&quot;)&#xA;    printf(&quot; fputs(mesg, stdout);\n&quot;)&#xA;    printf(&quot; errno = 0;\n&quot;)&#xA;    printf(&quot; if ((val = sysconf(name)) &amp;lt; 0) {\n&quot;)&#xA;    printf(&quot;  if (errno != 0) {\n&quot;)&#xA;    printf(&quot;   if (errno == EINVAL)\n&quot;)&#xA;    printf(&quot;    fputs(\&quot; (not supported)\\n\&quot;, stdout);\n&quot;)&#xA;    printf(&quot;   else\n&quot;)&#xA;    printf(&quot;    err_sys(\&quot;sysconf error\&quot;);\n&quot;)&#xA;    printf(&quot;  } else {\n&quot;)&#xA;    printf(&quot;   fputs(\&quot; (no limit)\\n\&quot;, stdout);\n&quot;)&#xA;    printf(&quot;  }\n&quot;)&#xA;    printf(&quot; } else {\n&quot;)&#xA;    printf(&quot;  printf(\&quot; %%ld\\n\&quot;, val);\n&quot;)&#xA;    printf(&quot; }\n&quot;)&#xA;    printf(&quot;}\n\n&quot;)&#xA;    printf(&quot;static void\n&quot;)&#xA;    printf(&quot;pr_pathconf(char *mesg, char *path, int name)\n&quot;)&#xA;    printf(&quot;{\n&quot;)&#xA;    printf(&quot; long val;\n&quot;)&#xA;    printf(&quot;\n&quot;)&#xA;    printf(&quot; fputs(mesg, stdout);\n&quot;)&#xA;    printf(&quot; errno = 0;\n&quot;)&#xA;    printf(&quot; if ((val = pathconf(path, name)) &amp;lt; 0) {\n&quot;)&#xA;    printf(&quot;  if (errno != 0) {\n&quot;)&#xA;    printf(&quot;   if (errno == EINVAL)\n&quot;)&#xA;    printf(&quot;    fputs(\&quot; (not supported)\\n\&quot;, stdout);\n&quot;)&#xA;    printf(&quot;   else\n&quot;)&#xA;    printf(&quot;    err_sys(\&quot;pathconf error, path = %%s\&quot;, path);\n&quot;)&#xA;    printf(&quot;  } else {\n&quot;)&#xA;    printf(&quot;   fputs(\&quot; (no limit)\\n\&quot;, stdout);\n&quot;)&#xA;    printf(&quot;  }\n&quot;)&#xA;    printf(&quot; } else {\n&quot;)&#xA;    printf(&quot;  printf(\&quot; %%ld\\n\&quot;, val);\n&quot;)&#xA;    printf(&quot; }\n&quot;)&#xA;    printf(&quot;}\n&quot;)&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;If you would like the apue.h header so you can compile the C program that can be found at.&#xA;&lt;a href=&quot;http://matthewh.me/scripts/browser/c/unix_system_programming/src/include/apue.h&quot; rel=&quot;nofollow&quot;&gt;apue.h&lt;/a&gt;&lt;/p&gt;&#xA;" OwnerUserId="287592" LastEditorUserId="287592" LastEditDate="2011-12-16T20:39:39.853" LastActivityDate="2011-12-16T20:39:39.853" Title="Advance Programming in the Unix Environment: Get Configuration Limits Figure 2.12 &quot;Build C Program to print all supported configuration limits&quot;" Tags="&lt;c&gt;&lt;linux&gt;&lt;unix&gt;&lt;awk&gt;&lt;redhat&gt;" AnswerCount="3" CommentCount="4" />
  <row Id="8562412" PostTypeId="1" AcceptedAnswerId="11282533" CreationDate="2011-12-19T13:59:36.333" Score="0" ViewCount="700" Body="&lt;p&gt;In a &lt;code&gt;UISplitViewController&lt;/code&gt; setup on iPad, &lt;code&gt;RootViewController&lt;/code&gt; is a &lt;code&gt;UIViewController&lt;/code&gt; class with a XIB file (not a &lt;code&gt;UITableViewController&lt;/code&gt;.)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My App has several targets. Depending on the target selected (and via &lt;code&gt;#ifdef ...&lt;/code&gt; in the code), I'd like to specify a different XIB file for &lt;code&gt;RootViewController&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I guess the changes have to be made in &lt;code&gt;application:didFinishLaunchingWithOptions&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions&#xA;{&#xA;    // Add the split view controller's view to the window and display.&#xA;    self.window.rootViewController = self.splitViewController;&#xA;    [self.window makeKeyAndVisible];&#xA;&#xA;    return YES;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;== EDIT ==&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I deleted all controllers from MainWindow.xib, then added the following lines in the AppDelegate. RootViewController is launched with the appropriate XIB, but the mechanics between RootVC and DetailsVC in SplitViewController does not work; ie. when hitting a button in RootVC that should trigger a change in DefaultVC, nothing happens. I am obviously missing something.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;splitViewController = [[UISplitViewController alloc] init];&#xA;&#xA;#ifdef OPTION1&#xA;    rootViewController = [[RootViewController alloc] initWithNibName:@&quot;RootViewController_1&quot; bundle:nil];&#xA;#elif OPTION2&#xA;    rootViewController = [[RootViewController alloc] initWithNibName:@&quot;RootViewController_2&quot; bundle:nil];&#xA;#endif&#xA;&#xA;defaultViewController = [[[DefaultViewController alloc] init] autorelease]; &#xA;&#xA;UINavigationController *rootNav = [[[UINavigationController alloc] initWithRootViewController:rootViewController] autorelease];&#xA;UINavigationController *defaultNav = [[[UINavigationController alloc] initWithRootViewController:defaultViewController] autorelease];&#xA;&#xA;splitViewController.viewControllers = [NSArray arrayWithObjects:rootNav, defaultNav, nil];&#xA;splitViewController.delegate = defaultViewController;&#xA;&#xA;self.window.rootViewController = self.splitViewController;&#xA;[self.window makeKeyAndVisible];&#xA;&#xA;// Add the split view controller's view to the window and display.&#xA;self.window.rootViewController = self.splitViewController;&#xA;[self.window makeKeyAndVisible];&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="619381" LastEditorUserId="619381" LastEditDate="2011-12-20T07:23:58.473" LastActivityDate="2012-07-01T13:53:44.593" Title="Overriding RootViewController.xib in UISplitViewController" Tags="&lt;ios&gt;&lt;ipad&gt;&lt;uisplitviewcontroller&gt;&lt;xib&gt;" AnswerCount="3" CommentCount="0" />
  <row Id="8636235" PostTypeId="1" AcceptedAnswerId="8640178" CreationDate="2011-12-26T13:32:33.443" Score="0" ViewCount="212" Body="&lt;p&gt;I am trying to compile a HAL API example on Netbeans. Netbeans shows warning and error about some header files. But I am able to compile my sample codes using following command line:  &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;gcc `pkg-config --libs --cflags dbus-1 hal hal-storage dbus-glib-1 glib-2.0` main.c HalDemos.c HalDemos.h -o HalDemos -lpthread&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;How can apply this command to my Netbeans project?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here the codes which I am trying to compile:  &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* &#xA; * File:   HallDemos.h&#xA; * Author: olcay&#xA; *&#xA; * Created on December 25, 2011, 5:05 AM&#xA; */&#xA;&#xA;#ifndef HALLDEMOS_H&#xA;#define HALLDEMOS_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;#include &amp;lt;hal/libhal.h&amp;gt;&#xA;#include &amp;lt;hal/libhal-storage.h&amp;gt;&#xA;#include &amp;lt;dbus/dbus.h&amp;gt;&#xA;#include &amp;lt;glib-1.2/glib.h&amp;gt;&#xA;//#include &amp;lt;dbus/dbus-glib-lowlevel.h&amp;gt;&#xA;&#xA;    #define HAL_DBUS_SERVICE &quot;org.freedesktop.Hal&quot;&#xA;    #define HAL_ROOT_COMPUTER &quot;/org/freedesktop/Hal/devices/computer&quot;&#xA;    #define HAL_DBUS_INTERFACE_POWER &quot;org.freedesktop.Hal.Device.SystemPowerManagement&quot;&#xA;&#xA;    static void handle_device_removed(LibHalContext *ctx, const char *udi);&#xA;    static void handle_device_added(LibHalContext *ctx, const char *udi);&#xA;    DBusConnection *connection;&#xA;    DBusError error;&#xA;    DBusMessage *mess;&#xA;    DBusMessage *reply;&#xA;    LibHalContext *ctx;&#xA;    LibHalDrive *drive;&#xA;    LibHalVolume *volume;&#xA;    const char *udi;&#xA;    int exit_code;&#xA;&#xA;    int initHal();&#xA;    int getSystemInfo();&#xA;    int getDeviceWithCapability(const char *capability);&#xA;    void callbackLoop();&#xA;    void listDeviceContent();&#xA;&#xA;&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif  /* HALLDEMOS_H */&#xA;&#xA;&#xA;&#xA;&#xA;#include &quot;HalDemos.h&quot;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;&#xA;static void handle_device_removed(LibHalContext *ctx, const char *udi) {&#xA;    printf(&quot;Device with udi=%s is removed\n&quot;, udi);&#xA;}&#xA;&#xA;static void handle_device_added(LibHalContext *ctx, const char *udi) {&#xA;&#xA;    dbus_bool_t is_storage;&#xA;&#xA;    is_storage = libhal_device_query_capability(ctx, udi, &quot;storage&quot;, NULL);&#xA;    if (is_storage) {&#xA;        drive = libhal_drive_from_udi(ctx, udi);&#xA;        volume = libhal_volume_from_udi(ctx, udi);&#xA;        if (libhal_drive_is_hotpluggable(drive) || libhal_drive_uses_removable_media(drive)) {&#xA;            printf(&quot;Storage device added %s model %s\n&quot;,&#xA;                    libhal_drive_get_device_file(drive),&#xA;                    libhal_drive_get_model(drive));&#xA;            //printf(&quot;Mount point = %s\n&quot;, libhal_volume_get_mount_point(volume));&#xA;        }&#xA;        libhal_drive_free(drive);&#xA;    }&#xA;&#xA;    //printf(&quot;Device with udi=%s is added\n&quot;, udi);&#xA;}&#xA;&#xA;int initHal() {&#xA;    udi = &quot;/org/freedesktop/Hal/devices/computer&quot;;&#xA;    dbus_error_init(&amp;amp;error);&#xA;    connection = dbus_bus_get(DBUS_BUS_SYSTEM, &amp;amp;error);&#xA;&#xA;    if (dbus_error_is_set(&amp;amp;error)) {&#xA;        printf(&quot;Unable to connect to Dbus: %s\n&quot;, error.message);&#xA;        dbus_error_free(&amp;amp;error);&#xA;        return 1;&#xA;    }&#xA;&#xA;    ctx = libhal_ctx_new();&#xA;&#xA;    if (!libhal_ctx_set_dbus_connection(ctx, connection)) {&#xA;        printf(&quot;Error: %s\n&quot;, error.message);&#xA;        dbus_error_free(&amp;amp;error);&#xA;        return 1;&#xA;    }&#xA;&#xA;    if (!libhal_ctx_init(ctx, &amp;amp;error)) {&#xA;        printf(&quot;Hal context initializing failure %s\n&quot;, error.message);&#xA;        return 1;&#xA;    }&#xA;}&#xA;&#xA;int getSystemInfo() {&#xA;&#xA;    char *kernel_version = libhal_device_get_property_string(ctx, udi, &quot;system.kernel.version&quot;, &amp;amp;error);&#xA;&#xA;    if (dbus_error_is_set(&amp;amp;error)) {&#xA;        printf(&quot;Error getting string property %s\n&quot;, error.message);&#xA;        dbus_error_free(&amp;amp;error);&#xA;        return 1;&#xA;    }&#xA;&#xA;    char *power_management_type = libhal_device_get_property_string(ctx, udi, &quot;power_management.type&quot;, &amp;amp;error);&#xA;&#xA;    if (dbus_error_is_set(&amp;amp;error)) {&#xA;        printf(&quot;Error getting string property %s\n&quot;, error.message);&#xA;        dbus_error_free(&amp;amp;error);&#xA;        return 1;&#xA;    }&#xA;&#xA;    dbus_bool_t can_hibernate = libhal_device_get_property_bool(ctx, udi, &quot;power_management.can_hibernate&quot;, &amp;amp;error);&#xA;&#xA;    if (dbus_error_is_set(&amp;amp;error)) {&#xA;        printf(&quot;Error getting bool property %s\n&quot;, error.message);&#xA;        dbus_error_free(&amp;amp;error);&#xA;        return 1;&#xA;    }&#xA;&#xA;    printf(&quot;System information:\n&quot;);&#xA;    printf(&quot;Kernel                = %s\n&quot;, kernel_version);&#xA;    printf(&quot;Power management type = %s\n&quot;, power_management_type);&#xA;    printf(&quot;Hibernate             = %s\n&quot;, can_hibernate ? &quot;Supported&quot; : &quot;Not supported&quot;);&#xA;&#xA;    libhal_free_string(kernel_version);&#xA;    libhal_free_string(power_management_type);&#xA;    return 0;&#xA;}&#xA;&#xA;int getDeviceWithCapability(const char* capability) {&#xA;    int num_devices = 0;&#xA;    char **udis = libhal_find_device_by_capability(ctx, capability, &amp;amp;num_devices, &amp;amp;error);&#xA;&#xA;    if (dbus_error_is_set(&amp;amp;error)) {&#xA;        printf(&quot;Error getting bool property %s\n&quot;, error.message);&#xA;        dbus_error_free(&amp;amp;error);&#xA;        return 1;&#xA;    }&#xA;    if (num_devices == 0) {&#xA;        printf(&quot;No device found with input capability!&quot;);&#xA;        return 0;&#xA;    }&#xA;    int i;&#xA;&#xA;    printf(&quot;Devices with input capability:\n&quot;);&#xA;    for (i = 0; udis[i]; i++) {&#xA;        printf(&quot;%2d - udi = %s\n&quot;, i + 1, udis[i]);&#xA;        /* Do something with it */&#xA;    }&#xA;    /* Free the string array */&#xA;    libhal_free_string_array(udis);&#xA;}&#xA;&#xA;void callbackLoop() {&#xA;    GMainLoop *loop;&#xA;    loop = (GMainLoop*) g_main_loop_new(NULL, FALSE);&#xA;    dbus_connection_setup_with_g_main(connection, NULL);&#xA;    libhal_ctx_set_device_added(ctx, handle_device_added);&#xA;    libhal_ctx_set_device_removed(ctx, handle_device_removed);&#xA;    g_main_loop_run(loop);&#xA;}&#xA;&#xA;void listDeviceContent(){&#xA;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;UPDATE:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Writing the command I used with &lt;code&gt;$$()&lt;/code&gt; and adding it to additional compiler settings solved my problem.&lt;/p&gt;&#xA;" OwnerUserId="614065" LastEditorUserId="614065" LastEditDate="2011-12-26T14:24:59.150" LastActivityDate="2011-12-27T00:32:36.297" Title="How can I compile HAL examples on Neatbeans?" Tags="&lt;netbeans&gt;&lt;compilation&gt;&lt;projects-and-solutions&gt;&lt;hal&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="8883818" PostTypeId="1" AcceptedAnswerId="8884101" CreationDate="2012-01-16T17:26:13.213" Score="11" ViewCount="11895" Body="&lt;p&gt;What's wrong here:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define CONTROLS_OFFSET 100&#xA;#ifdef  CONTROLS_OFFSET//Unterminated conditional directive it says&#xA;#define FIND_MAIN_MENU 3&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Why do i get this error? &lt;/p&gt;&#xA;" OwnerUserId="994107" LastEditorUserId="994107" LastEditDate="2012-01-16T17:45:32.127" LastActivityDate="2012-01-16T18:27:20.023" Title="Unterminated conditional directive in Xcode" Tags="&lt;objective-c&gt;&lt;xcode&gt;&lt;preprocessor-directive&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="8962633" PostTypeId="1" AcceptedAnswerId="8963207" CreationDate="2012-01-22T16:33:49.440" Score="0" ViewCount="1523" Body="&lt;p&gt;I am facing strange problem.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I am compiling a MFC application(VS 2008) which uses static library MyLib.lib.it is compiling fine in debug mode.&#xA;but in Debug Unicode it is showing error.I am using Debug Unicode version of MyLib.lib in MFC application.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Main.obj : error LNK2019: unresolved external symbol &quot;void * __cdecl  VCI_Open_Device(wchar_t *)&quot; (?VCI_Open_Device@@YAPAXPA_W@Z) referenced in function _wmain    &#xA;&#xA;&#xA;VCIHANDLE &#xA;VCI_Open_Device             (   TCHAR *ptszDevicePath   &#xA;                                );&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Here I notice in MFC App that in debug mode TCHAR is typedef char TCHAR, which is correct but in Debug Unicode mode TCHAR should be typedef WCHAR TCHAR but here also it showing typedef char TCHAR.&#xA;I checked in WebCam.lib Project TCHAR  is typedef WCHAR TCHAR in Debug Unicode mode which correct.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I guess it is problem with some setting in the Debug Unicode mode in MFC app mode.&#xA;Please help resolve this issue.&#xA;    #ifdef  UNICODE                     // r_winnt&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef _TCHAR_DEFINED&#xA;typedef WCHAR TCHAR, *PTCHAR;&#xA;typedef WCHAR TBYTE , *PTBYTE ;&#xA;#define _TCHAR_DEFINED&#xA;#endif /* !_TCHAR_DEFINED */&#xA;&#xA;typedef LPWCH LPTCH, PTCH;&#xA;typedef LPCWCH LPCTCH, PCTCH;&#xA;typedef LPWSTR PTSTR, LPTSTR;&#xA;typedef LPCWSTR PCTSTR, LPCTSTR;&#xA;typedef LPUWSTR PUTSTR, LPUTSTR;&#xA;typedef LPCUWSTR PCUTSTR, LPCUTSTR;    &#xA;typedef LPWSTR LP;&#xA;typedef PZZWSTR PZZTSTR;&#xA;typedef PCZZWSTR PCZZTSTR;&#xA;typedef PUZZWSTR PUZZTSTR;&#xA; typedef PCUZZWSTR PCUZZTSTR;&#xA;typedef PNZWCH PNZTCH;&#xA;typedef PCNZWCH PCNZTCH;&#xA;typedef PUNZWCH PUNZTCH;&#xA;typedef PCUNZWCH PCUNZTCH;&#xA;#define __TEXT(quote) L##quote      // r_winnt&#xA;&#xA;#else   /* UNICODE */               // r_winnt&#xA;&#xA;#ifndef _TCHAR_DEFINED&#xA;typedef char TCHAR, *PTCHAR;&#xA;typedef unsigned char TBYTE , *PTBYTE ;&#xA;#define _TCHAR_DEFINED&#xA;#endif /* !_TCHAR_DEFINED */&#xA;&#xA;typedef LPCH LPTCH, PTCH;&#xA;typedef LPCCH LPCTCH, PCTCH;&#xA;typedef LPSTR PTSTR, LPTSTR, PUTSTR, LPUTSTR;&#xA;typedef LPCSTR PCTSTR, LPCTSTR, PCUTSTR, LPCUTSTR;&#xA;typedef PZZSTR PZZTSTR, PUZZTSTR;&#xA;typedef PCZZSTR PCZZTSTR, PCUZZTSTR;&#xA;typedef PNZCH PNZTCH, PUNZTCH;&#xA;typedef PCNZCH PCNZTCH, PCUNZTCH;&#xA;#define __TEXT(quote) quote         // r_winnt&#xA;&#xA;#endif /* UNICODE */             &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Here when I do right click on TCHAR it is not going in UNICODE part.&lt;/p&gt;&#xA;" OwnerUserId="488505" LastEditorUserId="488505" LastEditDate="2012-01-22T17:38:58.493" LastActivityDate="2012-01-22T17:53:10.343" Title="TCHAR in Unicode mode is treated as typedef char TCHAR" Tags="&lt;c++&gt;&lt;visual-studio&gt;" AnswerCount="3" CommentCount="1" FavoriteCount="0" />
  <row Id="9096018" PostTypeId="1" AcceptedAnswerId="9107699" CreationDate="2012-02-01T12:44:02.870" Score="5" ViewCount="943" Body="&lt;p&gt;Is there any type of if/else statemant compatible with GNU make and Berkley make (freeBSD) ?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;GNU MAKE:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; ifeq ($(BUILD_TYPE), debug)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;berkley make: &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;.ifdef (BUILD_TYPE)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1179191" LastEditorUserId="545027" LastEditDate="2012-02-01T12:47:18.217" LastActivityDate="2012-02-02T05:42:13.507" Title="make &amp; gmake compatible if else statment" Tags="&lt;makefile&gt;&lt;gnu&gt;&lt;gnu-make&gt;&lt;bsdmake&gt;" AnswerCount="1" CommentCount="5" />
  <row Id="9205316" PostTypeId="1" CreationDate="2012-02-09T04:10:43.740" Score="2" ViewCount="1512" Body="&lt;p&gt;Can I #ifdef #imports in objective-c?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For example:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef USE_A&#xA;#import &quot;ClassA.h&quot;&#xA;#endif&#xA;&#xA;#ifdef USE_B&#xA;#import &quot;ClassB.h&quot;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1198770" LastEditorUserId="458390" LastEditDate="2012-02-09T04:19:32.647" LastActivityDate="2012-02-09T05:55:18.107" Title="Can I #ifdef #imports?" Tags="&lt;objective-c&gt;&lt;conditional-compilation&gt;" AnswerCount="3" CommentCount="3" />
  <row Id="9999386" PostTypeId="1" AcceptedAnswerId="10033319" CreationDate="2012-04-03T18:42:38.187" Score="3" ViewCount="393" Body="&lt;p&gt;I'm working on building Qt 4.8.1 in VisualStudio 2005 and I was getting an issue that the compiler could not find &lt;code&gt;_fileno&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;After some research, I found that in stdio.h it has&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  _POSIX_&#xA;_CRTIMP __checkReturn int __cdecl fileno(__in FILE * _File);&#xA;#else&#xA;_CRTIMP __checkReturn int __cdecl _fileno(__in FILE * _File);&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I then looked through the qt code and found that qfsfilengine_win.cpp and qfilesystemengine_win.cpp both have&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define _POSIX_&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It seems to me that this would be a mistake, and if I remove these lines, it seems to build successfully.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Does anyone know why these files would be defining &lt;code&gt;_POSIX_&lt;/code&gt;?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks.&lt;/p&gt;&#xA;" OwnerUserId="642185" LastEditorUserId="774651" LastEditDate="2012-04-03T19:39:17.377" LastActivityDate="2012-04-05T17:42:23.997" Title="Qt, windows and _POSIX_" Tags="&lt;c++&gt;&lt;qt&gt;&lt;visual-studio-2005&gt;&lt;posix&gt;&lt;qt4.8&gt;" AnswerCount="1" CommentCount="11" />
  <row Id="10089739" PostTypeId="1" AcceptedAnswerId="10103685" CreationDate="2012-04-10T13:28:14.000" Score="1" ViewCount="1192" Body="&lt;p&gt;I have the following snippet in my &lt;code&gt;program.wxs&lt;/code&gt; file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?ifndef $(var.TwoOnly) ?&amp;gt;&#xA;        &amp;lt;Feature Id=&quot;FeatureOne&quot; ... &amp;gt;&#xA;          ...&#xA;        &amp;lt;/Feature&amp;gt;&#xA;&amp;lt;?endif ?&amp;gt;&#xA;&#xA;&amp;lt;?ifndef $(var.OneOnly) ?&amp;gt;&#xA;        &amp;lt;Feature Id=&quot;FeatureTwo&quot; ... &amp;gt;&#xA;          ...&#xA;        &amp;lt;/Feature&amp;gt;&#xA;&amp;lt;?endif ?&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I'm compiling this using the following comand:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;candle -dOneOnly=1 program.wxs&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Looking at the compiled &lt;code&gt;program.wixobj&lt;/code&gt;, I can see that Feature Two's declaration is all there, and after running &lt;code&gt;light&lt;/code&gt;, both features are listed, and the installer functions exactly as if neither &lt;code&gt;OneOnly&lt;/code&gt; or &lt;code&gt;TwoOnly&lt;/code&gt; were set. Why is my &lt;code&gt;ifndef&lt;/code&gt; block not working correctly?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Note: I also have the following:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?ifdef $(var.OneOnly) ?&amp;gt;&#xA;  &amp;lt;?define productName = One Only ?&amp;gt;&#xA;&amp;lt;?else?&amp;gt;&#xA;  &amp;lt;?ifdef $(var.TwoOnly) ?&amp;gt;&#xA;    &amp;lt;?define productName = Two Only ?&amp;gt;&#xA;  &amp;lt;?else?&amp;gt;&#xA;    &amp;lt;?define productName = Both ?&amp;gt;&#xA;  &amp;lt;?endif?&amp;gt;&#xA;&amp;lt;?endif?&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The name, even when &lt;code&gt;OneOnly&lt;/code&gt; is set during compile, is displayed as &lt;code&gt;Both&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Edit&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I've reduced the complexity of my condition to the minimal case shown in &lt;a href=&quot;http://wix.sourceforge.net/manual-wix2/preprocessor.htm&quot; rel=&quot;nofollow&quot;&gt;the documentation&lt;/a&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?ifndef $(var.TwoOnly) ?&amp;gt;&#xA;  &amp;lt;?include featureOne.wxi ?&amp;gt;&#xA;&amp;lt;?endif?&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This still does not work. &lt;/p&gt;&#xA;" OwnerUserId="319618" LastEditorUserId="319618" LastEditDate="2012-04-11T09:33:18.183" LastActivityDate="2012-04-11T09:56:35.850" Title="Why is my ifndef section not working?" Tags="&lt;wix&gt;&lt;conditional-compilation&gt;" AnswerCount="1" CommentCount="2" FavoriteCount="2" />
  <row Id="10280321" PostTypeId="1" AcceptedAnswerId="10326019" CreationDate="2012-04-23T12:13:53.787" Score="4" ViewCount="840" Body="&lt;p&gt;I don't know if cc-mode or cedet is providing something alike that but that must not be such hard to realize I hope.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What I want is to change background for code in C++ / C# source files between #ifdef (something) and #endif. Is there mode option for make it or where from to start?&lt;/p&gt;&#xA;" OwnerUserId="238232" LastActivityDate="2012-04-26T01:18:16.630" Title="How to highlight #ifdef &lt;code/&gt; #endif in emacs?" Tags="&lt;emacs&gt;&lt;elisp&gt;&lt;cedet&gt;&lt;cc-mode&gt;" AnswerCount="1" CommentCount="1" FavoriteCount="1" />
  <row Id="11218797" PostTypeId="1" AcceptedAnswerId="11404986" CreationDate="2012-06-27T02:57:18.277" Score="8" ViewCount="14926" Body="&lt;p&gt;I have the following integers:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;int y, mon, d, h, min, s;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Their values are: &lt;code&gt;2012&lt;/code&gt;, &lt;code&gt;06&lt;/code&gt;, &lt;code&gt;27&lt;/code&gt;, &lt;code&gt;12&lt;/code&gt;, &lt;code&gt;47&lt;/code&gt;, &lt;code&gt;53&lt;/code&gt; respectively. I want to represent the date time of &quot;2012/06/27 12:47:53 UTC&quot; if I have selected 'UTC' somewhere else in my application, or &quot;2012/06/27 12:47:53 AEST&quot; if I have selected 'AEST' somewhere else in my application.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I want to convert this into a &lt;code&gt;time_t&lt;/code&gt;, and here's the code that I am current using to do so:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;struct tm timeinfo;&#xA;timeinfo.tm_year = year - 1900;&#xA;timeinfo.tm_mon = mon - 1;&#xA;timeinfo.tm_mday = day;&#xA;timeinfo.tm_hour = hour;&#xA;timeinfo.tm_min = min;&#xA;timeinfo.tm_sec = sec;&#xA;//timeinfo.tm_isdst = 0; //TODO should this be set?&#xA;&#xA;//TODO find POSIX or C standard way to do covert tm to time_t without in UTC instead of local time&#xA;#ifdef UNIX&#xA;return timegm(&amp;amp;timeinfo);&#xA;#else&#xA;return mktime(&amp;amp;timeinfo); //FIXME Still incorrect&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;So I am using a &lt;code&gt;tm struct&lt;/code&gt; and &lt;code&gt;mktime&lt;/code&gt;, however this is not working well, because it is always assuming my local time-zone.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What is the correct way of doing this?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So below is the solution that I have come up with so far.&#xA;It basically does one of three things:&lt;/p&gt;&#xA;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;If UNIX, simply use &lt;code&gt;timegm&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;If not UNIX&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Either, do math using the difference between UTC epoch and local epoch as an offset&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Reservation: Math may be incorrect&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/li&gt;&#xA;&lt;li&gt;Or, set the &quot;TZ&quot; environment variable to UTC temporarily&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Reservation: will trip up if/ when this code needs to be multithreaded&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre class=&quot;lang-cpp prettyprint-override&quot;&gt;&lt;code&gt;namespace tmUtil&#xA;{&#xA;    int const tm_yearCorrection = -1900;&#xA;    int const tm_monthCorrection = -1;&#xA;    int const tm_isdst_dontKnow = -1;&#xA;&#xA;#if !defined(DEBUG_DATETIME_TIMEGM_ENVVARTZ) &amp;amp;&amp;amp; !(defined(UNIX) &amp;amp;&amp;amp; !defined(DEBUG_DATETIME_TIMEGM))&#xA;    static bool isLeap(int year)&#xA;    {&#xA;        return&#xA;            (year % 4) ? false&#xA;            : (year % 100) ? true&#xA;            : (year % 400) ? false&#xA;            : true;&#xA;    }&#xA;&#xA;    static int daysIn(int year)&#xA;    {&#xA;        return isLeap(year) ? 366 : 365;&#xA;    }&#xA;#endif&#xA;}&#xA;&#xA;time_t utc(int year, int mon, int day, int hour, int min, int sec)&#xA;{&#xA;    struct tm time = {0};&#xA;    time.tm_year = year + tmUtil::tm_yearCorrection;&#xA;    time.tm_mon = mon + tmUtil::tm_monthCorrection;&#xA;    time.tm_mday = day;&#xA;    time.tm_hour = hour;&#xA;    time.tm_min = min;&#xA;    time.tm_sec = sec;&#xA;    time.tm_isdst = tmUtil::tm_isdst_dontKnow;&#xA;&#xA;    #if defined(UNIX) &amp;amp;&amp;amp; !defined(DEBUG_DATETIME_TIMEGM) //TODO remove &amp;amp;&amp;amp; 00&#xA;        time_t result;&#xA;        result = timegm(&amp;amp;time);&#xA;        return result;&#xA;    #else&#xA;        #if !defined(DEBUG_DATETIME_TIMEGM_ENVVARTZ)&#xA;            //TODO check that math is correct&#xA;            time_t fromEpochUtc = mktime(&amp;amp;time);&#xA;&#xA;            struct tm localData;&#xA;            struct tm utcData;&#xA;            struct tm* loc = localtime_r (&amp;amp;fromEpochUtc, &amp;amp;localData);&#xA;            struct tm* utc = gmtime_r (&amp;amp;fromEpochUtc, &amp;amp;utcData);&#xA;            int utcYear = utc-&amp;gt;tm_year - tmUtil::tm_yearCorrection;&#xA;            int gmtOff =&#xA;                (loc-&amp;gt; tm_sec - utc-&amp;gt; tm_sec)&#xA;                + (loc-&amp;gt; tm_min - utc-&amp;gt; tm_min) * 60&#xA;                + (loc-&amp;gt;tm_hour - utc-&amp;gt;tm_hour) * 60 * 60&#xA;                + (loc-&amp;gt;tm_yday - utc-&amp;gt;tm_yday) * 60 * 60 * 24&#xA;                + (loc-&amp;gt;tm_year - utc-&amp;gt;tm_year) * 60 * 60 * 24 * tmUtil::daysIn(utcYear);&#xA;&#xA;            #ifdef UNIX&#xA;                if (loc-&amp;gt;tm_gmtoff != gmtOff)&#xA;                {&#xA;                    StringBuilder err(&quot;loc-&amp;gt;tm_gmtoff=&quot;, StringBuilder((int)(loc-&amp;gt;tm_gmtoff)), &quot; but gmtOff=&quot;, StringBuilder(gmtOff));&#xA;                    THROWEXCEPTION(err);&#xA;                }&#xA;            #endif&#xA;&#xA;            int resultInt = fromEpochUtc + gmtOff;&#xA;            time_t result;&#xA;            result = (time_t)resultInt;&#xA;            return result;&#xA;        #else&#xA;            //TODO Find a way to do this without manipulating environment variables&#xA;            time_t result;&#xA;            char *tz;&#xA;            tz = getenv(&quot;TZ&quot;);&#xA;            setenv(&quot;TZ&quot;, &quot;&quot;, 1);&#xA;            tzset();&#xA;            result = mktime(&amp;amp;time);&#xA;            if (tz)&#xA;                setenv(&quot;TZ&quot;, tz, 1);&#xA;            else&#xA;                unsetenv(&quot;TZ&quot;);&#xA;            tzset();&#xA;            return result;&#xA;        #endif&#xA;    #endif&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;N.B. &lt;code&gt;StringBuilder&lt;/code&gt; is an internal class, it doesn't matter for the purposes of this question.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;More info:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I know that this can be done easily using boost, et al. But this is NOT and option. I need it to be done mathematically, or using a c or c++ standard function, or combinations thereof.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;timegm&lt;/code&gt; appears to solve this problem, however, it doesn't appear to part of the C / POSIX standard. This code currently is compiled on multiple platforms (Linux, OSX, WIndows, iOS, Android (NDK)), so I need to find a way to make it work across all of these platforms, even if the solution involves &lt;code&gt;#ifdef $PLATFORM&lt;/code&gt; type things.&lt;/p&gt;&#xA;" OwnerUserId="194982" LastEditorUserId="2642204" LastEditDate="2014-12-11T12:50:01.043" LastActivityDate="2014-12-11T12:50:01.043" Title="Convert date and time numbers to time_t AND specify the timezone" Tags="&lt;c++&gt;&lt;datetime&gt;&lt;timezone&gt;&lt;time-t&gt;" AnswerCount="5" CommentCount="6" FavoriteCount="3" />
  <row Id="11327941" PostTypeId="1" AcceptedAnswerId="11336881" CreationDate="2012-07-04T11:12:39.007" Score="3" ViewCount="3111" Body="&lt;p&gt;I - an embedded beginner - am fighting my way through the black magic world of embedded programming. So far I won already a bunch of fights, but this new bug seems to be a hard one.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;First, my embedded setup:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Olimex STM32-P207 (STM32F207)&lt;/li&gt;&#xA;&lt;li&gt;Olimex ARM-USB-OCD-H JTAG&lt;/li&gt;&#xA;&lt;li&gt;OpenOCD&lt;/li&gt;&#xA;&lt;li&gt;Eclipse (with CDT and GDB hardware debugging)&lt;/li&gt;&#xA;&lt;li&gt;Codesourcery Toolchain&lt;/li&gt;&#xA;&lt;li&gt;Startup file and linker script (adapted memory map for the STM32F207) for RIDE (what uses GCC)&lt;/li&gt;&#xA;&lt;li&gt;STM32F2xx_StdPeriph_Lib_V1.1.0&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;Using the many tutorials and Q&amp;amp;As out there I was able to set-up makefile, linker and startup code and got some simple examples running using STM's standard library (classic blinky, using buttons and interrupts etc.). However, once I started playing around with the SysTick interrupts, things got messy.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;If add the SysTick_Config() call to my code (even with an empty SysTick_Handler), ...&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;int main(void)&#xA;{&#xA;  /*!&amp;lt; At this stage the microcontroller clock setting is already configured, &#xA;       [...]&#xA;  */&#xA;  if (SysTick_Config(SystemCoreClock / 120000))&#xA;  {&#xA;    // Catch config error&#xA;    while(1);&#xA;  }&#xA;[...]&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;... then my debugger starts at the (inline) function NVIC_SetPriority() and once I hit &quot;run&quot; I end up in the HardFault_Handler().&#xA;This only happens, when using the debugger. Otherwise the code runs normal (telling from the blinking LEDs).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I already read a lot and tried a lot (modifying compiler options, linker, startup, trying other code with SysTick_Config() calls), but nothing solved this problem.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;One thing could be a hint:&#xA;The compiler starts in both cases (with and without the SysTick_Config call) at 0x00000184. In the case without the SysTick_Config call this points at the beginnig of main(). Using SysTick_Config this pionts at NVIC_SetPriority().&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Does anybody have a clue what's going on? Any hint about where I could continue my search for a solution?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I don't know what further information would be helpful to solve this riddle. Please let me know and I will be happy to provide the missing pieces.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks a lot!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;/edit1: Added results of arm-none-eabi-readelf, -objdump and -size.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;/edit2: I removed the code info to make space for the actual code. With this new simplified version debugging starts at&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;08000184:   stmdaeq r0, {r4, r6, r8, r9, r10, r11, sp}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;readelf:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;[ 2] .text             PROGBITS        08000184 008184 002dcc 00  AX  0   0  4&#xA;...&#xA; 2: 08000184     0 SECTION LOCAL  DEFAULT    2&#xA;...&#xA;46: 08000184     0 NOTYPE  LOCAL  DEFAULT    2 $d&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;main.c&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* Includes ------------------------------------------------------------------*/&#xA;#include &quot;stm32f2xx.h&quot;&#xA;&#xA;/* Private typedef -----------------------------------------------------------*/&#xA;/* Private define ------------------------------------------------------------*/&#xA;/* Private macro -------------------------------------------------------------*/&#xA;/* Private variables ---------------------------------------------------------*/&#xA;uint16_t counter = 0;&#xA;&#xA;/* Private function prototypes -----------------------------------------------*/&#xA;/* Private functions ---------------------------------------------------------*/&#xA;void assert_failed(uint8_t* file, uint32_t line);&#xA;void Delay(__IO uint32_t nCount);&#xA;void SysTick_Handler(void);&#xA;/**&#xA;  * @brief  Main program&#xA;  * @param  None&#xA;  * @retval None&#xA;  */&#xA;int main(void)&#xA;{&#xA;  if (SysTick_Config(SystemCoreClock / 12000))&#xA;  {&#xA;    // Catch config error&#xA;    while(1);&#xA;  }&#xA;  /*&#xA;   * Configure the LEDs&#xA;   */&#xA;  RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOF, ENABLE); // LEDs&#xA;&#xA;  GPIO_InitTypeDef GPIO_InitStructure;&#xA;  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6 | GPIO_Pin_7 | GPIO_Pin_8 | GPIO_Pin_9;&#xA;  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;&#xA;  GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;&#xA;  GPIO_InitStructure.GPIO_Speed = GPIO_Speed_2MHz;&#xA;  GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;&#xA;  GPIO_Init(GPIOF, &amp;amp;GPIO_InitStructure);&#xA;&#xA;  GPIOF-&amp;gt;BSRRL = GPIO_Pin_6;&#xA;&#xA;  while (1)&#xA;  {&#xA;    if (GPIO_ReadInputDataBit(GPIOF, GPIO_Pin_9) == SET)&#xA;    {&#xA;      GPIOF-&amp;gt;BSRRH = GPIO_Pin_9;&#xA;    }&#xA;    else&#xA;    {&#xA;      GPIOF-&amp;gt;BSRRL = GPIO_Pin_9;&#xA;    }&#xA;    Delay(500000);&#xA;  }&#xA;  return 0;&#xA;}&#xA;&#xA;#ifdef  USE_FULL_ASSERT&#xA;&#xA;/**&#xA;  * @brief  Reports the name of the source file and the source line number&#xA;  *         where the assert_param error has occurred.&#xA;  * @param  file: pointer to the source file name&#xA;  * @param  line: assert_param error line source number&#xA;  * @retval None&#xA;  */&#xA;void assert_failed(uint8_t* file, uint32_t line)&#xA;{ &#xA;  /* User can add his own implementation to report the file name and line number,&#xA;     ex: printf(&quot;Wrong parameters value: file %s on line %d\r\n&quot;, file, line) */&#xA;&#xA;  /* Infinite loop */&#xA;  while (1)&#xA;  {&#xA;  }&#xA;}&#xA;#endif&#xA;&#xA;/**&#xA; * @brief  Delay Function.&#xA; * @param  nCount:specifies the Delay time length.&#xA; * @retval None&#xA; */&#xA;void Delay(__IO uint32_t nCount)&#xA;{&#xA;  while (nCount &amp;gt; 0)&#xA;  {&#xA;    nCount--;&#xA;  }&#xA;}&#xA;&#xA;/**&#xA;  * @brief  This function handles Hard Fault exception.&#xA;  * @param  None&#xA;  * @retval None&#xA;  */&#xA;void HardFault_Handler(void)&#xA;{&#xA;  /* Go to infinite loop when Hard Fault exception occurs */&#xA;  while (1)&#xA;  {&#xA;  }&#xA;}&#xA;&#xA;/**&#xA;  * @brief  This function handles SysTick Handler.&#xA;  * @param  None&#xA;  * @retval None&#xA;  */&#xA;void SysTick_Handler(void)&#xA;{&#xA;  if (counter &amp;gt; 10000 )&#xA;  {&#xA;    if (GPIO_ReadInputDataBit(GPIOF, GPIO_Pin_8) == SET)&#xA;    {&#xA;      GPIOF-&amp;gt;BSRRH = GPIO_Pin_8;&#xA;    }&#xA;    else&#xA;    {&#xA;      GPIOF-&amp;gt;BSRRL = GPIO_Pin_8;&#xA;    }&#xA;    counter = 0;&#xA;  }&#xA;  else&#xA;  {&#xA;    counter++;&#xA;  }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;/edit3:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Soultion&lt;/strong&gt;:&#xA;Because the solution is burrowed in a comment, I put it up here:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My linker file was missing &lt;strong&gt;&lt;code&gt;ENTRY(your_function_of_choice);&lt;/code&gt;&lt;/strong&gt; (e.g. Reset_Handler). Adding this made my debugger work again (it now starts at the right point).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks everybody!&lt;/p&gt;&#xA;" OwnerUserId="1462520" LastEditorUserId="1462520" LastEditDate="2012-07-05T04:06:10.027" LastActivityDate="2012-07-05T04:06:10.027" Title="Can't debug after using SysTick_Config" Tags="&lt;debugging&gt;&lt;embedded&gt;&lt;inline&gt;&lt;stm32&gt;" AnswerCount="1" CommentCount="4" FavoriteCount="0" />
  <row Id="11332203" PostTypeId="1" AcceptedAnswerId="11376592" CreationDate="2012-07-04T15:47:10.540" Score="0" ViewCount="1923" Body="&lt;p&gt;I had been working on a cocos2d-x project for the QNX platform and I am now moving to the iPhone platform to finish developing.  I copied all the files over and created a new Xcode4 project and then imported them, but when I go to compile it, I get 40-something errors in the NSObjCRuntime.h.&#xA;Then it says: Too many errors emitted, stopping now.&#xA;Some of the errors read:&#xA;Unknown type name 'NSString'; did you mean 'CCString'?&#xA;Use of undeclared identifier 'NSString'; did you mean 'CCString'?&#xA;Use of undeclared identifier 'Protocol'&#xA;Use of undeclared identifier 'format'; did you mean 'normal'?&#xA;Use of undeclared identifier 'namestr'&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I looked at my Prefix.pch file, after research this seemed to be part of the problem, but everything is wrapped in the #ifdef &lt;strong&gt;OBJC&lt;/strong&gt; ... #endif condition so I don't think that's the issue.  I even tried commenting out the code there and still it gave me the same errors.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;How can I fix this?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;EDIT: This actually seems to be a problem with the OpenGLES library.  When it's not included and I comment out all gl calls, the errors go away.  Any thoughts?&#xA;I used this code to load the OpenGLES Library:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#import &amp;lt;OpenGLES/EAGL.h&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1500541" LastEditorUserId="1500541" LastEditDate="2012-07-04T16:40:15.817" LastActivityDate="2012-07-07T16:10:36.033" Title="Cocos2d-x, Xcode4 Build Errors in NSObjCRuntime.h" Tags="&lt;iphone&gt;&lt;xcode4&gt;&lt;objective-c++&gt;&lt;cocos2d-x&gt;&lt;build-error&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="11506277" PostTypeId="1" AcceptedAnswerId="11506649" CreationDate="2012-07-16T14:18:02.893" Score="3" ViewCount="339" Body="&lt;p&gt;I'm writing a platform-independent sockets library. The basic file structure is like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;source directory&#xA;|_________________________&#xA;|            |            |&#xA;v            v            v    &#xA;header.hpp   win32        linux&#xA;             |            |&#xA;             v            v&#xA;             source.cpp   source.cpp&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The header file contains any &lt;code&gt;#include&lt;/code&gt;s that are universal across operating systems. The source files &lt;code&gt;#include&lt;/code&gt; platform specific libraries.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I've built many projects like this, but I'm running into an issue with sockets. Because I'm specifying default values for my function parameters, &lt;code&gt;header.h&lt;/code&gt; needs the platform specific libraries for &lt;code&gt;#defines&lt;/code&gt; used in the header file,like &lt;code&gt;SOCK_STREAM&lt;/code&gt;, &lt;code&gt;AF_INET&lt;/code&gt;, and &lt;code&gt;SOMAXCONN&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Now, I don't want to use &lt;code&gt;#ifdef _WIN32&lt;/code&gt; statements in my header file, as I would like ALL platform specific code to be in the source files in separate folders.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Am I basically stuck between a rock and a hard place? Are avoiding &lt;code&gt;#ifdef #includes&lt;/code&gt; and specifying default parameter values with header-dependent &lt;code&gt;#defines&lt;/code&gt; mutually exclusive? &lt;/p&gt;&#xA;" OwnerUserId="1496544" LastActivityDate="2012-07-16T15:05:30.103" Title="Including platform-specific libraries with one header file and separate source files" Tags="&lt;c++&gt;&lt;static-linking&gt;" AnswerCount="3" CommentCount="0" />
  <row Id="11607363" PostTypeId="1" AcceptedAnswerId="11608295" CreationDate="2012-07-23T06:22:19.973" Score="5" ViewCount="3286" Body="&lt;blockquote&gt;&#xA;  &lt;p&gt;&lt;strong&gt;Possible Duplicate:&lt;/strong&gt;&lt;br&gt;&#xA;  &lt;a href=&quot;http://stackoverflow.com/questions/2288293/windows-c-extern-declspecdllimport&quot;&gt;Windows &amp;amp; C++: extern &amp;amp; __declspec(dllimport)&lt;/a&gt;&lt;br&gt;&#xA;  &lt;a href=&quot;http://stackoverflow.com/questions/4489441/why-when-is-declspec-dllimport-not-needed&quot;&gt;Why/when is __declspec( dllimport ) not needed?&lt;/a&gt;  &lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&#xA;&#xA;&lt;p&gt;I want to write a DLL project. This project include several DLLs. They are &lt;strong&gt;dependent&lt;/strong&gt;. I define some macros like follow :&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  MYDLL_DECL1&#xA;    #define  DLL_DECL __declspec(dllexport)&#xA;#else&#xA;    #define DLL_DECL __declspec(dllimport)&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I defined MYDLL_DECL1...MYDLL_DECLn for &lt;strong&gt;each modules&lt;/strong&gt;. Because I thought  if i define the same macro that it wouldn't work .  But I really want to define only one macro, and i wrote a testbed. I have two modules. In the second moudle's source file. I write code like follow:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define  MYDLL_DECL&#xA;#include &quot;moudle1.h&quot;&#xA;#include &quot;moudle2.h&quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;If I use the same macro name &quot;MYDLL_DECL&quot; ,for modle1's head file  I have defined  &quot;MYDLL_DECL&quot;, so &quot;DLL_DECL&quot; is equal to   '_&lt;em&gt;declspec(dllexport)'. Actually in module2 it should be equal to &quot;&lt;/em&gt;_declspec(dllimport)&quot;, Because module2 import module1.  &lt;strong&gt;But I found it worked when I just define a same macro for two module. And I also find that the OpenCV also use this methold to its library&lt;/strong&gt;&lt;/p&gt;&#xA;" OwnerUserId="936332" LastEditorUserId="936332" LastEditDate="2012-07-24T03:23:23.770" LastActivityDate="2012-07-24T03:23:23.770" Title="what does __declspec(dllexport) do , when add it before a import function" Tags="&lt;c++&gt;&lt;c&gt;&lt;dll&gt;&lt;opencv&gt;" AnswerCount="1" CommentCount="6" ClosedDate="2012-07-24T01:24:02.407" CommunityOwnedDate="2012-07-23T10:08:51.393" />
  <row Id="12339969" PostTypeId="1" AcceptedAnswerId="12340031" CreationDate="2012-09-09T14:33:50.283" Score="0" ViewCount="1467" Body="&lt;p&gt;i need to write the #import &quot;ZBarSDK.h&quot; into the #ifdef &lt;strong&gt;OBJ&lt;/strong&gt; part, because Minizip does not work if there's an import at another place!&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef __OBJC__&#xA;#import &amp;lt;UIKit/UIKit.h&amp;gt;&#xA;#import &amp;lt;Foundation/Foundation.h&amp;gt;&#xA;#import &quot;ZBarSDK.h&quot;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but then i get an error:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Undefined symbols for architecture armv7:&#xA;  &quot;_OBJC_CLASS_$_ZBarReaderViewController&quot;, referenced from:&#xA;      objc-class-ref in ViewController.o&#xA;  &quot;_ZBarReaderControllerResults&quot;, referenced from:&#xA;      -[ViewController imagePickerController:didFinishPickingMediaWithInfo:] in ViewController.o&#xA;  &quot;_OBJC_CLASS_$_CIImage&quot;, referenced from:&#xA;      objc-class-ref in ImageViewController.o&#xA;ld: symbol(s) not found for architecture armv7&#xA;clang: error: linker command failed with exit code 1 (use -v to see invocation)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;anyone can help?&#xA;myr0&lt;/p&gt;&#xA;" OwnerUserId="1053946" LastActivityDate="2014-06-12T11:25:55.203" Title="zbar #ifdef issue with minizip in iOS" Tags="&lt;ios&gt;&lt;zip&gt;&lt;conditional-compilation&gt;&lt;zbar-sdk&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="12372855" PostTypeId="1" CreationDate="2012-09-11T15:11:07.580" Score="1" ViewCount="268" Body="&lt;p&gt;I act according to &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-3123&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HADOOP-3123&lt;/a&gt;, entered command     &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;root@one: /export/hadoop-1.0.1/# ant -Dcompile.native=true -Dnonspace.os=SunOS -        Dmake.cmd=/usr/local/bin/make clean tar&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;also received as a result (this is a part)  &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; [exec] checking for an ANSI C-conforming const... yes&#xA; [exec] checking for memset... yes&#xA; [exec] checking whether strerror_r is declared... yes&#xA; [exec] checking for strerror_r... yes&#xA; [exec] checking whether strerror_r returns char *... no&#xA; [exec] configure: creating ./config.status&#xA; [exec]  /bin/sh ./config.status&#xA; [exec] config.status: creating Makefile&#xA; [exec] config.status: creating config.h&#xA; [exec] config.status: config.h is unchanged&#xA; [exec] config.status: executing depfiles commands&#xA; [exec] cd /export/hadoop-1.0.1/src/native &amp;amp;&amp;amp; /bin/sh /export/hadoop-1.0.1/src/native/config/missing --run autoheader&#xA; [exec] rm -f stamp-h1&#xA; [exec] touch /export/hadoop-1.0.1/src/native/config.h.in&#xA; [exec] cd . &amp;amp;&amp;amp; /bin/sh ./config.status config.h&#xA; [exec] /export/hadoop-1.0.1/src/native/config/missing[52]: autoheader: not found [No such file or directory]&#xA; [exec] WARNING: `autoheader' is missing on your system.  You should only need it if&#xA; [exec]          you modified `acconfig.h' or `configure.ac'.  You might want&#xA; [exec]          to install the `Autoconf' and `GNU m4' packages.  Grab them&#xA; [exec]          from any GNU archive site.&#xA; [exec] config.status: creating config.h&#xA; [exec] config.status: config.h is unchanged&#xA; [exec] /usr/local/bin/make  all-am&#xA; [exec] make[1]: Entering directory `/export/hadoop-1.0.1/build/native/SunOS-x86-32'&#xA; [exec] if /bin/sh ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I/export/hadoop-1.0.1/src/native -I.  -I/opt/jdk1.7.0_06/include -I/opt/jdk1.7.0_06/include/solaris -I/export/hadoop-1.0.1/src/native/src -Isrc/org/apache/hadoop/io/compress/zlib -Isrc/org/apache/hadoop/io/nativeio -Isrc/org/apache/hadoop/security  -g -Wall -fPIC -O2 -m32 -g -O2 -MT ZlibCompressor.lo -MD -MP -MF &quot;.deps/ZlibCompressor.Tpo&quot; -c -o ZlibCompressor.lo `test -f 'src/org/apache/hadoop/io/compress/zlib/ZlibCompressor.c' || echo '/export/hadoop-1.0.1/src/native/'`src/org/apache/hadoop/io/compress/zlib/ZlibCompressor.c; \&#xA; [exec] then mv -f &quot;.deps/ZlibCompressor.Tpo&quot; &quot;.deps/ZlibCompressor.Plo&quot;; else rm -f &quot;.deps/ZlibCompressor.Tpo&quot;; exit 1; fi&#xA; [exec] mkdir .libs&#xA; [exec]  gcc -DHAVE_CONFIG_H -I. -I/export/hadoop-1.0.1/src/native -I. -I/opt/jdk1.7.0_06/include -I/opt/jdk1.7.0_06/include/solaris -I/export/hadoop-1.0.1/src/native/src -Isrc/org/apache/hadoop/io/compress/zlib -Isrc/org/apache/hadoop/io/nativeio -Isrc/org/apache/hadoop/security -g -Wall -fPIC -O2 -m32 -g -O2 -MT ZlibCompressor.lo -MD -MP -MF .deps/ZlibCompressor.Tpo -c /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/io/compress/zlib/ZlibCompressor.c  -fPIC -DPIC -o .libs/ZlibCompressor.o&#xA; [exec]  gcc -DHAVE_CONFIG_H -I. -I/export/hadoop-1.0.1/src/native -I. -I/opt/jdk1.7.0_06/include -I/opt/jdk1.7.0_06/include/solaris -I/export/hadoop-1.0.1/src/native/src -Isrc/org/apache/hadoop/io/compress/zlib -Isrc/org/apache/hadoop/io/nativeio -Isrc/org/apache/hadoop/security -g -Wall -fPIC -O2 -m32 -g -O2 -MT ZlibCompressor.lo -MD -MP -MF .deps/ZlibCompressor.Tpo -c /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/io/compress/zlib/ZlibCompressor.c -o ZlibCompressor.o &amp;gt;/dev/null 2&amp;gt;&amp;amp;1&#xA; [exec] if /bin/sh ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I/export/hadoop-1.0.1/src/native -I.  -I/opt/jdk1.7.0_06/include -I/opt/jdk1.7.0_06/include/solaris -I/export/hadoop-1.0.1/src/native/src -Isrc/org/apache/hadoop/io/compress/zlib -Isrc/org/apache/hadoop/io/nativeio -Isrc/org/apache/hadoop/security  -g -Wall -fPIC -O2 -m32 -g -O2 -MT ZlibDecompressor.lo -MD -MP -MF &quot;.deps/ZlibDecompressor.Tpo&quot; -c -o ZlibDecompressor.lo `test -f 'src/org/apache/hadoop/io/compress/zlib/ZlibDecompressor.c' || echo '/export/hadoop-1.0.1/src/native/'`src/org/apache/hadoop/io/compress/zlib/ZlibDecompressor.c; \&#xA; [exec] then mv -f &quot;.deps/ZlibDecompressor.Tpo&quot; &quot;.deps/ZlibDecompressor.Plo&quot;; else rm -f &quot;.deps/ZlibDecompressor.Tpo&quot;; exit 1; fi&#xA; [exec]  gcc -DHAVE_CONFIG_H -I. -I/export/hadoop-1.0.1/src/native -I. -I/opt/jdk1.7.0_06/include -I/opt/jdk1.7.0_06/include/solaris -I/export/hadoop-1.0.1/src/native/src -Isrc/org/apache/hadoop/io/compress/zlib -Isrc/org/apache/hadoop/io/nativeio -Isrc/org/apache/hadoop/security -g -Wall -fPIC -O2 -m32 -g -O2 -MT ZlibDecompressor.lo -MD -MP -MF .deps/ZlibDecompressor.Tpo -c /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/io/compress/zlib/ZlibDecompressor.c  -fPIC -DPIC -o .libs/ZlibDecompressor.o&#xA; [exec]  gcc -DHAVE_CONFIG_H -I. -I/export/hadoop-1.0.1/src/native -I. -I/opt/jdk1.7.0_06/include -I/opt/jdk1.7.0_06/include/solaris -I/export/hadoop-1.0.1/src/native/src -Isrc/org/apache/hadoop/io/compress/zlib -Isrc/org/apache/hadoop/io/nativeio -Isrc/org/apache/hadoop/security -g -Wall -fPIC -O2 -m32 -g -O2 -MT ZlibDecompressor.lo -MD -MP -MF .deps/ZlibDecompressor.Tpo -c /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/io/compress/zlib/ZlibDecompressor.c -o ZlibDecompressor.o &amp;gt;/dev/null 2&amp;gt;&amp;amp;1&#xA; [exec] if /bin/sh ./libtool --tag=CC --mode=compile gcc -DHAVE_CONFIG_H -I. -I/export/hadoop-1.0.1/src/native -I.  -I/opt/jdk1.7.0_06/include -I/opt/jdk1.7.0_06/include/solaris -I/export/hadoop-1.0.1/src/native/src -Isrc/org/apache/hadoop/io/compress/zlib -Isrc/org/apache/hadoop/io/nativeio -Isrc/org/apache/hadoop/security  -g -Wall -fPIC -O2 -m32 -g -O2 -MT getGroup.lo -MD -MP -MF &quot;.deps/getGroup.Tpo&quot; -c -o getGroup.lo `test -f 'src/org/apache/hadoop/security/getGroup.c' || echo '/export/hadoop-1.0.1/src/native/'`src/org/apache/hadoop/security/getGroup.c; \&#xA; [exec] then mv -f &quot;.deps/getGroup.Tpo&quot; &quot;.deps/getGroup.Plo&quot;; else rm -f &quot;.deps/getGroup.Tpo&quot;; exit 1; fi&#xA; [exec]  gcc -DHAVE_CONFIG_H -I. -I/export/hadoop-1.0.1/src/native -I. -I/opt/jdk1.7.0_06/include -I/opt/jdk1.7.0_06/include/solaris -I/export/hadoop-1.0.1/src/native/src -Isrc/org/apache/hadoop/io/compress/zlib -Isrc/org/apache/hadoop/io/nativeio -Isrc/org/apache/hadoop/security -g -Wall -fPIC -O2 -m32 -g -O2 -MT getGroup.lo -MD -MP -MF .deps/getGroup.Tpo -c /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/security/getGroup.c  -fPIC -DPIC -o .libs/getGroup.o&#xA; [exec] make[1]: Leaving directory `/export/hadoop-1.0.1/build/native/SunOS-x86-32'&#xA; [exec] /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/security/getGroup.c: In function 'getGroupIDList':&#xA; [exec] /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/security/getGroup.c:42: warning: implicit declaration of function 'getPW'&#xA; [exec] /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/security/getGroup.c:52: warning: implicit declaration of function 'getgrouplist'&#xA; [exec] /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/security/getGroup.c: In function 'getGroupDetails':&#xA; [exec] /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/security/getGroup.c:90: error: too many arguments to function 'getgrgid_r'&#xA; [exec] /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/security/getGroup.c:90: warning: assignment makes integer from pointer without a cast&#xA; [exec] /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/security/getGroup.c: In function 'getPW':&#xA; [exec] /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/security/getGroup.c:132: error: too many arguments to function 'getpwnam_r'&#xA; [exec] /export/hadoop-1.0.1/src/native/src/org/apache/hadoop/security/getGroup.c:132: warning: assignment makes integer from pointer without a cast&#xA; [exec] make[1]: *** [getGroup.lo] Error 1&#xA; [exec] make: *** [all] Error 2&#xA;&#xA; BUILD FAILED&#xA; /export/hadoop-1.0.1/build.xml:653: exec returned: 2&#xA;&#xA; Total time: 58 seconds  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I provide the text of heading files in which these functions meet&lt;/p&gt;&#xA;&#xA;&lt;p&gt;/usr/include/grp.h  &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/*&#xA;* CDDL HEADER START&#xA;*&#xA;* The contents of this file are subject to the terms of the&#xA;* Common Development and Distribution License, Version 1.0 only&#xA;* (the &quot;License&quot;).  You may not use this file except in compliance&#xA;* with the License.&#xA;*&#xA;* You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE&#xA;* or http://www.opensolaris.org/os/licensing.&#xA;* See the License for the specific language governing permissions&#xA;* and limitations under the License.&#xA;*&#xA;* When distributing Covered Code, include this CDDL HEADER in each&#xA;* file and include the License file at usr/src/OPENSOLARIS.LICENSE.&#xA;* If applicable, add the following below this CDDL HEADER, with the&#xA;* fields enclosed by brackets &quot;[]&quot; replaced with your own identifying&#xA;* information: Portions Copyright [yyyy] [name of copyright owner]&#xA;*&#xA;* CDDL HEADER END&#xA;*/&#xA;/*  Copyright (c) 1988 AT&amp;amp;T */&#xA;/*    All Rights Reserved   */&#xA;&#xA;&#xA; /*&#xA;  * Copyright 2004 Sun Microsystems, Inc.  All rights reserved.&#xA;  * Use is subject to license terms.&#xA; */&#xA;&#xA;#ifndef _GRP_H&#xA;#define _GRP_H&#xA;&#xA;#pragma ident   &quot;%Z%%M% %I% %E% SMI&quot;    /* SVr4.0 1.3.3.1 */&#xA;&#xA;#include &amp;lt;sys/feature_tests.h&amp;gt;&#xA;&#xA;#include &amp;lt;sys/types.h&amp;gt;&#xA;&#xA;#if defined(__EXTENSIONS__) || !defined(__XOPEN_OR_POSIX)&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#endif&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;struct  group { /* see getgrent(3C) */&#xA;char    *gr_name;&#xA;char    *gr_passwd;&#xA;gid_t   gr_gid;&#xA;char    **gr_mem;&#xA;};&#xA;&#xA;#if defined(__STDC__)&#xA;&#xA;extern struct group *getgrgid(gid_t);       /* MT-unsafe */&#xA;extern struct group *getgrnam(const char *);    /* MT-unsafe */&#xA;&#xA;#if defined(__EXTENSIONS__) || !defined(__XOPEN_OR_POSIX)&#xA;extern struct group *getgrent_r(struct group *, char *, int);&#xA;extern struct group *fgetgrent_r(FILE *, struct group *, char *, int);&#xA;&#xA;&#xA;extern struct group *fgetgrent(FILE *);     /* MT-unsafe */&#xA;extern int initgroups(const char *, gid_t);&#xA;#endif /* defined(__EXTENSIONS__) || !defined(__XOPEN_OR_POSIX) */&#xA;&#xA;#if defined(__EXTENSIONS__) || !defined(__XOPEN_OR_POSIX) || defined(_XPG4_2)&#xA;extern void endgrent(void);&#xA;extern void setgrent(void);&#xA;extern struct group *getgrent(void);        /* MT-unsafe */&#xA;#endif /* defined(__EXTENSIONS__) || !defined(__XOPEN_OR_POSIX)... */&#xA;&#xA;#else&#xA;&#xA;extern struct group *getgrgid();        /* MT-unsafe */&#xA;extern struct group *getgrnam();        /* MT-unsafe */&#xA;&#xA;#if defined(__EXTENSIONS__) || !defined(__XOPEN_OR_POSIX)&#xA;extern struct group *getgrent_r();&#xA;extern struct group *fgetgrent_r();&#xA;&#xA;extern struct group *fgetgrent();       /* MT-unsafe */&#xA;extern int initgroups();&#xA;#endif /* defined(__EXTENSIONS__) || !defined(__XOPEN_OR_POSIX) */&#xA;&#xA;#if defined(__EXTENSIONS__) || !defined(__XOPEN_OR_POSIX) || defined(_XPG4_2)&#xA;extern void endgrent();&#xA;extern void setgrent();&#xA;extern struct group *getgrent();        /* MT-unsafe */&#xA;#endif /* defined(__EXTENSIONS__) || !defined(__XOPEN_OR_POSIX)... */&#xA;&#xA;#endif  /* __STDC__ */&#xA;&#xA;&#xA;/*&#xA; * getgrgid_r() &amp;amp; getgrnam_r() prototypes are defined here.&#xA;*/&#xA;&#xA;/*&#xA; * Previous releases of Solaris, starting at 2.3, provided definitions of&#xA; * various functions as specified in POSIX.1c, Draft 6.  For some of these&#xA; * functions, the final POSIX 1003.1c standard had a different number of&#xA; * arguments and return values.&#xA; *&#xA; * The following segment of this header provides support for the standard&#xA; * interfaces while supporting applications written under earlier&#xA; * releases.  The application defines appropriate values of the feature&#xA; * test macros _POSIX_C_SOURCE and _POSIX_PTHREAD_SEMANTICS to indicate&#xA; * whether it was written to expect the Draft 6 or standard versions of&#xA; * these interfaces, before including this header.  This header then&#xA; * provides a mapping from the source version of the interface to an&#xA; * appropriate binary interface.  Such mappings permit an application&#xA; * to be built from libraries and objects which have mixed expectations&#xA; * of the definitions of these functions.&#xA; *&#xA; * For applications using the Draft 6 definitions, the binary symbol is the&#xA; * same as the source symbol, and no explicit mapping is needed.  For the&#xA; * standard interface, the function func() is mapped to the binary symbol&#xA; * _posix_func().  The preferred mechanism for the remapping is a compiler&#xA; * #pragma.  If the compiler does not provide such a #pragma, the header file&#xA; * defines a static function func() which calls the _posix_func() version;&#xA; * this has to be done instead of #define since POSIX specifies that an&#xA; * application can #undef the symbol and still be bound to the correct&#xA; * implementation.  Unfortunately, the statics confuse lint so we fallback to&#xA; * #define in that case.&#xA; *&#xA; * NOTE: Support for the Draft 6 definitions is provided for compatibility&#xA; * only.  New applications/libraries should use the standard definitions.&#xA; */&#xA;&#xA; #if    defined(__EXTENSIONS__) || !defined(__XOPEN_OR_POSIX) || \&#xA;(_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || defined(_POSIX_PTHREAD_SEMANTICS)&#xA;&#xA; #if    defined(__STDC__)&#xA;&#xA; #if    (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || defined(_POSIX_PTHREAD_SEMANTICS)&#xA;&#xA; #ifdef __PRAGMA_REDEFINE_EXTNAME&#xA; #pragma redefine_extname getgrgid_r __posix_getgrgid_r&#xA; #pragma redefine_extname getgrnam_r __posix_getgrnam_r&#xA; extern int getgrgid_r(gid_t, struct group *, char *, int, struct group **);&#xA; extern int getgrnam_r(const char *, struct group *, char *, int,&#xA;                        struct group **);&#xA; #else  /* __PRAGMA_REDEFINE_EXTNAME */&#xA;&#xA; extern int __posix_getgrgid_r(gid_t, struct group *, char *, size_t,&#xA;  struct group **);&#xA; extern int __posix_getgrnam_r(const char *, struct group *, char *, size_t,&#xA;  struct group **);&#xA;&#xA; #ifdef __lint&#xA;&#xA; #define    getgrgid_r __posix_getgrgid_r&#xA; #define    getgrnam_r __posix_getgrnam_r&#xA;&#xA; #else  /* !__lint */&#xA;&#xA; static int&#xA; getgrgid_r(gid_t __gid, struct group *__grp, char *__buf, int __len,&#xA;    struct group **__res)&#xA; {&#xA;  return (__posix_getgrgid_r(__gid, __grp, __buf, __len, __res));&#xA; }&#xA; static int&#xA; getgrnam_r(const char *__cb, struct group *__grp, char *__buf, int __len,&#xA;    struct group **__res)&#xA; {&#xA;  return (__posix_getgrnam_r(__cb, __grp, __buf, __len, __res));&#xA; }&#xA;&#xA; #endif /* !__lint */&#xA; #endif /* __PRAGMA_REDEFINE_EXTNAME */&#xA;&#xA; #else  /* (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || ... */&#xA;&#xA; extern struct group *getgrgid_r(gid_t, struct group *, char *, int);&#xA; extern struct group *getgrnam_r(const char *, struct group *, char *, int);&#xA;&#xA; #endif  /* (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || ... */&#xA;&#xA; #else  /* __STDC__ */&#xA;&#xA; #if    (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || defined(_POSIX_PTHREAD_SEMANTICS)&#xA;&#xA; #ifdef __PRAGMA_REDEFINE_EXTNAME&#xA; #pragma redefine_extname getgrgid_r __posix_getgrgid_r&#xA; #pragma redefine_extname getgrnam_r __posix_getgrnam_r&#xA; extern int getgrgid_r();&#xA; extern int getgrnam_r();&#xA; #else  /* __PRAGMA_REDEFINE_EXTNAME */&#xA;&#xA; extern int __posix_getgrgid_r();&#xA; extern int __posix_getgrnam_r();&#xA;&#xA; #ifdef __lint&#xA;&#xA; #define    getgrgid_r __posix_getgrgid_r&#xA; #define    getgrnam_r __posix_getgrnam_r&#xA;&#xA; #else  /* !__lint */&#xA;&#xA; static int&#xA; getgrgid_r(__gid, __grp, __buf, __len, __res)&#xA;    gid_t __gid;&#xA;    struct group *__grp;&#xA;    char *__buf;&#xA;    int __len;&#xA;    struct group **__res;&#xA;{&#xA;    return (__posix_getgrgid_r(__gid, __grp, __buf, __len, __res));&#xA;}&#xA;static int&#xA;getgrnam_r(__cb, __grp, __buf, __len, __res)&#xA;    char *__cb;&#xA;    struct group *__grp;&#xA;    char *__buf;&#xA;    int __len;&#xA;    struct group **__res;&#xA;{&#xA;    return (__posix_getgrnam_r(__cb, __grp, __buf, __len, __res));&#xA;}&#xA;&#xA;#endif /* !__lint */&#xA;#endif /* __PRAGMA_REDEFINE_EXTNAME */&#xA;&#xA;#else  /* (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || ... */&#xA;&#xA;extern struct group *getgrgid_r();&#xA;extern struct group *getgrnam_r();&#xA;&#xA;#endif /* (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || ... */&#xA;&#xA;#endif /* __STDC__ */&#xA;&#xA;#endif /* defined(__EXTENSIONS__) || !defined(__XOPEN_OR_POSIX)... */&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif  /* _GRP_H */  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;/usr/include/pwd.h  &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/*&#xA; * CDDL HEADER START&#xA; *&#xA; * The contents of this file are subject to the terms of the&#xA; * Common Development and Distribution License, Version 1.0 only&#xA; * (the &quot;License&quot;).  You may not use this file except in compliance&#xA; * with the License.&#xA; *&#xA; * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE&#xA; * or http://www.opensolaris.org/os/licensing.&#xA; * See the License for the specific language governing permissions&#xA; * and limitations under the License.&#xA; *&#xA; * When distributing Covered Code, include this CDDL HEADER in each&#xA; * file and include the License file at usr/src/OPENSOLARIS.LICENSE.&#xA; * If applicable, add the following below this CDDL HEADER, with the&#xA; * fields enclosed by brackets &quot;[]&quot; replaced with your own identifying&#xA; * information: Portions Copyright [yyyy] [name of copyright owner]&#xA; *&#xA; * CDDL HEADER END&#xA;*/&#xA;/*  Copyright (c) 1988 AT&amp;amp;T */&#xA;/*    All Rights Reserved   */&#xA;&#xA;&#xA;/*&#xA; * Copyright 2004 Sun Microsystems, Inc.  All rights reserved.&#xA; * Use is subject to license terms.&#xA;*/&#xA;&#xA;#ifndef _PWD_H&#xA;#define _PWD_H&#xA;&#xA;#pragma ident   &quot;%Z%%M% %I% %E% SMI&quot;    /* SVr4.0 1.3.1.9 */&#xA;&#xA;#include &amp;lt;sys/feature_tests.h&amp;gt;&#xA;&#xA;#include &amp;lt;sys/types.h&amp;gt;&#xA;&#xA;#if !defined(__XOPEN_OR_POSIX) || defined(__EXTENSIONS__)&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#endif&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;struct passwd {&#xA;    char    *pw_name;&#xA;    char    *pw_passwd;&#xA;    uid_t   pw_uid;&#xA;    gid_t   pw_gid;&#xA;    char    *pw_age;&#xA;    char    *pw_comment;&#xA;    char    *pw_gecos;&#xA;    char    *pw_dir;&#xA;    char    *pw_shell;&#xA;};&#xA;&#xA;#if !defined(__XOPEN_OR_POSIX) || defined(__EXTENSIONS__)&#xA;struct comment {&#xA;    char    *c_dept;&#xA;    char    *c_name;&#xA;    char    *c_acct;&#xA;    char    *c_bin;&#xA;};&#xA;#endif /* !defined(__XOPEN_OR_POSIX) || defined(__EXTENSIONS__) */&#xA;&#xA;#if defined(__STDC__)&#xA;&#xA;extern struct passwd *getpwuid(uid_t);      /* MT-unsafe */&#xA;extern struct passwd *getpwnam(const char *);   /* MT-unsafe */&#xA;&#xA;#if !defined(__XOPEN_OR_POSIX) || defined(__EXTENSIONS__)&#xA;extern struct passwd *getpwent_r(struct passwd *, char *, int);&#xA;extern struct passwd *fgetpwent_r(FILE *, struct passwd *, char *, int);&#xA;extern struct passwd *fgetpwent(FILE *);    /* MT-unsafe */&#xA;extern int putpwent(const struct passwd *, FILE *);&#xA;#endif /* !defined(__XOPEN_OR_POSIX) || defined(__EXTENSIONS__) */&#xA;&#xA;#if !defined(__XOPEN_OR_POSIX) || defined(_XPG4_2) || \&#xA;    defined(__EXTENSIONS__)&#xA;extern void endpwent(void);&#xA;extern struct passwd *getpwent(void);       /* MT-unsafe */&#xA;extern void setpwent(void);&#xA;#endif /* !defined(__XOPEN_OR_POSIX) || defined(_XPG4_2) ... */&#xA;&#xA;#else  /* (__STDC__) */&#xA;&#xA;extern struct passwd *getpwuid();       /* MT-unsafe */&#xA;extern struct passwd *getpwnam();       /* MT-unsafe */&#xA;&#xA;#if !defined(__XOPEN_OR_POSIX) || defined(__EXTENSIONS__)&#xA;extern struct passwd *getpwent_r();&#xA;extern struct passwd *fgetpwent_r();&#xA;&#xA;extern struct passwd *fgetpwent();      /* MT-unsafe */&#xA;extern int putpwent();&#xA;#endif /* !defined(__XOPEN_OR_POSIX) || defined(__EXTENSIONS__) */&#xA;&#xA;#if !defined(__XOPEN_OR_POSIX) || defined(_XPG4_2) || \&#xA;    defined(__EXTENSIONS__)&#xA;extern void endpwent();&#xA;extern struct passwd *getpwent();       /* MT-unsafe */&#xA;extern void setpwent();&#xA;#endif /* !defined(__XOPEN_OR_POSIX) || defined(_XPG4_2) ... */&#xA;&#xA;#endif /* (__STDC__) */&#xA;&#xA;/*&#xA; * getpwuid_r() &amp;amp; getpwnam_r() prototypes are defined here.&#xA;*/&#xA;&#xA;/*&#xA; * Previous releases of Solaris, starting at 2.3, provided definitions of&#xA; * various functions as specified in POSIX.1c, Draft 6.  For some of these&#xA; * functions, the final POSIX 1003.1c standard had a different number of&#xA; * arguments and return values.&#xA; *&#xA; * The following segment of this header provides support for the standard&#xA; * interfaces while supporting applications written under earlier&#xA; * releases.  The application defines appropriate values of the feature&#xA; * test macros _POSIX_C_SOURCE and _POSIX_PTHREAD_SEMANTICS to indicate&#xA; * whether it was written to expect the Draft 6 or standard versions of&#xA; * these interfaces, before including this header.  This header then&#xA; * provides a mapping from the source version of the interface to an&#xA; * appropriate binary interface.  Such mappings permit an application&#xA; * to be built from libraries and objects which have mixed expectations&#xA; * of the definitions of these functions.&#xA; *&#xA; * For applications using the Draft 6 definitions, the binary symbol is the&#xA; * same as the source symbol, and no explicit mapping is needed.  For the&#xA; * standard interface, the function func() is mapped to the binary symbol&#xA; * _posix_func().  The preferred mechanism for the remapping is a compiler&#xA; * #pragma.  If the compiler does not provide such a #pragma, the header file&#xA; * defines a static function func() which calls the _posix_func() version;&#xA; * this has to be done instead of #define since POSIX specifies that an&#xA; * application can #undef the symbol and still be bound to the correct&#xA; * implementation.  Unfortunately, the statics confuse lint so we fallback to&#xA; * #define in that case.&#xA; *&#xA; * NOTE: Support for the Draft 6 definitions is provided for compatibility&#xA; * only.  New applications/libraries should use the standard definitions.&#xA; */&#xA;&#xA;#if !defined(__XOPEN_OR_POSIX) || (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || \&#xA;    defined(_POSIX_PTHREAD_SEMANTICS) || defined(__EXTENSIONS__)&#xA;&#xA;#if defined(__STDC__)&#xA;&#xA;#if (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || defined(_POSIX_PTHREAD_SEMANTICS)&#xA;&#xA;#ifdef __PRAGMA_REDEFINE_EXTNAME&#xA;#pragma redefine_extname getpwuid_r __posix_getpwuid_r&#xA;#pragma redefine_extname getpwnam_r __posix_getpwnam_r&#xA;extern int getpwuid_r(uid_t, struct passwd *, char *, int, struct passwd **);&#xA;extern int getpwnam_r(const char *, struct passwd *, char *,&#xA;                        int, struct passwd **);&#xA;#else  /* __PRAGMA_REDEFINE_EXTNAME */&#xA;&#xA;extern int __posix_getpwuid_r(uid_t, struct passwd *, char *, size_t,&#xA;    struct passwd **);&#xA;extern int __posix_getpwnam_r(const char *, struct passwd *, char *,&#xA;    size_t, struct passwd **);&#xA;&#xA;#ifdef __lint&#xA;&#xA;#define getpwuid_r __posix_getpwuid_r&#xA;#define getpwnam_r __posix_getpwnam_r&#xA;&#xA;#else   /* !__lint */&#xA;&#xA;static int&#xA;getpwuid_r(uid_t __uid, struct passwd *__pwd, char *__buf, int __len,&#xA;    struct passwd **__res)&#xA;{&#xA;    return (__posix_getpwuid_r(__uid, __pwd, __buf, __len, __res));&#xA;}&#xA;static int&#xA;getpwnam_r(const char *__cb, struct passwd *__pwd, char *__buf, int __len,&#xA;    struct passwd **__res)&#xA;{&#xA;     return (__posix_getpwnam_r(__cb, __pwd, __buf, __len, __res));&#xA;}&#xA;&#xA;#endif /* !__lint */&#xA;#endif /* __PRAGMA_REDEFINE_EXTNAME */&#xA;&#xA;#else  /* (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || ... */&#xA;&#xA;extern struct passwd *getpwuid_r(uid_t, struct passwd *, char *, int);&#xA;extern struct passwd *getpwnam_r(const char *, struct passwd *, char *, int);&#xA;&#xA;#endif  /* (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || ... */&#xA;&#xA;#else  /* __STDC__ */&#xA;&#xA;#if (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || defined(_POSIX_PTHREAD_SEMANTICS)&#xA;&#xA;#ifdef __PRAGMA_REDEFINE_EXTNAME&#xA;#pragma redefine_extname getpwuid_r __posix_getpwuid_r&#xA;#pragma redefine_extname getpwnam_r __posix_getpwnam_r&#xA;extern int getpwuid_r();&#xA;extern int getpwnam_r();&#xA;#else  /* __PRAGMA_REDEFINE_EXTNAME */&#xA;&#xA;extern int __posix_getpwuid_r();&#xA;extern int __posix_getpwnam_r();&#xA;&#xA;#ifdef  __lint&#xA;&#xA;#define getpwuid_r __posix_getpwuid_r&#xA;#define getpwnam_r __posix_getpwnam_r&#xA;&#xA;#else   /* !__lint */&#xA;&#xA;static int&#xA;getpwuid_r(__uid, __pwd, __buf, __len, __res)&#xA;    uid_t __uid;&#xA;    struct passwd *__pwd;&#xA;    char *__buf;&#xA;    int __len;&#xA;    struct passwd **__res;&#xA;{&#xA;    return (__posix_getpwuid_r(__uid, __pwd, __buf, __len, __res));&#xA;}&#xA;static int&#xA;getpwnam_r(__cb, __pwd, __buf, __len, __res)&#xA;    char *__cb;&#xA;    struct passwd *__pwd;&#xA;    char *__buf;&#xA;    int __len;&#xA;    struct passwd **__res;&#xA;{&#xA;    return (__posix_getpwnam_r(__cb, __pwd, __buf, __len, __res));&#xA;}&#xA;&#xA;#endif /* !__lint */&#xA;#endif /* __PRAGMA_REDEFINE_EXTNAME */&#xA;&#xA;#else  /* (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || ... */&#xA;&#xA;extern struct passwd *getpwuid_r();&#xA;extern struct passwd *getpwnam_r();&#xA;&#xA;#endif /* (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L) || ... */&#xA;&#xA;#endif /* __STDC__ */&#xA;&#xA;#endif /* !defined(__XOPEN_OR_POSIX) || (_POSIX_C_SOURCE - 0 &amp;gt;= 199506L)... */&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif /* _PWD_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;What problem with functions getgrouplist, getgrgid_r, getpwnam_r and how it to remove?&lt;/p&gt;&#xA;" OwnerUserId="1635206" LastEditorUserId="1635206" LastEditDate="2012-09-11T16:21:20.800" LastActivityDate="2012-09-11T16:21:20.800" Title="Error in case of assembly native hadoop library" Tags="&lt;java&gt;&lt;c++&gt;&lt;hadoop&gt;&lt;mapreduce&gt;" AnswerCount="0" CommentCount="3" />
  <row Id="12617667" PostTypeId="1" AcceptedAnswerId="12617843" CreationDate="2012-09-27T08:59:22.167" Score="2" ViewCount="241" Body="&lt;p&gt;I've been asked by a co-worker to come up with a regular expression (POSIX syntax) for finding calls to &lt;code&gt;printf(...);&lt;/code&gt; -- in a c-code file -- which aren't in a &lt;code&gt;#ifdef&lt;/code&gt; ... &lt;code&gt;#endif&lt;/code&gt; scope.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;However, seeing as I am only just learning about Regexes at Uni, I'm not completely confident in it.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The scenario would look something like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;possibly some code&#xA;printf(some_parameters);  // This should match&#xA;possibly more code&#xA;&#xA;#ifdef DEBUG&#xA;possibly some code&#xA;printf(some_parameters);  // This shouldn't match&#xA;possibly more code&#xA;#endif&#xA;&#xA;possibly some code&#xA;printf(some_parameters);  // This should also match&#xA;possibly more code&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Note that a c-file may not contain a #ifdef/#endif statement at all, in which case all calls to &lt;code&gt;printf();&lt;/code&gt; should match.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What I've tried so far is this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;(?&amp;lt;!(#ifdef [A-Å0-9]+)).*printf\(.*\);.*(?!(#endif))&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;...along with playing around with the position (and even inclusion/exclusion) of .*&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any help or hints appreciated.&lt;/p&gt;&#xA;" OwnerUserId="1602985" LastEditorUserId="648658" LastEditDate="2012-09-27T09:20:32.133" LastActivityDate="2012-09-27T09:21:46.343" Title="Finding printf() calls outside #ifdef statements using Regex (POSIX)" Tags="&lt;c&gt;&lt;regex&gt;&lt;posix&gt;&lt;c-preprocessor&gt;" AnswerCount="2" CommentCount="3" />
  <row Id="12633345" PostTypeId="1" CreationDate="2012-09-28T03:53:24.937" Score="2" ViewCount="1550" Body="&lt;p&gt;So I am running making a defconfig before building the kernel. I am trying to use a &lt;code&gt;#ifdef&lt;/code&gt; in some kernel code such that if the user chose making the first defconfig it would consider check #ifdef (value defined in defconfig) vs calling a second defconfig. Is this possible?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Edit:&lt;/strong&gt; So my defconfigs are in subdirectories. I want to either call make &lt;code&gt;first_defconfig&lt;/code&gt; or &lt;code&gt;second_defconfig&lt;/code&gt;. Then I run &lt;code&gt;make&lt;/code&gt;, based on that I would like it to be the case where if &lt;code&gt;first_defconfig&lt;/code&gt; is called then &lt;code&gt;-DVARIABLEX&lt;/code&gt; which should apply to the source tree not just subdirectories.&lt;/p&gt;&#xA;" OwnerUserId="1686143" LastEditorDisplayName="user647772" LastEditDate="2012-09-28T09:09:30.457" LastActivityDate="2012-09-28T09:09:30.457" Title="How to include c #ifdef variables in defconfig" Tags="&lt;c&gt;&lt;linux-kernel&gt;&lt;makefile&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="12720877" PostTypeId="1" CreationDate="2012-10-04T05:36:42.950" Score="0" ViewCount="129" Body="&lt;p&gt;I have a application running on both Linux &amp;amp; Mac.&#xA;Now, for this application I need to copy some libraries from different path.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For Linux,&#xA;cp ../gccRelease/libMsSipRelease.a ../../VoipAppLinux/lib/&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For Mac,&#xA;cp ../DerivedData/MsSipLib/Build/Products/Debug/libMsSipLib.dylib ../../VoipAppLinux/lib/&lt;/p&gt;&#xA;&#xA;&lt;p&gt;As you can see both paths are different.&#xA;Now, my question is can I use #ifdef Linux or #ifdef &lt;strong&gt;APPLE&lt;/strong&gt; in make file. If can what is the syntax please?&#xA;If #ifdef is not possible to use in makefile than how can I solve this problem.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thank you.&lt;/p&gt;&#xA;" OwnerUserId="1677240" LastActivityDate="2012-10-04T12:47:33.473" Title="Different Platform Support using Makefile" Tags="&lt;makefile&gt;&lt;preprocessor&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="12760828" PostTypeId="1" AcceptedAnswerId="12760960" CreationDate="2012-10-06T14:50:16.827" Score="1" ViewCount="2448" Body="&lt;p&gt;I want to to use boost &lt;code&gt;auto_cpu_timer&lt;/code&gt; to display the time my complete code needs to run. Additionally i want to see the progress of my loops using &lt;code&gt;progress_display&lt;/code&gt;. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;It seems there is a namespace confilict as Boost has two timer classes, where &lt;code&gt;progress_display&lt;/code&gt; is from the old, now deprecated library.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&quot;http://www.boost.org/doc/libs/1_51_0/libs/timer/doc/index.html&quot; rel=&quot;nofollow&quot;&gt;http://www.boost.org/doc/libs/1_51_0/libs/timer/doc/index.html&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Still, is there a way to achieve this? The following example shows, what i'm trying to do. Using either &lt;code&gt;AUTO&lt;/code&gt; or &lt;code&gt;PROG&lt;/code&gt; works fine, but both together result in error messages.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Main:&lt;/strong&gt; compiled with &lt;code&gt;g++ -lboost_timer main.cc -o time&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define AUTO&#xA;#define PROG&#xA;&#xA;#ifdef  PROG&#xA;#include &amp;lt;boost/progress.hpp&amp;gt;&#xA;#endif     //----  PROG  -----&#xA;&#xA;#ifdef  AUTO&#xA;#include &amp;lt;boost/timer/timer.hpp&amp;gt;&#xA;#endif     //----  AUTO  -----&#xA;&#xA;#include &amp;lt;cmath&amp;gt;&#xA;&#xA;int main()&#xA;{&#xA;#ifdef  AUTO&#xA;    boost::timer::auto_cpu_timer t;&#xA;#endif     //----  AUTO  -----&#xA;&#xA;    long loops = 100000000;&#xA;&#xA;#ifdef  PROG&#xA;    boost::progress_display pd( loops );&#xA;#endif     //----  PROG  -----&#xA;&#xA;    //long loop to burn some time&#xA;    for (long i = 0; i &amp;lt; loops; ++i)&#xA;    {&#xA;        std::sqrt(123.456L);&#xA;#ifdef  PROG&#xA;        ++pd;&#xA;#endif     //----  PROG  -----&#xA;    }&#xA;&#xA;    return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Error log:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/usr/include/boost/timer/timer.hpp:38:1: error: ‘namespace boost::timer { }’ redeclared as different kind of symbol&#xA;/usr/include/boost/timer.hpp:45:1: error: previous declaration of ‘class boost::timer’&#xA;/usr/include/boost/timer/timer.hpp: In member function ‘std::string boost::timer::cpu_timer::format(short int, const std::string&amp;amp;) const’:&#xA;/usr/include/boost/timer/timer.hpp:74:34: error: ‘format’ is not a member of ‘boost::timer’&#xA;/usr/include/boost/timer/timer.hpp: In member function ‘std::string boost::timer::cpu_timer::format(short int) const’:&#xA;/usr/include/boost/timer/timer.hpp:76:34: error: ‘format’ is not a member of ‘boost::timer’&#xA;main.cc: In function ‘int main()’:&#xA;main.cc:17:2: error: ‘auto_cpu_timer’ is not a member of ‘boost::timer’&#xA;main.cc:17:31: error: expected ‘;’ before ‘t’&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1627336" LastActivityDate="2012-10-06T15:09:32.243" Title="How to use boost auto_cpu_timer and progress_display at the same time?" Tags="&lt;c++&gt;&lt;boost&gt;&lt;timer&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="12768306" PostTypeId="1" AcceptedAnswerId="12771675" CreationDate="2012-10-07T11:13:24.303" Score="6" ViewCount="5183" Body="&lt;p&gt;My toolchain is a recent version of arm-gcc.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have a piece of code in an assembly file which must be conditionally included/assembled.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;.ifdef MACRO_FROM_CMDLINE&#xA; Assembly instr1&#xA; Assembly instr2&#xA;.endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Encapsulated code is a recent addition.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have tried both:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;gcc -x assembler-with-cpp --defsym MACRO_FROM_CMDLINE=1 &amp;lt;along with other necessary options&amp;gt; &#xA;&#xA;gcc -x assembler-with-cpp -D MACRO_FROM_CMDLINE=1 &amp;lt;along with other necessary options&amp;gt;   &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The &lt;code&gt;-D&lt;/code&gt; results in &quot;Invalid identifier for .ifdef &quot; and &quot;.endif without .if&quot; errors.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The &lt;code&gt;--defsym&lt;/code&gt; results in &quot;MACRO_FROM_CMDLINE=1 : No such file or directory&quot;, &quot;unrecognized option --defsym&quot; errors.&lt;/p&gt;&#xA;" OwnerUserId="1163200" LastEditorUserId="895245" LastEditDate="2015-06-20T20:24:28.157" LastActivityDate="2015-06-20T20:24:28.157" Title="gnu arm assembler command line macro fails with &quot;Invalid identifier for .ifdef&quot;" Tags="&lt;gcc&gt;&lt;assembly&gt;&lt;gas&gt;" AnswerCount="2" CommentCount="0" FavoriteCount="2" />
  <row Id="12768942" PostTypeId="1" AcceptedAnswerId="12768965" CreationDate="2012-10-07T12:42:49.487" Score="0" ViewCount="348" Body="&lt;p&gt;I have a doubt about a syntax used in linux kernel code. I have an intuition of what it does but I want to know it more formally. I am using kernel &lt;code&gt;v3.5.4&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;In file &lt;code&gt;/include/linux/sched.h&lt;/code&gt; the following is defined&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;struct task_struct {&#xA;    volatile long state;&#xA;    //some more data members&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and in file &lt;code&gt;/include/linux/init_task.h&lt;/code&gt; file the following is defined:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define INIT_TASK(tsk) {&#xA;    .state     = 0,               \&#xA;    //some more initializations&#xA;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I am confused about two things:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;a) I feel it is used for initialization but can anyone suggest some good read for this type of initialization for structures.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;b) I do not understand how the following initialization works. Like how this &lt;code&gt;#define&lt;/code&gt; and the corresponding &lt;code&gt;task_struct&lt;/code&gt; structure are related.   &lt;/p&gt;&#xA;&#xA;&lt;p&gt;[EDIT]&#xA;I noticed the following things also:&#xA;c) Is &lt;code&gt;\&lt;/code&gt; at the end of every line necessary. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;d) There are many parts of kernel doe wrapped in &lt;code&gt;#ifdef #endif&lt;/code&gt;. If you want to initialize a data member wrapped in &lt;code&gt;#ifdef #endif&lt;/code&gt; can we use this form of initialization. I mean can we use &lt;code&gt;#ifdef #endif&lt;/code&gt; inside &lt;code&gt;INIT_TASK()&lt;/code&gt; like this&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define INIT_TASK(tsk) {&#xA;    .state     = 0,               \&#xA;&#xA;    //some more initializations&#xA;    #ifdef CX &#xA;    .tickets   = 5,               \&#xA;    #endif&#xA;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1317240" LastEditorUserId="1317240" LastEditDate="2012-10-07T13:01:38.683" LastActivityDate="2012-10-09T10:40:45.320" Title="c syntax in kernel code and its working" Tags="&lt;c&gt;&lt;linux&gt;&lt;linux-kernel&gt;&lt;kernel&gt;" AnswerCount="2" CommentCount="1" FavoriteCount="1" />
  <row Id="12792968" PostTypeId="1" AcceptedAnswerId="12818099" CreationDate="2012-10-09T04:47:47.777" Score="0" ViewCount="7317" Body="&lt;p&gt;This may be a simple question.But I couldn't find a way to go around this.I am using an s function block to input a wave signal to my algorithm.wave signal is being read from file of about 2000 points&lt;/p&gt;&#xA;&#xA;&lt;p&gt;First i started with simulation time equal to 50.Then it read only 50 points.I checked the 'tout' variable. It was 0,1,2,....50&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Then i increased simulation time to 100.still result is same.only 50 points read.But tout is 0,2,4,6..50 &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I tried up to 10000.Whatever i do it reads 50 values only with wide time step like 0,200,400,600 etc.&#xA;Is it a problem with my s-function or simulink settings?&#xA;Here is the c s-function file&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    /* Give S-function a name */&#xA;#define S_FUNCTION_NAME  Readip&#xA;#define S_FUNCTION_LEVEL 2&#xA;&#xA;/* Include SimStruct definition and file I/O functions */&#xA;#include &quot;simstruc.h&quot;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;&#xA;static FILE* file2;&#xA;/* Called at the beginning of the simulation */&#xA;    static void mdlInitializeSizes(SimStruct *S)&#xA;&#xA;{&#xA;&#xA;        ssSetNumSFcnParams(S, 0); &#xA;&#xA;&#xA;   if (ssGetNumSFcnParams(S) != ssGetSFcnParamsCount(S)) {&#xA;        return;&#xA;    }&#xA;    if (!ssSetNumOutputPorts(S, 3)) return;&#xA;    ssSetNumContStates(S, 0);&#xA;    ssSetNumDiscStates(S, 0);&#xA;    ssSetOutputPortWidth(S, 0, 1);&#xA;    ssSetOutputPortDataType(S,0,DYNAMICALLY_SIZED);&#xA;    ssSetOutputPortOptimOpts(S, 0, SS_REUSABLE_AND_LOCAL);&#xA;    ssSetOutputPortWidth(S, 1, 1);&#xA;    ssSetOutputPortDataType(S,1,DYNAMICALLY_SIZED);&#xA;    ssSetOutputPortOptimOpts(S, 1, SS_REUSABLE_AND_LOCAL);&#xA;    ssSetOutputPortWidth(S, 2, 1);&#xA;    ssSetOutputPortDataType(S,2,DYNAMICALLY_SIZED);&#xA;    ssSetOutputPortOptimOpts(S, 2, SS_REUSABLE_AND_LOCAL);&#xA;&#xA;&#xA;       ssSetNumPWork(S,1);&#xA;        ssSetNumSampleTimes(S, 1);&#xA;    }&#xA;&#xA;&#xA;    /* Set sample times for the block */&#xA;    static void mdlInitializeSampleTimes(SimStruct *S)&#xA;    {&#xA;        ssSetSampleTime(S, 0, CONTINUOUS_SAMPLE_TIME);&#xA;        ssSetOffsetTime(S, 0, 0.0);&#xA;    }&#xA;&#xA;&#xA;&#xA;        #define MDL_START  /* Change to #undef to remove function */&#xA;        #if defined(MDL_START) &#xA;          /* Function: mdlStart ========&#xA;&#xA;    ===============================================&#xA;       * Abstract:&#xA;       *    This function is called once at start of model execution. If you&#xA;       *    have states that shou&#xA;&#xA;ld be initialized once, this is the place&#xA;   *    to do it.&#xA;   */&#xA;  static void mdlStart(SimStruct *S)&#xA;  {&#xA;      /*at start of model execution, open the file and store the pointer&#xA;       *in the pwork vector */&#xA;      void** pwork = ssGetPWork(S);&#xA;      FILE *datafile;&#xA;&#xA;      datafile = fopen(&quot;table.data&quot;,&quot;r&quot;);&#xA;      pwork[0] =  datafile;&#xA;&#xA;      }&#xA;    #endif /*  MDL_START */&#xA;&#xA;/* Function: mdlOutputs =======================================================&#xA; * Abstract:&#xA; *    In this function, you compute the outputs of your S-function&#xA; *    block. Generally outputs are placed in the output vector, ssGetY(S).&#xA; */&#xA;static void mdlOutputs(SimStruct *S, int_T tid)&#xA;{&#xA;    //get pointer to the block's output signal&#xA;    real_T       *y1 = ssGetOutputPortSignal(S,0);&#xA;    real_T       *y2 = ssGetOutputPortSignal(S,1);&#xA;    real_T       *y3 = ssGetOutputPortSignal(S,2);&#xA;    char a[10];&#xA;    char b[10];&#xA;    char c[10];&#xA;    /*get pointer to array of pointers, where the first element is the address&#xA;     *of the open file */&#xA;    void** pwork = ssGetPWork(S);&#xA;&#xA;/*read a floating point number and then the comma delimiter&#xA; *store the result in y*/&#xA;&#xA;fscanf(pwork[0],&quot;%s    %s    %s&quot;,&amp;amp;a,&amp;amp;b,&amp;amp;c);&#xA;*y1=atof(a);&#xA;*y2=atof(b);&#xA;    *y3=atof(c);&#xA;&#xA;}&#xA;&#xA;&#xA;&#xA;/* Function: mdlTerminate =====================================================&#xA; * Abstract:&#xA; *    In this function, you should perform any actions that are necessary&#xA; *    at the termination of a simulation.  For example, if memory was&#xA; *    allocated in mdlStart, this is the place to free it.&#xA; */&#xA;static void mdlTerminate(SimStruct *S)&#xA;{&#xA;    //close the file&#xA;    void** pwork = ssGetPWork(S);&#xA;      FILE *datafile;&#xA;&#xA;      datafile = pwork[0];&#xA;      fclose(datafile);&#xA;&#xA;}&#xA;&#xA;&#xA;&#xA;/*=============================*&#xA; * Required S-function trailer *&#xA; *=============================*/&#xA;&#xA;    #ifdef  MATLAB_MEX_FILE    /* Is this file being compiled as a MEX-file? */&#xA;    #include &quot;simulink.c&quot;      /* MEX-file interface mechanism */&#xA;    #else&#xA;    #include &quot;cg_sfun.h&quot;       /* Code generation registration function */&#xA;    #endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1466866" LastEditorUserId="1466866" LastEditDate="2012-10-09T11:57:05.570" LastActivityDate="2012-10-26T14:44:14.263" Title="How to fix number of steps (not time) in Matlab simulink" Tags="&lt;matlab&gt;&lt;simulink&gt;" AnswerCount="2" CommentCount="2" />
  <row Id="13061947" PostTypeId="1" AcceptedAnswerId="13062301" CreationDate="2012-10-25T05:10:08.043" Score="0" ViewCount="104" Body="&lt;p&gt;I'm trying to following to application in &lt;a href=&quot;http://www.cs.rit.edu/~ats/books/ooc.pdf&quot; rel=&quot;nofollow noreferrer&quot;&gt;OOP C&lt;/a&gt; but I get errors in my new.h file.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I am getting a bunch of &quot;unexpected&quot; errors.&#xA;Just about everything after the first 'void' is exepected.&#xA;Any ideas?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef NEW_H&#xA;#define NEW_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;void * new (const void * type);&#xA;void delete (void * item);  &#xA;&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;&#xA;&#xA;#endif  /* NEW_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/ztJEJ.png&quot; alt=&quot;enter image description here&quot;&gt;&lt;/p&gt;&#xA;" OwnerUserId="504963" LastActivityDate="2012-10-25T05:45:07.363" Title="unexpected *, unexpected (" Tags="&lt;c&gt;&lt;oop&gt;&lt;header-files&gt;&lt;netbeans-7&gt;" AnswerCount="4" CommentCount="5" />
  <row Id="13169943" PostTypeId="1" AcceptedAnswerId="13169961" CreationDate="2012-11-01T01:55:23.923" Score="1" ViewCount="2859" Body="&lt;blockquote&gt;&#xA;  &lt;p&gt;&lt;strong&gt;Possible Duplicate:&lt;/strong&gt;&lt;br&gt;&#xA;  &lt;a href=&quot;http://stackoverflow.com/questions/1813853/ifdef-ifndef-in-java&quot;&gt;#ifdef #ifndef in Java&lt;/a&gt;  &lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&#xA;&#xA;&lt;p&gt;I'm trying to implement some debug messages in my Android code by using something like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;private static final boolean DEBUG = false;&#xA;&#xA;if (DEBUG) {&#xA;// some code&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;However, upon compilation I keep getting &quot;Illegal start of expression&quot; errors. final boolean works, but neither static nor private work.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I'm declaring the DEBUG variable in methods. Would also appreciate if there's a way to make this global so that everything within the same Java file will see it rather than me having to declare it in every method that needs it.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks!&lt;/p&gt;&#xA;" OwnerUserId="1118764" LastActivityDate="2012-11-01T02:07:34.473" Title="#ifdef equivalent in Java?" Tags="&lt;java&gt;&lt;android&gt;&lt;conditional-compilation&gt;" AnswerCount="2" CommentCount="2" ClosedDate="2012-11-01T05:14:24.603" />
  <row Id="13188732" PostTypeId="1" AcceptedAnswerId="13188746" CreationDate="2012-11-02T03:06:26.520" Score="1" ViewCount="692" Body="&lt;p&gt;I have the following code&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#if defined(TESTING)&#xA;#define TEST_FAILED_IN_VMC(...) TestFailed(__FILE__, __LINE__, __VA_ARGS__)&#xA;#define TEST_FAILED_IN_UNIT_TEST(...) TestFailedInUnitTest(__VA_ARGS__)&#xA;#else&#xA;#define TEST_FAILED_IN_VMC(...)&#xA;#define TEST_FAILED_IN_UNIT_TEST(...)&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and make a call &lt;code&gt;TEST_FAILED_IN_VMC(peripheral, testSuiteName, testName, &#xA;                                    &quot;Internal coding error; bad state (%d)&quot;, state);&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;and the compiler complians that &lt;code&gt;testSuiteName&lt;/code&gt; and &lt;code&gt;testName&lt;/code&gt; are not defined - even though &lt;code&gt;#TESTING&lt;/code&gt; is not defined.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;[Update] The compiler also says &lt;code&gt;&quot;Error 3   implicit declaration of function 'TEST_FAILED_IN_VMC'&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;[Update] Please ignore veryting below this line. The problem is above. Thanks.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So, I tried this [Update] &lt;code&gt;else&lt;/code&gt; should be &lt;code&gt;#else&lt;/code&gt;, then I am told that &lt;code&gt;TESTING&lt;/code&gt; is not defiend. SO, why is the code above not working?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#if defined(TESTING)&#xA;#error &quot;Testing is defined &amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&quot;&#xA;wf&#xA;else&#xA;#error &quot;Testing is NOT defined &amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&quot;&#xA;eyh6&#xA;#endif&#xA;&#xA;#ifdef TESTING&#xA;#error &quot;Testing is defined @@&quot;&#xA;ehye&#xA;else&#xA;#error &quot;Testing is NOT defined @@&quot;&#xA;5he567&#xA;#endif&#xA;&#xA;#error &quot;Sample error ###&quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and the only error the compiler gave was &lt;code&gt;Error 3   #error &quot;Sample error ###&quot;&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any idea what is going wrong? (Atmel AVR Studio, which is based on Microsoft Visual studio`.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Many, many, many other &lt;code&gt;#if defined&lt;/code&gt; are working just fine ...&lt;/p&gt;&#xA;" OwnerUserId="192910" LastEditorUserId="192910" LastEditDate="2012-11-02T03:15:44.317" LastActivityDate="2012-11-02T03:39:24.790" Title="#ifdef #else - neither branch chosen" Tags="&lt;c&gt;&lt;c-preprocessor&gt;" AnswerCount="2" CommentCount="0" FavoriteCount="1" />
  <row Id="13240081" PostTypeId="1" AcceptedAnswerId="13240094" CreationDate="2012-11-05T20:45:41.123" Score="1" ViewCount="598" Body="&lt;p&gt;I can see &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef &amp;lt;token&amp;gt;&#xA;code;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;to be included, but I can't find it defined in any of the headers it includes. Is there any other mechanism with which the token could be defined?&lt;/p&gt;&#xA;" OwnerUserId="1279782" LastActivityDate="2012-11-05T21:01:01.897" Title="c++ - #ifdef macro" Tags="&lt;c++&gt;" AnswerCount="3" CommentCount="2" />
  <row Id="13322041" PostTypeId="1" AcceptedAnswerId="13323602" CreationDate="2012-11-10T12:26:10.203" Score="0" ViewCount="100" Body="&lt;p&gt;I have a class inside a dll which I want to use in another project. I read &lt;a href=&quot;http://www.codeproject.com/Articles/28969/HowTo-Export-C-classes-from-a-DLL&quot; rel=&quot;nofollow&quot;&gt;this tutorial&lt;/a&gt; about how to do this and my pseudo code looks like this&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;interface.h&lt;/strong&gt;  &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  EXPORT&#xA;#define SOMEAPI __declspec(dllexport)&#xA;#else&#xA;#define SOMEAPI __declspec(dllimport)&#xA;#endif&#xA;&#xA;struct ISomeInterface&#xA;{&#xA;  virtual void SomeMethod()=0;&#xA;};&#xA;&#xA;typedef ISomeInterface* SOMEHANDLE;&#xA;&#xA;#define EXTERN_C     extern &quot;C&quot;&#xA;&#xA;EXTERN_C SOMEAPI SOMEHANDLE WINAPI CreateSomething(VOID);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And then I have &lt;code&gt;SomeDLL.dll&lt;/code&gt; which implements &lt;code&gt;ISomeInterface&lt;/code&gt; and &lt;code&gt;CreateSomething&lt;/code&gt;.&lt;br&gt;&#xA;When I try to use this in my client I get linker error. The client looks like this:&lt;br&gt;&#xA;&lt;strong&gt;Client.cpp&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;interface.h&quot;&#xA;SOMEHANDLE h = ::CreateSomething();  // Linker error here: Unresolved external  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I can solve this by adding the dll project as a dependency of Client project in VC++. Then everything is good.&lt;br&gt;&#xA;The problem is what if I want to use this a standalong dll(which is the case right now)? How do I get rid of the linker error then?&lt;/p&gt;&#xA;" OwnerUserId="279982" LastActivityDate="2012-11-10T16:06:00.437" Title="Using a class inside a dll" Tags="&lt;c++&gt;&lt;visual-studio&gt;&lt;class&gt;&lt;dll&gt;&lt;export&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="13516476" PostTypeId="1" AcceptedAnswerId="16360980" CreationDate="2012-11-22T16:07:20.237" Score="17" ViewCount="13356" Body="&lt;p&gt;I'm looking for detailled information on &lt;code&gt;long double&lt;/code&gt; and &lt;code&gt;__float128&lt;/code&gt; in GCC/x86 (more out of curiosity than because of an actual problem).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Few people will probably ever need these (I've just, for the first time ever, &lt;em&gt;truly&lt;/em&gt; needed a &lt;code&gt;double&lt;/code&gt;), but I guess it is still worthwile (and interesting) to know what you have in your toolbox and what it's about.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;In that light, please excuse my somewhat open questions:&lt;/p&gt;&#xA;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Could someone explain the implementation rationale and intended usage of these types, also in comparison of each other? For example, are they &quot;embarrassment implementations&quot; because the standard allows for the type, and someone might complain if they're only just the same precision as &lt;code&gt;double&lt;/code&gt;, or are they intended as first-class types? &lt;/li&gt;&#xA;&lt;li&gt;Alternatively, does someone have a good, usable web reference to share? A Google search on &lt;code&gt;&quot;long double&quot; site:gcc.gnu.org/onlinedocs&lt;/code&gt; didn't give me much that's truly useful.&lt;/li&gt;&#xA;&lt;li&gt;Assuming that the common mantra &lt;em&gt;&quot;if you believe that you need double, you probably don't understand floating point&quot;&lt;/em&gt; does not apply, i.e. you &lt;em&gt;really&lt;/em&gt; need more precision than just &lt;code&gt;float&lt;/code&gt;, and one doesn't care whether 8 or 16 bytes of memory are burnt... is it reasonable to expect that one can as well just jump to &lt;code&gt;long double&lt;/code&gt; or &lt;code&gt;__float128&lt;/code&gt; instead of &lt;code&gt;double&lt;/code&gt; without a significant performance impact?&lt;/li&gt;&#xA;&lt;li&gt;The &quot;extended precision&quot; feature of Intel CPUs has historically been source of nasty surprises when values were moved between memory and registers. If actually 96 bits are stored, the &lt;code&gt;long double&lt;/code&gt; type should eliminate this issue. On the other hand, I understand that the &lt;code&gt;long double&lt;/code&gt; type is mutually exclusive with &lt;code&gt;-mfpmath=sse&lt;/code&gt;, as there is no such thing as &quot;extended precision&quot; in SSE. &lt;code&gt;__float128&lt;/code&gt;, on the other hand, should work just perfectly fine with SSE math (though in absence of quad precision instructions certainly not on a 1:1 instruction base). Am I right in these assumptions?&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;p&gt;(3. and 4. can probably be figured out with some work spent on profiling and disassembling, &lt;em&gt;but maybe someone else had the same thought previously and has already done that work&lt;/em&gt;.)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Background (this is the TL;DR part):&lt;/strong&gt;&lt;br&gt;&#xA;I initially stumbled over &lt;code&gt;long double&lt;/code&gt; because I was looking up &lt;code&gt;DBL_MAX&lt;/code&gt; in &lt;code&gt;&amp;lt;float.h&amp;gt;&lt;/code&gt;, and incidentially &lt;code&gt;LDBL_MAX&lt;/code&gt; is on the next line. &quot;Oh look, GCC actually has 128 bit doubles, not that I need them, but... cool&quot; was my first thought. Surprise, surprise: &lt;code&gt;sizeof(long double)&lt;/code&gt; returns 12... wait, you mean 16?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The C and C++ standards unsurprisingly do not give a very concrete definition of the type. C99 (6.2.5 10) says that the numbers of &lt;code&gt;double&lt;/code&gt; are a subset of &lt;code&gt;long double&lt;/code&gt; whereas C++03 states (3.9.1 8) that &lt;code&gt;long double&lt;/code&gt; has at least as much precision as &lt;code&gt;double&lt;/code&gt; (which is the same thing, only worded differently). Basically, the standards leave everything to the implementation, in the same manner as with &lt;code&gt;long&lt;/code&gt;, &lt;code&gt;int&lt;/code&gt;, and &lt;code&gt;short&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Wikipedia says that GCC uses &lt;em&gt;&quot;80-bit extended precision on x86 processors regardless of the physical storage used&quot;&lt;/em&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The GCC documentation states, all on the same page, that the size of the type is 96 bits because of the i386 ABI, but no more than 80 bits of precision are enabled by any option (huh? what?), also Pentium and newer processors want them being aligned as 128 bit numbers. This is the default under 64 bits and can be manually enabled under 32 bits, resulting in 32 bits of zero padding.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Time to run a test:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;cfloat&amp;gt;&#xA;&#xA;int main()&#xA;{&#xA;#ifdef  USE_FLOAT128&#xA;    typedef __float128  long_double_t;&#xA;#else&#xA;    typedef long double long_double_t;&#xA;#endif&#xA;&#xA;long_double_t ld;&#xA;&#xA;int* i = (int*) &amp;amp;ld;&#xA;i[0] = i[1] = i[2] = i[3] = 0xdeadbeef;&#xA;&#xA;for(ld = 0.0000000000000001; ld &amp;lt; LDBL_MAX; ld *= 1.0000001)&#xA;    printf(&quot;%08x-%08x-%08x-%08x\r&quot;, i[0], i[1], i[2], i[3]);&#xA;&#xA;return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The output, when using &lt;code&gt;long double&lt;/code&gt;, looks somewhat like this, with the marked digits being constant, and all others eventually changing as the numbers get bigger and bigger:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;5636666b-c03ef3e0-00223fd8-deadbeef&#xA;                  ^^       ^^^^^^^^&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This suggests that it is &lt;strong&gt;not&lt;/strong&gt; an 80 bit number. An 80-bit number has 18 hex digits. I see 22 hex digits changing, which looks much more like a 96 bits number (24 hex digits). It also isn't a 128 bit number since &lt;code&gt;0xdeadbeef&lt;/code&gt; isn't touched, which is consistent with &lt;code&gt;sizeof&lt;/code&gt; returning 12.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The output for &lt;code&gt;__int128&lt;/code&gt; looks like it's really just a 128 bit number. All bits eventually flip.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Compiling with &lt;code&gt;-m128bit-long-double&lt;/code&gt; does &lt;strong&gt;not&lt;/strong&gt; align &lt;code&gt;long double&lt;/code&gt; to 128 bits with a 32-bit zero padding, as indicated by the documentation. It doesn't use &lt;code&gt;__int128&lt;/code&gt; either, but indeed seems to align to 128 bits, padding with the value &lt;code&gt;0x7ffdd000&lt;/code&gt;(?!).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Further, &lt;code&gt;LDBL_MAX&lt;/code&gt;, seems to work as &lt;code&gt;+inf&lt;/code&gt; for both &lt;code&gt;long double&lt;/code&gt; and &lt;code&gt;__float128&lt;/code&gt;. Adding or subtracting a number like &lt;code&gt;1.0E100&lt;/code&gt; or &lt;code&gt;1.0E2000&lt;/code&gt; to/from &lt;code&gt;LDBL_MAX&lt;/code&gt; results in the same bit pattern.&lt;br&gt;&#xA;Up to now, it was my belief that the &lt;code&gt;foo_MAX&lt;/code&gt; constants were to hold the largest representable number that is &lt;em&gt;not&lt;/em&gt; &lt;code&gt;+inf&lt;/code&gt; (apparently that isn't the case?). I'm also not quite sure how an 80-bit number could conceivably act as &lt;code&gt;+inf&lt;/code&gt; for a 128 bit value... maybe I'm just too tired at the end of the day and have done something wrong.&lt;/p&gt;&#xA;" OwnerUserId="572743" LastActivityDate="2016-02-14T17:30:28.447" Title="long double (GCC specific) and __float128" Tags="&lt;gcc&gt;&lt;long-double&gt;" AnswerCount="2" CommentCount="2" FavoriteCount="12" />
  <row Id="13957970" PostTypeId="1" AcceptedAnswerId="14728142" CreationDate="2012-12-19T17:36:06.997" Score="1" ViewCount="387" Body="&lt;ol&gt;&#xA;&lt;li&gt;I have a render engine that works on an iOS app. &lt;/li&gt;&#xA;&lt;li&gt;I almost managed to make it work by calling the same openGL rendering engine from a qt(4.8) app with a QGLWidget. To support es2 function set my widget also inherits QGLFunctions.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;p&gt;However I still have issues with shaders : I could not compile them on qt with glCompileShader because of almost every keywords (lowp, vec4, vec2 ...) were returning compilations errors. So I compiled it with QGLShader program, but I had to specify &quot;#version 120&quot;, the closest to es2. But still, my sprites don't show up the right size and the only potentially influencing different pieces of code with iOS are in shader compilation / version. I think the issue in the shader is gl_PointSize not changing anything in qt's compilation of the vertex shader.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there any better way for me to have shaders compiled on qt like they are on iOS ?&#xA;( I know glsl es2 version is coming from version 120 but I don't know to what extent they differ ).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My shaders, working well on iOS but not on Qt:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;const GLchar vShaderStr[] =&#xA;#ifdef  QT_OPENGL_LIB&#xA;&quot;#version 120\n&quot;&#xA;#endif //QT_OPENGL_LIB&#xA;&quot;attribute lowp vec4 Position;\n&quot;&#xA;&quot;attribute mediump vec2 TextureCoord;\n&quot;&#xA;&quot;attribute lowp float Weight;\n&quot;&#xA;&quot;uniform mat4 MVP;\n&quot;&#xA;&quot;varying mediump vec2 TextureCoordOut;\n&quot;&#xA;&quot;void main(void)\n&quot;&#xA;&quot;{\n&quot;&#xA;&quot;  gl_Position = MVP * Position;\n&quot;&#xA;&quot;  TextureCoordOut = TextureCoord;\n&quot;&#xA;&quot;  gl_PointSize = Weight;\n&quot;&#xA;&quot;}\n&quot;;&#xA;&#xA;const GLchar fShaderStr[] =&#xA;#ifdef  QT_OPENGL_LIB&#xA;&quot;#version 120\n&quot;&#xA;#endif //QT_OPENGL_LIB&#xA;&quot;varying mediump vec2 TextureCoordOut;\n&quot;&#xA;&quot;uniform sampler2D Sampler;\n&quot;&#xA;&quot;uniform bool IsSprite;\n&quot;&#xA;&quot;uniform lowp vec3 TextureColor;\n&quot;&#xA;&quot;uniform lowp float Opacity;\n&quot;&#xA;&quot;void main(void)\n&quot;&#xA;&quot;{\n&quot;&#xA;&quot;   lowp vec4 textureColorResult;\n&quot;&#xA;&quot;   textureColorResult = texture2D(Sampler,  IsSprite ? gl_PointCoord : TextureCoordOut);\n&quot;&#xA;&quot;   gl_FragColor = IsSprite ? vec4(mix(textureColorResult.rgb,TextureColor, 1.0),\n&quot;&#xA;&quot;                    textureColorResult.a * Opacity) : textureColorResult;\n&quot;&#xA;&quot;}\n&quot;;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="777554" LastActivityDate="2013-02-06T11:38:57.867" Title="How to make shaders in qt compile &amp; work like in es2 (iOS)?" Tags="&lt;qt&gt;&lt;opengl-es-2.0&gt;&lt;glsl&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="14035334" PostTypeId="1" AcceptedAnswerId="14035466" CreationDate="2012-12-26T02:10:12.760" Score="1" ViewCount="6210" Body="&lt;p&gt;I'm trying to use flex and bison to create a simple calc, but i receive errors when i try compile, i don't experience in YACC or FLEX this is my first program.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;flex 2.5.35, bison (GNU bison) 2.3, gcc (Debian 4.3.2-1.1) 4.3.2, linux 2.6.26-1-686&lt;/p&gt;&#xA;&#xA;&lt;p&gt;this is the error:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;bison -d -y math.yacc -b math&#xA;lex -P math math.lex&#xA;gcc lex.math.c math.tab.c -g -Wall -lfl -ll -o math.parse.so&#xA;math.tab.c: In function ‘yyparse’:&#xA;math.tab.c:1244: warning: implicit declaration of function ‘yylex’&#xA;/tmp/ccOhwzV0.o: In function `yyparse':&#xA;/root/.netbeans/remote/192.168.56.101/silenobrito-nb-Windows-x86_64/D/source/lib-        math/src/model/math.tab.c:1244: undefined reference to `yylex'&#xA;collect2: ld returned 1 exit status&#xA;make: ** [math.parse.so] Erro 1&#xA;athenas:~/.netbeans/remote/192.168.56.101/silenobrito-nb-Windows-x86_64/D/source/lib-math/src/model#&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;this is my Makefile:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;## -*- Makefile -*-&#xA;##&#xA;## Usuário: silenobrito&#xA;## Hora: 25/12/2012 17:21:13&#xA;## Makefile created by Oracle Solaris Studio.&#xA;##&#xA;## Este arquivo é gerado automaticamente.&#xA;##&#xA;CC=gcc&#xA;CFLAGS=-g -Wall -lfl -ll&#xA;LEX=lex&#xA;#YACC=yacc -d&#xA;#LEX=flex&#xA;YACC=bison -d -y&#xA;&#xA;all: lex.math.c math.tab.c math.parse.so &#xA;&#xA;## Destino: lex.math.c&#xA;lex.math.c: math.tab.c&#xA;    $(LEX) -P math math.lex &#xA;&#xA;## Destino: math.tab.c&#xA;math.tab.c: math.yacc  math.lex&#xA;    $(YACC) math.yacc -b math&#xA;&#xA;## Destino: math.parse.o&#xA;math.parse.so: math.tab.c math.tab.h lex.math.c&#xA;    $(CC) lex.math.c math.tab.c $(CFLAGS) -o $@&#xA;&#xA;#### Limpar o destino deleta todos os arquivos gerados ####&#xA;clean:&#xA;    rm -fr math.tab.c math.tab.h lex.math.c &#xA;&#xA;# Ativar verificação de dependências&#xA;.KEEP_STATE:&#xA;.KEEP_STATE_FILE:.make.state.GNU-amd64-Linux&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;this is my YACC file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;%{&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;math.h&amp;gt;&#xA;&#xA;#define YYSTYPE double&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;    int yyerror(char *message);&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;&#xA;%}&#xA;%start solve&#xA;%token END_OF_LINE ADD SUB OPEN_PARENTHESIS CLOSE_PARENTHESIS NUMBER&#xA;%left ADD SUB&#xA;%%&#xA;&#xA;solve   :   expr END_OF_LINE&#xA;        {&#xA;            printf(&quot;resposta: %lf\n&quot;, $1);&#xA;            return EXIT_SUCCESS;&#xA;        }&#xA;expr    :   expr ADD expr&#xA;        {&#xA;            $$ = $1 + $3;&#xA;        }|  expr SUB expr&#xA;        {&#xA;            $$ = $1 - $3;&#xA;        }|  OPEN_PARENTHESIS expr CLOSE_PARENTHESIS&#xA;        {&#xA;            $$ = $2;&#xA;        }|  NUMBER;&#xA;%%&#xA;&#xA;int yyerror(char *message) {&#xA;    fprintf(stderr, &quot;%s\n&quot;, message);&#xA;    return EXIT_FAILURE;&#xA;}&#xA;&#xA;int main(int argc, char ** argv) {&#xA;    return yyparse();&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;this is my LEX file: &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;%{&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &quot;math.tab.h&quot;&#xA;#define _POSIX_SOURCE 1&#xA;&#xA;int decValue;&#xA;%}&#xA;&#xA;%option nounput&#xA;%option noinput&#xA;%option noyywrap&#xA;&#xA;%%&#xA;add                 return ADD;&#xA;sub                 return SUB;&#xA;[0-9]+              {yylval = atof(yytext); return NUMBER;};&#xA;0x[0-9a-fA-F]+      {sscanf(yytext, &quot;%x&quot;, &amp;amp;decValue); yylval = decValue; return NUMBER;};&#xA;\(                  return OPEN_PARENTHESIS;&#xA;\)                  return CLOSE_PARENTHESIS;&#xA;\n                  return END_OF_LINE;&#xA;.                   ;&#xA;%%&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1775025" LastActivityDate="2012-12-26T02:41:24.890" Title="YACC &amp; Lex undefined reference to `yylex'" Tags="&lt;c&gt;&lt;reference&gt;&lt;makefile&gt;&lt;yacc&gt;&lt;lex&gt;" AnswerCount="1" CommentCount="2" FavoriteCount="1" />
  <row Id="14071099" PostTypeId="1" AcceptedAnswerId="14071579" CreationDate="2012-12-28T14:37:00.697" Score="2" ViewCount="2294" Body="&lt;p&gt;I have a working client and a server which, once finished would have a valid SSL certificate.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;At the moment, for the mean of testing, I'm just disabling the need of SSL verification in the client by adding the flags &lt;code&gt;INTERNET_FLAG_IGNORE_CERT_CN_INVALID&lt;/code&gt; and &lt;code&gt;SECURITY_FLAG_IGNORE_UNKNOWN_CA&lt;/code&gt; like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;HINTERNET hRequest = HttpOpenRequest(hConnection,&#xA;           &quot;GET&quot;,&quot;index.html&quot;,&#xA;           NULL,NULL,NULL,&#xA;           INTERNET_FLAG_RELOAD|&#xA;           INTERNET_FLAG_EXISTING_CONNECT&#xA;           #ifdef  __HTTPS__&#xA;           | INTERNET_FLAG_SECURE |INTERNET_FLAG_IGNORE_CERT_CN_INVALID|SECURITY_FLAG_IGNORE_UNKNOWN_CA&#xA;           #endif&#xA;           ,&#xA;           dwContext);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I got this to work perfectly on my laptop. Now I'm trying to use it on my PC. same code exactly. copied and pasted the files (both Visual Studio Professional 2008), now I'm getting &lt;code&gt;12045&lt;/code&gt; error. which means &lt;code&gt;Invalid Certificate Authority&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I tried disabling Windows Firewall, didn't work. both computer connected to the same router&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any ideas what can cause this?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;EDIT&lt;/strong&gt;&#xA;Basically what happens is the same as described &lt;a href=&quot;http://support.microsoft.com/kb/825828&quot; rel=&quot;nofollow&quot;&gt;here by Microsoft&lt;/a&gt;, only this article is for &lt;code&gt;Windows CE&lt;/code&gt;&lt;/p&gt;&#xA;" OwnerUserId="975959" LastEditorUserId="975959" LastEditDate="2012-12-28T15:07:41.897" LastActivityDate="2012-12-28T15:12:15.700" Title="OpenSSL WinINET client" Tags="&lt;visual-studio&gt;&lt;winapi&gt;&lt;ssl&gt;&lt;openssl&gt;&lt;wininet&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="14269080" PostTypeId="1" CreationDate="2013-01-10T23:20:47.953" Score="1" ViewCount="545" Body="&lt;p&gt;I'm trying to create an MySQL UDF getFile() which is supposed to return the contents of a text file from a certain directory on disk. The problem is that the call works once or twice, but upon calling the UDF for a second or third time the MySQL server crashes.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I can't reproduce the error by calling getFile() directly from the mysql console, here it seems to work fine - it seems to occur only when I call the UDF from the stored procedure. The error also disappears when I call only the small (2.5 k) &quot;session&quot; file while omitting the bigger &quot;mailConfirmation&quot; (45 k) and &quot;mailProtocol&quot; (88 k) files, so it seems to have something to do with the file size.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;MySQL version: 5.1.49-3&lt;/p&gt;&#xA;&#xA;&lt;p&gt;OS: Debian 6 Squeeze&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any suggestions or ideas will be greatly appreciated - thanks in advance!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This is the UDF:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/*&#xA; * Skeleton libary for MySQL.&#xA; * A set of MySQL user defined functions (UDF) to [DESCRIPTION]&#xA; *&#xA; * Copyright (C) [YYYY YOUR NAME &amp;lt;YOU@EXAMPLE.COM&amp;gt;]&#xA; *&#xA; * This library is free software; you can redistribute it and/or modify it&#xA; * under the terms of the GNU Lesser General Public License as published by&#xA; * the Free Software Foundation; either version 2.1 of the License, or (at&#xA; * your option) any later version.&#xA; *&#xA; * This library is distributed in the hope that it will be useful, but&#xA; * WITHOUT ANY WARRANTY; without even the implied warranty of&#xA; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser&#xA; * General Public License for more details.&#xA; *&#xA; * You should have received a copy of the GNU Lesser General Public License&#xA; * along with this library; if not, write to the Free Software Foundation, Inc.,&#xA; * 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA&#xA; */&#xA;&#xA;#include &quot;mysqludf.h&quot;&#xA;&#xA;/* For Windows, define PACKAGE_STRING in the VS project */&#xA;#ifndef __WIN__&#xA;#include &quot;config.h&quot;&#xA;#endif&#xA;&#xA;/* These must be right or mysqld will not find the symbol! */&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;    DLLEXP my_bool getFile_init(UDF_INIT *initid, UDF_ARGS *args, char *message);&#xA;    DLLEXP void getFile_deinit(UDF_INIT *initid);&#xA;    DLLEXP char *getFile(UDF_INIT *initid, UDF_ARGS *args, char *result, unsigned long *length, char *is_null, char *error);&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;&#xA;/*&#xA; * Output the library version.&#xA; * dbrw_info()&#xA; */&#xA;&#xA;my_bool getFile_init(UDF_INIT *initid, UDF_ARGS *args, char *message)&#xA;{&#xA;    if(!(args-&amp;gt;arg_count == 3))&#xA;    {&#xA;        strcpy(message, &quot;Three arguments expected! (table, uuid, column)&quot;);&#xA;        //strcpy(message, &quot;Error&quot;);&#xA;        return 1;&#xA;    }&#xA;&#xA;    char *input_file_name;&#xA;    asprintf(&amp;amp;input_file_name, &quot;%s%s%s%s%s%s&quot;, &quot;/var/lib/mysqlFiles/&quot;, args-&amp;gt;args[0], &quot;/&quot;, args-&amp;gt;args[1], &quot;_&quot;, args-&amp;gt;args[2]);&#xA;&#xA;    if (FILE * file = fopen(input_file_name, &quot;r&quot;))&#xA;    {&#xA;        fclose(file);&#xA;    }&#xA;    else&#xA;    {&#xA;        strcpy(message, &quot;File not found!&quot;);&#xA;        //strcpy(message, &quot;Error&quot;);&#xA;        return 1;&#xA;    }&#xA;&#xA;    return 0;&#xA;}&#xA;&#xA;void getFile_deinit(UDF_INIT *initid)&#xA;{&#xA;}&#xA;&#xA;char* getFile(UDF_INIT *initid, UDF_ARGS *args, char* result, unsigned long* length,    char *is_null, char *error)&#xA;{&#xA;    char *input_file_name;&#xA;    asprintf(&amp;amp;input_file_name, &quot;%s%s%s%s%s%s&quot;, &quot;/var/lib/mysqlFiles/&quot;, args-&amp;gt;args[0], &quot;/&quot;, args-&amp;gt;args[1], &quot;_&quot;, args-&amp;gt;args[2]);&#xA;&#xA;    char *file_contents;&#xA;    long input_file_size;&#xA;    FILE *input_file = fopen(input_file_name, &quot;rb&quot;);&#xA;    fseek(input_file, 0, SEEK_END);&#xA;    input_file_size = ftell(input_file);&#xA;    rewind(input_file);&#xA;    file_contents = (char*) malloc(input_file_size * (sizeof(char)));&#xA;    fread(file_contents, sizeof(char), input_file_size, input_file);&#xA;    fclose(input_file);&#xA;&#xA;    result=file_contents;&#xA;&#xA;    *length = strlen(result);       &#xA;    return result;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The UDF is being called from a stored procedure:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;CREATE PROCEDURE getOrder&#xA;(&#xA;    IN authKey_in CHAR(255),&#xA;    IN orderNumber  CHAR(255)&#xA;)&#xA;&#xA;BEGIN&#xA;    DECLARE customerId INTEGER(11);&#xA;    DECLARE orderUUID CHAR(32);&#xA;&#xA;    SET customerId=getCustomerId(authKey_in);&#xA;&#xA;    IF customerId=-1 THEN&#xA;        SELECT 'authKey_expired' AS error;&#xA;    ELSEIF customerId=-2 THEN&#xA;        SELECT 'authKey_invalid' AS error;&#xA;    ELSE&#xA;&#xA;        SELECT order_uuid&#xA;        FROM `order`&#xA;        WHERE &#xA;            order_orderNumber=orderNumber AND&#xA;            order_customer_id=customerId&#xA;        INTO orderUUID;&#xA;&#xA;&#xA;        SELECT&#xA;            order_customer_id,&#xA;            order_hasBeenCollected,&#xA;            order_id,&#xA;            order_orderNumber,&#xA;            order_orderValue,&#xA;            order_paymentMethod,&#xA;            order_sofortConfirmation,&#xA;            order_synced,&#xA;            order_timestamp,&#xA;            order_timestamp_lastChange,&#xA;            order_uuid,&#xA;            getFile(&quot;order&quot;, orderUUID, &quot;session&quot;) AS order_session,&#xA;            getFile(&quot;order&quot;, orderUUID, &quot;mailProtocol&quot;) AS order_confirmationMail_protocol,&#xA;            getFile(&quot;order&quot;, orderUUID, &quot;mailConfirmation&quot;) AS order_confirmationMail_text,&#xA;            DATE_FORMAT(&#xA;                        order_timestamp,&#xA;                        &quot;%d.%m.%Y&quot;&#xA;                       ) AS order_timestamp_readable&#xA;        FROM `order`&#xA;        WHERE&#xA;            order_orderNumber=orderNumber AND&#xA;            order_customer_id=customerId;&#xA;&#xA;    END IF;&#xA;END|&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And this is MySQL's output from /var/log/syslog:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Jan 11 00:01:21 devserver mysqld: 130111  0:01:21 - mysqld got signal 11 ;&#xA;Jan 11 00:01:21 devserver mysqld: This could be because you hit a bug. It is also possible that this binary&#xA;Jan 11 00:01:21 devserver mysqld: or one of the libraries it was linked against is corrupt, improperly built,&#xA;Jan 11 00:01:21 devserver mysqld: or misconfigured. This error can also be caused by malfunctioning hardware.&#xA;Jan 11 00:01:21 devserver mysqld: We will try our best to scrape up some info that will hopefully help diagnose&#xA;Jan 11 00:01:21 devserver mysqld: the problem, but since we have already crashed, something is definitely wrong&#xA;Jan 11 00:01:21 devserver mysqld: and this may fail.&#xA;Jan 11 00:01:21 devserver mysqld: &#xA;Jan 11 00:01:21 devserver mysqld: key_buffer_size=4294967296&#xA;Jan 11 00:01:21 devserver mysqld: read_buffer_size=131072&#xA;Jan 11 00:01:21 devserver mysqld: max_used_connections=2&#xA;Jan 11 00:01:21 devserver mysqld: max_threads=50&#xA;Jan 11 00:01:21 devserver mysqld: threads_connected=2&#xA;Jan 11 00:01:21 devserver mysqld: It is possible that mysqld could use up to &#xA;Jan 11 00:01:21 devserver mysqld: key_buffer_size + (read_buffer_size + sort_buffer_size)*max_threads = 4303618 K&#xA;Jan 11 00:01:21 devserver mysqld: bytes of memory&#xA;Jan 11 00:01:21 devserver mysqld: Hope that's ok; if not, decrease some variables in the equation.&#xA;Jan 11 00:01:21 devserver mysqld: &#xA;Jan 11 00:01:21 devserver mysqld: thd: 0x7f8291eae3f0&#xA;Jan 11 00:01:21 devserver mysqld: Attempting backtrace. You can use the following information to find out&#xA;Jan 11 00:01:21 devserver mysqld: where mysqld died. If you see no messages after this, something went&#xA;Jan 11 00:01:21 devserver mysqld: terribly wrong...&#xA;Jan 11 00:01:21 devserver mysqld: stack_bottom = 0x7f81867e0e88 thread_stack 0x30000&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(my_print_stacktrace+0x29) [0x7f82910e8829]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(handle_segfault+0x404) [0x7f8290df2b14]&#xA;Jan 11 00:01:21 devserver mysqld: /lib/libpthread.so.0(+0xeff0) [0x7f8290654ff0]&#xA;Jan 11 00:01:21 devserver mysqld: /lib/libc.so.6(fseek+0x1) [0x7f828f12b891]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/lib/mysql/plugin/dbrw.so(getFile+0x7e) [0x7f81867e2c1e]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(Item_func_udf_str::val_str(String*)+0x80) [0x7f8290d64900]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(Item::send(Protocol*, String*)+0x3e) [0x7f8290d30eae]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(select_send::send_data(List&amp;lt;Item&amp;gt;&amp;amp;)+0x107) [0x7f8290de05f7]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(+0x3d1b7a) [0x7f8290e53b7a]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(+0x3dda00) [0x7f8290e5fa00]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(JOIN::exec()+0xba5) [0x7f8290e748f5]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(mysql_select(THD*, Item***, TABLE_LIST*, unsigned int, List&amp;lt;Item&amp;gt;&amp;amp;, Item*, unsigned int, st_order*, st_order*, Item*, st_order*, unsigned long long, select_result*, st_select_lex_unit*, st_select_lex*)+0x142) [0x7f8290e70622]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(handle_select(THD*, st_lex*, select_result*, unsigned long)+0x174) [0x7f8290e75f24]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(+0x37edfa) [0x7f8290e00dfa]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(mysql_execute_command(THD*)+0x516) [0x7f8290e04df6]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(sp_instr_stmt::exec_core(THD*, unsigned int*)+0x1c) [0x7f8290f6047c]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(sp_lex_keeper::reset_lex_and_exec_core(THD*, unsigned int*, bool, sp_instr*)+0x1c5) [0x7f8290f65c65]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(sp_instr_stmt::execute(THD*, unsigned int*)+0x124) [0x7f8290f65f74]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(sp_head::execute(THD*)+0x5d3) [0x7f8290f62fa3]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(sp_head::execute_procedure(THD*, List&amp;lt;Item&amp;gt;*)+0x51c) [0x7f8290f6472c]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(mysql_execute_command(THD*)+0x2736) [0x7f8290e07016]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(mysql_parse(THD*, char const*, unsigned int, char const**)+0x3fb) [0x7f8290e0a30b]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(dispatch_command(enum_server_command, THD*, char*, unsigned int)+0xb34) [0x7f8290e0ae54]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(do_command(THD*)+0xea) [0x7f8290e0bd3a]&#xA;Jan 11 00:01:21 devserver mysqld: /usr/sbin/mysqld(handle_one_connection+0x235) [0x7f8290dfda25]&#xA;Jan 11 00:01:21 devserver mysqld: /lib/libpthread.so.0(+0x68ca) [0x7f829064c8ca]&#xA;Jan 11 00:01:21 devserver mysqld: /lib/libc.so.6(clone+0x6d) [0x7f828f19492d]&#xA;Jan 11 00:01:21 devserver mysqld: Trying to get some variables.&#xA;Jan 11 00:01:21 devserver mysqld: Some pointers may be invalid and cause the dump to abort...&#xA;Jan 11 00:01:21 devserver mysqld: thd-&amp;gt;query at 0x7f8291eea5c8 = SELECT&#xA;Jan 11 00:01:21 devserver mysqld:             order_customer_id,&#xA;Jan 11 00:01:21 devserver mysqld:             order_hasBeenCollected,&#xA;Jan 11 00:01:21 devserver mysqld:             order_id,&#xA;Jan 11 00:01:21 devserver mysqld:             order_orderNumber,&#xA;Jan 11 00:01:21 devserver mysqld:             order_orderValue,&#xA;Jan 11 00:01:21 devserver mysqld:             order_paymentMethod,&#xA;Jan 11 00:01:21 devserver mysqld:             order_sofortConfirmation,&#xA;Jan 11 00:01:21 devserver mysqld:             order_synced,&#xA;Jan 11 00:01:21 devserver mysqld:             order_timestamp,&#xA;Jan 11 00:01:21 devserver mysqld:             order_timestamp_lastChange,&#xA;Jan 11 00:01:21 devserver mysqld:             order_uuid,&#xA;Jan 11 00:01:21 devserver mysqld:             getFile(&quot;order&quot;,  NAME_CONST('orderUUID',_latin1'8A507ECC5B4F11E2B385F526BF61D66D' COLLATE 'latin1_swedish_ci'), &quot;session&quot;) AS order_session,&#xA;Jan 11 00:01:21 devserver mysqld:             getFile(&quot;order&quot;,  NAME_CONST('orderUUID',_latin1'8A507ECC5B4F11E2B385F526BF61D66D' COLLATE 'latin1_swedish_ci'), &quot;mailProtocol&quot;) AS order_confirmationMail_protocol,&#xA;Jan 11 00:01:21 devserver mysqld:             getFile(&quot;order&quot;,  NAME_CONST('orderUUID',_latin1'8A507ECC5B4F11E2B385F526BF61D66D' COLLATE 'latin1_swedish_ci'), &quot;mailConfirmation&quot;) AS order_confirmationMail_text,&#xA;Jan 11 00:01:21 devserver mysqld:             DATE_FORMAT(&#xA;Jan 11 00:01:21 devserver mysqld:                         order_timestamp,&#xA;Jan 11 00:01:21 devserver mysqld:                         &quot;%d.%m.%Y&quot;&#xA;Jan 11 00:01:21 devserver mysqld:                        ) AS order_timestamp_readable&#xA;Jan 11 00:01:21 devserver mysqld:         FROM `o&#xA;Jan 11 00:01:21 devserver mysqld: thd-&amp;gt;thread_id=17&#xA;Jan 11 00:01:21 devserver mysqld: thd-&amp;gt;killed=NOT_KILLED&#xA;Jan 11 00:01:21 devserver mysqld: The manual page at http://dev.mysql.com/doc/mysql/en/crashing.html contains&#xA;Jan 11 00:01:21 devserver mysqld: information that should help you find out what is causing the crash.&#xA;Jan 11 00:01:21 devserver mysqld_safe: Number of processes running now: 0&#xA;Jan 11 00:01:21 devserver mysqld_safe: mysqld restarted&#xA;Jan 11 00:01:22 devserver mysqld: 130111  0:01:22 [Note] Plugin 'FEDERATED' is disabled.&#xA;Jan 11 00:01:22 devserver mysqld: InnoDB: Log scan progressed past the checkpoint lsn 38 555424888&#xA;Jan 11 00:01:22 devserver mysqld: 130111  0:01:22  InnoDB: Database was not shut down normally!&#xA;Jan 11 00:01:22 devserver mysqld: InnoDB: Starting crash recovery.&#xA;Jan 11 00:01:22 devserver mysqld: InnoDB: Reading tablespace information from the .ibd files...&#xA;Jan 11 00:01:25 devserver mysqld: InnoDB: Restoring possible half-written data pages from the doublewrite&#xA;Jan 11 00:01:25 devserver mysqld: InnoDB: buffer...&#xA;Jan 11 00:01:25 devserver mysqld: InnoDB: Doing recovery: scanned up to log sequence number 38 555424898&#xA;Jan 11 00:01:26 devserver mysqld: 130111  0:01:26  InnoDB: Started; log sequence number 38 555424898&#xA;Jan 11 00:01:26 devserver mysqld: 130111  0:01:26 [ERROR] Can't open shared library 'lib_mysqludf_preg.so' (errno: 0 /usr/lib/mysql/plugin/lib_mysqludf_preg.so: cannot open shared object file: No such file or directory)&#xA;Jan 11 00:01:26 devserver last message repeated 5 times&#xA;Jan 11 00:01:26 devserver mysqld: 130111  0:01:26 [Warning] Neither --relay-log nor --relay-log-index were used; so replication may break when this MySQL server acts as a slave and has his hostname changed!! Please use '--relay-log=mysqld-relay-bin' to avoid this problem.&#xA;Jan 11 00:01:26 devserver mysqld: 130111  0:01:26 [Note] Event Scheduler: Loaded 0 events&#xA;Jan 11 00:01:26 devserver mysqld: 130111  0:01:26 [Note] /usr/sbin/mysqld: ready for connections.&#xA;Jan 11 00:01:26 devserver mysqld: Version: '5.1.49-3'  socket: '/var/run/mysqld/mysqld.sock'  port: 3306  (Debian)&#xA;Jan 11 00:01:27 devserver mysqld: 130111  0:01:27 [ERROR] /usr/sbin/mysqld: Table './mysql/proc' is marked as crashed and should be repaired&#xA;Jan 11 00:01:27 devserver mysqld: 130111  0:01:27 [Warning] Checking table:   './mysql/proc'&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;These are the files that are being read:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;[root@devserver order]# ls -l&#xA;total 140&#xA;-rw-rw-rw- 1 mysql staff 45366 Jan 10 18:59 8A507ECC5B4F11E2B385F526BF61D66D_mailConfirmation&#xA;-rw-rw-rw- 1 mysql staff 88389 Jan 10 18:59 8A507ECC5B4F11E2B385F526BF61D66D_mailProtocol&#xA;-rw-rw-rw- 1 mysql staff  2518 Jan 10 18:59 8A507ECC5B4F11E2B385F526BF61D66D_session&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And finally the statement to create the UDF:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;USE mysql;&#xA;&#xA;DROP FUNCTION IF EXISTS getFile;&#xA;CREATE FUNCTION getFile RETURNS STRING SONAME 'dbrw.so';&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1968330" LastEditorUserId="1968330" LastEditDate="2013-01-10T23:38:44.610" LastActivityDate="2013-01-11T09:57:35.120" Title="MySQL UDF for reading a file from disk: MySQL keeps crashing on every second UDF call" Tags="&lt;mysql&gt;&lt;c&gt;&lt;stored-procedures&gt;&lt;user-defined-functions&gt;" AnswerCount="3" CommentCount="1" FavoriteCount="1" />
  <row Id="14302846" PostTypeId="1" AcceptedAnswerId="14303882" CreationDate="2013-01-13T11:07:25.363" Score="1" ViewCount="5771" Body="&lt;p&gt;I'm trying to check whether a variable is defined using &lt;code&gt;ifndef/ifdef&lt;/code&gt;, but I keep getting a &lt;code&gt;not found&lt;/code&gt; error from the execution. I'm using &lt;code&gt;GNU Make 3.81&lt;/code&gt;, and here is a snippet of what I have:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;all: _images                 &#xA;    $(call clean, .)         &#xA;    $(call compile, .)       &#xA;    @$(OPENER) *.pdf &amp;amp;       &#xA;&#xA;_images:                     &#xA;    $(call clean, &quot;images&quot;)  &#xA;    $(call compile, &quot;images&quot;)&#xA;&#xA;define clean                                             &#xA;    @rm -f ${1}/*.log ${1}/*.aux ${1}/*.pdf              &#xA;endef                                                    &#xA;&#xA;define compile                                           &#xA;&#xA;    ifdef ${1}                                           &#xA;        dir = ${1}                                       &#xA;    else                                                 &#xA;        dir = .                                          &#xA;    endif                                                &#xA;&#xA;    ifdef ${2}                                           &#xA;        outdir = ${2}                                    &#xA;    else                                                 &#xA;        outdir = ${1}                                    &#xA;    endif                                                &#xA;&#xA;    @$(COMPILER) -output-directory ${outdir} ${dir}/*.tex&#xA;&#xA;endef                                                    &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And the exact error:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ make                       &#xA;ifdef  &quot;images&quot;              &#xA;/bin/sh: 1: ifdef: not found &#xA;make: *** [_images] Error 127&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Edit&lt;/strong&gt;:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Considering Barmar comments, here goes the conclusions:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The contents of a define are shell command lines, not make directives;&#xA;to break lines inside commands within a define block, the linebreak must be escaped -- with \;&#xA;also, each block corresponding to one-liner commands is executed separately, each in a different shell execution, which means that, defining local variables won't work if the intention is to access the variable value in the next one-liner block.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks tripleee for the nice work around.&lt;/p&gt;&#xA;" OwnerUserId="1655939" LastEditorUserId="1655939" LastEditDate="2013-01-13T14:04:39.917" LastActivityDate="2013-01-13T14:04:39.917" Title="Using ifdef and ifndef directives" Tags="&lt;bash&gt;&lt;makefile&gt;&lt;gnu-make&gt;&lt;conditional-compilation&gt;&lt;ifndef&gt;" AnswerCount="1" CommentCount="8" FavoriteCount="1" />
  <row Id="14341709" PostTypeId="1" AcceptedAnswerId="14342483" CreationDate="2013-01-15T16:01:54.140" Score="0" ViewCount="224" Body="&lt;p&gt;I'm trying to write a macro that will allow me to surround currently highlighted lines of text with an #ifdef. Ideally with the cursor placed after the #ifdef to be ready to enter the macro name. I'm able to record to create a macro, but I'm only able to do it for one line of code.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Before:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    bool first_selected_line = false;&#xA;    int second_selected_line = 0;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;After:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef // if possible, cursor placed here in insert mode&#xA;    bool first_selected_line = false;&#xA;    int second_selected_line = 0;&#xA;#else&#xA;    bool first_selected_line = false;&#xA;    int second_selected_line = 0;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Any ideas?&lt;/p&gt;&#xA;" OwnerUserId="605030" LastActivityDate="2013-01-15T20:32:16.430" Title="Surrounding multiple selected lines with #ifdef" Tags="&lt;vim&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="14349844" PostTypeId="1" AcceptedAnswerId="14349882" CreationDate="2013-01-16T01:05:45.680" Score="7" ViewCount="5812" Body="&lt;p&gt;On iOS &lt;code&gt;NSUInteger&lt;/code&gt; is a &lt;code&gt;unsigned int&lt;/code&gt;, on OSX it is a &lt;code&gt;unsigned long&lt;/code&gt;. How can I make a print statement like&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; NSLog(@&quot;Array has %d elements.&quot;,[array count]);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;compile on both platforms without a warning? I can of course use an &lt;code&gt;#ifdef #else #endif&lt;/code&gt; construct but that will add 4 lines of code. I could also cast the return value to unsigned int. Is there a shorter solution? &lt;/p&gt;&#xA;" OwnerUserId="115102" LastActivityDate="2015-08-07T11:42:42.510" Title="Compile NSLog with unsigned int and unsigned long on iOS and OSX without a warning" Tags="&lt;ios&gt;&lt;xcode&gt;&lt;osx&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="14478859" PostTypeId="1" CreationDate="2013-01-23T11:40:57.573" Score="0" ViewCount="986" Body="&lt;p&gt;I'm trying to build a project in VS2008 but I'm getting the following errors:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Error   1   error C2143: syntax error : missing ';' before '['&#xA;    C:\Program Files\Microsoft Visual Studio 9.0\VC\include\io.h    185 lmlib&#xA;.&#xA;.&#xA;.&#xA;Error   7   error C2143: syntax error : missing ';' before 'type'&#xA;    C:\Program Files\Microsoft Visual Studio 9.0\VC\include\io.h    192 lmlib&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This project works fine in VS2005, but why it doesn't  work VS2008?&#xA;Im attaching io.h file ,pls help me how to resolve these errors&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; #if _MSC_VER &amp;gt; 1000&#xA;    #pragma once&#xA;    #endif&#xA;&#xA;    #ifndef _INC_IO&#xA;    #define _INC_IO&#xA;&#xA;    #include &amp;lt;crtdefs.h&amp;gt;&#xA;&#xA;    #ifdef  _MSC_VER&#xA;    /*&#xA;     * Currently, all MS C compilers for Win32 platforms default to 8 byte&#xA;     * alignment.&#xA;     */&#xA;    #pragma pack(push,_CRT_PACKING)&#xA;    #endif  /* _MSC_VER */&#xA;&#xA;    #ifndef _POSIX_&#xA;&#xA;    #ifdef  __cplusplus&#xA;    extern &quot;C&quot; {&#xA;    #endif&#xA;&#xA;    #ifndef _FSIZE_T_DEFINED&#xA;    typedef unsigned long _fsize_t; /* Could be 64 bits for Win32 */&#xA;    #define _FSIZE_T_DEFINED&#xA;    #endif&#xA;&#xA;    #ifndef _FINDDATA_T_DEFINED&#xA;&#xA;    struct _finddata32_t {&#xA;        unsigned    attrib;&#xA;        __time32_t  time_create;    /* -1 for FAT file systems */&#xA;        __time32_t  time_access;    /* -1 for FAT file systems */&#xA;        __time32_t  time_write;&#xA;        _fsize_t    size;&#xA;        char        name[260];&#xA;    };&#xA;&#xA;    struct _finddata32i64_t {&#xA;        unsigned    attrib;&#xA;        __time32_t  time_create;    /* -1 for FAT file systems */&#xA;        __time32_t  time_access;    /* -1 for FAT file systems */&#xA;        __time32_t  time_write;&#xA;        __int64     size;&#xA;        char        name[260];&#xA;    };&#xA;&#xA;    struct _finddata64i32_t {&#xA;        unsigned    attrib;&#xA;        __time64_t  time_create;    /* -1 for FAT file systems */&#xA;        __time64_t  time_access;    /* -1 for FAT file systems */&#xA;        __time64_t  time_write;&#xA;        _fsize_t    size;&#xA;        char        name[260];&#xA;    };&#xA;&#xA;    struct __finddata64_t {&#xA;        unsigned    attrib;&#xA;        __time64_t  time_create;    /* -1 for FAT file systems */&#xA;        __time64_t  time_access;    /* -1 for FAT file systems */&#xA;        __time64_t  time_write;&#xA;        __int64     size;&#xA;        char        name[260];&#xA;    };&#xA;&#xA;    #ifdef _USE_32BIT_TIME_T&#xA;    #define _finddata_t     _finddata32_t&#xA;    #define _finddatai64_t  _finddata32i64_t&#xA;&#xA;    #define _findfirst      _findfirst32&#xA;    #define _findnext       _findnext32&#xA;    #define _findfirsti64   _findfirst32i64&#xA;    #define _findnexti64     _findnext32i64&#xA;&#xA;    #else&#xA;    #define _finddata_t     _finddata64i32_t&#xA;    #define _finddatai64_t  __finddata64_t&#xA;&#xA;    #define _findfirst      _findfirst64i32&#xA;    #define _findnext       _findnext64i32&#xA;    #define _findfirsti64   _findfirst64&#xA;    #define _findnexti64    _findnext64&#xA;&#xA;    #endif&#xA;&#xA;&#xA;    #define _FINDDATA_T_DEFINED&#xA;    #endif&#xA;&#xA;    #ifndef _WFINDDATA_T_DEFINED&#xA;&#xA;    struct _wfinddata32_t {&#xA;        unsigned    attrib;&#xA;        __time32_t  time_create;    /* -1 for FAT file systems */&#xA;        __time32_t  time_access;    /* -1 for FAT file systems */&#xA;        __time32_t  time_write;&#xA;        _fsize_t    size;&#xA;        wchar_t     name[260];&#xA;    };&#xA;&#xA;    struct _wfinddata32i64_t {&#xA;        unsigned    attrib;&#xA;        __time32_t  time_create;    /* -1 for FAT file systems */&#xA;        __time32_t  time_access;    /* -1 for FAT file systems */&#xA;        __time32_t  time_write;&#xA;        __int64     size;&#xA;        wchar_t     name[260];&#xA;    };&#xA;&#xA;    struct _wfinddata64i32_t {&#xA;        unsigned    attrib;&#xA;        __time64_t  time_create;    /* -1 for FAT file systems */&#xA;        __time64_t  time_access;    /* -1 for FAT file systems */&#xA;        __time64_t  time_write;&#xA;        _fsize_t    size;&#xA;        wchar_t     name[260];&#xA;    };&#xA;&#xA;    struct _wfinddata64_t {&#xA;        unsigned    attrib;&#xA;        __time64_t  time_create;    /* -1 for FAT file systems */&#xA;        __time64_t  time_access;    /* -1 for FAT file systems */&#xA;        __time64_t  time_write;&#xA;        __int64     size;&#xA;        wchar_t     name[260];&#xA;    };&#xA;&#xA;    #ifdef _USE_32BIT_TIME_T&#xA;    #define _wfinddata_t    _wfinddata32_t&#xA;    #define _wfinddatai64_t _wfinddata32i64_t&#xA;&#xA;    #define _wfindfirst     _wfindfirst32&#xA;    #define _wfindnext      _wfindnext32&#xA;    #define _wfindfirsti64  _wfindfirst32i64&#xA;    #define _wfindnexti64   _wfindnext32i64&#xA;&#xA;    #else                  &#xA;    #define _wfinddata_t    _wfinddata64i32_t&#xA;    #define _wfinddatai64_t _wfinddata64_t&#xA;&#xA;    #define _wfindfirst     _wfindfirst64i32&#xA;    #define _wfindnext      _wfindnext64i32&#xA;    #define _wfindfirsti64  _wfindfirst64&#xA;    #define _wfindnexti64   _wfindnext64&#xA;&#xA;    #endif&#xA;&#xA;    #define _WFINDDATA_T_DEFINED&#xA;    #endif&#xA;&#xA;    /* File attribute constants for _findfirst() */&#xA;&#xA;    #define _A_NORMAL       0x00    /* Normal file - No read/write restrictions */&#xA;    #define _A_RDONLY       0x01    /* Read only file */&#xA;    #define _A_HIDDEN       0x02    /* Hidden file */&#xA;    #define _A_SYSTEM       0x04    /* System file */&#xA;    #define _A_SUBDIR       0x10    /* Subdirectory */&#xA;    #define _A_ARCH         0x20    /* Archive file */&#xA;&#xA;    /* function prototypes */&#xA;&#xA;    #ifndef _SIZE_T_DEFINED&#xA;    #ifdef  _WIN64&#xA;    typedef unsigned __int64    size_t;&#xA;    #else&#xA;    typedef _W64 unsigned int   size_t;&#xA;    #endif&#xA;    #define _SIZE_T_DEFINED&#xA;    #endif&#xA;    //from this line onwards i got errors//&#xA;    _Check_return_ _CRTIMP int __cdecl _access(_In_z_ const char * _Filename, _In_ int      _AccessMode);&#xA;    _Check_return_wat_ _CRTIMP errno_t __cdecl _access_s(_In_z_ const char * _Filename,     _In_ int _AccessMode);&#xA;    _Check_return_ _CRTIMP int __cdecl _chmod(_In_z_ const char * _Filename, _In_ int   _Mode);&#xA;    /* note that the newly added _chsize_s takes a 64 bit value */&#xA;    _Check_return_ _CRTIMP int __cdecl _chsize(_In_ int _FileHandle, _In_ long _Size);&#xA;    _Check_return_wat_ _CRTIMP errno_t __cdecl _chsize_s(_In_ int _FileHandle,_In_ __int64   _Size);&#xA;    _Check_return_opt_ _CRTIMP int __cdecl _close(_In_ int _FileHandle);&#xA;    _Check_return_opt_ _CRTIMP int __cdecl _commit(_In_ int _FileHandle);&#xA;    _Check_return_ _CRT_INSECURE_DEPRECATE(_sopen_s) _CRTIMP int __cdecl _creat(_In_z_   const char * _Filename, _In_ int _PermissionMode);&#xA;    _Check_return_ _CRTIMP int __cdecl _dup(_In_ int _FileHandle);&#xA;    _Check_return_ _CRTIMP int __cdecl _dup2(_In_ int _FileHandleSrc, _In_ int  _FileHandleDst);&#xA;    _Check_return_ _CRTIMP int __cdecl _eof(_In_ int _FileHandle);&#xA;    _Check_return_ _CRTIMP long __cdecl _filelength(_In_ int _FileHandle);&#xA;    _Check_return_ _CRTIMP intptr_t __cdecl _findfirst32(_In_z_ const char * _Filename,   _Out_ struct _finddata32_t * _FindData);&#xA;    _Check_return_ _CRTIMP int __cdecl _findnext32(_In_ intptr_t _FindHandle, _Out_ struct   _finddata32_t * _FindData);&#xA;    _Check_return_opt_ _CRTIMP int __cdecl _findclose(_In_ intptr_t _FindHandle);&#xA;    _Check_return_ _CRTIMP int __cdecl _isatty(_In_ int _FileHandle);&#xA;    _CRTIMP int __cdecl _locking(_In_ int _FileHandle, _In_ int _LockMode, _In_ long   _NumOfBytes);&#xA;    _Check_return_opt_ _CRTIMP long __cdecl _lseek(_In_ int _FileHandle, _In_ long _Offset, _In_ int _Origin);&#xA;    _Check_return_wat_ _CRTIMP errno_t __cdecl _mktemp_s(_Inout_z_cap_(_Size) char * _TemplateName, _In_ size_t _Size);&#xA;   __DEFINE_CPP_OVERLOAD_SECURE_FUNC_0_0(errno_t, _mktemp_s, _Deref_prepost_z_ char,  _TemplateName)&#xA;    _Check_return_ __DEFINE_CPP_OVERLOAD_STANDARD_FUNC_0_0(char *, __RETURN_POLICY_DST,  _CRTIMP, _mktemp, _Inout_z_, char, _TemplateName)&#xA;    _Check_return_ _CRTIMP int __cdecl _pipe(_Inout_cap_c_(2) int * _PtHandles, _In_  unsigned int _PipeSize, _In_ int _TextMode);&#xA;    _Check_return_ _CRTIMP int __cdecl _read(_In_ int _FileHandle, _Out_bytecap_(_MaxCharCount) void * _DstBuf, _In_ unsigned int _MaxCharCount);&#xA;&#xA;    #ifndef _CRT_DIRECTORY_DEFINED&#xA;    #define _CRT_DIRECTORY_DEFINED&#xA;    _Check_return_ _CRTIMP int __cdecl remove(_In_z_ const char * _Filename);&#xA;    _Check_return_ _CRTIMP int __cdecl rename(_In_z_ const char * _OldFilename, _In_z_   const char * _NewFilename);&#xA;    _Check_return_ _CRTIMP int __cdecl _unlink(_In_z_ const char * _Filename);&#xA;    #if !__STDC__&#xA;    _Check_return_ _CRT_NONSTDC_DEPRECATE(_unlink) _CRTIMP int __cdecl unlink(_In_z_ const  char * _Filename);&#xA;    #endif&#xA;    #endif&#xA;&#xA;    _Check_return_ _CRTIMP int __cdecl _setmode(_In_ int _FileHandle, _In_ int _Mode);&#xA;    _Check_return_ _CRTIMP long __cdecl _tell(_In_ int _FileHandle);&#xA;    _CRT_INSECURE_DEPRECATE(_umask_s) _CRTIMP int __cdecl _umask(_In_ int _Mode);&#xA;    _Check_return_wat_ _CRTIMP errno_t __cdecl _umask_s(_In_ int _NewMode, _Out_ int *   _OldMode);&#xA;    _CRTIMP int __cdecl _write(_In_ int _FileHandle, _In_bytecount_(_MaxCharCount) const       void * _Buf, _In_ unsigned int _MaxCharCount);&#xA;&#xA;    _Check_return_ _CRTIMP __int64 __cdecl _filelengthi64(_In_ int _FileHandle);&#xA;    _Check_return_ _CRTIMP intptr_t __cdecl _findfirst32i64(_In_z_ const char * _Filename,     _Out_ struct _finddata32i64_t * _FindData);&#xA;    _Check_return_ _CRTIMP intptr_t __cdecl _findfirst64i32(_In_z_ const char * _Filename,   _Out_ struct _finddata64i32_t * _FindData);&#xA;    _Check_return_ _CRTIMP intptr_t __cdecl _findfirst64(_In_z_ const char * _Filename,   _Out_ struct __finddata64_t * _FindData);&#xA;    _Check_return_ _CRTIMP int __cdecl _findnext32i64(_In_ intptr_t _FindHandle, _Out_  struct _finddata32i64_t * _FindData);&#xA;    _Check_return_ _CRTIMP int __cdecl _findnext64i32(_In_ intptr_t _FindHandle, _Out_   struct _finddata64i32_t * _FindData);&#xA;    _Check_return_ _CRTIMP int __cdecl _findnext64(_In_ intptr_t _FindHandle, _Out_ struct  __finddata64_t * _FindData);&#xA;    _Check_return_opt_ _CRTIMP __int64 __cdecl _lseeki64(_In_ int _FileHandle, _In_ __int64  _Offset, _In_ int _Origin);&#xA;    _Check_return_ _CRTIMP __int64 __cdecl _telli64(_In_ int _FileHandle);&#xA;&#xA;    _Check_return_wat_ _CRTIMP errno_t __cdecl _sopen_s(_Out_ int * _FileHandle, _In_z_  const char * _Filename,_In_ int _OpenFlag, _In_ int _ShareFlag, _In_ int _PermissionMode);&#xA;&#xA;    #if !defined(__cplusplus)&#xA;    _Check_return_ _CRT_INSECURE_DEPRECATE(_sopen_s) _CRTIMP int __cdecl _open(_In_z_ const  char * _Filename, _In_ int _OpenFlag, ...);&#xA;    _Check_return_ _CRT_INSECURE_DEPRECATE(_sopen_s) _CRTIMP int __cdecl _sopen(_In_z_  const char * _Filename, _In_ int _OpenFlag, int _ShareFlag, ...);&#xA;    #else&#xA;&#xA;    /* these function do not validate pmode; use _sopen_s */&#xA;    extern &quot;C++&quot; _Check_return_ _CRT_INSECURE_DEPRECATE(_sopen_s) _CRTIMP int __cdecl   _open(_In_z_ const char * _Filename, _In_ int _Openflag, _In_ int _PermissionMode = 0);&#xA;    extern &quot;C++&quot; _Check_return_ _CRT_INSECURE_DEPRECATE(_sopen_s) _CRTIMP int __cdecl   _sopen(_In_z_ const char * _Filename, _In_ int _Openflag, _In_ int _ShareFlag, _In_ int   _PermissionMode = 0);&#xA;&#xA;    #endif&#xA;&#xA;    #ifndef _WIO_DEFINED&#xA;&#xA;    /* wide function prototypes, also declared in wchar.h  */&#xA;&#xA;    _Check_return_ _CRTIMP int __cdecl _waccess(_In_z_ const wchar_t * _Filename, _In_ int  _AccessMode);&#xA;    _Check_return_wat_ _CRTIMP errno_t __cdecl _waccess_s(_In_z_ const wchar_t * _Filename, _In_ int _AccessMode);&#xA;    _Check_return_ _CRTIMP int __cdecl _wchmod(_In_z_ const wchar_t * _Filename, _In_ int _Mode);&#xA;    _Check_return_ _CRT_INSECURE_DEPRECATE(_wsopen_s) _CRTIMP int __cdecl _wcreat(_In_z_ const wchar_t * _Filename, _In_ int _PermissionMode);&#xA;    _Check_return_ _CRTIMP intptr_t __cdecl _wfindfirst32(_In_z_ const wchar_t * _Filename,  _Out_ struct _wfinddata32_t * _FindData);&#xA;    _Check_return_ _CRTIMP int __cdecl _wfindnext32(_In_ intptr_t _FindHandle, _Out_ struct  _wfinddata32_t * _FindData);&#xA;    _Check_return_ _CRTIMP int __cdecl _wunlink(_In_z_ const wchar_t * _Filename);&#xA;    _Check_return_ _CRTIMP int __cdecl _wrename(_In_z_ const wchar_t * _OldFilename, _In_z_  const wchar_t * _NewFilename);&#xA;    _CRTIMP errno_t __cdecl _wmktemp_s(_Inout_z_cap_(_SizeInWords) wchar_t * _TemplateName,  _In_ size_t _SizeInWords);&#xA;    __DEFINE_CPP_OVERLOAD_SECURE_FUNC_0_0(errno_t, _wmktemp_s, _Deref_prepost_z_ wchar_t,  _TemplateName)&#xA;   __DEFINE_CPP_OVERLOAD_STANDARD_FUNC_0_0(wchar_t *, __RETURN_POLICY_DST, _CRTIMP,  _wmktemp, _Inout_z_, wchar_t, _TemplateName)&#xA;&#xA;    _Check_return_ _CRTIMP intptr_t __cdecl _wfindfirst32i64(_In_z_ const wchar_t *   _Filename, _Out_ struct _wfinddata32i64_t * _FindData);&#xA;    _Check_return_ _CRTIMP intptr_t __cdecl _wfindfirst64i32(_In_z_ const wchar_t * _Filename, _Out_ struct _wfinddata64i32_t * _FindData);&#xA;    _Check_return_ _CRTIMP intptr_t __cdecl _wfindfirst64(_In_z_ const wchar_t * _Filename,  _Out_ struct _wfinddata64_t * _FindData);&#xA;    _Check_return_ _CRTIMP int __cdecl _wfindnext32i64(_In_ intptr_t _FindHandle, _Out_  struct _wfinddata32i64_t * _FindData);&#xA;    _Check_return_ _CRTIMP int __cdecl _wfindnext64i32(_In_ intptr_t _FindHandle, _Out_  struct _wfinddata64i32_t * _FindData);&#xA;    _Check_return_ _CRTIMP int __cdecl _wfindnext64(_In_ intptr_t _FindHandle, _Out_ struct  _wfinddata64_t * _FindData);&#xA;&#xA;    _Check_return_wat_ _CRTIMP errno_t __cdecl _wsopen_s(_Out_ int * _FileHandle, _In_z_  const wchar_t * _Filename, _In_ int _OpenFlag, _In_ int _ShareFlag, _In_ int _PermissionFlag);&#xA;&#xA;    #if !defined(__cplusplus) || !defined(_M_IX86)&#xA;&#xA;    _Check_return_ _CRT_INSECURE_DEPRECATE(_wsopen_s) _CRTIMP int __cdecl _wopen(_In_z_  const wchar_t * _Filename, _In_ int _OpenFlag, ...);&#xA;    _Check_return_ _CRT_INSECURE_DEPRECATE(_wsopen_s) _CRTIMP int __cdecl _wsopen(_In_z_   const wchar_t * _Filename, _In_ int _OpenFlag, int _ShareFlag, ...);&#xA;&#xA;    #else&#xA;&#xA;    /* these function do not validate pmode; use _sopen_s */&#xA;    extern &quot;C++&quot; _CRT_INSECURE_DEPRECATE(_wsopen_s) _CRTIMP int __cdecl _wopen(_In_z_ const  wchar_t * _Filename, _In_ int _OpenFlag, _In_ int _PermissionMode = 0);&#xA;    extern &quot;C++&quot; _CRT_INSECURE_DEPRECATE(_wsopen_s) _CRTIMP int __cdecl _wsopen(_In_z_  const wchar_t * _Filename, _In_ int _OpenFlag, _In_ int _ShareFlag, int _PermissionMode =  0);&#xA;&#xA;    #endif&#xA;&#xA;    #define _WIO_DEFINED&#xA;    #endif&#xA;&#xA;    int  __cdecl __lock_fhandle(_In_ int _Filehandle);&#xA;    void __cdecl _unlock_fhandle(_In_ int _Filehandle);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1448763" LastEditorUserId="1448763" LastEditDate="2013-01-24T07:02:03.410" LastActivityDate="2013-01-24T07:02:03.410" Title="VS2008Compile errors in io.h file" Tags="&lt;c++&gt;&lt;visual-studio-2008&gt;" AnswerCount="2" CommentCount="6" />
  <row Id="14547495" PostTypeId="1" CreationDate="2013-01-27T12:48:57.093" Score="0" ViewCount="274" Body="&lt;p&gt;I would like to know how to evaluate ifdef ... else ... end statement which could be put anywhere in a code. I start with a simple example who implement 2 basic function add(p1,p2) and diff(p1,p2) where p1 and p2 are Strings. It only adds a + or a - in between p1 and p2. Here is my grammar:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;grammar ifdef;&#xA;&#xA;options {&#xA;  language = Java;&#xA;  output = AST;&#xA;  ASTLabelType=CommonTree;&#xA;}&#xA;&#xA;tokens &#xA;{&#xA;    EQUAL           = '=' ;&#xA;    HASH            = '#' ;&#xA;    DBLEQUOTE       = '&quot;' ;&#xA;    SEMICOLON       = ';' ;&#xA;}&#xA;&#xA;&#xA;@header {&#xA;    package Grammar;&#xA;&#xA;    import java.util.Map;&#xA;    import java.util.HashMap;&#xA;&#xA;}&#xA;&#xA;@lexer::header {&#xA;    package Grammar;    &#xA;}&#xA;&#xA;@members {&#xA;    private Map&amp;lt;String, String&amp;gt; strMapID = new HashMap&amp;lt;String, String&amp;gt;();&#xA;    private Map&amp;lt;String, String&amp;gt; strMapDefine = new HashMap&amp;lt;String, String&amp;gt;();&#xA;}&#xA;&#xA;&#xA;rule returns [String strEval]&#xA;    :   {   StringBuilder strBuilder = new StringBuilder(); }&#xA;    (   command&#xA;        {   if ( $command.str != &quot;&quot; ) {&#xA;                strBuilder.append( $command.str );&#xA;                strBuilder.append( &quot;\n&quot; );&#xA;            }&#xA;        }&#xA;&#xA;    )+ EOF&#xA;        { $strEval = strBuilder.toString(); }&#xA;    ;&#xA;&#xA;command returns [String str]&#xA;    :   define      { $str=&quot;&quot;; }&#xA;    |   undef       { $str=&quot;&quot;; }&#xA;    |   set         { $str=&quot;&quot;; }&#xA;    |   function    { $str = $function.str; }&#xA;    |   ifdef       { $str=&quot;&quot;; }&#xA;    ;&#xA;&#xA;define&#xA;    :   HASH 'define' ID&#xA;        { strMapDefine.put($ID.text, $ID.text); }       // save define ID into hash table&#xA;    ;&#xA;&#xA;undef&#xA;    :   HASH 'undef' ID&#xA;        {   if ( strMapDefine.containsKey($ID.text) ) {&#xA;                strMapDefine.remove($ID.text);          // undef ID in hash table&#xA;                }&#xA;        }&#xA;    ;&#xA;&#xA;set&#xA;    :   'set' ID EQUAL string SEMICOLON&#xA;        { strMapID.put($ID.text, $string.text); }       // save ID,string definition into hash table &#xA;    ;&#xA;&#xA;string&#xA;    :   DBLEQUOTE expr DBLEQUOTE&#xA;    ;&#xA;&#xA;function returns [String str]&#xA;    :   add     { $str = $add.str; }&#xA;    |   diff    { $str = $diff.str; }&#xA;    ;&#xA;&#xA;add returns [String str]&#xA;    :   'add' '(' p1=param ',' p2=param ')'&#xA;        {   StringBuilder strBuilder = new StringBuilder();&#xA;            strBuilder.append( $p1.str );&#xA;            strBuilder.append( &quot;+&quot; );&#xA;            strBuilder.append( $p2.str );&#xA;            $str = strBuilder.toString();&#xA;        }&#xA;    ;&#xA;&#xA;diff returns [String str]&#xA;    :   'diff' '(' p1=param ',' p2=param ')'&#xA;        {   StringBuilder strBuilder = new StringBuilder();&#xA;            strBuilder.append( $p1.str );&#xA;            strBuilder.append( &quot;-&quot; );&#xA;            strBuilder.append( $p2.str );&#xA;            $str = strBuilder.toString();&#xA;        }&#xA;    ;&#xA;&#xA;param returns [String str]&#xA;    :   ID          { $str = strMapID.get($ID.text); }      // assign ID definition to str&#xA;    |   string      { $str = $string.text; }&#xA;    |   function    { $str = $function.str; }&#xA;    ;&#xA;&#xA;ifdef&#xA;    :   {   Boolean bElse= false;&#xA;            StringBuilder strBuilder = new StringBuilder(); }&#xA;        HASH 'ifdef' '(' ID ')' c1=expr ( HASH 'else' c2=expr { bElse= true; } )? HASH 'end'&#xA;        {   if ( strMapDefine.containsKey($ID.text) ) {&#xA;                strBuilder.append($c1.text);&#xA;            }&#xA;            else {&#xA;                if ( bElse ) {&#xA;                    strBuilder.append($c2.text);&#xA;                }&#xA;            }&#xA;            System.out.println(&quot;ifdef content is : &quot; + strBuilder.toString() + &quot;\n&quot; );&#xA;        }&#xA;    ;&#xA;&#xA;expr&#xA;    :   .+&#xA;    ;&#xA;&#xA;ID&#xA;    :   ('a'..'z' | 'A'..'Z')+&#xA;    ;&#xA;&#xA;WS&#xA;    :   ( ' ' | '\t' | '\n' | '\r' ) {$channel=HIDDEN;}&#xA;    ;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and java main class&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;package Grammar;&#xA;&#xA;import java.io.IOException;&#xA;&#xA;import org.antlr.runtime.ANTLRFileStream;&#xA;import org.antlr.runtime.CharStream;&#xA;import org.antlr.runtime.CommonTokenStream;&#xA;import org.antlr.runtime.RecognitionException;&#xA;import org.antlr.runtime.TokenStream;&#xA;&#xA;import Grammar.ifdefParser.rule_return;&#xA;&#xA;&#xA;public class mainifdef {&#xA;&#xA;    public static void main(String[] args) throws RecognitionException {&#xA;        CharStream stream=null;&#xA;        try {&#xA;            stream = new ANTLRFileStream(&quot;src/input/test.txt&quot;);&#xA;        } catch (IOException e) {&#xA;            // TODO Auto-generated catch block&#xA;            e.printStackTrace();&#xA;        }&#xA;        ifdefLexer lexer = new ifdefLexer(stream);&#xA;        TokenStream tokenStream = new CommonTokenStream(lexer);&#xA;        ifdefParser parser = new ifdefParser(tokenStream);&#xA;        rule_return evaluator = parser.rule();&#xA;&#xA;        System.out.println(&quot;Parsing Tree is \n&quot; + evaluator.tree.toStringTree() + &quot;\n&quot;);&#xA;        System.out.println(&quot;Evaluation is \n&quot; + evaluator.strEval + &quot;\n&quot;);&#xA;&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;With input file content like:&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;#undef Z&lt;br&gt;&#xA;  set AB = &quot;toto&quot;;&lt;br&gt;&#xA;  set CD = &quot;titi&quot;;  &lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;diff(CD,&quot;essai&quot;)&lt;br&gt;&#xA;  #ifdef(Z) add( #end  &lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;add ( AB , diff( CD,&quot;essai&quot;) )  &lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;The result console is as expected&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;ifdef content is :  &lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;Parsing Tree is&lt;br&gt;&#xA;  # undef Z set AB = &quot; toto &quot; ; set CD = &quot; titi &quot; ; diff ( CD , &quot; essai &quot; ) # ifdef ( Z ) add ( # end add ( AB , diff ( CD , &quot; essai &quot; ) )   &lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;Evaluation is&lt;br&gt;&#xA;  &quot;titi&quot;-&quot;essai&quot;&lt;br&gt;&#xA;  &quot;toto&quot;+&quot;titi&quot;-&quot;essai&quot;  &lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;My question is how to do to evaluate such input text which should give same result :&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;#undef Z&lt;br&gt;&#xA;  set AB = &quot;toto&quot;;&lt;br&gt;&#xA;  set CD = &quot;titi&quot;;  &lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;diff(CD,&quot;essai&quot;)&lt;br&gt;&#xA;  #ifdef(Z) add( #end  &lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;add ( AB , #ifdef(Z) add( #else diff( #end CD,&quot;essai&quot;) )  &lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;The result console is (which is normal ANTLR behavior):&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;ifdef content is :  &lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;src/input/test.txt line 8:11 no viable alternative at input '#'&lt;br&gt;&#xA;  src/input/test.txt line 8:43 missing EOF at 'CD'&lt;br&gt;&#xA;  ifdef content is : diff(  &lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;Parsing Tree is&lt;br&gt;&#xA;  # undef Z set AB = &quot; toto &quot; ; set CD = &quot; titi &quot; ; diff ( CD , &quot; essai &quot; ) # ifdef ( Z ) add ( # end add ( AB , &amp;lt; unexpected: [@59,94:94='#',&amp;lt; 6 &gt;,8:11], resync=# &gt; &amp;lt; missing ')'&gt; # ifdef ( Z ) add ( # else diff ( # end &amp;lt; missing EOF &gt;&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;Evaluation is&lt;br&gt;&#xA;  &quot;titi&quot;-&quot;essai&quot;&lt;br&gt;&#xA;  &quot;toto&quot;+null  &lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;Some guidance where to start will be much more appreciate&lt;br&gt;&#xA;Regards JPM  &lt;/p&gt;&#xA;" OwnerUserId="2015393" LastActivityDate="2013-01-27T12:48:57.093" Title="ANTLR how to evaluate ifdef else end statement" Tags="&lt;antlr&gt;&lt;conditional-compilation&gt;" AnswerCount="0" CommentCount="4" />
  <row Id="14556336" PostTypeId="1" CreationDate="2013-01-28T06:07:40.147" Score="3" ViewCount="698" Body="&lt;p&gt;I have seen this code:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#if !defined(errno)&#xA;extern int errno;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;So my question is whether &lt;code&gt;errno&lt;/code&gt; is int or macro , because with &lt;code&gt;#if&lt;/code&gt; if can check macro defined or not and after we are doing &lt;code&gt;extern int errno;&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;in errno.h it is defined like this&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  _ERRNO_H&#xA;&#xA;/* Declare the `errno' variable, unless it's defined as a macro by&#xA;   bits/errno.h.  This is the case in GNU, where it is a per-thread&#xA;   variable.  This redeclaration using the macro still works, but it&#xA;   will be a function declaration without a prototype and may trigger&#xA;   a -Wstrict-prototypes warning.  */&#xA;#ifndef errno&#xA;extern int errno;&#xA;#endif&#xA;&#xA;&#xA;#endif &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1622022" LastEditorUserId="1622022" LastEditDate="2013-01-28T07:42:23.513" LastActivityDate="2013-01-28T07:42:23.513" Title="errno is int or macro in errno.h" Tags="&lt;c++&gt;" AnswerCount="2" CommentCount="2" />
  <row Id="14805073" PostTypeId="1" AcceptedAnswerId="14824398" CreationDate="2013-02-11T02:24:54.700" Score="0" ViewCount="361" Body="&lt;p&gt;I am working on a project where we import a 32x32 or 64x64 PBM image file. Sample is provided below:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;P1&#xA;# CREATOR: GIMP PNM Filter Version 1.1&#xA;32 32&#xA;01111110000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000001000000000000&#xA;00000000000001100000000000000000&#xA;00001100000000100011100000000000&#xA;00001100000000000000000000000000&#xA;00000011000000000000000000000000&#xA;00000011000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000011100000&#xA;01000101001000000000000000000000&#xA;01000101010000011100000000000000&#xA;01000101100000111000000000000000&#xA;01000101010000000000000000000000&#xA;01000101001000000000000000000000&#xA;00111001001000000000000001000000&#xA;00000000000000000000000001000000&#xA;00000000000000000000000001000000&#xA;00000000000000000000000000000000&#xA;00000000010000000000000000000000&#xA;00000000001000000000000000000000&#xA;00000000111000000000000000000000&#xA;00000000000000000000000110000000&#xA;00000000000000000000001001000000&#xA;00110000000000000000000110000000&#xA;01100000000000000110000000001000&#xA;00100000000000000110000000001100&#xA;00000000000000011000000000001100&#xA;00000000000000011000000000000100&#xA;00000000000000000000000000000000&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This is read into a 1D array and processed sequentially. I am attempting to break the 1D array into multiple arrays in a 4x4 pattern. Once broken into &quot;chunks&quot; the temporary smaller arrays will be distributed to multiple processing elements. After each smaller chunk has been processed the &quot;chunks&quot; will be sent back to the primary node to be reassembled. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;This is the complete code which is working in a sequential manner:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/*  life.c&#xA;&#xA;    Play Conway's Game of Life&#xA;&#xA;    Reads a P1 file in, outputs a P1 file.&#xA;&#xA;    Does as many timesteps as stated on the command line.&#xA;&#xA;    Uses a classic 1-element fake zone internally.&#xA;&#xA;    Jan. 30, 2013 by H. Dietz&#xA;*/&#xA;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;mpi.h&amp;gt;&#xA;&#xA;&#xA;unsigned char *&#xA;read_P1(int *xdim, int *ydim)&#xA;{&#xA;    register int c, x, y;&#xA;    register unsigned char *p;&#xA;&#xA;    if ((c = getchar()) != 'P') {&#xA;pbm_bad:&#xA;        fprintf(stderr, &quot;Bad PBM input\n&quot;);&#xA;        exit(1);&#xA;    }&#xA;    if ((c = getchar()) != '1') goto pbm_bad;&#xA;    c = getchar();&#xA;&#xA;#define Eat_Space \&#xA;    while ((c == ' ') || \&#xA;           (c == '\t') || \&#xA;           (c == '\n') || \&#xA;           (c == '\r') || \&#xA;           (c == '#')) { \&#xA;        if (c == '#') while ((c = getchar()) != '\n') ; \&#xA;        c = getchar(); \&#xA;    }&#xA;&#xA;    Eat_Space;      /* Eat white space and comments */&#xA;&#xA;#define Get_Number(n) \&#xA;    { \&#xA;        if ((c &amp;lt; '0') || (c &amp;gt; '9')) goto pbm_bad; \&#xA; \&#xA;        n = (c - '0'); \&#xA;        c = getchar(); \&#xA;        while ((c &amp;gt;= '0') &amp;amp;&amp;amp; (c &amp;lt;= '9')) { \&#xA;            n *= 10; \&#xA;            n += (c - '0'); \&#xA;            c = getchar(); \&#xA;        } \&#xA;    }&#xA;&#xA;    Get_Number(*xdim);  /* Get image width */&#xA;&#xA;    Eat_Space;      /* Eat white space and comments */&#xA;    Get_Number(*ydim);  /* Get image height */&#xA;&#xA;    p = ((unsigned char *)&#xA;         calloc(((*xdim + 2) * (*ydim + 2)),&#xA;            sizeof(unsigned char)));&#xA;    if (p == 0) goto pbm_bad;&#xA;&#xA;    Eat_Space;&#xA;&#xA;    for (y=0; y&amp;lt;*ydim; ++y) {&#xA;        for (x=0; x&amp;lt;*xdim; ++x) {&#xA;            Eat_Space;&#xA;            switch (c) {&#xA;            case '1':   p[x+1+((y+1)*(*xdim+2))] = 1; break;&#xA;            case '0':   /* 0 from calloc() */ break;&#xA;            default:    goto pbm_bad;&#xA;            }&#xA;            c = getchar();&#xA;        }&#xA;    }&#xA;&#xA;    return(p);&#xA;}&#xA;&#xA;#undef  Eat_Space&#xA;#undef  Get_Number&#xA;&#xA;&#xA;write_P1(register int xdim,&#xA;register int ydim,&#xA;register unsigned char *p)&#xA;{&#xA;    register int x, y, pos = 0;&#xA;&#xA;    printf(&quot;P1\n&quot;&#xA;           &quot;# CREATOR: P1IO\n&quot;&#xA;           &quot;%d %d\n&quot;,&#xA;           xdim,&#xA;           ydim);&#xA;&#xA;    for (y=0; y&amp;lt;ydim; ++y) {&#xA;        for (x=0; x&amp;lt;xdim; ++x) {&#xA;            int c = &quot;01&quot;[ p[x+1+((y+1)*(xdim+2))] != 0 ];&#xA;            putchar(c);&#xA;&#xA;            /* Keep lines even matrices */&#xA;            if ( (++pos)%xdim == 0) {&#xA;                putchar('\n');&#xA;            }&#xA;        }&#xA;    }&#xA;    putchar('\n');&#xA;}&#xA;&#xA;&#xA;int main(int argc, char **argv)&#xA;{&#xA;    if(MPI_Init(&amp;amp;argc, &amp;amp;argv) != MPI_SUCCESS){&#xA;        exit(1);&#xA;    }&#xA;&#xA;    int xdim, ydim;&#xA;    int iproc, nproc;&#xA;    register unsigned char *p, *q, *masterP;&#xA;    register int x, y, i, j, t, divisions, timesteps;&#xA;&#xA;    divisions = 4;&#xA;&#xA;    MPI_Comm_size(MPI_COMM_WORLD, &amp;amp;nproc); //nproc = number of PE&#xA;    MPI_Comm_rank(MPI_COMM_WORLD, &amp;amp;iproc); //iproc = position out of nproc&#xA;&#xA;    if (argc != 2) {&#xA;        fprintf(stderr, &quot;Usage: %s timesteps\n&quot;, argv[0]);&#xA;        exit(2);&#xA;    }&#xA;    timesteps = atoi(argv[1]);&#xA;&#xA;&#xA;    /* Carve p into 4x4 and send to 15 processing elements. PE0 will&#xA;    handle one chunk on its own */&#xA;    //if(iproc == 0){&#xA;        int masterx, mastery;&#xA;        /* Read the initial state image */&#xA;        masterP = read_P1(&amp;amp;masterx, &amp;amp;mastery);&#xA;        xdim = (masterx/divisions);&#xA;        ydim = (mastery/divisions);&#xA;&#xA;&#xA;        /* Make a temporary array to send each chunk of the image */&#xA;        p = ((unsigned char *)calloc((((xdim)+2) * ((ydim)+2)), &#xA;            sizeof(unsigned char)));&#xA;        if (p == 0) {&#xA;        fprintf(stderr, &quot;Calloc failed\n&quot;);&#xA;        exit(3);&#xA;        }&#xA;&#xA;        printf(&quot;Check master P\n&quot;);&#xA;        write_P1(masterx, mastery, masterP);&#xA;&#xA;&#xA;        int loopx , loopy;&#xA;        int cnt = 0;&#xA;        for(loopy = 0; loopy &amp;lt; divisions; ++loopy){&#xA;            for(loopx = 0; loopx &amp;lt; divisions; ++loopx){&#xA;                x=1;&#xA;                //Fill p&#xA;                for (j=(loopy*ydim)+1; j&amp;lt;((loopy+1)*ydim+2); ++j){&#xA;                    for( i=(loopx*xdim)+1; i&amp;lt;((loopx+1)*xdim+2); ++i){&#xA;                        //printf(&quot;j: %d i: %d\n&quot;,j,i);&#xA;                        p[x]=masterP[i+(loopy*j)+1];&#xA;                        printf(&quot;%d&quot;,p[x]);&#xA;                        x++;&#xA;                    }&#xA;                }&#xA;                //Print P contents&#xA;                printf(&quot;\nIteration Y:%d X:%d\n&quot;,loopy, loopx);&#xA;                write_P1(xdim, ydim, p);&#xA;&#xA;            }&#xA;        }&#xA;&#xA;&#xA;        //MPI_Send(p, sizeof(temp), MPI_UNSIGNED_CHAR, pe_num, 0, MPI_COMM_WORLD);&#xA;        //++pe_num;&#xA;&#xA;    //}/* End IProc 0's business */&#xA;&#xA;&#xA;    /* Make a target image (with blank fake zone) */&#xA;    q = ((unsigned char *)&#xA;         calloc(((xdim + 2) * (ydim + 2)),&#xA;            sizeof(unsigned char)));&#xA;    if (q == 0) {&#xA;        fprintf(stderr, &quot;Calloc failed\n&quot;);&#xA;        exit(3);&#xA;    }&#xA;&#xA;    /* Iterate over the timesteps */&#xA;    for (t=0; t&amp;lt;timesteps; ++t) {&#xA;#ifdef  VERBOSE&#xA;        fprintf(stderr, &quot;Timestep %d...\n&quot;, t);&#xA;#endif&#xA;&#xA;        for (y=0; y&amp;lt;ydim; ++y) {&#xA;            for (x=0; x&amp;lt;xdim; ++x) {&#xA;&#xA;#define FAKE(P, X, Y) P[((X)+1)+(((Y)+1)*(xdim+2))]&#xA;&#xA;                register int live = FAKE(p, x-1, y-1) +&#xA;                            FAKE(p, x, y-1) +&#xA;                            FAKE(p, x+1, y-1) +&#xA;                            FAKE(p, x-1, y) +&#xA;                            FAKE(p, x+1, y) +&#xA;                            FAKE(p, x-1, y+1) +&#xA;                            FAKE(p, x, y+1) +&#xA;                            FAKE(p, x+1, y+1);&#xA;&#xA;                /* Apply Conway's rules...&#xA;                   (yes, I know this is clever code!)&#xA;                */&#xA;                FAKE(q, x, y) = ((live == 3) ||&#xA;                         ((live == 2) &amp;amp;&amp;amp;&#xA;                          FAKE(p, x, y)));&#xA;            }&#xA;        }&#xA;&#xA;        /* Swap our notion of p and q...&#xA;           this saves us copying every timestep&#xA;        */&#xA;        {&#xA;            register unsigned char *pt = p;&#xA;            p = q;&#xA;            q = pt;&#xA;        }&#xA;    } /* End iterate timestep for block */&#xA;&#xA;    /* Done; write-out results */&#xA;    write_P1(masterx, mastery, q);&#xA;    exit(0);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The following should break the large array &lt;code&gt;masterP&lt;/code&gt; into 4x4 &quot;chunks&quot;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;int loopx , loopy;&#xA;int cnt = 0;&#xA;for(loopy = 0; loopy &amp;lt; divisions; ++loopy){&#xA;    for(loopx = 0; loopx &amp;lt; divisions; ++loopx){&#xA;        x=1;&#xA;        //Fill p&#xA;        for (j=(loopy*ydim)+1; j&amp;lt;((loopy+1)*ydim+2); ++j){&#xA;            for( i=(loopx*xdim)+1; i&amp;lt;((loopx+1)*xdim+2); ++i){&#xA;                //printf(&quot;j: %d i: %d\n&quot;,j,i);&#xA;                p[x]=masterP[i+(loopy*j)+1];&#xA;                printf(&quot;%d&quot;,p[x]);&#xA;                x++;&#xA;            }&#xA;        }&#xA;        //Print P contents&#xA;        printf(&quot;\nIteration Y:%d X:%d\n&quot;,loopy, loopx);&#xA;        write_P1(xdim, ydim, p);&#xA;&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;However, my resulting arrays are all 0. Is it improper to say&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;  p[x]=masterP[i+(loopy*j)+1];&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Array &lt;code&gt;p&lt;/code&gt; is an array created to be a 4x4 &quot;chunk&quot; of &lt;code&gt;masterP&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Sample output:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;P1  &#xA;# CREATOR: GIMP PNM Filter Version 1.1&#xA;32 32&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000001000000000000&#xA;00000000000001100000000000000000&#xA;00001100000000100011100000000000&#xA;00001100000000000000000000000000&#xA;00000011000000000000000000000000&#xA;00000011000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000011100000&#xA;01000101001000000000000000000000&#xA;01000101010000011100000000000000&#xA;01000101100000111000000000000000&#xA;01000101010000000000000000000000&#xA;01000101001000000000000000000000&#xA;00111001001000000000000001000000&#xA;00000000000000000000000001000000&#xA;00000000000000000000000001000000&#xA;00000000000000000000000000000000&#xA;00000000010000000000000000000000&#xA;00000000001000000000000000000000&#xA;00000000111000000000000000000000&#xA;00000000000000000000000110000000&#xA;00000000000000000000001001000000&#xA;00110000000000000000000110000000&#xA;01100000000000000110000000001000&#xA;001000000000000001100000000000001100&#xA;00000000000000011000000000000100&#xA;00000000000000000000000000000000&#xA;Check master P&#xA;P1&#xA;# CREATOR: P1IO&#xA;32 32&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000001000000000000&#xA;00000000000001100000000000000000&#xA;00001100000000100011100000000000&#xA;00001100000000000000000000000000&#xA;00000011000000000000000000000000&#xA;00000011000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000011100000&#xA;01000101001000000000000000000000&#xA;01000101010000011100000000000000&#xA;01000101100000111000000000000000&#xA;01000101010000000000000000000000&#xA;01000101001000000000000000000000&#xA;00111001001000000000000001000000&#xA;00000000000000000000000001000000&#xA;00000000000000000000000001000000&#xA;00000000000000000000000000000000&#xA;00000000010000000000000000000000&#xA;00000000001000000000000000000000&#xA;00000000111000000000000000000000&#xA;00000000000000000000000110000000&#xA;00000000000000000000001001000000&#xA;00110000000000000000000110000000&#xA;01100000000000000110000000001000&#xA;00100000000000000110000000001100&#xA;00000000000000011000000000001100&#xA;00000000000000011000000000000100&#xA;00000000000000000000000000000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:0 X:0&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:0 X:1&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:0 X:2&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:0 X:3&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:1 X:0&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:1 X:1&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:1 X:2&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:1 X:3&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:2 X:0&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:2 X:1&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:2 X:2&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:2 X:3&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:3 X:0&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:3 X:1&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:3 X:2&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;000000000000000000000000000000000000000000000000000000000000000000000000000000000&#xA;Iteration Y:3 X:3&#xA;P1&#xA;# CREATOR: P1IO&#xA;8 8&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;00000000&#xA;&#xA;P1&#xA;# CREATOR: P1IO&#xA;32 32&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000100000&#xA;11011100011111100111110000000000&#xA;11110001111110011111000111111000&#xA;00000000000101111100000000000111&#xA;00000000000000000010000000110111&#xA;01111110010000000100000001111110&#xA;00000100000000100000001101110000&#xA;00000000000000000000000000000000&#xA;00000000000000000001111100011111&#xA;01111100011111000111110001111100&#xA;11110000111100011111000111110001&#xA;11000111111001111100011111100111&#xA;00011111100111110001111110011111&#xA;01111110011111000111111001111100&#xA;11111001111100011111100111110001&#xA;11100111110001111110011111000111&#xA;10011111000111111001111100011111&#xA;01111100000000000111110001111110&#xA;11110001111110000000000000000100&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;00000000000000000000000000000000&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Thank you for your help!&lt;/p&gt;&#xA;" OwnerUserId="1691699" LastEditorUserId="1691699" LastEditDate="2013-02-11T02:55:00.690" LastActivityDate="2013-02-12T02:13:02.693" Title="Breaking 1D binary array into multiple smaller arrays for MPI, not filling appropriate data, what is missing?" Tags="&lt;c&gt;&lt;arrays&gt;&lt;mpi&gt;" AnswerCount="3" CommentCount="1" />
  <row Id="15013060" PostTypeId="1" CreationDate="2013-02-21T22:00:31.470" Score="1" ViewCount="237" Body="&lt;p&gt;After a thorough search of these forums, and being unable to find a relevant answer; I decided to ask you, the kind people of StackOverflow my question.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I currently have 3 (C++) libraries:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;p&gt;StaticLib (containing pure virtual interfaces and &quot;C&quot; style prototypes)&lt;/p&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;p&gt;DynamicLibLinux (containing Linux implementation of above prototypes)&lt;/p&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;p&gt;DynamicLibAndroid (not sure what to put in here)&lt;/p&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;The problem is, I don't want to change the StaticLib's code which is:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;struct IObject {&#xA; virtual ~IObject() {}&#xA; virtual void foo() = 0;&#xA;};&#xA;&#xA;extern &quot;C&quot; { &#xA; IObject* CreateObject();&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The DynamicLibLinux contains&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;IObject.h&amp;gt;&#xA;class Object : public IObject {&#xA;public:&#xA; virtual ~Object() {}&#xA; virtual void foo() {&#xA;  //do something incredibly useful here...&#xA; }&#xA;};&#xA;&#xA;#ifdef __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;IObject* CreateObject() {&#xA; return new Object;&#xA;}&#xA;#ifdef __cplusplus&#xA;}&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;after which, in my linux standalone, I can call the dlsym(&quot;libDynamicLibLinux.so&quot;) function to load my CreateObject function. And it all works like a charm. Now, here's the thing: I want to use the static library in an Android application as well. And I can't figure out how to implement this in JNI. So far I have something like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;IObject.h&amp;gt;&#xA;#include &amp;lt;jni.h&amp;gt;&#xA;class Object : public IObject {&#xA;... same as above&#xA;};&#xA;&#xA;#ifdef ...&#xA;JNIEXPORT IObject* JNICALL CreateObject(JNIEnv*) {&#xA; return new Object;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;which will, obviously, not work since the implementation doesn't match the declaration. So my question boils down to:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there any way I can use the C++ static lib &quot;as-is&quot; with JNI?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Kind regards and thank you for you patience,&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Emiel&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;EDIT:&lt;/strong&gt;&#xA;In the meantime, i've found something promising: javacpp. Does anyone here have experience with using this library?&lt;/p&gt;&#xA;" OwnerUserId="2097260" LastEditorUserId="2097260" LastEditDate="2013-02-22T00:53:40.343" LastActivityDate="2013-02-22T09:53:18.610" Title="C++ JNI interoperability" Tags="&lt;android&gt;&lt;c++&gt;&lt;jni&gt;&lt;shared-libraries&gt;&lt;static-libraries&gt;" AnswerCount="1" CommentCount="7" />
  <row Id="15024382" PostTypeId="1" CreationDate="2013-02-22T12:35:53.710" Score="0" ViewCount="222" Body="&lt;p&gt;I have a set of services that are provided through jar files (they are ad networks). I wnat to just add the networks I need for every project but have all code that handles the networks in just a class (It is called AdNetworkManager). For example with c# this is easily done having some symbols definined true or false and just wrap every ad network code with a #ifdef / #endif statements. Is this possible with java?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have read about having some static final constants but this does not work the way I need. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks in advance.&lt;/p&gt;&#xA;" OwnerUserId="574633" LastActivityDate="2013-02-22T12:45:30.843" Title="Something like #ifdef to let me not add all libs to my projects" Tags="&lt;java&gt;" AnswerCount="1" CommentCount="10" />
  <row Id="15081471" PostTypeId="1" AcceptedAnswerId="15081546" CreationDate="2013-02-26T04:41:16.073" Score="1" ViewCount="209" Body="&lt;p&gt;I have a class &lt;code&gt;A&lt;/code&gt;, and two classes, &lt;code&gt;B&lt;/code&gt; and &lt;code&gt;C&lt;/code&gt;, inheriting from &lt;code&gt;A&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Apart from the methods from &lt;code&gt;A&lt;/code&gt;, each class is to offer different things, and, therefore, I'd like to put them in two different files -- &lt;code&gt;b.hpp&lt;/code&gt; and &lt;code&gt;c.hpp&lt;/code&gt;, since they're templates with inline functions.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I also have a class &lt;code&gt;User&lt;/code&gt;, using both &lt;code&gt;B&lt;/code&gt; and &lt;code&gt;C&lt;/code&gt; classes. In &lt;code&gt;user.cpp&lt;/code&gt;, I should have something close to:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;# include &quot;b.hpp&quot;&#xA;# include &quot;c.hpp&quot;&#xA;&#xA;class User{&#xA;    ...;&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Which would raise a compiler redefinition error, for what I'm keeping both classes &lt;code&gt;B&lt;/code&gt; and &lt;code&gt;C&lt;/code&gt; in a &lt;code&gt;bc.hpp&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The concern here is rather aesthetic other than a programming error: I just don't find &lt;em&gt;very elegant&lt;/em&gt; using &lt;code&gt;ifdef / ifndef&lt;/code&gt; directives in small applications -- they always look to me like IDE's solution for people managing too many modules, and for those not even aware of the directives.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there any (&lt;em&gt;even nonstandard, but at least sane&lt;/em&gt;) workaround for this, or do I have to stick with either having two different classes in the same file and using &lt;code&gt;ifdef / ifndef&lt;/code&gt;?&lt;/p&gt;&#xA;" OwnerUserId="1655939" LastEditorUserId="4370109" LastEditDate="2016-06-29T19:01:43.067" LastActivityDate="2016-06-29T19:01:43.067" Title="Workaround for ifdef / ifndef" Tags="&lt;c++&gt;&lt;class&gt;&lt;templates&gt;&lt;c-preprocessor&gt;&lt;conditional-compilation&gt;" AnswerCount="3" CommentCount="0" />
  <row Id="15112042" PostTypeId="1" CreationDate="2013-02-27T12:21:56.670" Score="1" ViewCount="355" Body="&lt;p&gt;I build a virtual USB Bus (communicating via network with an linux box) as kext for OSX.&#xA;The main class is derived from an IOUSBControllerV3.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;It works under 10.6 32Bit, 10.7.5 64bit, 10.8 64bit, but failed to load&#xA;under 10.7.5 32bit due to (a?) pure virtual function. kextutil told me this.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I've compiled (Xcode 4.6) the kext under the same system, tried a lot of variations&#xA;which target system or SDK versions, but the problem is still resident?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I know that there are some #ifdef &lt;strong&gt;LP64&lt;/strong&gt; differences in the headers of the&#xA;base classes, especially in context of the pure virtual functions.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;But after two days of comparing and comparing the overloadings of the&#xA;pure virtual functions I have no idea why only 32bit makes trouble?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The same code works under the other systems, but Lion 32bit does not.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Many thanks in advance for every hint, &lt;/p&gt;&#xA;&#xA;&lt;p&gt;regards&#xA;    Markus&lt;/p&gt;&#xA;&#xA;&lt;p&gt;=========== terminal output:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;MacProTest:Developer ms$ sudo kextutil -t -v 2   MaCute.kext&#xA;Password:&#xA;Notice: MaCute.kext has debug properties set.&#xA;MaCute.kext appears to be loadable (not including linkage for on-disk libraries).&#xA;Loading MaCute.kext.&#xA;Reading load info for 13 kexts.&#xA;Created mkext for architecture i386 containing 1 kexts.&#xA;Loading MaCute.kext.&#xA;(kernel) Received request from user space to load kext de.seh.utn.MaCute.&#xA;(kernel) Loading kext de.seh.utn.MaCute.&#xA;(kernel) Allocated link buffer for kext de.seh.utn.MaCute at 0x1507000 (200704 bytes).&#xA;(kernel) kxld[de.seh.utn.MaCute]: This kext calls a pure virtual function. Make sure your kext's OSObject-derived classes implement all pure virtual functions.&#xA;(kernel) Can't load kext de.seh.utn.MaCute - link failed.&#xA;(kernel) Failed to load executable for kext de.seh.utn.MaCute.&#xA;(kernel) Kext de.seh.utn.MaCute failed to load (0xdc008016).&#xA;(kernel) Failed to load kext de.seh.utn.MaCute (error 0xdc008016).&#xA;Failed to load MaCute.kext - (libkern/kext) link error.&#xA;Failed to load MaCute.kext - (libkern/kext) link error.&#xA;Check library declarations for your kext with kextlibs(8).&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1876205" LastEditorUserId="1876205" LastEditDate="2013-02-27T15:44:27.340" LastActivityDate="2013-03-05T12:07:13.237" Title="Lion 32bit kext failed to load for pure virtual function but 64bit works" Tags="&lt;usb&gt;&lt;osx-lion&gt;&lt;32-bit&gt;&lt;kext&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="15271127" PostTypeId="1" CreationDate="2013-03-07T12:21:18.170" Score="2" ViewCount="478" Body="&lt;p&gt;there is a problem.&#xA;I need to link ffmpeg(particularly libavcodec) statically into visual studio 2008 project.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I  found  some visual studio solutions in internet but they are very old (around 0.6 version) and i need latest version, so this way is not an option for me.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Next, I made static build (with --enable-satic --disable-shared flags) using MinGW/msys and obtained (*.a) libraries in output.&#xA; In Visual Studio I go to the linker properities and add to Additional Dependencies(Linker-&gt;Input) libvacodec.a and libgcc.a.&#xA;Then i wrote simple application:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;extern &quot;C&quot;&#xA;{&#xA;   #ifdef  __STDC_CONSTANT_MACROS&#xA;      #define __STDC_CONSTANT_MACROS&#xA;   #endif&#xA;      #include &quot;libavcodec/avcodec.h&quot;    &#xA; }&#xA;&#xA;&#xA;&#xA;#include &quot;libavformat/avformat.h&quot;&#xA;&#xA;      int main()&#xA;   {&#xA;    av_register_all();&#xA;    return 0;&#xA;   }&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Compilation of this code was succeeded but linking failed. There is an error was obtained:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;error  LNK2019: unresolved external symbol &quot;void __cdecl av_register(void)&quot; (?av_register_all@@YAXXZ) referenced in function _main.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;So, there are two questions:&lt;/p&gt;&#xA;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;p&gt;How to  link  Visual Studio application with libavcodec.a ?&lt;/p&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;p&gt;If it possible, where can i get visual studio solution which includes ffmpeg latest version?&lt;/p&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;p&gt;Thanks in advance!!&lt;/p&gt;&#xA;" OwnerUserId="1657348" LastActivityDate="2013-06-23T21:37:38.030" Title="ffmpeg latest visual studio builds or linking with (.a) libs" Tags="&lt;visual-studio-2008&gt;&lt;gcc&gt;&lt;ffmpeg&gt;&lt;static-linking&gt;&lt;solution&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="2" />
  <row Id="15285927" PostTypeId="1" CreationDate="2013-03-08T02:58:05.107" Score="1" ViewCount="738" Body="&lt;p&gt;In UNIX Network Programming Volume 1:Figure 6-22 ,there is a piece of code as follows:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* include fig01 */&#xA;#include    &quot;unp.h&quot;&#xA;&#xA;int main(int argc, char **argv)&#xA;{&#xA;&#xA;int                 i, maxi, maxfd, listenfd, connfd, sockfd;&#xA;int                 nready, client[FD_SETSIZE];&#xA;ssize_t             n;&#xA;fd_set              rset, allset;&#xA;char                buf[MAXLINE];&#xA;socklen_t           clilen;&#xA;struct sockaddr_in  cliaddr, servaddr;&#xA;&#xA;listenfd = Socket(AF_INET, SOCK_STREAM, 0);&#xA;&#xA;bzero(&amp;amp;servaddr, sizeof(servaddr));&#xA;servaddr.sin_family      = AF_INET;&#xA;servaddr.sin_addr.s_addr = htonl(INADDR_ANY);&#xA;servaddr.sin_port        = htons(SERV_PORT);&#xA;&#xA;Bind(listenfd, (SA *) &amp;amp;servaddr, sizeof(servaddr));&#xA;&#xA;Listen(listenfd, LISTENQ);&#xA;&#xA;maxfd = listenfd;           /* initialize */&#xA;maxi = -1;                  /* index into client[] array */&#xA;for (i = 0; i &amp;lt; FD_SETSIZE; i++)&#xA;    client[i] = -1;         /* -1 indicates available entry */&#xA;FD_ZERO(&amp;amp;allset);&#xA;FD_SET(listenfd, &amp;amp;allset);&#xA;/* end fig01 */&#xA;&#xA;/* include fig02 */&#xA;for ( ; ; ) {&#xA;    rset = allset;      /* structure assignment */&#xA;    nready = Select(maxfd+1, &amp;amp;rset, NULL, NULL, NULL);&#xA;&#xA;    if (FD_ISSET(listenfd, &amp;amp;rset)) {    /* new client connection */&#xA;        clilen = sizeof(cliaddr);&#xA;        connfd = Accept(listenfd, (SA *) &amp;amp;cliaddr, &amp;amp;clilen);&#xA;#ifdef  NOTDEF&#xA;        printf(&quot;new client: %s, port %d\n&quot;,&#xA;                Inet_ntop(AF_INET, &amp;amp;cliaddr.sin_addr, 4, NULL),&#xA;                ntohs(cliaddr.sin_port));&#xA;#endif&#xA;&#xA;        for (i = 0; i &amp;lt; FD_SETSIZE; i++)&#xA;            if (client[i] &amp;lt; 0) {&#xA;                client[i] = connfd; /* save descriptor */&#xA;                break;&#xA;            }&#xA;        if (i == FD_SETSIZE)&#xA;            err_quit(&quot;too many clients&quot;);&#xA;&#xA;        FD_SET(connfd, &amp;amp;allset);    /* add new descriptor to set */&#xA;        if (connfd &amp;gt; maxfd)&#xA;            maxfd = connfd;         /* for select */&#xA;        if (i &amp;gt; maxi)&#xA;            maxi = i;               /* max index in client[] array */&#xA;&#xA;        if (--nready &amp;lt;= 0)&#xA;            continue;               /* no more readable descriptors */&#xA;    }&#xA;&#xA;    for (i = 0; i &amp;lt;= maxi; i++) {   /* check all clients for data */&#xA;        if ( (sockfd = client[i]) &amp;lt; 0)&#xA;            continue;&#xA;        if (FD_ISSET(sockfd, &amp;amp;rset)) {&#xA;            if ( (n = Read(sockfd, buf, MAXLINE)) == 0) {&#xA;                    /*4connection closed by client */&#xA;                Close(sockfd);&#xA;                FD_CLR(sockfd, &amp;amp;allset);&#xA;                client[i] = -1;&#xA;            } else&#xA;                Writen(sockfd, buf, n);&#xA;&#xA;            if (--nready &amp;lt;= 0)&#xA;                break;              /* no more readable descriptors */&#xA;        }&#xA;    }&#xA;}&#xA;}&#xA;/* end fig02 */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I want to know how to use &quot;epoll&quot; instead &quot;select&quot; in here,But I have little knowledge about epoll,so can anyone give me some points ? Thanks.&lt;/p&gt;&#xA;" OwnerUserId="1761489" LastActivityDate="2013-03-08T10:57:29.497" Title="How to use epoll instead of select in this code?" Tags="&lt;unix&gt;&lt;network-programming&gt;&lt;epoll&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="1" />
  <row Id="15338879" PostTypeId="1" AcceptedAnswerId="15359165" CreationDate="2013-03-11T12:43:13.037" Score="3" ViewCount="3516" Body="&lt;p&gt;I have a &lt;strong&gt;C Project&lt;/strong&gt; which uses a &lt;strong&gt;C++ library&lt;/strong&gt;. However, if i compile the C Project i get a long list of &lt;em&gt;&quot;undefined reference to XY&quot;&lt;/em&gt; errors.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Those errors are caused by C++ references:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Errors while compiling:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;In function `&amp;lt;c function&amp;gt;':&#xA;implicit declaration of function `&amp;lt;function&amp;gt;'&#xA;[...]&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;em&gt;(list shorted)&lt;/em&gt;&lt;br&gt;&#xA;Where &lt;em&gt;&amp;lt;c function&amp;gt;&lt;/em&gt; is the calling function from C Project and &lt;em&gt;&amp;lt;function&amp;gt;&lt;/em&gt; the function from the C++ library.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Errors while linking:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;undefined reference to `std::cerr'&#xA;undefined reference to `std::basic_ostream&amp;lt;char, std::char_traits&amp;lt;char&amp;gt; &amp;gt;&amp;amp; std::operator&amp;lt;&amp;lt; &amp;lt;std::char_traits&amp;lt;char&amp;gt; &amp;gt;(std::basic_ostream&amp;lt;char, std::char_traits&amp;lt;char&amp;gt; &amp;gt;&amp;amp;, char const*)'&#xA;undefined reference to `std::basic_ostream&amp;lt;char, std::char_traits&amp;lt;char&amp;gt; &amp;gt;&amp;amp; std::operator&amp;lt;&amp;lt; &amp;lt;char, std::char_traits&amp;lt;char&amp;gt;, std::allocator&amp;lt;char&amp;gt; &amp;gt;(std::basic_ostream&amp;lt;char, std::char_traits&amp;lt;char&amp;gt; &amp;gt;&amp;amp;, std::basic_string&amp;lt;char, std::char_traits&amp;lt;char&amp;gt;, std::allocator&amp;lt;char&amp;gt; &amp;gt; const&amp;amp;)'&#xA;[...]&#xA;undefined reference to `__gxx_personality_v0'&#xA;more undefined references to `__gxx_personality_v0' follow&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;em&gt;(lots of errors - example shorted)&lt;/em&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;In the static C++ library my types / functions are enclosed by &lt;code&gt;extern &quot;C&quot;&lt;/code&gt; block:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  __cplusplus&#xA;extern &quot;C&quot;&#xA;{&#xA;#endif&#xA;&#xA;    void example();&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;To ensure this, all the &lt;code&gt;#include&lt;/code&gt;'s referring to C++ library are surrounded by such a &lt;code&gt;extern &quot;C&quot;&lt;/code&gt; block too.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Compiler:&lt;/strong&gt; The &lt;em&gt;C++ library&lt;/em&gt; is compiled using &lt;strong&gt;g++&lt;/strong&gt;, the &lt;em&gt;C project&lt;/em&gt; using &lt;strong&gt;gcc&lt;/strong&gt; - both from &lt;strong&gt;MinGW&lt;/strong&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;CL (Linking):&lt;/strong&gt; &lt;code&gt;gcc -L&amp;lt;search-path here&amp;gt; -shared [...] -lstdc++ -l&amp;lt;C++ library set here&amp;gt;&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;em&gt;Please note the &lt;code&gt;-lstdc++&lt;/code&gt; flag.&lt;/em&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The C project contains only &lt;code&gt;.c&lt;/code&gt; and &lt;code&gt;.h&lt;/code&gt; files – no &lt;code&gt;.cpp&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Putting a &quot;dummy&quot; cpp file in like stated &lt;a href=&quot;http://stackoverflow.com/questions/376966/using-c-c-static-libraries-from-iphone-objectivec-apps&quot;&gt;here&lt;/a&gt; didn't work&lt;/li&gt;&#xA;&lt;li&gt;MinGW and Eclipse CDT Indigo&lt;/li&gt;&#xA;&lt;li&gt;The C++ Library has a name like &lt;code&gt;lib&amp;lt;NAME&amp;gt;.a&lt;/code&gt; - it's linked with &lt;code&gt;-l&amp;lt;NAME&amp;gt;&lt;/code&gt;, search path is set.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;h1&gt;Edit:&lt;/h1&gt;&#xA;&#xA;&lt;p&gt;Using &lt;code&gt;g++&lt;/code&gt; as linker: &lt;code&gt;undefined reference to&lt;/code&gt;std::cerr'` etc. are gone, but i get another list of errors:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Warning: .drectve `-aligncomm:&quot;___hexdig_D2A&quot;,5' unrecognized&#xA;undefined reference to `&amp;lt;function / class / method from C++ Library&amp;gt;'&#xA;[...]&#xA;undefined reference to `_Unwind_Resume'&#xA;[...]&#xA;undefined reference to `__gxx_personality_v0'&#xA;more undefined references to `__gxx_personality_v0' follow&#xA;undefined reference to `__chkstk_ms'&#xA;[...]&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;em&gt;(list shorted)&lt;/em&gt; &lt;/p&gt;&#xA;&#xA;&lt;p&gt;eg. &lt;code&gt;_Unwind_Resume&lt;/code&gt; is available in &lt;code&gt;nm&lt;/code&gt; of the c++ library.&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;h1&gt;Example:&lt;/h1&gt;&#xA;&#xA;&lt;p&gt;This part is in the Library (C++):&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Test.h&lt;/strong&gt; - Header&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef TEST_H_&#xA;#define TEST_H_&#xA;&#xA;// --- Pure C++ here ---&#xA;#ifdef __cplusplus&#xA;&#xA;#include &amp;lt;string&amp;gt;     /* (1) */&#xA;class Test&#xA;{&#xA;public:&#xA;    Test();&#xA;&#xA;&#xA;    void aMethod();&#xA;&#xA;private:&#xA;    int i;&#xA;};&#xA;#endif&#xA;&#xA;// --- Mixed (C / C++ ) here ---&#xA;&#xA;#ifdef __cplusplus&#xA;extern &quot;C&quot;&#xA;{&#xA;#endif&#xA;&#xA;    extern void doTest();&#xA;    extern void invoke();&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif /* TEST_H_ */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Test.cpp&lt;/strong&gt; - Implementation of C++ part&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;Test.h&quot;&#xA;&#xA;&#xA;Test::Test() : i(0) { }&#xA;&#xA;void Test::aMethod()&#xA;{&#xA;    this-&amp;gt;i++;&#xA;}&#xA;&#xA;&#xA;void invoke()&#xA;{&#xA;    Test i;&#xA;    i.aMethod();&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Test.c&lt;/strong&gt; - Implementation of C Interface (still in library!)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;Test.h&quot;&#xA;&#xA;void doTest()&#xA;{&#xA;    invoke();&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Now, here comes the part of the second project (pure C):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;Test.h&quot;&#xA;&#xA;&#xA;int main(int argc, char* argv[])&#xA;{&#xA;    doTest();&#xA;&#xA;    return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;(1)&lt;/code&gt;&lt;/strong&gt;: If i remove that include i can compile the C Project. But adding one include for any kind of class or c++ stuff causes lots of errors while linking. unfortunately i need to include classes etc..&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Btw. here's the error i get for this example:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Test.cpp:(.text+0x1b): undefined reference to `std::basic_string&amp;lt;char, std::char_traits&amp;lt;char&amp;gt;, std::allocator&amp;lt;char&amp;gt; &amp;gt;::basic_string()'&#xA;Test.cpp:(.text+0x64): undefined reference to `_Unwind_Resume'&#xA;Test.cpp:(.text$_ZN4TestD1Ev[Test::~Test()]+0x12): undefined reference to `std::basic_string&amp;lt;char, std::char_traits&amp;lt;char&amp;gt;, std::allocator&amp;lt;char&amp;gt; &amp;gt;::~basic_string()'&#xA;Test.cpp:(.eh_frame+0x6b): undefined reference to `__gxx_personality_v0'&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;setting &lt;code&gt;-lstdc++&lt;/code&gt; flag after (!) the flag for the library i get &quot;only&quot; these:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Test.cpp:(.text+0x64): undefined reference to `_Unwind_Resume'&#xA;Test.cpp:(.eh_frame+0x6b): undefined reference to `__gxx_personality_v0'&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1622894" LastEditorUserId="1622894" LastEditDate="2013-03-13T23:16:55.473" LastActivityDate="2013-05-17T11:12:19.680" Title="Using a C++ Library in a C Project causes a long list of errors" Tags="&lt;c++&gt;&lt;c&gt;&lt;eclipse&gt;&lt;gcc&gt;&lt;mingw&gt;" AnswerCount="2" CommentCount="6" />
  <row Id="15579950" PostTypeId="1" CreationDate="2013-03-22T21:14:26.400" Score="0" ViewCount="621" Body="&lt;p&gt;Im programming client/server app that client provide the file name then the server send it to client then the client will save it ..&lt;/p&gt;&#xA;&#xA;&lt;p&gt;so i want to make signal handler to handle zombie problem between parent and child so this code for signal :&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;enter code here&#xA;&#xA;Sigfunc *&#xA;signal(int signo, Sigfunc *func)&#xA;{&#xA;    struct sigaction    act, oact;&#xA;&#xA;    act.sa_handler = func;&#xA;    sigemptyset(&amp;amp;act.sa_mask);&#xA;    act.sa_flags = 0;&#xA;    if (signo == SIGALRM) {&#xA;#ifdef    SA_INTERRUPT&#xA;        act.sa_flags |= SA_INTERRUPT;    /* SunOS 4.x */&#xA;#endif&#xA;    } else {&#xA;#ifdef    SA_RESTART&#xA;        act.sa_flags |= SA_RESTART;        /* SVR4, 44BSD */&#xA;#endif&#xA;    }&#xA;    if (sigaction(signo, &amp;amp;act, &amp;amp;oact) &amp;lt; 0)&#xA;        return(SIG_ERR);&#xA;    return(oact.sa_handler);&#xA;}&#xA;/* end signal */&#xA;&#xA;The filename is : myHeader.h&#xA;and the error when compile the file is :&#xA;&#xA;gcc -Wall -I/home/zmhnk/Desktop/ -o &quot;myHeader&quot; &quot;myHeader.h&quot; (in directory: /home/zmhnk/Desktop)&#xA;myHeader.h:281:1: error: unknown type name ‘Sigfunc’&#xA;myHeader.h:282:19: error: unknown type name ‘Sigfunc’&#xA;Compilation failed.&#xA;&#xA;so how to solve this problem ???&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="2103930" LastActivityDate="2013-03-22T21:21:14.547" Title="Implement Signal() using sigaction() in ubuntu" Tags="&lt;c&gt;&lt;unix&gt;&lt;network-programming&gt;&lt;signals&gt;&lt;handler&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="15687138" PostTypeId="1" CreationDate="2013-03-28T16:26:24.467" Score="0" ViewCount="341" Body="&lt;p&gt;I have a piece of code that has to be run both on a CPU and CUDA-GPU and an other piece of code running on CPU alone. &#xA;&lt;code&gt;#define ENABLE_CUDA&lt;/code&gt; is what i 'turn on' to enable the CUDA code in the entire application.&#xA;Here is what my code looks like....&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;# define ENABEL_CUDA is the preprocessor directive to turn ON/OFF CUDA code.&#xA;&#xA;CPU and GPU code --This piece of code has to be executed irrespective of whether CUDA is ON / OFF.&#xA;&#xA;standalone CPU code alone -- This piece of code has to be executed only if CUDA is OFF.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;My solution is : &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef ENABLE_CUDA&#xA;&#xA;  CPU AND GPU code&#xA;# else&#xA;  CPU AND GPU code&#xA;  standalone CPU code &#xA;# endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But this involves code duplication (CPU AND GPU code) in both the ifdef and else blocks, I would like to avoid it.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;How can I accomplish it? What has to be done inorder to avoid duplication of code ? Any pointers regarding this appreciated...&lt;/p&gt;&#xA;" OwnerUserId="1801733" LastEditorUserId="16287" LastEditDate="2013-03-28T16:27:01.993" LastActivityDate="2013-03-28T22:14:43.620" Title="#ifdef / #ifndef and #endif" Tags="&lt;c++&gt;&lt;cuda&gt;" AnswerCount="3" CommentCount="1" />
  <row Id="15714812" PostTypeId="1" AcceptedAnswerId="15715139" CreationDate="2013-03-30T03:57:55.447" Score="1" ViewCount="295" Body="&lt;p&gt;I'd like to control the branding for my NSIS installer by passing a parameter to makensis:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;makensis.exe /DCOMPANY_X=1 installer.nsi  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The following are the first few lines listed in my NSI file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;!ifdef ${COMPANY_X}&#xA;  !define PRODUCT_NAME &quot;Widget Pro&quot;&#xA;  !define PRODUCT_VERSION &quot;v2.0&quot;&#xA;  !define PRODUCT_PUBLISHER &quot;ACE Company&quot;&#xA;  !define PRODUCT_WEB_SITE &quot;www.ace.com&quot;&#xA;  !define PRODUCT_COPYRIGHT &quot;Copyright 2013 Ace&quot;&#xA;!else&#xA;  !define PRODUCT_NAME &quot;Widget Maker&quot;&#xA;  !define PRODUCT_VERSION &quot;v12.3&quot;&#xA;  !define PRODUCT_PUBLISHER &quot;ACME CO&quot;&#xA;  !define PRODUCT_WEB_SITE &quot;www.acme.com&quot;&#xA;  !define PRODUCT_COPYRIGHT &quot;Copyright 2013 ACME&quot;&#xA;!endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I use these defines throughout my script.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The problem I'm encountering is that even with COMPANY_X defined on the command line, execution is passing through to the second block of defines (ACME).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Being new to NSIS, I'm sure there's a better way to handle this. I'd also like to use a switch statement to define multiple companies. If I do this, the compiler warns me that I need to place this code in a section or function.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;One thing that might complicate a solution for this is that I'm signing my uinstaller with a two pass process:&#xA;&lt;a href=&quot;http://nsis.sourceforge.net/Signing_an_Uninstaller&quot; rel=&quot;nofollow&quot;&gt;http://nsis.sourceforge.net/Signing_an_Uninstaller&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Kudos to the NSIS team and all the contributors. No way I'd ever go back to InstallShield.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks in advance for any help.&lt;/p&gt;&#xA;" OwnerUserId="1096739" LastEditorUserId="200936" LastEditDate="2013-03-31T00:57:54.663" LastActivityDate="2013-03-31T00:57:54.663" Title="Using NSIS command line to globally define product definitions" Tags="&lt;command-line-arguments&gt;&lt;nsis&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="16382589" PostTypeId="1" AcceptedAnswerId="16387218" CreationDate="2013-05-05T08:03:45.773" Score="3" ViewCount="2037" Body="&lt;p&gt;How to achieve Perl regular expression ^ and $ in the ANLTR4 lexer? ie. to match the start of a line and end of a line without consuming any character.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I am trying to use ANTLR4 lexer to match a # character at the start of a line but not in the middle of a line For example, to isolate and toss out all C++ preprocessor directives regardless of which directive it is while disregard a # inside a string literal.  (Normally we can tokenize C++ string literals to eliminate a # appearing in the middle of a line but assuming we're not doing that).  That means I only want to specify # .*? without bothering #if #ifndef #pragma, etc.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Also, the C++ standard allows whitespace and multi line comments right before and after the # e.g. &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;   /* helo&#xA;world*/  #  /* hel&#xA;l&#xA;o&#xA;*/  /*world */ifdef .....&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;is considered a valid preprocessor directive appearing on a single line. (the CRLFs inside the ML COMMENTs are tossed)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This's what I am doing currently:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;PPLINE: '\r'? '\n' (ML_COMMENT | '\t' | '\f' |' ')* '#' (ML_COMMENT | ~[\r\n])+ -&amp;gt; channel(PPDIR); &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But the problem is I have to rely on the existence of a CRLF before the # and toss out that CRLF altogether with the directive. I need to replace the CRLF tossed out by the CRLF of this directive line so I've to make sure the directive is terminated by a CRLF.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;However, that means my grammar cannot handle a directive appearing right at the start of file (i.e. no preceding CRLF) or preceded by an EOF without terminating CRLF.  &lt;/p&gt;&#xA;&#xA;&lt;p&gt;If the Perl style regex ^ $ syntax is available, I can match the SOL/EOL instead of explicitly matching and consuming CRLF.&lt;/p&gt;&#xA;" OwnerUserId="237575" LastEditorUserId="237575" LastEditDate="2013-05-05T09:33:01.610" LastActivityDate="2013-05-05T17:37:35.430" Title="ANTLR4 Lexer Matching Start of Line End Of Line" Tags="&lt;regex&gt;&lt;antlr4&gt;" AnswerCount="2" CommentCount="0" FavoriteCount="3" />
  <row Id="16565002" PostTypeId="1" CreationDate="2013-05-15T12:28:33.147" Score="2" ViewCount="351" Body="&lt;p&gt;I am trying to program a C++ Wrapper for TWAIN with Visual Studio 2012, Windows 7.&#xA;I have installed Twain SDK and have all DLL like Twain_32.dll in C:/Windows&#xA;I have twain.h : &lt;a href=&quot;https://svn.apache.org/repos/asf/incubator/ooo/trunk/main/twain/inc/twain.h&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/incubator/ooo/trunk/main/twain/inc/twain.h&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;And I have my main :&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;   #include &amp;lt;windows.h&amp;gt;&#xA;   #include &quot;twain.h&quot;&#xA;&#xA;int main()&#xA;{&#xA;   return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And I get 200 errors like for this line &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  _MSWIN_&#xA;typedef HANDLE TW_HANDLE; &#xA;typedef LPVOID TW_MEMREF;&#xA;&#xA;error C2146: syntax error : missing ';' before identifier 'TW_HANDLE'&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;How can I resolve that ?&lt;/p&gt;&#xA;" OwnerUserId="2385830" LastEditorUserId="2385830" LastEditDate="2013-05-15T12:47:13.817" LastActivityDate="2013-05-15T12:47:13.817" Title="Error in official Twain header VS2012 C++" Tags="&lt;c++&gt;&lt;visual-studio-2012&gt;&lt;twain&gt;" AnswerCount="0" CommentCount="6" />
  <row Id="16569039" PostTypeId="1" CreationDate="2013-05-15T15:23:20.573" Score="0" ViewCount="397" Body="&lt;p&gt;I want to make a Google Chrome plugin that use Twain to remote control a Digital Camera.&#xA;I want this to run on Windows and I'm using Visual Studio Express 2012 C++.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have &lt;a href=&quot;http://code.google.com/p/npapi-chrome-plugin-helloworld-example/&quot; rel=&quot;nofollow&quot;&gt;this&lt;/a&gt; sample for NPAPI and &lt;a href=&quot;http://www.codeproject.com/Articles/296/A-C-Wrapper-for-TWAIN&quot; rel=&quot;nofollow&quot;&gt;this&lt;/a&gt; sample of CppWrapper for Twain which has 3 interesting files (TwainCpp.cpp TwainCpp.h twain.h)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Before doing anything, I want to merge these two projects. &lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;First step: putting twain.h in the npsimple project which failed, twain.h  errors caught.&lt;/li&gt;&#xA;&lt;li&gt;Second step: putting CppTwain in npsimple, which also failed because twain.h &quot;contains&quot; errors.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;Problem is that when I create an empty project, and put twain.h in it, there is no error! So I tried to put npsimple files in that empty project, and this time I get error from npsimple files..&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Error type : &#xA;I have this code in twain.h :&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  _MSWIN_&#xA;typedef HANDLE TW_HANDLE; &#xA;typedef LPVOID TW_MEMREF;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and I get plenty of errors like :&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;error C2146: syntax error : missing ';' before identifier 'TW_HANDLE'&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;How can I merge these projects?&lt;/p&gt;&#xA;" OwnerUserId="2385830" LastEditorUserId="2385830" LastEditDate="2013-05-15T16:53:54.373" LastActivityDate="2013-05-16T14:13:03.827" Title="Visual Studio C++ NPAPI plugin with Twain support" Tags="&lt;c++&gt;&lt;google-chrome&gt;&lt;visual-studio-2012&gt;&lt;npapi&gt;&lt;twain&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="16581888" PostTypeId="1" AcceptedAnswerId="16581996" CreationDate="2013-05-16T07:55:53.520" Score="3" ViewCount="207" Body="&lt;p&gt;I was wondering if there is some pro and contra having include statements directly in the include files as opposed to have them in the source file.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Personally I like to have my includes &quot;clean&quot; so, when I include them in some c/cpp file I don't have to hunt down every possible header required because the include file doesn't take care of it itself. On the other hand, if I have the includes in the include files compile time might get bigger, because even with the include guards, the files have to be parsed first. Is this just a matter of taste, or are there any pros/cons over the other?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What I mean is:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;sample.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef ...&#xA;&#xA;#include &quot;my_needed_file.h&quot;&#xA;#include ...&#xA;&#xA;class myclass&#xA;{&#xA;}&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;sample.c&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;sample.h&quot;&#xA;&#xA;my code goes here&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Versus:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;sample.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef ...&#xA;&#xA;class myclass&#xA;{&#xA;}&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;sample.c&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;my_needed_file.h&quot;&#xA;#include ...&#xA;#include &quot;sample.h&quot;&#xA;&#xA;my code goes here&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="2282011" LastEditorUserId="1132871" LastEditDate="2013-05-16T08:50:42.710" LastActivityDate="2013-05-16T11:12:06.963" Title="Best practice for including from include files" Tags="&lt;c++&gt;" AnswerCount="6" CommentCount="7" FavoriteCount="0" />
  <row Id="16589908" PostTypeId="1" AcceptedAnswerId="16590284" CreationDate="2013-05-16T14:18:05.643" Score="0" ViewCount="187" Body="&lt;p&gt;I want to add conditions to show certain layout/theme based on build, for example:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I want to define a constant for 2 apps (both debug and release)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#IFDEF APP1.Debug   &#xA;   --- display layout 1&#xA;#IFDEF APP1.Release&#xA;   --- display layout 2&#xA;#IFDEF  APP2.Debug&#xA;   --- display layout 3&#xA;#IFDEF  APP2.Release&#xA;   --- display layout 4&#xA;#ELSE&#xA;  --- display layout 5&#xA;#ENDIF&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;How do setup the constant names (above) in Visual Studio 2010? How do they show up under DEBUG and RElease?&lt;/p&gt;&#xA;" OwnerUserId="1069456" LastActivityDate="2013-05-16T14:33:10.437" Title="How do you define constantname for #IfDEF (VS 2010)?" Tags="&lt;visual-studio-2010&gt;&lt;build&gt;&lt;constants&gt;&lt;conditional-compilation&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="16633542" PostTypeId="1" AcceptedAnswerId="16633633" CreationDate="2013-05-19T10:14:05.373" Score="1" ViewCount="313" Body="&lt;p&gt;I have written some utility code to detect memory leaks when a program closes.  detect_leaks.hpp and cpp contain the function which sets things up and in a program you would just call the start_detecting() function at program start.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Note this code uses the Microsoft debug functions so only applicable to Windows.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My report prints out the line in the file with the leaked allocation for new because I have this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define new new(_CLIENT_BLOCK,__FILE__, __LINE__)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But how would I do the same thing for malloc?  Or I don't mind changing name to eg mmalloc if required.  Yes I know I shouldn't be using malloc, but I have some very old code.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is the code so far:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;detect_leaks.hpp:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef __DETECT_LEAKS_HPP__&#xA;#define __DETECT_LEAKS_HPP__&#xA;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#include &amp;lt;malloc.h&amp;gt;&#xA;#include &amp;lt;crtdbg.h&amp;gt;&#xA;&#xA;#define new new(_CLIENT_BLOCK,__FILE__, __LINE__)&#xA;&#xA;// The following macros set and clear, respectively, given bits&#xA;// of the C runtime library debug flag, as specified by a bitmask.&#xA;#ifdef   _DEBUG&#xA;#define  SET_CRT_DEBUG_FIELD(a) \&#xA;    _CrtSetDbgFlag((a) | _CrtSetDbgFlag(_CRTDBG_REPORT_FLAG))&#xA;#define  CLEAR_CRT_DEBUG_FIELD(a) \&#xA;    _CrtSetDbgFlag(~(a) &amp;amp; _CrtSetDbgFlag(_CRTDBG_REPORT_FLAG))&#xA;#else&#xA;#define  SET_CRT_DEBUG_FIELD(a)   ((void) 0)&#xA;#define  CLEAR_CRT_DEBUG_FIELD(a) ((void) 0)&#xA;#endif&#xA;&#xA;void start_detecting();&#xA;&#xA;#endif // __DETECT_LEAKS_HPP__&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;detect_leaks.cpp:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;detect_leaks.hpp&quot;&#xA;&#xA;void start_detecting() {&#xA;    // Send all reports to STDOUT&#xA;    _CrtSetReportMode( _CRT_WARN, _CRTDBG_MODE_FILE );&#xA;    _CrtSetReportFile( _CRT_WARN, _CRTDBG_FILE_STDOUT );&#xA;    _CrtSetReportMode( _CRT_ERROR, _CRTDBG_MODE_FILE );&#xA;    _CrtSetReportFile( _CRT_ERROR, _CRTDBG_FILE_STDOUT );&#xA;    _CrtSetReportMode( _CRT_ASSERT, _CRTDBG_MODE_FILE );&#xA;    _CrtSetReportFile( _CRT_ASSERT, _CRTDBG_FILE_STDOUT );&#xA;&#xA;    // Set the debug-heap flag so that freed blocks are kept on the&#xA;    // linked list, to catch any inadvertent use of freed memory&#xA;    SET_CRT_DEBUG_FIELD( _CRTDBG_DELAY_FREE_MEM_DF );&#xA;&#xA;    // Set the debug-heap flag so that memory leaks are reported when the process terminates.&#xA;    SET_CRT_DEBUG_FIELD( _CRTDBG_LEAK_CHECK_DF );&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;main.cpp (sample usage):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;detect_leaks.hpp&quot;&#xA;&#xA;int  main()&#xA;{&#xA;    start_detecting();&#xA;&#xA;    char* s = (char*)malloc(100);&#xA;    strcpy(s, &quot;ABC leak1&quot;);&#xA;&#xA;    char* s1 = new char[100]();&#xA;    strcpy(s1, &quot;ABC leak2&quot;);&#xA;&#xA;    return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Sample printout:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Detected memory leaks!&#xA;Dumping objects -&amp;gt;&#xA;\memleak_malloc\main.cpp(10) : {74} client block at 0x00161A90, subtype 0, 100 bytes long.&#xA; Data: &amp;lt;ABC leak2       &amp;gt; 41 42 43 20 6C 65 61 6B 32 00 00 00 00 00 00 00&#xA;{73} normal block at 0x00164F50, 100 bytes long.&#xA; Data: &amp;lt;ABC leak1       &amp;gt; 41 42 43 20 6C 65 61 6B 31 00 CD CD CD CD CD CD&#xA;Object dump complete.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="619818" LastEditorUserId="8331" LastEditDate="2013-05-19T10:27:19.033" LastActivityDate="2013-05-19T10:27:19.033" Title="How to override general malloc so I get line number printed in memory leak printout" Tags="&lt;c++&gt;&lt;debugging&gt;&lt;memory-leaks&gt;&lt;malloc&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="16794425" PostTypeId="1" AcceptedAnswerId="16794533" CreationDate="2013-05-28T14:17:54.103" Score="3" ViewCount="184" Body="&lt;p&gt;I need to compile the same code with two different libraries. One allows the objects to be const, the other doesn't. The solution that's implemented now looks like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef (OLDLIB)&#xA;    ClassFoo TheFoo = Bar();&#xA;#else&#xA;    const ClassFoo TheFoo = Bar();&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This is used many times for different classes and impedes readability. I'd like to make the distinction somewhere else. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I guess one could say:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef (OLDLIB)&#xA;#define CLASS_FOO ClassFoo&#xA;#define CLASS_BAR ClassBar&#xA;#else&#xA;#define CLASS_FOO const ClassFoo&#xA;#define CLASS_BAR const ClassBar&#xA;#endif&#xA;&#xA;CLASS_FOO TheFoo = Bar();&#xA;CLASS_BAR TheBar = FooBar();&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But I dislike preprocessor stuff. Is there a nice C++-Way of doing the above? Thanks.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Update 1:&#xA;As Peter Wood said, it is possible to just instantiate them non-const. I changed the sentence.&lt;/p&gt;&#xA;" OwnerUserId="1210825" LastEditorUserId="1210825" LastEditDate="2013-05-29T08:48:16.900" LastActivityDate="2013-05-29T08:48:16.900" Title="Elegantly reuse code adding const to a class instantiation" Tags="&lt;c++&gt;&lt;const&gt;&lt;c-preprocessor&gt;" AnswerCount="4" CommentCount="3" />
  <row Id="17127665" PostTypeId="1" CreationDate="2013-06-15T20:36:57.687" Score="-1" ViewCount="108" Body="&lt;p&gt;Searching a files contents to remove lines between pre-compile directives that have a $DEBUG character.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Typical pattern for data lines searching for:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#IFDEF $DEBUG_MY_TEST&#xA;.... lines ...&#xA;#ENDIF&#xA;&#xA;&#xA;#IFDEF DEBUG_MY_issues for_sam&#xA;.... lines ...&#xA;#ENDIF&#xA;&#xA;#IFDEF CMER for_max&#xA;.... lines ....&#xA;#ENDIF&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This expression test works:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;if { [regexp -lineanchor -nocase -- {^[ \t]*#IFDEF[ \t]+[\$]?DEBUG.*} $oline_strpd ] == 1 } {&#xA;  set remove_to_cust_endif $oline_strpd; # sanity check&#xA;  continue;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I believe the problem is using the &lt;code&gt;$&lt;/code&gt; character in the string variable pattern.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Making a search using this string variable method is not working? :&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;set RE_STRNG [format &quot;\{^\[ \\t\]*#IFDEF\[ \\t\]+\[\\$\]?DEBUG.*\}&quot;]&#xA;if { [regexp -lineanchor -nocase -- $RE_STRNG $oline_strpd ] == 1 } {&#xA;  set remove_to_cust_endif $oline_strpd; # sanity check&#xA;  continue;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;In a previous line in the code using this string variable method is working:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;set RE_STRNG [format &quot;\{^\[ \\t\]*#IFDEF\[ \\t\]+CMER\[ \\t\]+%s\}&quot; $is_cmer_name ]; # insert name into the search pattern&#xA;if { [regexp -lineanchor -nocase -- $RE_STRNG $oline_strpd ] == 1 &amp;amp;&amp;amp; [llength $oline_strpd] == 3 } {&#xA;      set print_to_cust_endif $oline_strpd; # sanity check&#xA;      continue;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="2406910" LastEditorUserId="2255089" LastEditDate="2013-06-15T23:45:51.833" LastActivityDate="2013-06-16T14:39:54.037" Title="regexp function behavior using a string variable to define an expression" Tags="&lt;regex&gt;&lt;tcl&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="17447838" PostTypeId="1" CreationDate="2013-07-03T12:21:09.567" Score="-3" ViewCount="592" Body="&lt;p&gt;I am working on very legacy code which is migration to 32 bit to 64 bit machine.it generally write file with data which was working fine in 32 bit but having issue in 64 bit machine.When I check the file and found that it is generally contain division of 4 of 32 bit value. I mean if we have 80 value in 32 bit machine than it will be 20 in 64 bit machine.(most case). I have  looked into below piece of code and could not understand some of functionality.&lt;/p&gt;&#xA;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;p&gt;why we call reverse function before write into File.&lt;/p&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;p&gt;What is purpose of reverse function.&lt;/p&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;p&gt;In write function,we always write one_ascii value although we have any data type.&lt;/p&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;p&gt;I have tried to took some piece of code which help me to explain issue briefly.Please let &#xA;me know if I need to provide more information. &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;class  GdsHeader&#xA;{&#xA;public:&#xA;  unsigned  short  rlen;&#xA;  char      record_type;&#xA;  char      data_type;&#xA;};&#xA;&#xA;class  GdsRecord&#xA;{&#xA;public:&#xA;#ifndef SWIG&#xA;  union&#xA;    {&#xA;    short    *two_int;&#xA;    int     *four_int;&#xA;    double   *eight_real;&#xA;    char     *one_ascii;&#xA;//    void    *v;&#xA;    };&#xA;#endif&#xA;  int  length;&#xA;&#xA;      GdsRecord (); // { v = 0; length = 0; }&#xA;      ~GdsRecord ()  ;//  { delete v; }&#xA;  void  len (int l, int type);&#xA;};&#xA;&#xA;&#xA;&#xA;&#xA;    class  GdsBlock&#xA;    {&#xA;      bool      valid_block ();&#xA;      int      len;&#xA;&#xA;    public:&#xA;&#xA;      bool      record_unred;&#xA;      int      header_ftell;&#xA;      GdsHeader  h;&#xA;      GdsRecord  r;&#xA;      int      array_size;&#xA;    //  bool      re_read;&#xA;&#xA;    //          GdsBlock () { re_read = false; }&#xA;              GdsBlock () { record_unred = false; header_ftell = 0; }&#xA;      void      set (int rt, int dt, int sz)&#xA;                {TBE;&#xA;                h.record_type = rt;    h.data_type = dt;&#xA;                array_size = sz;       r.len (sz, dt);TBX;&#xA;                }&#xA;       int      read_header (FILE *);&#xA;      void      read_block (FILE *);&#xA;&#xA;      void      write (FILE *);&#xA;      void      prt ();&#xA;    };&#xA;&#xA;&#xA;&#xA;    void  GdsRecord :: len (int l, int type)&#xA;{&#xA;&#xA;  switch (type)&#xA;    {&#xA;    case STREAM_Bit_array:&#xA;    case STREAM_Short:  l *= 2; break;&#xA;    case STREAM_Long:    l *= 4; break;&#xA;    case STREAM_Double:  l *= 8; break;&#xA;    }&#xA;  if (l &amp;gt; length)&#xA;    {&#xA;    l = ((l / 8) + 2) * 8;&#xA;    if (one_ascii) delete [] one_ascii;&#xA;    one_ascii = new char[l];&#xA;    debug2.printf(&quot;GdsRecord::len  new one_ascii  len %d   one_ascii %X\n&quot;,l, one_ascii);&#xA;    length = l;&#xA;    }&#xA;&#xA;}&#xA;&#xA;&#xA;#ifndef sparc&#xA;        static  void  reverse (int len, char *buf)&#xA;        {&#xA;          TBE;&#xA;          char  tmp[24];&#xA;         int  i;&#xA;          for (i = 0; i &amp;lt; len; i++) tmp[i] = buf[i];&#xA;          for (i = 0; i &amp;lt; len; i++) buf[i] = tmp[ (len - 1) - i];&#xA;          TBX;&#xA;        }&#xA;        inline  void  reverse (int len, short *s)  { reverse (len, (char *) s); }&#xA;        inline  void  reverse (int len, int *s)    {  reverse (len, (char *) s); }&#xA;        inline  void  reverse (int len, double *s)  { reverse (len, (char *) s); }&#xA;        inline  void  reverse (int len, unsigned char *s)  {reverse (len, (char *) s); }&#xA;        #endif&#xA;&#xA;void    GdsBlock :: write (FILE *outstr)&#xA;{&#xA;TBE;&#xA;debug.printf(&quot;GdsBlock::write %X\n&quot;,outstr);&#xA;  int  i, err;&#xA;  char  *c, tmp;&#xA;  if (h.data_type == 3)&#xA;  {&#xA;      cout&amp;lt;&amp;lt;&quot;Begin...blk.r.four_int[0] =&amp;gt;&quot;&amp;lt;&amp;lt;r.four_int[0]&amp;lt;&amp;lt;endl;&#xA;  }&#xA;  if (!this)&#xA;    error.printf_exit(&quot;GdsBlock::write error !this\n&quot;);&#xA;&#xA;  if (!outstr)&#xA;    error.printf_exit (&quot;GdsBlock::write  Error - outstr == 0\n&quot;);&#xA;&#xA;  err = ferror(outstr);&#xA;  cout&amp;lt;&amp;lt; __LINE__&amp;lt;&amp;lt;&quot;    &quot;&amp;lt;&amp;lt;__PRETTY_FUNCTION__&amp;lt;&amp;lt;endl;&#xA;  if (err)&#xA;    { {&#xA;    char  *s = strerror (err);&#xA;    fclose (outstr);&#xA;    error.printf_exit (&quot;GdsBlock::write  error - %s, errno %d\n&quot;, s, err);&#xA;    }&#xA;  switch(h.data_type)&#xA;    {&#xA;    case 0: /* NO DATA */&#xA;      h.rlen = 4;&#xA;  cout&amp;lt;&amp;lt; __LINE__&amp;lt;&amp;lt;&quot;    &quot;&amp;lt;&amp;lt;__PRETTY_FUNCTION__&amp;lt;&amp;lt;endl;&#xA;      break;&#xA;      case 1: /* BIT ARRAY */&#xA;  cout&amp;lt;&amp;lt; __LINE__&amp;lt;&amp;lt;&quot;    &quot;&amp;lt;&amp;lt;__PRETTY_FUNCTION__&amp;lt;&amp;lt;endl;&#xA;#ifndef sparc&#xA;       reverse (2, &amp;amp;r.two_int[0]);&#xA;#endif&#xA;      h.rlen = (2 * array_size) + 4;&#xA;      break;&#xA;      case 2: /* TWO BYTE SIGNED INTEGER */&#xA;  cout&amp;lt;&amp;lt; __LINE__&amp;lt;&amp;lt;&quot;    &quot;&amp;lt;&amp;lt;__PRETTY_FUNCTION__&amp;lt;&amp;lt;endl;&#xA;#ifndef sparc&#xA;      for (i = 0; i &amp;lt; array_size; i++)    reverse(2,&amp;amp;r.two_int[i]);&#xA;#endif&#xA;      h.rlen = (2 * array_size) + 4;&#xA;      break;&#xA;      case 3: /* FOUR BYTE SIGNED INTEGER */&#xA;  cout&amp;lt;&amp;lt; __LINE__&amp;lt;&amp;lt;&quot;    &quot;&amp;lt;&amp;lt;__PRETTY_FUNCTION__&amp;lt;&amp;lt;endl;&#xA;#ifndef sparc&#xA;      for(i = 0; i &amp;lt; array_size; i++)&#xA;      {&#xA;          cout&amp;lt;&amp;lt;r.four_int[i]&amp;lt;&amp;lt;endl;&#xA;          int *temp = &amp;amp;r.four_int[i];&#xA;          reverse(4,temp);&#xA;          //print_stacktrace();&#xA;          cout&amp;lt;&amp;lt;r.four_int[i]&amp;lt;&amp;lt;endl;&#xA;          //r.four_int[i] = r.four_int[i] &amp;lt;&amp;lt; 2 ;&#xA;      }&#xA;&#xA;#endif&#xA;      h.rlen = (4 * array_size) + 4;&#xA;      break;&#xA;      case 5: /* EIGHT BYTE REAL */&#xA;  cout&amp;lt;&amp;lt; __LINE__&amp;lt;&amp;lt;&quot;    &quot;&amp;lt;&amp;lt;__PRETTY_FUNCTION__&amp;lt;&amp;lt;endl;&#xA;#ifndef  FPC&#xA;        for (i = 0; i &amp;lt; array_size; i++)    getr ((CONV *) (r.eight_real + i));&#xA;#endif&#xA;#ifdef  FPC&#xA;        for (i = 0; i &amp;lt; array_size; i++)    fpc (r.eight_real + i);&#xA;#endif&#xA;      h.rlen = (8 * array_size) + 4;&#xA;      break;&#xA;      case 6: /* CHARACTER ARRAY */&#xA;  cout&amp;lt;&amp;lt; __LINE__&amp;lt;&amp;lt;&quot;    &quot;&amp;lt;&amp;lt;__PRETTY_FUNCTION__&amp;lt;&amp;lt;endl;&#xA;      h.rlen = array_size + 4;&#xA;      break;&#xA;    default:&#xA;      error.printf_exit(&quot;Error: bad record type %d in GdsBlock :: external\n&quot;, (int) h.data_type);&#xA;      }&#xA;&#xA;  if (h.rlen % 2)&#xA;    {&#xA;    r.one_ascii[h.rlen] = 0;&#xA;    h.rlen++;&#xA;    }&#xA;&#xA;  cout&amp;lt;&amp;lt; __LINE__&amp;lt;&amp;lt;&quot;    &quot;&amp;lt;&amp;lt;__PRETTY_FUNCTION__&amp;lt;&amp;lt;endl;&#xA;&#xA;  i = h.rlen - 4;&#xA;#ifndef sparc&#xA;  c = (char *) &amp;amp;h.rlen;&#xA;  tmp = c[0];&#xA;  c[0] = c[1];&#xA;  c[1] = tmp;&#xA;#endif&#xA;  err = fwrite (&amp;amp;h, 1, sizeof (h), outstr);&#xA;  if (err != sizeof(h))&#xA;    {&#xA;    err = ferror(outstr);&#xA;    if (err)&#xA;      {&#xA;      char  *s = strerror (err);&#xA;      fclose (outstr);&#xA;      error.printf_exit (&quot;GdsBlock::write  error - %s, errno %d\n&quot;, s, err);&#xA;      }&#xA;&#xA;    fclose (outstr);&#xA;    error.printf_exit(&quot;Error: bad header fwrite in GdsBlock :: write\n&quot;);&#xA;    }&#xA;#if 1&#xA;  err = fwrite (r.one_ascii, 1, i, outstr);&#xA;  if (err != i)&#xA;    {&#xA;    err = ferror(outstr);&#xA;    if (err)&#xA;   {&#xA;      char  *s = strerror (err);&#xA;      fclose (outstr);&#xA;      error.printf_exit (&quot;GdsBlock::write  error - %s, errno %d\n&quot;, s, err);&#xA;      }&#xA;&#xA;    fclose (outstr);&#xA;    error.printf_exit(&quot;Error: bad record fwrite in GdsBlock :: write\n&quot;);&#xA;    }&#xA;#endif&#xA;debug.printf(&quot;GdsBlock::write exit\n&quot;);&#xA;  TBX;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3996232" LastEditorUserId="3996232" LastEditDate="2013-07-04T08:28:28.337" LastActivityDate="2013-07-04T08:28:28.337" Title="migration c++ code 32 bit machine to 64 bit machine" Tags="&lt;c++&gt;&lt;endianness&gt;" AnswerCount="2" CommentCount="6" />
  <row Id="17597032" PostTypeId="1" CreationDate="2013-07-11T15:07:43.247" Score="1" ViewCount="398" Body="&lt;p&gt;I'm working on a legacy VC6 application, that uses winsocket to listen to a UDP port for incoming packets. However I am getting the following errors. If I use &lt;strong&gt;&lt;code&gt;WSAGetLastError()&lt;/code&gt;&lt;/strong&gt; I get &lt;strong&gt;&lt;code&gt;WSAECONNRESET&lt;/code&gt;&lt;/strong&gt;, which if I read the description, doesn't seem to make sense, because its saying that remote host forcibly closed the socket, But I want use UDP connection-less manor, so it shouldn't matter what the other machine is doing... we should just listen. If I check the &lt;strong&gt;&lt;code&gt;errno&lt;/code&gt;&lt;/strong&gt; and use &lt;strong&gt;&lt;code&gt;sterror()&lt;/code&gt;&lt;/strong&gt; I get the following message. &lt;strong&gt;&lt;code&gt;&quot;No such file or directory&quot;&lt;/code&gt;&lt;/strong&gt;. (I think this it's enum is EIO, according to &lt;a href=&quot;http://pubs.opengroup.org/onlinepubs/009695399/functions/recvfrom.html&quot; rel=&quot;nofollow&quot;&gt;http://pubs.opengroup.org/onlinepubs/009695399/functions/recvfrom.html&lt;/a&gt;)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I've had some success in narrowing down the issue, it appears if I take out a &lt;strong&gt;&lt;code&gt;sendto()&lt;/code&gt;&lt;/strong&gt; call, that calls back on the same port as the &lt;strong&gt;&lt;code&gt;recvfrom()&lt;/code&gt;&lt;/strong&gt;, the code seems to work ok. So something with that &lt;strong&gt;&lt;code&gt;sendto()&lt;/code&gt;&lt;/strong&gt; is putting in a bad state. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I'm looking for suggestions on why this socket is going bad, and either how to prevent or recover.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Edit&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is the other weird part, if do the setup again for that socket (after a recvfrom() fails)... it all seems to work, even additional calls to &lt;strong&gt;&lt;code&gt;sendto()&lt;/code&gt;&lt;/strong&gt; don't seem trigger a recvfrom() fail, which in turn would call the setup again..&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;CODE&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; static VOID SetupSocketAddress( SOCKADDR_U &amp;amp;saRx, int nRTDPort )&#xA;    {&#xA;        memset(&amp;amp;saRx.saIPX, 0, sizeof(SOCKADDR_IPX));&#xA;        saRx.saIPX.sa_family = AF_IPX;                          // IPX type address&#xA;        memset(saRx.saIPX.sa_netnum,0x00,4);                    // we may have to get this number&#xA;        memset(saRx.saIPX.sa_nodenum,0xff,6);                   // broadcast address&#xA;        saRx.saIPX.sa_socket=(unsigned short)nRTDPort;      // socket number&#xA;    }&#xA;&#xA;void CRealTimeData::SetupSocket( CRealTimeData * lpRTD, BOOL &amp;amp;bDone, SOCKADDR_U &amp;amp;saRx, int nRTDPort, SOCKADDR_U &amp;amp;saFrom, int &amp;amp;cbAddr, &#xA;    DWORD &amp;amp;dwLocalAddress, int &amp;amp;nMaxIpIpxBuf, char * &amp;amp;pbyIpIpxRxBuf, int nFlags, BOOL bDo)&#xA;{&#xA;    char    szErrorCode[32];&#xA;    int     nReturn = 0;&#xA;&#xA;    if (lpRTD-&amp;gt;m_eSourceType == V7_RTD_IPX)&#xA;    {&#xA;        // open IPX socket&#xA;        // packet type = 4&#xA;        lpRTD-&amp;gt;m_Socket=socket(AF_IPX, SOCK_DGRAM, NSPROTO_IPX+4);&#xA;        if (lpRTD-&amp;gt;m_Socket == INVALID_SOCKET)&#xA;        {&#xA;            nReturn = AddSocketErrorToEventViewer( lpRTD);&#xA;            bDone = TRUE;&#xA;        }&#xA;&#xA;        // Socket must be bound prior to calling recvfrom()&#xA;        // setup address&#xA;        SetupSocketAddress(saRx, nRTDPort);&#xA;&#xA;&#xA;#ifdef  _DEBUG_IPX&#xA;        // test changing host number to network number&#xA;        // we can't actually change though, because other programs use it this way&#xA;        u_short nNetPort=0;&#xA;        int nRet=WSAHtons(lpRTD-&amp;gt;m_Socket, (unsigned short)nRTDPort, &amp;amp;nNetPort);&#xA;        TRACE(_T(&quot;RTDIpxThread: Host Port=%04x  Net Port=%04x RTD Input=%d \n&quot;),nRTDPort, nNetPort, lpRTD-&amp;gt;GetInputNumber());&#xA;#endif&#xA;        // setup address for Sending Data on RTD&#xA;        SetupSocketAddress( lpRTD-&amp;gt;m_saRTD, nRTDPort );&#xA;&#xA;        // copy address - Why are we copying the address just over right later (in recvfrom() )? -NG&#xA;        memcpy(&amp;amp;saFrom.saIPX, &amp;amp;lpRTD-&amp;gt;m_saRTD.saIPX, sizeof(SOCKADDR_IPX));&#xA;&#xA;        cbAddr = sizeof(SOCKADDR_IPX);&#xA;    }&#xA;    else&#xA;    {&#xA;        // open IP socket&#xA;        lpRTD-&amp;gt;m_Socket=socket(AF_INET, SOCK_DGRAM, IPPROTO_IP);        // ??? should this use IPPROTO_UDP???&#xA;        if (lpRTD-&amp;gt;m_Socket == INVALID_SOCKET)&#xA;        {&#xA;            nReturn = AddSocketErrorToEventViewer( lpRTD);&#xA;            bDone = TRUE;&#xA;        }&#xA;&#xA;        // Socket must be bound prior to calling recvfrom()&#xA;        // setup address&#xA;        memset(&amp;amp;saRx.saIP, 0, sizeof(SOCKADDR_IN));&#xA;        saRx.saIP.sin_family = AF_INET;                                         // IP type address&#xA;        saRx.saIP.sin_port=htons((u_short)nRTDPort);                            // PORT number&#xA;        saRx.saIP.sin_addr.s_addr=htonl(INADDR_ANY);                            // ADDRESS number&#xA;&#xA;        // setup for Sending Data on RTD port&#xA;        memset(&amp;amp;lpRTD-&amp;gt;m_saRTD.saIP, 0, sizeof(SOCKADDR_IN));&#xA;        lpRTD-&amp;gt;m_saRTD.saIP.sin_family = AF_INET;                       // IP type address&#xA;        lpRTD-&amp;gt;m_saRTD.saIP.sin_port=htons((u_short)nRTDPort);          // PORT number&#xA;        lpRTD-&amp;gt;m_saRTD.saIP.sin_addr.s_addr=htonl(INADDR_BROADCAST);    // ADDRESS number&#xA;&#xA;        // copy address - Why are we copying the address just over right later (in recvfrom() )? -NG&#xA;        memcpy(&amp;amp;saFrom.saIP, &amp;amp;lpRTD-&amp;gt;m_saRTD.saIP, sizeof(SOCKADDR_IN));&#xA;&#xA;        cbAddr = sizeof(SOCKADDR_IN);&#xA;&#xA;        char    szHostName[MAX_PATH+1];&#xA;        if (gethostname(szHostName, MAX_PATH)==0)&#xA;        {&#xA;            hostent *phe=gethostbyname(szHostName);&#xA;&#xA;            dwLocalAddress = *(DWORD*)&amp;amp;phe-&amp;gt;h_addr_list[0];&#xA;        }&#xA;    }   // end IP socket&#xA;&#xA;    if (!bDone)&#xA;    {&#xA;        // enable broadcasting&#xA;        BOOL bOptVal=TRUE;&#xA;        nReturn=setsockopt(lpRTD-&amp;gt;m_Socket, SOL_SOCKET, SO_BROADCAST, (char *)&amp;amp;bOptVal, sizeof(BOOL));&#xA;        if (nReturn == SOCKET_ERROR)&#xA;        {&#xA;            nReturn=WSAGetLastError();&#xA;        }&#xA;&#xA;        // enable reuse of address&#xA;        bOptVal=TRUE;&#xA;        nReturn=setsockopt(lpRTD-&amp;gt;m_Socket, SOL_SOCKET, SO_REUSEADDR, (char *)&amp;amp;bOptVal, sizeof(BOOL));&#xA;        if (nReturn == SOCKET_ERROR)&#xA;        {&#xA;            nReturn=WSAGetLastError();&#xA;        }&#xA;&#xA;        // get the socket's max message size&#xA;        int nOptSize=sizeof(UINT);&#xA;        UINT nMaxMsgSize=600;&#xA;        nReturn=getsockopt(lpRTD-&amp;gt;m_Socket, SOL_SOCKET, SO_MAX_MSG_SIZE, (char *)&amp;amp;nMaxMsgSize, &amp;amp;nOptSize);&#xA;        if (nReturn == SOCKET_ERROR)&#xA;        {&#xA;            nReturn=WSAGetLastError();&#xA;            nMaxMsgSize=600;                // default max size&#xA;        }&#xA;&#xA;        nMaxIpIpxBuf=nMaxMsgSize;                           // always create buffer that is as big as the sockets max message size&#xA;        pbyIpIpxRxBuf = new char[nMaxIpIpxBuf];     // allocate buffer for receiving data from socket&#xA;&#xA;        if (!pbyIpIpxRxBuf)&#xA;            bDone = TRUE;&#xA;        else&#xA;            memset(pbyIpIpxRxBuf,0,nMaxIpIpxBuf*sizeof(char));&#xA;&#xA;        // bind to address&#xA;        nReturn=bind(lpRTD-&amp;gt;m_Socket, &amp;amp;saRx.sa, cbAddr);&#xA;        if (nReturn == SOCKET_ERROR)&#xA;        {&#xA;            nReturn = AddSocketErrorToEventViewer(lpRTD);&#xA;            bDone = TRUE;&#xA;        }&#xA;&#xA;        // send data to indicate startup&#xA;        if (lpRTD-&amp;gt;m_eProtocol == V7_RTD_ENHANCED)&#xA;        {&#xA;            int nLen=lpRTD-&amp;gt;BuildErrorMsg(V7_ERTD_SERVICE_STARTUP, szErrorCode, sizeof(szErrorCode));&#xA;            nReturn=sendto(lpRTD-&amp;gt;m_Socket,szErrorCode,nLen, nFlags, &amp;amp;lpRTD-&amp;gt;m_saRTD.sa, cbAddr);&#xA;            if (nReturn == SOCKET_ERROR)&#xA;            {&#xA;                nReturn=WSAGetLastError();&#xA;            }&#xA;        }&#xA;&#xA;    }   // end if not done&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Main()&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    nFromLen = cbAddr;&#xA;    nReturn=recvfrom(lpRTD-&amp;gt;m_Socket, pbyIpIpxRxBuf, nMaxIpIpxBuf, nFlags, &amp;amp;saFrom.sa, &amp;amp;nFromLen);&#xA;    if(nReturn == SOCKET_ERROR)&#xA;    {&#xA;        SetupSocket(lpRTD, bDone, saRx, nRTDPort, saFrom, cbAddr, dwLocalAddress, nMaxIpIpxBuf, pbyIpIpxRxBuf,nFlags, FALSE);&#xA;        nReturn=recvfrom(lpRTD-&amp;gt;m_Socket, pbyIpIpxRxBuf, nMaxIpIpxBuf, nFlags, &amp;amp;saFrom.sa, &amp;amp;nFromLen);&#xA;    }&#xA;&#xA;// if i take this out no error....&#xA;    nReturn=sendto(lpRTD-&amp;gt;m_Socket, szErrorCode, nLen, nFlags, &amp;amp;saFrom.sa, cbAddr);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="184466" LastEditorUserId="184466" LastEditDate="2013-07-12T19:20:25.003" LastActivityDate="2013-07-12T19:20:25.003" Title="Win Socket UDP connection-less recvfrom() Error" Tags="&lt;c++&gt;&lt;udp&gt;&lt;communication&gt;&lt;vc6&gt;&lt;winsock2&gt;" AnswerCount="0" CommentCount="6" />
  <row Id="17761778" PostTypeId="1" AcceptedAnswerId="17786608" CreationDate="2013-07-20T11:30:15.817" Score="6" ViewCount="726" Body="&lt;h1&gt;&lt;strong&gt;MEGAEDIT 3000&lt;/strong&gt;&lt;/h1&gt;&#xA;&#xA;&lt;p&gt;I have discovered the cause of undefined references. I checked my .o files for symbols, and they were just missing. Just weren't there. For no apparent reason. I have checked the source of the compromiting .o file, but everything seemed to be OK. I've thought that it may be one of those nasty &lt;code&gt;#ifdef ... #endif&lt;/code&gt; blocks, cunningly hidden amongst lines of the code like a bear trap, waiting for its victim. But I couldn't find any. After moving some function definitions to the very end of the file and enclosing them in &lt;code&gt;#ifdef ... #endif&lt;/code&gt; block suitable for Linux, the symbols magically appeared and everything was fine. Thank you for your time.&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;&lt;strong&gt;Outdated, do not read.&lt;/strong&gt;&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;I have been assigned to one big project lately, my job is to make it&#xA;  run on Linux platforms. Unfortunately, the programmer who wrote the&#xA;  whole project before me did a very poor job, creating whole lots of&#xA;  circular dependencies by including file &lt;code&gt;B3D_Base.h&lt;/code&gt;, where almost&#xA;  every header is &lt;code&gt;#included&lt;/code&gt;, to almost every header and source file in&#xA;  the project (that makes 170+ files with &lt;code&gt;#include &quot;B3D_Base.h&quot;&lt;/code&gt; line).&#xA;  This caused no problems during compilation on both Windows and Linux.&#xA;  However, this causes lots of 'undefined reference' errors during&#xA;  linking phase on Linux, even though all object files and libraries are&#xA;  linked. &lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;Being aware of &lt;code&gt;ld&lt;/code&gt;'s limitation of single iteration through all object files during linking, I'm asking: &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there a way to force &lt;code&gt;ld&lt;/code&gt; to do multiple iterations through objects and libraries, possibly solving all the 700+ undefined reference errors, or is my only chance to actually link the project just replacing all the &lt;code&gt;#include &quot;B3D_Base.h&quot;&lt;/code&gt; lines with proper includes to needed headers?&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;&lt;strong&gt;APPENDIX #1:&lt;/strong&gt;&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;Here is an example of what mess I'm supposed to make run on Linux:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;There is one header file &lt;code&gt;B3D_Base.h&lt;/code&gt;, to which is included &lt;code&gt;B3D_Loading3.h&lt;/code&gt;, which contains class &lt;code&gt;B3D_LOADING3&lt;/code&gt;. File &lt;code&gt;B3D_Loading3.cpp&lt;/code&gt; is including only &lt;code&gt;B3D_Base.h&lt;/code&gt; and a memory manager class not included in Base. An instance &lt;code&gt;B3D_LOADING3 g_Loading3;&lt;/code&gt; is declared in &lt;code&gt;B3D_Base.h&lt;/code&gt; and initializes+used in many other parts of the project. Everything compiles just fine, but when it comes to linking, I get many &lt;code&gt;'undefined reference to g_Loading3'&lt;/code&gt; errors. And there are many more errors like this, complaining about undefined references to both class instances and functions alike. So much for clean code.&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;&lt;strong&gt;APPENDIX #2:&lt;/strong&gt;&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;I'll be providing an SSCCE example, as kfsone requested:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;B3D_Base.h&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;... (many other includes)&#xA;&#xA;#include &quot;B3D_Loading3.h&quot;&#xA;extern B3D_LOADING3 g_Loading3;&#xA;&#xA;... (includes go on)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;B3D_Loading3.h/B3D_Loading.cpp&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;a full definition of class B3D_LOADING3, but no real declaration of g_Loading3&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;AW_Game.cpp&lt;/strong&gt; (one of the files where g_Loading3 is used)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;B3D_Base.h&quot;&#xA;... (some lines)&#xA;extern B3D_LOADING3 g_Loading3; &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Thanks to kfsone who made me go through the code thoroughly, I managed to find out where the problem lies: g_Loading3 is defined everywhere as &lt;code&gt;extern&lt;/code&gt;, thus not being properly defined. All I needed was to remove the &lt;code&gt;extern&lt;/code&gt; keyword from one file. Fixed me ~ 30 linking errors. Thanks, kfsone.&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;&lt;strong&gt;APPENDIX #3:&lt;/strong&gt;&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;But there is still problem with undefined references to class functions. After some code scanning, I suppose that the functions are not even defined due to overextended use of &lt;code&gt;#ifdef ... #endif&lt;/code&gt; clauses (portability) and thus it may be my fault, overlooking functions defined  only in some passive ifdef block. I will try to look at this issue and later report if anything changed.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;APPENDIX #3 REPORT:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Even after properly defining functions, the undefined-reference-list did not shrink. The problem is therefore still open for discussion.&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;&lt;strong&gt;APPENDIX #3.1&lt;/strong&gt;&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;I'll be providing some example code.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Foo.h&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef FOO_H&#xA;#define FOO_H&#xA;&#xA;class Foo&#xA;{&#xA;    unsigned int    m_size;&#xA;    bool            m_lock;&#xA;    friend class ASDF;&#xA;&#xA;public:&#xA;    unsigned int    m_id;&#xA;&#xA;    void    Release() {delete this;}&#xA;    int     Lock(UINT OffsetToLock, UINT SizeToLock, VOID ** ppbData, DWORD Flags);&#xA;    int     Unlock();&#xA;};&#xA;&#xA;// other class declarations to follow&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Foo.cpp&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;Foo.h&quot;&#xA;// other includes and function definitions to follow&#xA;&#xA;int Foo::Lock(UINT OffsetToLock, UINT SizeToLock, VOID ** ppbData, DWORD Flags)&#xA;{&#xA;    if(!m_lock)&#xA;    {&#xA;        // some locking code&#xA;    }&#xA;    return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Baz.cpp&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;Foo.h&quot;  // although included, defined and declared, causes undef reference&#xA;&#xA;Foo *m_pFoo;&#xA;// several lines later&#xA;m_pFoo-&amp;gt;Lock(0,0,(void)&amp;amp;Asdf,NULL); // &amp;lt;-- compiles fine, causes undefined reference&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1187935" LastEditorUserId="1187935" LastEditDate="2013-07-22T13:10:04.820" LastActivityDate="2013-07-22T13:10:04.820" Title="Houston, we have an undefined reference" Tags="&lt;c++&gt;&lt;linker&gt;&lt;undefined-reference&gt;" AnswerCount="3" CommentCount="12" FavoriteCount="0" />
  <row Id="17839708" PostTypeId="1" CreationDate="2013-07-24T16:27:09.157" Score="0" ViewCount="151" Body="&lt;p&gt;I have a dll for third party app and normally communicate with it via Named Pipes. But NPs works only when the other app is started. Can I directly call a method from the dll to see its version.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;C++ VS2012&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  MTFST_EXPORTS&#xA;#define MTFST_API __declspec(dllexport)&#xA;#else&#xA;#define MTFST_API __declspec(dllimport)&#xA;#endif&#xA;&#xA;#define LIBRARY_VERSION      &quot;3.0&quot;&#xA;&#xA;    ....&#xA;&#xA;using namespace std;&#xA;&#xA;MTFST_API char *__stdcall FST_LibraryVersion()&#xA;{&#xA;    return LIBRARY_VERSION;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I tried the following code, but it doesn't work. .NET 4.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;internal class Program&#xA;{&#xA;    [DllImport(&quot;Library.dll&quot;)]&#xA;    private static extern char[] FST_LibraryVersion();&#xA;&#xA;    private static void Main(string[] args)&#xA;    {&#xA;        Console.WriteLine(new string(FST_LibraryVersion()));&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="926841" LastActivityDate="2013-07-24T16:31:02.457" Title="Call C++ method from .NET" Tags="&lt;c#&gt;&lt;.net&gt;&lt;interop&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="18013310" PostTypeId="1" AcceptedAnswerId="18055301" CreationDate="2013-08-02T09:25:17.033" Score="0" ViewCount="49" Body="&lt;p&gt;To stop autoboot we have 2 ifdef (CONFIG_AUTOBOOT_STOP_ [STR2 || STR1] ). Which is very easy and straightforward to implement. Halting a boot with single “Keystroke” or with a pharase is having its own advantages to the user. But, why contole key support is ignored say like [ctrl + anykey ] combination. Especially, BIOS vendors prefer at least simultaneous pressing of 2 or more keys to halt the boot. Any specific reasons to avoid this. Other than simplicity is there any specific reason to stick on this.&lt;/p&gt;&#xA;" OwnerUserId="1660014" LastEditorUserId="1009479" LastEditDate="2013-09-03T06:05:40.333" LastActivityDate="2013-09-03T06:05:40.333" Title="u-boot - control characters support disabled" Tags="&lt;u-boot&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="18406622" PostTypeId="1" CreationDate="2013-08-23T15:31:38.690" Score="5" ViewCount="13047" Body="&lt;p&gt;I am buliding a dark themed iOS 6 and 7 app. I understand I can call &lt;code&gt;[[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleLightContent];&lt;/code&gt; to make the iOS 7 status bar suit a dark color theme application.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The problem is I am going to submit my app to the App Store and currently Xcode 5 is not ready for that, so I have to use Xcode 4.6.x to do this task. However with Xcode 4.6, I am not able to compile the new method from iOS 7. I think I have to do something like &quot;&quot;if ios7&quot;&quot; then do &lt;code&gt;[[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleLightContent];&lt;/code&gt; and reposition my application window. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I am trying to do this with &lt;code&gt;#ifdef&lt;/code&gt; ... &lt;code&gt;#else&lt;/code&gt;...&#xA;this code is &lt;code&gt;[[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleLightContent];&lt;/code&gt; inside the &lt;code&gt;viewDidLoad&lt;/code&gt;. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Could anyone help to understand how to use &lt;code&gt;#ifdef&lt;/code&gt;... with the method in some functions. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks a lot!!!!&lt;/p&gt;&#xA;" OwnerUserId="1168295" LastEditorUserId="2613662" LastEditDate="2015-08-07T06:11:46.580" LastActivityDate="2015-08-07T06:11:46.580" Title="#ifdef #else #endif choose iOS sdk version and function?" Tags="&lt;ios&gt;&lt;objective-c&gt;&lt;sdk&gt;&lt;ifdefine&gt;" AnswerCount="2" CommentCount="3" FavoriteCount="2" />
  <row Id="18413118" PostTypeId="1" AcceptedAnswerId="18421515" CreationDate="2013-08-23T23:02:30.983" Score="2" ViewCount="1789" Body="&lt;p&gt;I am trying to build a dll with visual studio so I can use it in matlab ...&#xA;I tried thausand codes with no solution !!! I am working on matlab 2013(32and64) and VS2010 !&#xA;I tried for example to write the code this way ...&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;        //The header&#xA;&#xA;    #ifndef SIMPLEH_H&#xA;    #define SIMPLEH_H&#xA;    #ifdef  __cplusplus&#xA;    extern &quot;C&quot; {&#xA;    int sq(int x);  &#xA;    #endif&#xA;    #ifdef  __cplusplus&#xA;    }&#xA;    #endif&#xA;    #endif&#xA;&#xA;//the Func(example)&#xA;&#xA;#include &quot;SimpleH.h&quot;&#xA;int sq(int x)&#xA;{&#xA;return (x*x);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;visual studio Build it and make th dll file but matlab always doesn't see the function ...&#xA;What should I do /* I am really stucked :(  */&#xA;Thanks in advance ...&lt;/p&gt;&#xA;" OwnerUserId="2604334" LastEditorUserId="97160" LastEditDate="2013-08-24T17:21:53.603" LastActivityDate="2013-08-24T18:15:45.750" Title="visual studio Dll and Matlab" Tags="&lt;c++&gt;&lt;visual-studio-2010&gt;&lt;matlab&gt;&lt;dll&gt;&lt;loadlibrary&gt;" AnswerCount="1" CommentCount="6" FavoriteCount="1" />
  <row Id="18465187" PostTypeId="1" CreationDate="2013-08-27T12:17:33.697" Score="2" ViewCount="2582" Body="&lt;p&gt;I’m working on Windows Server 2008 R2 Standard (SP1), using the MSVC Ultimate 2012. I’m trying to compile one my „C“ project for 64 bit platform (but it seems that the problem is not target related). The project includes one *.pc file, which has to be precompiled by Pro*C/C++ precompiler. Problem is, that I’m not able to precompile that file. &lt;strong&gt;The precompilation fails during parsing of windows.h header file&lt;/strong&gt;. Please help!!!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;More details:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;1)  &lt;strong&gt;Source file:&lt;/strong&gt; My my.pc file begins as follows: &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; #include &amp;lt;windows.h&amp;gt;&#xA; #include &amp;lt;stdio.h&amp;gt;&#xA; #include &amp;lt;stdlib.h&amp;gt;  &#xA; #include &amp;lt;string.h&amp;gt;&#xA; #include &amp;lt;time.h&amp;gt;&#xA; #include &amp;lt;assert.h&amp;gt;&#xA; #include &amp;lt;sqlca.h&amp;gt;&#xA; #include &amp;lt;sqlcpr.h&amp;gt;&#xA;&#xA;…..&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Note: The first &lt;code&gt;#include &amp;lt;windows.h&amp;gt;&lt;/code&gt; is sufficient for error invocation.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;2)  &lt;strong&gt;Configuration files:&lt;/strong&gt; The default pcscfg.cfg file is empty, the project configuration file my.cfg looks like follows:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;sys_include=(d:\Progra~1\Micros~2.0\VC\include,c:\Progra~2\WI3CF2~1\8.0\Include\um,c:\Progra~2\WI3CF2~1\8.0\Include\shared,$PROC11_ORACLE_HOME\PRECOMP\PUBLIc)&#xA;sqlcheck=full&#xA;parse=FULL&#xA;define=_WIN64 (or without this line)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Note: d:\Progra~1\Micros~2.0\VC\include = D:\Program Files\Microsoft Visual Studio 10.0\VC\include, c:\Progra~2\WI3CF2~1\8.0\Include\um = C:\Program Files (x86)\Windows Kits\8.0\Include\um, c:\Progra~2\WI3CF2~1\8.0\Include\shared = C:\Program Files (x86)\Windows Kits\8.0\Include\shared, $PROC11_ORACLE_HOME = d:\oracle\product\11.2.0\client_2. Those paths are there to find all the needed header files.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;3)  &lt;strong&gt;Command line:&lt;/strong&gt; I have defined the following Command line for my my.pc file in the Custom Build Tool/General options: &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$(PROC11_ORACLE_HOME)\bin\proc config=.\my.cfg iname=%(Filename).pc oname=.\%(Filename).c include=&quot;$(MSDEV_HOME)\vc\include&quot;.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Note: The $(MSDEV_HOME) = D:\Program Files\Microsoft Visual Studio 10.0.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;4)  &lt;strong&gt;Platform:&lt;/strong&gt; The MSVC platform is set to x64, but I obtained similar results for Win32 also.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;5)  &lt;strong&gt;Error messages:&lt;/strong&gt; Error messages received during precompilation if there is &lt;strong&gt;define=_WIN64 involved&lt;/strong&gt; in my.cfg file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;1&amp;gt;  Syntax error at line 46, column 1, file d:\Progra~1\Micros~2.0\VC\include\vadefs.h:&#xA;1&amp;gt;  Error at line 46, column 1 in file d:\Progra~1\Micros~2.0\VC\include\vadefs.h&#xA;1&amp;gt;  typedef unsigned __int64    uintptr_t;&#xA;1&amp;gt;  1&#xA;1&amp;gt;  **PCC-S-02201, Encountered the symbol &quot;typedef&quot; when expecting one of the following:**&#xA;1&amp;gt;     ; , = ( [&#xA;1&amp;gt;  The symbol &quot;;&quot; was substituted for &quot;typedef&quot; to continue.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;6)  &lt;strong&gt;Error messages:&lt;/strong&gt; Error messages received during precompilation if the &lt;strong&gt;define=_WIN64 is NOT involved&lt;/strong&gt; in my.cfg file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;1&amp;gt;  Syntax error at line 48, column 1, file d:\Progra~1\Micros~2.0\VC\include\vadefs.h:&#xA;1&amp;gt;  Error at line 48, column 1 in file d:\Progra~1\Micros~2.0\VC\include\vadefs.h&#xA;1&amp;gt;  typedef _W64 unsigned int   uintptr_t;&#xA;1&amp;gt;  1&#xA;1&amp;gt;  **PCC-S-02201, Encountered the symbol &quot;typedef&quot; when expecting one of the following:**&#xA;1&amp;gt;  ; , = ( [&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;7)  &lt;strong&gt;File vadefs.h:&lt;/strong&gt; The critical lines in the vadefs.h header file look like follows:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; #ifndef _UINTPTR_T_DEFINED&#xA; #ifdef  _WIN64&#xA; typedef unsigned __int64    uintptr_t; (this is line no. 46)&#xA; #else&#xA; typedef _W64 unsigned int   uintptr_t; (this is line no. 48)&#xA; #endif&#xA; #define _UINTPTR_T_DEFINED&#xA; #endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Question is, why the precompilation fails in the standard Microsoft header file. May be there is some mess in macros, e.g. something related to the _WIN64 one? Or should I add another macro to the configuration file? I have read plenty of discussions but without progress. Any ideas would be very appreciated!&lt;/p&gt;&#xA;" OwnerUserId="2718532" LastEditorUserId="635608" LastEditDate="2013-09-14T12:15:02.080" LastActivityDate="2013-09-14T12:15:02.080" Title="Why the Pro*C/C++ Oracle precompiler can not parse the windows.h header file?" Tags="&lt;visual-studio-2012&gt;&lt;win64&gt;&lt;oracle-pro-c&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="18571661" PostTypeId="1" AcceptedAnswerId="18571805" CreationDate="2013-09-02T11:02:46.523" Score="8" ViewCount="515" Body="&lt;p&gt;I am writing a Go program for Windows which contains several packages. One of these packages is using CGo to call a few functions defined in some .h and .c files. These .c files are dependent on windows.h .&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Since developing on the Windows platform is incredibly tedious I would like to make a mockup of the functions in this file and develop on Linux instead. But when I try to compile I get:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;fatal error: windows.h: No such file or directory&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Since the go tool tries to compile my Windows dependent files. Is there some way around this? I know that putting something like &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef ..&#xA;import x&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;is not best practice but in this case I need something to allow compiling only the &quot;Linux&quot; files.&lt;/p&gt;&#xA;" OwnerUserId="702065" LastActivityDate="2013-09-02T11:09:53.080" Title="Exclude go source files by architecture when compiling" Tags="&lt;compilation&gt;&lt;go&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="1" />
  <row Id="18815237" PostTypeId="1" AcceptedAnswerId="18815474" CreationDate="2013-09-15T17:20:47.833" Score="0" ViewCount="412" Body="&lt;p&gt;I am reading a file using fgets. I need to check each line of the file against a regex. If there is a non alpha numeric character, it needs to exit the program with the line number and &quot;bad&quot; character displayed. What is happening is it is kicking out before the &quot;bad&quot; character.&#xA;Here is my .dat file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;howard jim dave &#xA;joe&#xA;(&#xA;Maggie&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;My output of the program is:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;file opened&#xA;Digit: howard jim dave &#xA;is not alphanumeric on line: 1&#xA;Exiting program!&#xA;File closed&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;What should happen is it should kick out on line 3, as you can see that is not happening.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is my regex which is in my main.h file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef MAIN_H&#xA;#define MAIN_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;#define BUFF 1024&#xA;#define to_find &quot;^[a-zA-Z0-9]+$&quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Here is my fileCheck.c&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;main.h&quot;&#xA;&#xA;int fileCheck(FILE *fp)&#xA;{&#xA;&#xA;    int ret_val;&#xA;    int line_count = 0;&#xA;    char file[BUFF];&#xA;    regex_t regex;&#xA;&#xA;    if (regcomp(&amp;amp;regex, to_find, REG_EXTENDED) != 0)&#xA;    {&#xA;        fprintf(stderr, &quot;Failed to compile regex '%s'\n&quot;, to_find);&#xA;        return EXIT_FAILURE;&#xA;    }&#xA;&#xA;    if (fp != NULL)&#xA;    {&#xA;        while (fgets(file, BUFF, fp))&#xA;        {&#xA;            line_count++;&#xA;&#xA;            if ((ret_val = regexec(&amp;amp;regex, file, 0, NULL, 0)) != 0)&#xA;            {&#xA;                printf(&quot;Digit: %s is not alphanumeric on line: %d\n&quot;, file, line_count);&#xA;                printf(&quot;Exiting program!\n&quot;);&#xA;                return EXIT_FAILURE;&#xA;            }&#xA;        }&#xA;    }&#xA;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I am not sure if the &quot;\n&quot; character is the problem or not. I do not think it is. I am well aware if isalnum() but I am tasked with a regex. What would be a possible solution for this problem? Thank you for your suggestions.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;EDIT: I wanted to mention that when I used fscanf instead of fgets, the above regex worked just fine. The reason for the change is I need to count each line. If I am correct, fscanf ignores newline character. I need some way to count a newline. Is it possible to count a new using fscanf? My original file read loop was:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;while (fscanf(fp, &quot;%11023s&quot;, file) != EOF&#xA;{&#xA;    line_count++;&#xA;    if (regexec(&amp;amp;regex, file, 0, NULL, 0) != 0)&#xA;    {&#xA;        printf(&quot;%s%d wrong:\n, file, line_count);&#xA;        return EXIT_FAILURE;&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1646877" LastEditorUserId="1646877" LastEditDate="2013-09-15T18:50:12.010" LastActivityDate="2013-09-16T01:15:18.163" Title="Using regex for checking a .dat file" Tags="&lt;c&gt;&lt;regex&gt;&lt;fgets&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="18875725" PostTypeId="1" CreationDate="2013-09-18T14:59:27.643" Score="0" ViewCount="471" Body="&lt;p&gt;I am trying to create a Windows DLL using gcc version 4.7.2, however I'm facing problems when I use Exceptions internally. In the DLL code I am throwing an exception found in &lt;code&gt;test()&lt;/code&gt; method which is caught in the same method. Below is the code found in main.cpp:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;cstdlib&amp;gt;&#xA;#include &amp;lt;windows.h&amp;gt;&#xA;#include &amp;lt;iostream&amp;gt;&#xA;#include &quot;dllexport.h&quot;&#xA;&#xA;using namespace std;&#xA;&#xA;ADDAPI int test()&#xA;{&#xA;    try&#xA;    {&#xA;        throw 2;&#xA;    }catch(...)&#xA;    {&#xA;        std::cout &amp;lt;&amp;lt; &quot;Caught&quot;;&#xA;        return 1;&#xA;    }&#xA;    return 0;&#xA;}&#xA;&#xA;//Link to correct DllMain if C++ is used&#xA;#ifdef __cplusplus&#xA;extern &quot;C&quot;&#xA;#endif&#xA;BOOL APIENTRY DllMain(HINSTANCE hModule, DWORD  reason, LPVOID lpReserved)&#xA;{&#xA;    switch (reason)&#xA;    {&#xA;        case DLL_PROCESS_ATTACH:&#xA;        break;&#xA;        case DLL_THREAD_ATTACH:&#xA;        break;&#xA;        case DLL_THREAD_DETACH:&#xA;        break;&#xA;        case DLL_PROCESS_DETACH:&#xA;        break;&#xA;    }&#xA;    return TRUE;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and the relevant header found in dllexport.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef DLLEXPORT_H&#xA;#define DLLEXPORT_H&#xA;&#xA;/* Define calling convention in one place, for convenience. */&#xA;#define ADDCALL __stdcall&#xA;&#xA;/* Usually format is ADDAPI int ADDCALL Add(int a, int b)...&#xA;   but moving ADDCALL near ADDAPI works in gcc */&#xA;&#xA;/* You should define BUILDING_DLL *only* when building the DLL. */&#xA;#ifdef BUILDING_DLL&#xA;  #define ADDAPI __declspec(dllexport) ADDCALL&#xA;#else&#xA;  #define ADDAPI __declspec(dllimport) ADDCALL&#xA;#endif&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;    ADDAPI int test();&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif  /* DLLEXPORT_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This compiles fine, however when I try to call the test method from a process which links to it, the following error is returned: &lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;em&gt;&lt;strong&gt;This application has requested the Runtime to terminate it in an unusual way.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I compile the dll using the following:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;g++ -c main.cpp -O3 -DBUILDING_DLL&#xA;g++ -o mydll.dll main.o -shared -static-libgcc -static-libstdc++ -Wl,--add-stdcall-alias&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Additionally, I compile the client application using &lt;code&gt;-lmydll&lt;/code&gt;. I understand that it is risky to throw exceptions from DLLs and catching them in a process, however I am not doing so, as exceptions will all be handled internally in the DLL.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What am I doing wrong?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Edit:&lt;/strong&gt; &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Removing static linking of libstdc++ to the DLL solves the issue. However, it would be ideal if the DLL resolved all the dependencies internally, in order for it to be self-contained. What can I do to attain the above?&lt;/p&gt;&#xA;" OwnerUserId="1634130" LastEditorUserId="1634130" LastEditDate="2013-09-19T10:51:47.790" LastActivityDate="2015-03-10T18:23:30.757" Title="C++ Windows DLL using try-catch block internally fails" Tags="&lt;c++&gt;&lt;windows&gt;&lt;exception&gt;&lt;dll&gt;&lt;try-catch&gt;" AnswerCount="1" CommentCount="5" />
  <row Id="19039874" PostTypeId="1" CreationDate="2013-09-26T22:38:26.160" Score="2" ViewCount="441" Body="&lt;p&gt;In a project I am working on at the moment I have a lot of functions interleaved with blocks of &lt;code&gt;#ifdef&lt;/code&gt;'d code.  In this particular case it would be much more readable if that code was subtly highlighted to show it as being separate from the main code.  I've had a look in the theme options but couldn't see any way to do this.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I'd just remove the symbol from the project and have eclipse highlight it as being disabled, but then I can't work on it easily (limited / no hover or f3 functionality).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I've read several posts (specifically &lt;a href=&quot;http://stackoverflow.com/questions/3121920/how-can-i-get-eclipse-to-index-code-inside-ifdef-endif&quot;&gt;How can I get Eclipse to index code inside #ifdef .... #endif&lt;/a&gt; and &lt;a href=&quot;http://stackoverflow.com/questions/10903951/eclipse-color-theme-ifdef-issue&quot;&gt;eclipse color theme #ifdef issue&lt;/a&gt; ), but they're not quite what I'm looking for - it all seems to be about undefining the symbol then living with the fact you lose functionality.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Am I missing something, or does this feature not exist in Eclipse?  &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Cheers &lt;/p&gt;&#xA;" OwnerUserId="645613" LastActivityDate="2013-09-26T22:38:26.160" Title="Can I have Eclipse highlight an #ifdef block of code regardless of whether the symbol is defined?" Tags="&lt;c++&gt;&lt;c&gt;&lt;eclipse&gt;&lt;syntax-highlighting&gt;&lt;eclipse-cdt&gt;" AnswerCount="0" CommentCount="0" />
  <row Id="19084981" PostTypeId="1" AcceptedAnswerId="19097953" CreationDate="2013-09-30T00:47:40.143" Score="3" ViewCount="361" Body="&lt;p&gt;I have a function that would &lt;strong&gt;&lt;em&gt;love&lt;/em&gt;&lt;/strong&gt; to take advantage of the &lt;em&gt;&quot;correct&quot;&lt;/em&gt; way to do something that was provided in .NET 4.5:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;public DbDataAdapater CreateDataAdapter(DbConnection connection)&#xA;{&#xA;   #IFDEF (NET45)&#xA;      return DbProviderFactories.GetFactory(connection).CreateDataAdapter();&#xA;   #ELSE&#xA;      //We can't construct an adapter directly&#xA;      //So let's run around the block 3 times, before potentially crashing&#xA;      DbDataAdapter adapter; &#xA;&#xA;      if (connection is System.Data.SqlClient.SqlConnection)&#xA;         return new System.Data.SqlClient.SqlDataAdapter();&#xA;      if (connection is System.Data.OleDb.OleDbConnection)&#xA;         return new System.Data.OleDb.OleDbDataAdapter();&#xA;      if (connection is System.Data.Odbc.OdbcConnection)&#xA;         return new System.Data.Odbc.OdbcDataAdapter();&#xA;      //Add more DbConnection kinds as they become invented&#xA;      if (connection is SqlCeConnection)&#xA;         return new SqlCeDataAdapter();&#xA;      if (connection is MySqlConnection)&#xA;         return new MySqlDataAdapter();&#xA;      if (connection is DB2Connection)&#xA;         return new DB2DataAdapter();&#xA;&#xA;      throw new Exception(&quot;[CreateDataAdapter] Unknown DbConnection type: &quot; + connection.GetType().FullName);&#xA;   #END&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The only way i've been able to find to make this work is for &lt;strong&gt;&lt;em&gt;everyone&lt;/em&gt;&lt;/strong&gt; who uses this shared code to &lt;a href=&quot;http://stackoverflow.com/questions/2923210/c-sharp-conditional-compilation-and-framework-targets&quot;&gt;alter their Visual Studio solution&lt;/a&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Which not going to happen; it has to just work, or it's not going to be used at all.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there a ways to define away non-functional code when the solution targets earlier versions of the .NET framework?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;In other words, it would be great if this compiled:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;public DbDataAdapter CreateDataAdapter(DbConnection conn)&#xA;{&#xA;   if (System.Runtime.Version &amp;gt;= 45)&#xA;      return DbProviderFactories.GetFactor(connection).CreateDataAdapter();&#xA;   else&#xA;   {&#xA;      //...snip the hack...&#xA;   }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But it doesn't compile if the targeted framework is too low.&lt;/p&gt;&#xA;" OwnerUserId="12597" LastEditorUserId="12597" LastEditDate="2013-09-30T14:08:07.683" LastActivityDate="2017-03-03T20:12:02.187" Title="How to define away code based on .NET framework version?" Tags="&lt;c#&gt;&lt;.net&gt;&lt;.net-4.5&gt;" AnswerCount="3" CommentCount="4" FavoriteCount="1" />
  <row Id="19420893" PostTypeId="1" CreationDate="2013-10-17T07:41:38.280" Score="-1" ViewCount="610" Body="&lt;p&gt;I need to solve the producer-consumer problem requiring a single process solution using threads within a process. The main routine of the single process should setup and initialize the required ring buffers and control variables in global memory where they can be seen by all other threads of the process. The main routine will then begin creating some number of producer threads and some number of consumer threads. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I did a lot of research on the internet and was able to code some of it. However, it doesn't seem to be working right and I'm getting deadlocks for all the values. Can someone please help me out?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My header file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    #include &amp;lt;sys/signal.h&amp;gt;&#xA;#include &amp;lt;sys/time.h&amp;gt;&#xA;#include &amp;lt;pthread.h&amp;gt;&#xA;#include &amp;lt;sys/signal.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;&#xA;#define         NUMFLAVORS          4&#xA;#define         NUMSLOTS            400&#xA;#define         NUMCONSUMERS        50  &#xA;#define     NUMPRODUCERS        30&#xA;#define       NoOfDozens        200 &#xA;&#xA;struct  DONUT_SHOP {&#xA;    int         flavor [NUMFLAVORS] [NUMSLOTS];&#xA;    int         outptr [NUMFLAVORS];&#xA;    int     in_ptr [NUMFLAVORS];&#xA;    int     serial [NUMFLAVORS];&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;My program:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    void    *sig_waiter ( void *arg );&#xA;    void    *producer   ( void *arg );&#xA;    void    *consumer ( void *arg) ;&#xA;    void    sig_handler ( int );&#xA;&#xA;&#xA;&#xA;/****************************/&#xA;/*      GLOBAL VARIABLES    */&#xA;/****************************/&#xA;&#xA;#include &quot;ml_pc.h&quot;&#xA;&#xA;    struct DONUT_SHOP   shared_ring;&#xA;    int         space_count [NUMFLAVORS];       &#xA;    int         donut_count [NUMFLAVORS];        &#xA;    int         serial [NUMFLAVORS];            &#xA;    pthread_mutex_t     prod [NUMFLAVORS];&#xA;    pthread_mutex_t     cons [NUMFLAVORS];&#xA;    pthread_cond_t      prod_cond [NUMFLAVORS];&#xA;    pthread_cond_t      cons_cond [NUMFLAVORS];&#xA;    pthread_t       thread_id [NUMCONSUMERS+1], sig_wait_id;&#xA;&#xA;&#xA;int  main ( int argc, char *argv[] )&#xA;{&#xA;    int         i, j, k, nsigs;&#xA;    struct timeval      randtime, first_time, last_time;&#xA;    struct sigaction    new_act;&#xA;    int         arg_array[NUMCONSUMERS];&#xA;    sigset_t        all_signals;&#xA;    int sigs[]      = { SIGBUS, SIGSEGV, SIGFPE };&#xA;    pthread_attr_t      thread_attr;&#xA;    struct sched_param  sched_struct;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;/**********************************************************************/&#xA;/* INITIAL TIMESTAMP VALUE FOR PERFORMANCE MEASURE                    */&#xA;/**********************************************************************/&#xA;&#xA;        gettimeofday (&amp;amp;first_time, (struct timezone *) 0 );&#xA;&#xA;&#xA;        for ( i = 0; i &amp;lt; NUMCONSUMERS + 1 ; i++ ) {&#xA;            arg_array [i] = i+1;    /** SET ARRAY OF ARGUMENT VALUES **/&#xA;        }&#xA;&#xA;/**********************************************************************/&#xA;/* GENERAL PTHREAD MUTEX AND CONDITION INIT AND GLOBAL INIT           */&#xA;/**********************************************************************/&#xA;&#xA;    for ( i = 0; i &amp;lt; NUMFLAVORS; i++ ) {&#xA;        pthread_mutex_init ( &amp;amp;prod [i], NULL );&#xA;        pthread_mutex_init ( &amp;amp;cons [i], NULL );&#xA;        pthread_cond_init ( &amp;amp;prod_cond [i],  NULL );&#xA;        pthread_cond_init ( &amp;amp;cons_cond [i],  NULL );&#xA;        shared_ring.outptr [i]      = 0;&#xA;        shared_ring.in_ptr [i]      = 0;&#xA;        shared_ring.serial [i]      = 0;&#xA;        space_count [i]         = NUMSLOTS;&#xA;        donut_count [i]         = 0;&#xA;    }&#xA;&#xA;&#xA;&#xA;/**********************************************************************/&#xA;/* SETUP FOR MANAGING THE SIGTERM SIGNAL, BLOCK ALL SIGNALS           */&#xA;/**********************************************************************/&#xA;&#xA;    sigfillset (&amp;amp;all_signals );&#xA;    nsigs = sizeof ( sigs ) / sizeof ( int );&#xA;    for ( i = 0; i &amp;lt; nsigs; i++ ){&#xA;            sigdelset ( &amp;amp;all_signals, sigs [i] );&#xA;        }&#xA;    sigprocmask ( SIG_BLOCK, &amp;amp;all_signals, NULL );&#xA;    sigfillset (&amp;amp;all_signals );&#xA;    for( i = 0; i &amp;lt;  nsigs; i++ ) {&#xA;            new_act.sa_handler  = sig_handler;&#xA;            new_act.sa_mask     = all_signals;&#xA;            new_act.sa_flags    = 0;&#xA;            if ( sigaction ( sigs[i], &amp;amp;new_act, NULL ) == -1 ){&#xA;                    perror(&quot;can't set signals: &quot;);&#xA;                    exit(1);&#xA;            }&#xA;    }&#xA;&#xA;    printf ( &quot;just before threads created\n&quot; );&#xA;&#xA;&#xA;/*********************************************************************/&#xA;/* CREATE SIGNAL HANDLER THREAD, PRODUCER AND CONSUMERS              */&#xA;/*********************************************************************/&#xA;&#xA;        if ( pthread_create (&amp;amp;sig_wait_id, NULL,&#xA;                    sig_waiter, NULL) != 0 ){&#xA;&#xA;                printf ( &quot;pthread_create failed &quot; );&#xA;                exit ( 3 );&#xA;        }&#xA;&#xA;       pthread_attr_init ( &amp;amp;thread_attr );&#xA;       pthread_attr_setinheritsched ( &amp;amp;thread_attr,&#xA;        PTHREAD_INHERIT_SCHED );&#xA;&#xA;        #ifdef  GLOBAL&#xA;&#xA;        sched_struct.sched_priority = sched_get_priority_max(SCHED_OTHER);&#xA;        pthread_attr_setinheritsched ( &amp;amp;thread_attr,&#xA;        PTHREAD_EXPLICIT_SCHED );&#xA;        pthread_attr_setschedpolicy ( &amp;amp;thread_attr, SCHED_OTHER );&#xA;        pthread_attr_setschedparam ( &amp;amp;thread_attr, &amp;amp;sched_struct );  &#xA;        pthread_attr_setscope ( &amp;amp;thread_attr,&#xA;        PTHREAD_SCOPE_SYSTEM );&#xA;         #endif&#xA;&#xA;    if ( pthread_create (&amp;amp;thread_id[0], &amp;amp;thread_attr,&#xA;                        producer, NULL ) != 0 ) {&#xA;        printf ( &quot;pthread_create failed &quot; );&#xA;        exit ( 3 );&#xA;    }&#xA;&#xA;    for ( i = NUMPRODUCERS; i &amp;lt; NUMCONSUMERS + 1; i++ ) {&#xA;        if ( pthread_create ( &amp;amp;thread_id [i], &amp;amp;thread_attr,&#xA;                consumer, ( void * )&amp;amp;arg_array [i]) != 0 ){&#xA;            printf ( &quot;pthread_create failed&quot; );&#xA;            exit ( 3 );&#xA;        }&#xA;    }&#xA;&#xA;    printf ( &quot;just after threads created\n&quot; );&#xA;&#xA;/*********************************************************************/&#xA;/* WAIT FOR ALL CONSUMERS TO FINISH, SIGNAL WAITER WILL              */&#xA;/* NOT FINISH UNLESS A SIGTERM ARRIVES AND WILL THEN EXIT            */&#xA;/* THE ENTIRE PROCESS....OTHERWISE MAIN THREAD WILL EXIT             */&#xA;/* THE PROCESS WHEN ALL CONSUMERS ARE FINISHED                       */&#xA;/*********************************************************************/&#xA;&#xA;    for ( i = 1; i &amp;lt; NUMCONSUMERS + 1; i++ ) {&#xA;                    pthread_join ( thread_id [i], NULL ); &#xA;    }&#xA;&#xA;/*****************************************************************/&#xA;/* GET FINAL TIMESTAMP, CALCULATE ELAPSED SEC AND USEC           */&#xA;/*****************************************************************/&#xA;&#xA;&#xA;    gettimeofday (&amp;amp;last_time, ( struct timezone * ) 0 );&#xA;            if ( ( i = last_time.tv_sec - first_time.tv_sec) == 0 )&#xA;            j = last_time.tv_usec - first_time.tv_usec;&#xA;            else{&#xA;            if ( last_time.tv_usec - first_time.tv_usec &amp;lt; 0 ) {&#xA;                i--;&#xA;                j = 1000000 + &#xA;                   ( last_time.tv_usec - first_time.tv_usec );&#xA;                } else {&#xA;                j = last_time.tv_usec - first_time.tv_usec; }&#xA;                   }&#xA;    printf ( &quot;Elapsed consumer time is %d sec and %d usec\n&quot;, i, j );&#xA;&#xA;    printf ( &quot;\n\n ALL CONSUMERS FINISHED, KILLING  PROCESS\n\n&quot; );&#xA;    exit ( 0 );&#xA;}&#xA;&#xA;/*********************************************/&#xA;/* INITIAL PART OF PRODUCER.....             */&#xA;/*********************************************/&#xA;&#xA;void    *producer ( void *arg )&#xA;{&#xA;    int     i, j, k;&#xA;    int         rand_donuts;&#xA;    unsigned short  xsub1 [3];&#xA;    struct timeval  randtime;&#xA;    int threadid = pthread_self ( );&#xA;    FILE *prod_file ;&#xA;    char prod_id[10];&#xA;    char prod_filename[20]=&quot;prod_&quot;;&#xA;    gettimeofday ( &amp;amp;randtime, ( struct timezone * ) 0 );&#xA;    xsub1 [0] = ( unsigned short     )randtime.tv_usec;&#xA;    xsub1 [1] = ( unsigned short     ) ( randtime.tv_usec &amp;gt;&amp;gt; 16 );&#xA;    xsub1 [2] = ( unsigned short     ) ( pthread_self );    &#xA;&#xA;    while ( 1 ) &#xA;    {&#xA;      rand_donuts = nrand48 ( xsub1 ) &amp;amp; 3;&#xA;&#xA;      pthread_mutex_lock ( &amp;amp;prod [rand_donuts] );&#xA;&#xA;      /** check if there is space available to produce donuts **/&#xA;&#xA;    while ( space_count [rand_donuts] == 0 ) &#xA;    {&#xA;                pthread_cond_wait ( &amp;amp;prod_cond [rand_donuts], &amp;amp;prod [rand_donuts] );&#xA;        }&#xA;&#xA;&#xA;    serial[rand_donuts] ++; &#xA;&#xA;    fprintf(prod_file,&quot;thread %d is producing donuts of type :%d , serial number of donut: %d \n&quot;,threadid,rand_donuts,serial[rand_donuts]);&#xA;&#xA;    shared_ring.flavor[rand_donuts][shared_ring.in_ptr[rand_donuts]]=serial[rand_donuts];&#xA;&#xA;    /** Increment in_ptr modulo NUMSLOTS **/        &#xA;    shared_ring.in_ptr[rand_donuts] = (shared_ring.in_ptr[rand_donuts]+1) % NUMSLOTS ;&#xA;&#xA;    /** Decrement the space count **/&#xA;    space_count [rand_donuts] --; &#xA;&#xA;        pthread_mutex_unlock ( &amp;amp;prod [rand_donuts] );&#xA;&#xA;    /* get cons mutex */                &#xA;    /* inc donut count */               &#xA;    /* unlock cons mutex */         &#xA;    /* signal cons_condx_var */&#xA;&#xA;    pthread_mutex_lock(&amp;amp;cons [rand_donuts]);&#xA;&#xA;    donut_count [rand_donuts]++;&#xA;&#xA;    pthread_mutex_unlock(&amp;amp;cons [rand_donuts]);&#xA;&#xA;    pthread_cond_signal(&amp;amp;cons_cond[rand_donuts]);&#xA;&#xA;    usleep(10000);&#xA;    }&#xA;    fclose(prod_file);&#xA;    return NULL;&#xA;}&#xA;&#xA;&#xA;&#xA;/*********************************************/&#xA;/* Consumer Code ,starts here    */&#xA;/*********************************************/&#xA;&#xA;&#xA;&#xA;void    *consumer ( void *arg )&#xA;{&#xA;    int     i, j, k, m, id ,rand_donuts,outptr,numofdonut;&#xA;    unsigned short  xsub [3];&#xA;    struct timeval  randtime;&#xA;&#xA;    int printresult;&#xA;    int     serial [NUMFLAVORS];                &#xA;    int collection [NUMFLAVORS][12];    &#xA;    FILE *cons_file;&#xA;    char fileid[10];&#xA;    char cons_filename[10]=&quot;cons_&quot;;&#xA;&#xA;&#xA;    time_t current_time;&#xA;    id = *( int * ) arg;&#xA;&#xA;     sprintf(fileid, &quot;%d&quot;, id) ;    &#xA;     strcat(cons_filename,fileid);&#xA;&#xA;&#xA;&#xA;    gettimeofday ( &amp;amp;randtime, ( struct timezone * ) 0 );&#xA;    xsub [0] = ( unsigned short )randtime.tv_usec;&#xA;    xsub [1] = ( unsigned short ) ( randtime.tv_usec &amp;gt;&amp;gt; 16 );&#xA;    xsub [2] = ( unsigned short ) ( pthread_self );&#xA;&#xA;&#xA;&#xA;    if ((cons_file = fopen(cons_filename, &quot;a+&quot;)) == NULL)&#xA;           fprintf(stderr, &quot;Cannot open %s\n&quot;, &quot;cons_file&quot;);&#xA;&#xA;    for( i = 0; i &amp;lt; 10; i++ ) &#xA;    {&#xA;&#xA;&#xA;        for( k = 0; k &amp;lt; NUMFLAVORS; k++)&#xA;        {&#xA;                    for( m = 0; m &amp;lt; 12; m++)&#xA;            {&#xA;                    collection[k][m] = -1;&#xA;}&#xA;&#xA;        }&#xA;&#xA;&#xA;&#xA;        for(k = 0; k &amp;lt; NUMFLAVORS; k++)&#xA;        {&#xA;            serial [k] = 0;&#xA;        }&#xA;&#xA;&#xA;        for( m = 0; m &amp;lt; 12; m++ ) &#xA;        {&#xA;&#xA;            rand_donuts = nrand48( xsub ) &amp;amp; 3;&#xA;&#xA;&#xA;        /*******************************************************        &#xA;        get cons mutex &#xA;        check donut count&#xA;        loop:&#xA;        if donut count == 0&#xA;        wait cons_condx_var&#xA;        *******************************************************/&#xA;&#xA;            pthread_mutex_lock ( &amp;amp;cons [rand_donuts] );&#xA;            while ( donut_count [rand_donuts] == 0 ) &#xA;            {&#xA;                pthread_cond_wait ( &amp;amp;cons_cond [rand_donuts], &amp;amp;cons [rand_donuts] );&#xA;            }&#xA;&#xA;        /************************************************       &#xA;            Consume donut&#xA;        ************************************************/&#xA;&#xA;&#xA;&#xA;&#xA;            outptr = shared_ring.outptr[rand_donuts]; &#xA;            numofdonut = shared_ring.flavor[rand_donuts][outptr];&#xA;            collection[rand_donuts][serial[rand_donuts]]=numofdonut ;&#xA;            serial[rand_donuts] ++;&#xA;&#xA;            outptr ++;&#xA;            shared_ring.outptr[rand_donuts] = outptr % NUMSLOTS;&#xA;&#xA;            donut_count [rand_donuts] --; &#xA;&#xA;&#xA;&#xA;            pthread_mutex_unlock ( &amp;amp;cons [rand_donuts] );&#xA;&#xA;&#xA;&#xA;            /* lock producer mutex */&#xA;            pthread_mutex_lock(&amp;amp;prod [rand_donuts]);&#xA;&#xA;            /*increment the space count*/   &#xA;            space_count [rand_donuts] ++;&#xA;&#xA;            /* unlock producer mutex */&#xA;            pthread_mutex_unlock(&amp;amp;prod [rand_donuts]);&#xA;&#xA;            //signal the producer&#xA;            pthread_cond_signal(&amp;amp;prod_cond[rand_donuts]);&#xA;&#xA;            }&#xA;&#xA;&#xA;&#xA;&#xA;                current_time=time(NULL);&#xA;            fprintf(cons_file,&quot;Consumer %d finished collecting dozen#: %d  \n&quot;,id,i);&#xA;            fprintf(cons_file,&quot;Consumer thread#: %d , time: %s, Dozen#: %d&quot;,id,asctime(localtime(&amp;amp;current_time)),i);&#xA;            fprintf(cons_file,&quot;\t plain \t jelly \t coconut \t honey-dip \t&quot;);&#xA;            fprintf(cons_file,&quot;\n&quot;);&#xA;&#xA;            printresult=0;&#xA;for (i = 1; i &amp;lt; NoOfDozens; i++)&#xA;{&#xA;            for( m = 0; m &amp;lt; 12  &amp;amp;&amp;amp; printresult &amp;lt;=3 ; m++)&#xA;            {&#xA;                printresult = 0;&#xA;                for(k = 0; k &amp;lt; NUMFLAVORS ; k++)&#xA;                {               &#xA;                    if(collection[k][m] &amp;gt;= 0)&#xA;                    {&#xA;                        fprintf(cons_file,&quot;\t %d \t&quot;,collection[k][m]);&#xA;                        printresult = 0;&#xA;                    }&#xA;                    else&#xA;                    {&#xA;                        fprintf(cons_file,&quot;\t   \t&quot;);&#xA;                        printresult =printresult+1;&#xA;                    }                &#xA;&#xA;                }&#xA;                fprintf(cons_file,&quot;\n&quot;);                &#xA;            }&#xA;&#xA;}&#xA;&#xA;&#xA;/*Sleeping*/&#xA;&#xA;    fflush(cons_file);&#xA;         usleep(1000); /* sleep 1 ms */&#xA;         }&#xA;&#xA;&#xA;        fprintf(cons_file,&quot;Consumer %d finished  collecting all 10 dozen donuts  \n&quot;,id);&#xA;        fclose(cons_file);&#xA;         return NULL;&#xA;}&#xA;&#xA;/***********************************************************/&#xA;/* PTHREAD ASYNCH SIGNAL HANDLER ROUTINE...                */&#xA;/***********************************************************/&#xA;&#xA;void    *sig_waiter ( void *arg )&#xA;{&#xA;    sigset_t    sigterm_signal;&#xA;    int     signo;&#xA;&#xA;    sigemptyset ( &amp;amp;sigterm_signal );&#xA;    sigaddset ( &amp;amp;sigterm_signal, SIGTERM );&#xA;    sigaddset ( &amp;amp;sigterm_signal, SIGINT );&#xA;&#xA;    if (sigwait ( &amp;amp;sigterm_signal, &amp;amp; signo)  != 0 ) {&#xA;        printf ( &quot;\n  sigwait ( ) failed, exiting \n&quot;);&#xA;        exit(2);&#xA;    }&#xA;    printf ( &quot;process going down on SIGNAL (number %d)\n\n&quot;, signo );&#xA;    exit ( 1 );&#xA;    return NULL;&#xA;}&#xA;&#xA;&#xA;/**********************************************************/&#xA;/* PTHREAD SYNCH SIGNAL HANDLER ROUTINE...                */&#xA;/**********************************************************/&#xA;&#xA;void    sig_handler ( int sig )&#xA;{&#xA;    pthread_t   signaled_thread_id;&#xA;    int     i, thread_index;&#xA;&#xA;    signaled_thread_id = pthread_self ( );&#xA;    for ( i = 0; i &amp;lt; (NUMCONSUMERS + NUMPRODUCERS ); i++) {&#xA;        if ( signaled_thread_id == thread_id [i] )  {&#xA;                thread_index = i;&#xA;                break;&#xA;        }&#xA;    }&#xA;    printf ( &quot;\nThread %d took signal # %d, PROCESS HALT\n&quot;,&#xA;                thread_index, sig );&#xA;    exit ( 1 );&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Can someone please tell me where I'm going wrong and what changes I need to make?? Thanks in advance!!&lt;/p&gt;&#xA;" OwnerUserId="2830418" LastEditorUserId="2830418" LastEditDate="2013-10-17T08:23:57.040" LastActivityDate="2013-10-22T15:40:38.780" Title="Producer - Consumer using ring buffers and pthreads" Tags="&lt;c&gt;&lt;multithreading&gt;&lt;pthreads&gt;" AnswerCount="1" CommentCount="5" />
  <row Id="19443464" PostTypeId="1" CreationDate="2013-10-18T06:59:19.450" Score="1" ViewCount="80" Body="&lt;p&gt;These days, I start learning the Nucleus Plus OS. After build the OS and download the image into the board, the OS cannot run successfully. And I find the error occurs on the function CMEM_Index(); I have read the code, but I cannot find out the reason. And I even don't know how the system get the ID lists such as combo_mem_id_list.&#xA;Now here is the code for CMEM_Index().&#xA;Is there anyone know something about Nucleus Plus? Or who can tell me how can the system get the nor flash ID list? Plz.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#if defined(__DUAL_SERIAL_FLASH_SUPPORT__)&#xA;kal_int32 CMEM_Index(const kal_uint16 CS)&#xA;#else //ADMUX or Nand or SF without Dual SF enable&#xA;kal_int32 CMEM_Index()&#xA;#endif&#xA;{&#xA;    kal_int32 i, j;&#xA;    CMEMFlashID id;&#xA;    const CMEMEntryID *id_list=NULL;&#xA;&#xA;#if !defined(__DUAL_SERIAL_FLASH_SUPPORT__)&#xA;    if (cmem_index&amp;gt;=0) return cmem_index;&#xA;#endif&#xA;&#xA;// Read Flash ID&#xA;#if defined(_NAND_FLASH_BOOTING_)&#xA;    #if defined(__UBL__)&#xA;    return CMEM_INVALID_INDEX;&#xA;    #else&#xA;    if(DAL_is_initialized == 0)&#xA;    {&#xA;        DAL_init(); // Call DAL init to ensure FlashID alreay there.&#xA;    }&#xA;    MTD_ReadID(8, id.NAND);&#xA;    #endif&#xA;#elif defined(__DUAL_SERIAL_FLASH_SUPPORT__)&#xA;  #if defined(__UBL__)&#xA;    //begin from MT6255, remapping is done before NOR_ReadID&#xA;    if(CS !=2) //Skip Read ID for dummy SF2&#xA;    {&#xA;        if(EMI_QueryIsRemapped())&#xA;            NOR_ReadID(CS,(void*)0x10000000, id.NOR);&#xA;        else&#xA;            NOR_ReadID(CS, (void*)0, id.NOR);&#xA;    }&#xA;  #else&#xA;    if(CS !=2)//Skip Read ID for dummy SF2&#xA;        NOR_ReadID(CS, (void *)(INT_RetrieveFlashBaseAddr() + NOR_FLASH_BASE_ADDRESS), id.NOR);&#xA;  #endif&#xA;#else //ADMUX and SF without Dual SF enable&#xA;  #if defined(__UBL__)&#xA;    //begin from MT6255, remapping is done before NOR_ReadID&#xA;        if(EMI_QueryIsRemapped())&#xA;            NOR_ReadID(0,(void*)0x10000000, id.NOR);&#xA;        else&#xA;            NOR_ReadID(0, (void*)0, id.NOR);&#xA;  #else&#xA;        NOR_ReadID(0, (void *)(INT_RetrieveFlashBaseAddr() + NOR_FLASH_BASE_ADDRESS), id.NOR);&#xA;  #endif&#xA;#endif //defined(_NAND_FLASH_BOOTING_)&#xA;&#xA;#ifdef   __SV5_ENABLED__&#xA;    id_list=combo_mem_id_list.m_data.List;&#xA;#else&#xA;    id_list=combo_mem_id_list.List;&#xA;#endif&#xA;&#xA;    // seach CMEM list for specific Flash ID&#xA;    for (i=0; i&amp;lt;COMBO_MEM_DEVICE_COUNT; i++)    {&#xA;        // Check 1: Compare ID&#xA;        for (j=0; j&amp;lt;id_list[i].IDLength; j++) {&#xA;            #if defined(_NAND_FLASH_BOOTING_)&#xA;            if (id_list[i].ID[j]!=id.NAND[j]) break;&#xA;            #else // __SERIAL_FLASH__ || NOR FLASH&#xA;            if (id_list[i].ID[j]!=id.NOR[j]) break;&#xA;            #endif&#xA;        }&#xA;        // Check 2: Compare RegionInfo&#xA;        if (j==id_list[i].IDLength)   {&#xA;            // TBD: Compare RegionInfo&#xA;            cmem_index=i;&#xA;            break;  // entry found, break the loop&#xA;        }&#xA;    }&#xA;#if defined(__DUAL_SERIAL_FLASH_SUPPORT__)&#xA;    /*Get Dummy SF entry ID*/&#xA;    if(CS==2)&#xA;    {&#xA;        // seach CMEM list for specific Flash ID&#xA;        for (i=0; i&amp;lt;COMBO_MEM_DEVICE_COUNT; i++)    {&#xA;            // Check 1: Compare ID&#xA;            for (j=0; j&amp;lt;id_list[i].IDLength; j++) {&#xA;                if(j==0)&#xA;                    if (id_list[i].ID[j]!= 0x00) break;&#xA;                if(j==1)&#xA;                    if (id_list[i].ID[j]!= 0x34) break;&#xA;                if(j==2)&#xA;                    if (id_list[i].ID[j]!= 0x56) break;&#xA;            }&#xA;&#xA;            if (j==id_list[i].IDLength)   &#xA;            {&#xA;                // TBD: Compare RegionInfo&#xA;                cmem_index=i;&#xA;                break;  // entry found, break the loop&#xA;            }&#xA;        }&#xA;    }&#xA;#endif&#xA;&#xA;    return cmem_index;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="2637251" LastActivityDate="2013-10-18T06:59:19.450" Title="How can Nucleus get the ID list?" Tags="&lt;operating-system&gt;&lt;embedded&gt;" AnswerCount="0" CommentCount="0" />
  <row Id="19658441" PostTypeId="1" CreationDate="2013-10-29T12:38:14.393" Score="0" ViewCount="117" Body="&lt;p&gt;I use C++ for project, there includes a c header file ira.h as below:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  __cplusplus&#xA;    extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;extern inline void disable_irqs() {&#xA;    __asm__ __volatile__(&quot;\torc  #0x80,ccr\n&quot;:::&quot;cc&quot;);&#xA;}&#xA;&#xA;extern inline void enable_irqs() {&#xA;    __asm__ __volatile__(&quot;\tandc #0x7f,ccr\n&quot;:::&quot;cc&quot;);&#xA;}&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;When I compile it, I got error as below:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/usr/local/bin/h8300-hitachi-hms-g++ -DCXX -fno-rtti -fno-exceptions -O2 -fno-builtin -fomit-frame-pointer -Wall -I/brickos/include -I/brickos/include/lnp -I. -I/brickos/boot  -c rcx1.C -o rcx1.o&#xA;In file included from PowerFunctionsController.H:32,&#xA;             from rcx1.H:27,&#xA;             from rcx1.C:21:&#xA;/brickos/include/lnp/sys/irq.h: In function `void disable_irqs(...)':&#xA;/brickos/include/lnp/sys/irq.h:99: parse error before `::'&#xA;/brickos/include/lnp/sys/irq.h: In function `void enable_irqs(...)':&#xA;/brickos/include/lnp/sys/irq.h:104: parse error before `::'&#xA;make: *** [rcx1.o] Error 1&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;What can I do?&lt;/p&gt;&#xA;" OwnerUserId="424957" LastEditorUserId="111160" LastEditDate="2013-10-29T12:44:24.793" LastActivityDate="2013-10-29T12:44:24.793" Title="Syntax error in: __asm__ (&quot;some_code&quot;:::&quot;cc&quot;)" Tags="&lt;c++&gt;&lt;syntax-error&gt;" AnswerCount="1" CommentCount="7" />
  <row Id="19849217" PostTypeId="1" CreationDate="2013-11-08T00:00:56.223" Score="4" ViewCount="135" Body="&lt;p&gt;We are migrating our C application from Solaris 8 to Solaris 10. I am getting error when I run this code on Solaris 10. I am using the 32 bit gcc compiler.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;nFDs = ulimit(UL_GDESLIM, 0);&#xA;n=select(nFDs, &amp;amp;set, NULL, NULL, NULL);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Error:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Error : GetKey_(): select(): Invalid argument&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I got why I got this error, because &lt;code&gt;nFDs&lt;/code&gt; is more than 1024.&#xA;Below is from the &lt;code&gt;select.h&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  _LP64 &#xA;#define  FD_SETSIZE      65536 &#xA;#else &#xA;#define  FD_SETSIZE      1024&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Could you please give me pointer how the &lt;code&gt;ulimit(UL_GDESLIM, 0)&lt;/code&gt; and &lt;code&gt;select&lt;/code&gt; works and which header I need to fix ?&lt;/p&gt;&#xA;" OwnerUserId="2782741" LastEditorUserId="1009479" LastEditDate="2013-11-08T01:44:57.900" LastActivityDate="2013-11-08T02:56:58.390" Title="How do ulimit(UL_GDESLIM, 0) and select work?" Tags="&lt;c&gt;&lt;unix&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="19959390" PostTypeId="1" AcceptedAnswerId="19959485" CreationDate="2013-11-13T16:38:46.490" Score="2" ViewCount="2404" Body="&lt;p&gt;I'm trying to adapt this code about AVL Trees But I get compile errors&lt;/p&gt;&#xA;&#xA;&lt;p&gt;These are the errors obtained:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;gerasg@gerasg-iMac:~/Escritorio/AVLTREE$ g++ -Wall -Wextra -Werror -pedantic main.c avltree.c -o avl.exe&#xA;In file included from main.c:3:0:&#xA;avltree.h:24:7: error: expected unqualified-id before ‘delete’&#xA;avltree.h:24:7: error: expected initializer before ‘delete’&#xA;In file included from avltree.c:3:0:&#xA;avltree.h:24:7: error: expected unqualified-id before ‘delete’&#xA;avltree.h:24:7: error: expected initializer before ‘delete’&#xA;avltree.c:205:7: error: expected unqualified-id before ‘delete’&#xA;avltree.c:205:7: error: expected initializer before ‘delete’&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Before you ask me, my teacher requires us to use the g++ compiler, and write the code in C.&#xA;I know that sounds weird, but it's his desire.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;And here is the code with which I have been fighting:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;main.c:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &quot;avltree.h&quot;&#xA;&#xA;int main()&#xA;{&#xA;    node *t;&#xA;    int i;&#xA;    int j = 0;&#xA;    const int max = 10;&#xA;&#xA;    printf(&quot;--- C AVL Tree Demo  ---\n&quot;);&#xA;&#xA;    t = NULL;&#xA;&#xA;    printf(&quot;Insert: &quot;);&#xA;    for( i = 0; i &amp;lt; max; i++, j = ( j + 7 ) % max )&#xA;    {&#xA;&#xA;        t = insert( j, t );&#xA;        printf(&quot;%d &quot;,j);&#xA;&#xA;    }&#xA;    printf(&quot; into the tree\n\n&quot;);&#xA;&#xA;    display_avl(t);&#xA;&#xA;    dispose(t);&#xA;&#xA;    return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;avltree.c:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &quot;avltree.h&quot;&#xA;/*&#xA;    remove all nodes of an AVL tree&#xA;*/&#xA;void dispose(node* t)&#xA;{&#xA;    if( t != NULL )&#xA;    {&#xA;        dispose( t-&amp;gt;left );&#xA;        dispose( t-&amp;gt;right );&#xA;        free(t);&#xA;    }&#xA;}&#xA;&#xA;/*&#xA;    find a specific node's key in the tree&#xA;*/&#xA;node* find(int e, node* t )&#xA;{&#xA;    if( t == NULL )&#xA;        return NULL;&#xA;    if( e &amp;lt; t-&amp;gt;data )&#xA;        return find( e, t-&amp;gt;left );&#xA;    else if( e &amp;gt; t-&amp;gt;data )&#xA;        return find( e, t-&amp;gt;right );&#xA;    else&#xA;        return t;&#xA;}&#xA;&#xA;/*&#xA;    find minimum node's key&#xA;*/&#xA;node* find_min( node* t )&#xA;{&#xA;    if( t == NULL )&#xA;        return NULL;&#xA;    else if( t-&amp;gt;left == NULL )&#xA;        return t;&#xA;    else&#xA;        return find_min( t-&amp;gt;left );&#xA;}&#xA;&#xA;/*&#xA;    find maximum node's key&#xA;*/&#xA;node* find_max( node* t )&#xA;{&#xA;    if( t != NULL )&#xA;        while( t-&amp;gt;right != NULL )&#xA;            t = t-&amp;gt;right;&#xA;&#xA;    return t;&#xA;}&#xA;&#xA;/*&#xA;    get the height of a node&#xA;*/&#xA;int height( node* n )&#xA;{&#xA;    if( n == NULL )&#xA;        return -1;&#xA;    else&#xA;        return n-&amp;gt;height;&#xA;}&#xA;&#xA;/*&#xA;    get maximum value of two integers&#xA;*/&#xA;int max( int l, int r)&#xA;{&#xA;    return l &amp;gt; r ? l: r;&#xA;}&#xA;&#xA;/*&#xA;    perform a rotation between a k2 node and its left child&#xA;&#xA;    note: call single_rotate_with_left only if k2 node has a left child&#xA;*/&#xA;&#xA;node* single_rotate_with_left( node* k2 )&#xA;{&#xA;    node* k1 = NULL;&#xA;&#xA;    k1 = k2-&amp;gt;left;&#xA;    k2-&amp;gt;left = k1-&amp;gt;right;&#xA;    k1-&amp;gt;right = k2;&#xA;&#xA;    k2-&amp;gt;height = max( height( k2-&amp;gt;left ), height( k2-&amp;gt;right ) ) + 1;&#xA;    k1-&amp;gt;height = max( height( k1-&amp;gt;left ), k2-&amp;gt;height ) + 1;&#xA;    return k1; /* new root */&#xA;}&#xA;&#xA;/*&#xA;    perform a rotation between a node (k1) and its right child&#xA;&#xA;    note: call single_rotate_with_right only if&#xA;    the k1 node has a right child&#xA;*/&#xA;&#xA;node* single_rotate_with_right( node* k1 )&#xA;{&#xA;    node* k2;&#xA;&#xA;    k2 = k1-&amp;gt;right;&#xA;    k1-&amp;gt;right = k2-&amp;gt;left;&#xA;    k2-&amp;gt;left = k1;&#xA;&#xA;    k1-&amp;gt;height = max( height( k1-&amp;gt;left ), height( k1-&amp;gt;right ) ) + 1;&#xA;    k2-&amp;gt;height = max( height( k2-&amp;gt;right ), k1-&amp;gt;height ) + 1;&#xA;&#xA;    return k2;  /* New root */&#xA;}&#xA;&#xA;/*&#xA;&#xA;    perform the left-right double rotation,&#xA;&#xA;    note: call double_rotate_with_left only if k3 node has&#xA;    a left child and k3's left child has a right child&#xA;*/&#xA;&#xA;node* double_rotate_with_left( node* k3 )&#xA;{&#xA;    /* Rotate between k1 and k2 */&#xA;    k3-&amp;gt;left = single_rotate_with_right( k3-&amp;gt;left );&#xA;&#xA;    /* Rotate between K3 and k2 */&#xA;    return single_rotate_with_left( k3 );&#xA;}&#xA;&#xA;/*&#xA;    perform the right-left double rotation&#xA;&#xA;   notes: call double_rotate_with_right only if k1 has a&#xA;   right child and k1's right child has a left child&#xA;*/&#xA;&#xA;&#xA;&#xA;node* double_rotate_with_right( node* k1 )&#xA;{&#xA;    /* rotate between K3 and k2 */&#xA;    k1-&amp;gt;right = single_rotate_with_left( k1-&amp;gt;right );&#xA;&#xA;    /* rotate between k1 and k2 */&#xA;    return single_rotate_with_right( k1 );&#xA;}&#xA;&#xA;/*&#xA;    insert a new node into the tree&#xA;*/&#xA;node* insert(int e, node* t )&#xA;{&#xA;    if( t == NULL )&#xA;    {&#xA;        /* Create and return a one-node tree */&#xA;        t = (node*)malloc(sizeof(node));&#xA;        if( t == NULL )&#xA;        {&#xA;            fprintf (stderr, &quot;Out of memory!!! (insert)\n&quot;);&#xA;            exit(1);&#xA;        }&#xA;        else&#xA;        {&#xA;            t-&amp;gt;data = e;&#xA;            t-&amp;gt;height = 0;&#xA;            t-&amp;gt;left = t-&amp;gt;right = NULL;&#xA;        }&#xA;    }&#xA;    else if( e &amp;lt; t-&amp;gt;data )&#xA;    {&#xA;        t-&amp;gt;left = insert( e, t-&amp;gt;left );&#xA;        if( height( t-&amp;gt;left ) - height( t-&amp;gt;right ) == 2 ){&#xA;            if( e &amp;lt; t-&amp;gt;left-&amp;gt;data ){&#xA;                t = single_rotate_with_left( t );&#xA;            }&#xA;            else{&#xA;                t = double_rotate_with_left( t );&#xA;            }&#xA;        }&#xA;    }&#xA;    else if( e &amp;gt; t-&amp;gt;data )&#xA;    {&#xA;        t-&amp;gt;right = insert( e, t-&amp;gt;right );&#xA;        if( height( t-&amp;gt;right ) - height( t-&amp;gt;left ) == 2 ){&#xA;            if( e &amp;gt; t-&amp;gt;right-&amp;gt;data ){&#xA;                t = single_rotate_with_right( t );&#xA;            }&#xA;            else{&#xA;                t = double_rotate_with_right( t );&#xA;            }&#xA;        }&#xA;    }&#xA;    /* Else X is in the tree already; we'll do nothing */&#xA;&#xA;    t-&amp;gt;height = max( height( t-&amp;gt;left ), height( t-&amp;gt;right ) ) + 1;&#xA;    return t;&#xA;}&#xA;&#xA;/*&#xA;    remove a node in the tree&#xA;*/&#xA;node* delete( int e, node* t ){&#xA;    printf( &quot;Sorry Delete is unimplemented %d remains\n&quot;, e );&#xA;    return t;&#xA;}&#xA;&#xA;/*&#xA;    data data of a node&#xA;*/&#xA;int get(node* n)&#xA;{&#xA;    return n-&amp;gt;data;&#xA;}&#xA;&#xA;/*&#xA;    Recursively display AVL tree or subtree&#xA;*/&#xA;void display_avl(node* t)&#xA;{&#xA;    if (t == NULL)&#xA;        return;&#xA;    printf(&quot;%d&quot;,t-&amp;gt;data);&#xA;&#xA;    if(t-&amp;gt;left != NULL)&#xA;        printf(&quot;(L:%d)&quot;,t-&amp;gt;left-&amp;gt;data);&#xA;    if(t-&amp;gt;right != NULL)&#xA;        printf(&quot;(R:%d)&quot;,t-&amp;gt;right-&amp;gt;data);&#xA;    printf(&quot;\n&quot;);&#xA;&#xA;    display_avl(t-&amp;gt;left);&#xA;    display_avl(t-&amp;gt;right);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;avltree.h:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef AVLTREE_H&#xA;#define AVLTREE_H&#xA;&#xA;struct node{&#xA;    int data;&#xA;    struct node* left;&#xA;    struct node* right;&#xA;    int height;&#xA;};&#xA;&#xA;&#xA;&#xA;void dispose(node* t);&#xA;node* find(int e, node* t );&#xA;node* find_min( node* t );&#xA;node* find_max( node* t );&#xA;int height( node* n );&#xA;int max( int l, int r);&#xA;node* single_rotate_with_left( node* k2 );&#xA;node* single_rotate_with_right( node* k1 );&#xA;node* double_rotate_with_left( node* k3 );&#xA;node* double_rotate_with_right( node* k1 );&#xA;node* insert(int e, node* t );&#xA;node* delete( int e, node* t );&#xA;void display_avl(node* t);&#xA;int get(node* n);&#xA;&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;&#xA;&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I've checked the syntax and have not seen anything out of the ordinary ... could someone help me a bit to make it work?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thank you all.&lt;/p&gt;&#xA;" OwnerUserId="2102292" LastActivityDate="2013-11-13T16:42:46.160" Title="Unusual error: expected unqualified-id before ‘delete’/expected initializer before ‘delete’" Tags="&lt;c&gt;&lt;avl-tree&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="20010689" PostTypeId="1" AcceptedAnswerId="20010718" CreationDate="2013-11-15T21:13:09.700" Score="0" ViewCount="617" Body="&lt;p&gt;Hey everyone im very new to the C programming language and i am trying to read from a simple .txt file which contains this information:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;  13 11 2011 13 10 00 GS452 45 20&#xA;  13 11 2011 15 14 23 EI597 60 30&#xA;  13 11 2011 15 34 35 EI600 20 15&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;currently i am using fscaf to read in the whole line then store them in correct variables in my structure. I looked up online and it seems that checking for EOF isnt as straight forward as it seems using fscanf as you it returns the amount of &quot;items&quot; read.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Using my below code and the above file:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;1) which is the best way to read and store the information from the file in the correct place&lt;/p&gt;&#xA;&#xA;&lt;p&gt;2) the best way to check for EOF so it stops and the end of file/doesnt read empty files.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Header file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;  #ifndef MAYDAY_STRUCT_H&#xA;  #define   MAYDAY_STRUCT_H&#xA;&#xA;  #ifdef    __cplusplus&#xA;   extern &quot;C&quot; {&#xA;   #endif&#xA;&#xA;typedef struct {&#xA;    /* unsigned because these values cannot be negative*/&#xA;&#xA;    unsigned int day;&#xA;    unsigned int month;&#xA;    unsigned int year;&#xA;    unsigned int hour;&#xA;    unsigned int mins;&#xA;    unsigned int secs;&#xA;    char ais[5];&#xA;    unsigned int l_boat_time;&#xA;    unsigned int heli_time;&#xA;&#xA;&#xA;} mayday_call;&#xA;&#xA;void read_may_day_file();&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;main.c&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;  #include &amp;lt;stdio.h&amp;gt;&#xA;  #include &amp;lt;stdlib.h&amp;gt;&#xA;  #include &quot;mayday_struct.h&quot;&#xA;&#xA;&#xA; int main(int argc, char** argv) {&#xA;&#xA;&#xA;read_may_day_file();&#xA;&#xA;&#xA;return (EXIT_SUCCESS);&#xA; }&#xA;&#xA;void read_may_day_file() {&#xA;&#xA;char locof[30];&#xA;char eofTest;&#xA;mayday_call mday;&#xA;&#xA;&#xA;&#xA;printf(&quot;please enter the location of the input file \n&quot;);&#xA;scanf(&quot;%s&quot;, locof);&#xA;&#xA;FILE *fp;&#xA;fp = fopen(locof, &quot;r&quot;);&#xA;&#xA;&#xA;if (fp) {&#xA;&#xA;&#xA;&#xA;        fscanf(fp, &quot;%d %d %d %d %d %d %s %d %d&quot;, &amp;amp;mday.day, &amp;amp;mday.month, &amp;amp;mday.year, &amp;amp;mday.hour, &amp;amp;mday.mins, &amp;amp;mday.secs, mday.ais, &amp;amp;mday.l_boat_time, &amp;amp;mday.heli_time);&#xA;&#xA;&#xA;        printf(&quot;reading file mayday_1.txt \n&quot;&#xA;                &quot;day %d \n&quot;&#xA;                &quot;month %d \n&quot;&#xA;                &quot;yr %d \n&quot;&#xA;                &quot;hour % d\n&quot;&#xA;                &quot;mins %d \n&quot;&#xA;                &quot;sec %d \n&quot;&#xA;                &quot;ais %s \n&quot;&#xA;                &quot;lBoattime %d\n&quot;&#xA;                &quot;helitime %d \n&quot;, mday.day, mday.month,&#xA;                mday.year, mday.hour, mday.mins, mday.secs, mday.ais, mday.l_boat_time, mday.heli_time);&#xA;&#xA;        fclose(fp);&#xA;    }&#xA;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="2942536" LastActivityDate="2013-11-15T21:20:28.220" Title="C best way to read input from this test file and test for EOF" Tags="&lt;c&gt;&lt;io&gt;&lt;eof&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="20126330" PostTypeId="1" CreationDate="2013-11-21T16:19:36.970" Score="0" ViewCount="88" Body="&lt;p&gt;I face a very strange link problem with VC 2010. Now I am developing a C++ library, and in order to make debug much easier, for some functions the library provides two function interfaces. For example, &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;class Object&#xA;{&#xA;  public:&#xA;   int fun(std::vector&amp;lt;int&amp;gt; &amp;amp;auxiliary_variable_for_debug_purpose); &#xA;   int fun();&#xA; }&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It is also possible to reorganize this class in this way:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    class Object&#xA;    {&#xA;      public:&#xA;#ifdef DEBUG_INDICATOR&#xA;       int fun(std::vector&amp;lt;int&amp;gt; &amp;amp;auxiliary_variable_for_debug_purpose); &#xA;#else&#xA;       int fun();&#xA;#endif&#xA;     }&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;By doing so I except to give a clear interface to the user. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;The problem I face now is both &lt;code&gt;int fun(std::vector&amp;lt;int&amp;gt; &amp;amp;auxiliary_variable_for_debug_purpose);&lt;/code&gt; and &lt;code&gt;int fun();&lt;/code&gt; will invoke another function called &lt;code&gt;void help_function()&lt;/code&gt;, which is declared and defined in separated files.   &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;file.h&#xA;void help_function()&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;file.cpp&#xA;void help_function()&#xA;{&#xA;  // do something&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;As you can see &lt;code&gt;void help_function()&lt;/code&gt; is the same regardless whether &lt;code&gt;DEBUG_INDICATOR&lt;/code&gt; is defined or not. If I defined &lt;code&gt;DEBUG_INDICATOR&lt;/code&gt;, I can compile the class with &lt;code&gt;int fun()&lt;/code&gt; function without any problem. However, when I undefined &lt;code&gt;DEBUG_INDICATOR&lt;/code&gt;, the error &lt;code&gt;LNK2001&lt;/code&gt; error happens, suggesting unresolved external symbol void &lt;code&gt;help_function()&lt;/code&gt;. I have tried every possible means to figure it out, but failed. Any ideas will be appreciated. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;EDIT&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The library I have built is a dynamic library. Regardless whether &lt;code&gt;DEBUG_INDICATOR&lt;/code&gt; is defined, the library can be built, and the link error only happens when the library is invoked. &lt;/p&gt;&#xA;" OwnerUserId="1264018" LastEditorUserId="1264018" LastEditDate="2013-11-21T16:31:14.713" LastActivityDate="2013-11-21T18:14:38.997" Title="Strange link error when #ifdef #else is defined" Tags="&lt;c++&gt;&lt;visual-studio-2010&gt;" AnswerCount="1" CommentCount="7" />
  <row Id="20167124" PostTypeId="1" AcceptedAnswerId="20167541" CreationDate="2013-11-23T19:55:25.363" Score="2" ViewCount="1427" Body="&lt;p&gt;i have this chunk of code &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;static void err_doit(int errnoflag, int level, const char *fmt, va_list ap)&#xA;{&#xA;    int     errno_save;&#xA;    unsigned long n;&#xA;char    buf[MAXLINE];&#xA;    errno_save = errno;    &#xA;    #ifdef  HAVE_VSNPRINTF&#xA;vsnprintf(buf, sizeof(buf), fmt, ap);   /* this is safe */&#xA;    #else&#xA;vsprintf(buf ,fmt, ap);         /* this is not safe */&#xA;    #endif&#xA;n = strlen(buf);&#xA;if (errnoflag)&#xA;    snprintf(buf + n, sizeof(buf) - n, &quot;: %s&quot;, strerror(errno_save));&#xA;strcat(buf, &quot;\n&quot;);&#xA;&#xA;if (daemon_proc) {&#xA;    syslog(level,&quot;%s&quot;, buf);&#xA;} else {&#xA;    fflush(stdout);     &#xA;    fputs(buf, stderr);&#xA;    fflush(stderr);&#xA;}&#xA;return;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;when i compile it (Clang 5.0.0 with -Weverything) i obtain those warnings:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Building C object lib/netutils/CMakeFiles/netutils.dir/error.c.o&#xA;/Users/User/Desktop/project.cmake/lib/netutils/error.c:98:16: warning: format string is        not a string literal [-Wformat-nonliteral]&#xA;    vsprintf(buf ,fmt, ap);                 /* this is not safe */&#xA;                  ^~~&#xA;/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.9.sdk/usr/include/secure/_stdio.h:66:57: note: expanded from&#xA;  macro 'vsprintf'__builtin___vsprintf_chk (str, 0, __darwin_obsz(str), format, ap)&#xA;                                                    ^&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;the same thing happens with this other function vsnprintf(buf, sizeof(buf), fmt, ap);&lt;/p&gt;&#xA;&#xA;&lt;p&gt;how can i fix this warning? &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks&lt;/p&gt;&#xA;" OwnerUserId="327785" LastActivityDate="2013-11-23T21:09:02.467" Title="vsprintf and vsnprintf [-Wformat-nonliteral] warning on Clang 5.0" Tags="&lt;c&gt;&lt;network-programming&gt;&lt;clang&gt;&lt;printf&gt;" AnswerCount="1" CommentCount="1" FavoriteCount="0" />
  <row Id="20212789" PostTypeId="1" AcceptedAnswerId="20213743" CreationDate="2013-11-26T09:17:47.993" Score="0" ViewCount="54" Body="&lt;p&gt;Here is an excerpt from ntdddisk.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;typedef struct _DISK_GEOMETRY_EX {&#xA;        DISK_GEOMETRY Geometry;                                 // Standard disk geometry: may be faked by driver.&#xA;        LARGE_INTEGER DiskSize;                                 // Must always be correct&#xA;        UCHAR Data[1];                                                  // Partition, Detect info&#xA;} DISK_GEOMETRY_EX, *PDISK_GEOMETRY_EX;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;What is the point of &lt;code&gt;UCHAR Data[1];&lt;/code&gt;? Why not just &lt;code&gt;UCHAR Data;&lt;/code&gt; ?&#xA;And there are a lot of structures in DDK which have arrays of one element in declarations.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks, thats clear now. The one thing is not clear the implementation of offsetof.&#xA;It's defined as&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  _WIN64&#xA;#define offsetof(s,m)   (size_t)( (ptrdiff_t)&amp;amp;(((s *)0)-&amp;gt;m) )&#xA;#else&#xA;#define offsetof(s,m)   (size_t)&amp;amp;(((s *)0)-&amp;gt;m)&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;How this works:&#xA;&lt;code&gt;((s *)0)-&amp;gt;m&lt;/code&gt; ???&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;(size_t)&amp;amp;((DISK_GEOMETRY_EX *)0)-&amp;gt;Data &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;is like &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;sizeof (DISK_GEOMETRY) + sizeof( LARGE_INTEGER);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But there is two additional questions:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;1)&#xA; What type is this? And why we should use &amp;amp; for this?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;((DISK_GEOMETRY_EX *)0)-&amp;gt;Data&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;2) &lt;code&gt;((DISK_GEOMETRY_EX *)0)&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This gives me 00000000. Is it convering to the address alignment? interpret it like an address?&lt;/p&gt;&#xA;" OwnerUserId="530589" LastEditorUserId="530589" LastEditDate="2013-11-26T10:54:13.983" LastActivityDate="2013-11-26T10:54:13.983" Title="What is the point of using arrays of one element in ddk structures?" Tags="&lt;visual-c++&gt;&lt;winddk&gt;&lt;ddk&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="20384656" PostTypeId="1" AcceptedAnswerId="20384875" CreationDate="2013-12-04T19:54:02.923" Score="1" ViewCount="5266" Body="&lt;p&gt;Team,&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have an environment variable which i would like to undefined/unset during the  compilation of that particular project and then enable that back..&lt;/p&gt;&#xA;&#xA;&lt;p&gt;i have tried using.. the below code..&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;ifdef ${ENV_VAR_TEST}&#xA;    undefine ${ENV_VAR_TEST}&#xA;    endif&#xA;&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;but i still see that its get reflected in the compilation environment... are these correct steps to undefined/unset a variable ?..i am i missing some basics here..&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks for your time .&lt;/p&gt;&#xA;" OwnerUserId="2189668" LastActivityDate="2013-12-04T20:57:59.400" Title="can we undefine/unset a variable in makefile" Tags="&lt;makefile&gt;&lt;gnu-make&gt;" AnswerCount="3" CommentCount="1" FavoriteCount="1" />
  <row Id="20397675" PostTypeId="1" AcceptedAnswerId="20397926" CreationDate="2013-12-05T10:36:56.457" Score="1" ViewCount="221" Body="&lt;p&gt;I'm developing a simple instant-messaging software on Ubuntu 12.10， it's client requires GUI. &lt;br&gt;&#xA;  In the main window of the client, i need to create a thread to keep listening messages received from the server.&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;Here is the error message:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;main.cpp:-1: In function 'int main(int, char**)':&#xA;main.cpp:27: error: invalid conversion from 'void*' to 'void* (*)(void*)' [-fpermissive]&#xA;&#xA; /usr/include/pthread.h:225: error:   initializing argument 3 of 'int pthread_create(pthread_t*, const pthread_attr_t*, void* (*)(void*), void*)' [-fpermissive]&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;In the &lt;code&gt;maininterface.h&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Class MainInterface: public QWidget&#xA;{&#xA;public:&#xA;    explicit MainInterface(QWidget *parent = 0);&#xA;    ~MainInterface();&#xA;    void* ServerMSGWatch(void *threadArgs=NULL); // function run in the new thread&#xA;&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;It's definition in &lt;code&gt;maininterface.cpp&lt;/code&gt; is:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;void* MainInterface::ServerMSGWatch(void *threadArgs)&#xA;{&#xA;    pthread_detach(pthread_self());&#xA;    char arrServerMSGRecv[SERVER_MSG_MAX_SIZE + 1];&#xA;    while(1){&#xA;        recv(Login::sockClnt, arrServerMSGRecv, SERVER_MSG_MAX_SIZE+1, 0);&#xA;        Handle_Server_MSG(arrServerMSGRecv); &#xA;        memset(arrServerMSGRecv, 0, SERVER_MSG_MAX_SIZE+1);&#xA;    }&#xA;    return NULL;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;in &lt;code&gt;main.cpp&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;MainInterface mWindow;&#xA;mWindow.show();&#xA;pthread_t pthreadID;&#xA;pthread_create(&amp;amp;pthreadID, NULL, mWindow.ServerMSGWatch(), NULL); &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;and in this &lt;a href=&quot;http://stackoverflow.com/questions/11758121/error-invalid-conversion-from-void-to-void-void-pthreads&quot;&gt;question&lt;/a&gt;, i figured out that maybe there's something wrong with using a C++ compiler to compile c code.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;so i tried to add a 'c_pthread.h':&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef C_PTHREAD_H&#xA;#define C_PTHREAD_H&#xA;&#xA;#ifdef  __cplusplus&#xA;&#xA;extern &quot;C&quot; {&#xA;&#xA;#endif&#xA;&#xA;void* ServerMSGWatch(void *threadArgs=NULL);&#xA;void Handle_Server_MSG(char *arrServerMSGRecv);&#xA;&#xA;#ifdef  __cplusplus&#xA;&#xA;}&#xA;#endif&#xA;#endif // C_PTHREAD_H&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;and &lt;code&gt;c_pthread.cpp&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;void* ServerMSGWatch(void *threadArgs=NULL)&#xA;{&#xA;     //definition&#xA;}&#xA;&#xA;void Handle_Server_MSG(char *arrServerMSGRecv)&#xA;{&#xA;    //definition&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;then invoke it in &lt;code&gt;main.cpp&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;c_pthread.h&quot;&#xA;pthread_t pthreadID;&#xA;pthread_create(&amp;amp;pthreadID, NULL, ServerMSGWatch(), NULL); &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but i still got the same error. &lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;PS: sorry about some malapropisms.&lt;/p&gt;&#xA;" OwnerUserId="3069208" LastActivityDate="2013-12-05T11:02:55.473" Title="Create a new thread using C in Qt4.8" Tags="&lt;c++&gt;&lt;c&gt;&lt;linux&gt;&lt;qt&gt;&lt;pthreads&gt;" AnswerCount="4" CommentCount="1" />
  <row Id="20408608" PostTypeId="1" AcceptedAnswerId="20434319" CreationDate="2013-12-05T19:15:40.787" Score="0" ViewCount="359" Body="&lt;p&gt;I tried to compile a simple C program with a header, a main, and another source file in &lt;code&gt;Netbeans&lt;/code&gt; but it didn't work. I always get a huge error message.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have absolutely no idea what I can do to make it work. Hope you guy can help me.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;console:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&quot;/usr/bin/make&quot; -f nbproject/Makefile-Debug.mk QMAKE= SUBPROJECTS= .build-conf&#xA;make[1]: Entering directory `/home/***/***/***/***/***/headertest'&#xA;nbproject/Makefile-Debug.mk:73: warning: overriding commands for target `build/Debug/GNU-Linux-x86/header.o'&#xA;nbproject/Makefile-Debug.mk:68: warning: ignoring old commands for target `build/Debug/GNU-Linux-x86/header.o'&#xA;&quot;/usr/bin/make&quot;  -f nbproject/Makefile-Debug.mk dist/Debug/GNU-Linux-x86/headertest&#xA;make[2]: Entering directory `//home/***/***/***/***/***/headertest'&#xA;nbproject/Makefile-Debug.mk:73: warning: overriding commands for target `build/Debug/GNU-Linux-x86/header.o'&#xA;nbproject/Makefile-Debug.mk:68: warning: ignoring old commands for target `build/Debug/GNU-Linux-x86/header.o'&#xA;mkdir -p build/Debug/GNU-Linux-x86&#xA;rm -f &quot;build/Debug/GNU-Linux-x86/header.o.d&quot;&#xA;gcc    -c -g -MMD -MP -MF &quot;build/Debug/GNU-Linux-x86/header.o.d&quot; -o build/Debug/GNU-Linux-x86/header.o header.h&#xA;mkdir -p build/Debug/GNU-Linux-x86&#xA;rm -f &quot;build/Debug/GNU-Linux-x86/main.o.d&quot;&#xA;gcc    -c -g -MMD -MP -MF &quot;build/Debug/GNU-Linux-x86/main.o.d&quot; -o build/Debug/GNU-Linux-x86/main.o main.c&#xA;mkdir -p dist/Debug/GNU-Linux-x86&#xA;gcc     -o dist/Debug/GNU-Linux-x86/headertest build/Debug/GNU-Linux-x86/header.o build/Debug/GNU-Linux-x86/header.o build/Debug/GNU-Linux-x86/main.o&#xA;/usr/bin/ld:build/Debug/GNU-Linux-x86/header.o: file format not recognized; treating as linker script&#xA;/usr/bin/ld:build/Debug/GNU-Linux-x86/header.o:1: syntax error&#xA;collect2: error: ld returned 1 exit status&#xA;make[2]: *** [dist/Debug/GNU-Linux-x86/headertest] Error 1&#xA;make[2]: Leaving directory `/home/***/***/***/***/***/headertest'&#xA;make[1]: *** [.build-conf] Error 2&#xA;make[1]: Leaving directory `/home/***/***/***/***/***/headertest'&#xA;make: *** [.build-impl] Error 2&#xA;&#xA;BUILD FAILED (exit value 2, total time: 283ms)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Here is the rest of my code:&#xA;main.c&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &quot;header.h&quot;&#xA;&#xA;int main(int argc, char** argv) {&#xA;&#xA;    lol();&#xA;&#xA;    return (EXIT_SUCCESS);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;header.c&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;header.h&quot;&#xA;&#xA;void lol(){&#xA;    printf(&quot;lol&quot;);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;header.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef HEADER_H&#xA;#define   HEADER_H&#xA;#ifdef   __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;void lol();&#xA;&#xA;#ifdef   __cplusplus&#xA;}&#xA;#endif&#xA;#endif   /* HEADER_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3071626" LastEditorUserId="3041194" LastEditDate="2013-12-05T19:19:23.947" LastActivityDate="2013-12-06T21:57:58.557" Title="using header in netbeans C" Tags="&lt;c&gt;&lt;netbeans&gt;&lt;header&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="20424623" PostTypeId="1" CreationDate="2013-12-06T13:04:00.103" Score="7" ViewCount="2603" Body="&lt;p&gt;I really like the cross-compile/platform ease for many tasks that I can get with GO.  I have a question regarding, I guess, the equivalent of a #ifdef / #else type of construct for executing/compiling a function based upon the operating system.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here's the scenario - let's say I have a function that inserts information into the OS's control structures to launch a process at the next time the user starts up their system.  On Windows I would update the 'RUN/RUNONCE' registry entry for the user, on MAC there would be a plist entry, etc.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;In essence, I'd like to be able to write someone analogous to this (or have overloaded OS specific functions):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;func setStartupProcessLaunch () {&#xA;    if [OS is Windows] {&#xA;        updateRegistry(){}&#xA;    } else if [OS is Darwin] {&#xA;        updatePlist(){}&#xA;    } else if [OS is Linux] {&#xA;        doLinuxthing() {}&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Given the static compilation, any of the routines that aren't called would be flagged as a compilation error.  So ideally, I'd like to surround my 'doSpecificOS()' functions in #ifdef WINDOWS, #ifdef MAC type of blocks -- what's the proper way to accomplish this?  My hope is that I don't need to create several project trees of the same program for each OS platform.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thx!&lt;/p&gt;&#xA;" OwnerUserId="2644113" LastActivityDate="2013-12-06T14:11:10.117" Title="GOLANG: Proper way to choose func at runtime for different operating systems" Tags="&lt;go&gt;" AnswerCount="3" CommentCount="1" FavoriteCount="2" />
  <row Id="20439640" PostTypeId="1" AcceptedAnswerId="20472017" CreationDate="2013-12-07T09:12:05.410" Score="6" ViewCount="3223" Body="&lt;p&gt;I am writing an audio transcoding application using ffmpeg libraries. &#xA;Here is my code &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    /*&#xA;     * File:   main.cpp&#xA;     * Author: vinod&#xA;     * Compile with &quot;g++ -std=c++11 -o audiotranscode main.cpp -lavformat -lavcodec -lavutil -lavfilter&quot;&#xA;     * &#xA;     */&#xA;&#xA;&#xA;    #if !defined PRId64 || PRI_MACROS_BROKEN&#xA;    #undef PRId64&#xA;    #define PRId64 &quot;lld&quot;&#xA;    #endif&#xA;&#xA;    #define __STDC_FORMAT_MACROS&#xA;&#xA;    #ifdef   __cplusplus&#xA;    extern &quot;C&quot; {&#xA;    #endif&#xA;&#xA;    #include &amp;lt;stdio.h&amp;gt;&#xA;    #include &amp;lt;stdlib.h&amp;gt;&#xA;    #include &amp;lt;sys/types.h&amp;gt;&#xA;    #include &amp;lt;stdint.h&amp;gt;&#xA;    #include &amp;lt;libavutil/imgutils.h&amp;gt;&#xA;    #include &amp;lt;libavutil/samplefmt.h&amp;gt;&#xA;    #include &amp;lt;libavutil/frame.h&amp;gt;&#xA;    #include &amp;lt;libavutil/timestamp.h&amp;gt;&#xA;    #include &amp;lt;libavformat/avformat.h&amp;gt;&#xA;    #include &amp;lt;libavfilter/avfilter.h&amp;gt;&#xA;    #include &amp;lt;libavfilter/buffersrc.h&amp;gt;&#xA;    #include &amp;lt;libavfilter/buffersink.h&amp;gt;&#xA;    #include &amp;lt;libswscale/swscale.h&amp;gt;&#xA;    #include &amp;lt;libavutil/opt.h&amp;gt;&#xA;&#xA;    #ifdef   __cplusplus&#xA;    }&#xA;    #endif&#xA;&#xA;    #include &amp;lt;iostream&amp;gt;&#xA;    using namespace std;&#xA;&#xA;    int select_stream, got_frame, got_packet;&#xA;&#xA;    AVFormatContext *in_fmt_ctx = NULL, *out_fmt_ctx = NULL;&#xA;    AVCodec *dec_codec = NULL, * enc_codec = NULL;&#xA;    AVStream *audio_st = NULL;&#xA;    AVCodecContext *enc_ctx = NULL, *dec_ctx = NULL;&#xA;&#xA;    AVFrame *pFrame = NULL, * pFrameFiltered = NULL;&#xA;&#xA;    AVFilterGraph *filter_graph = NULL;&#xA;    AVFilterContext *buffersrc_ctx = NULL;&#xA;    AVFilterContext *buffersink_ctx = NULL;&#xA;&#xA;    AVPacket packet;&#xA;&#xA;    string inFileName = &quot;/home/vinod/vinod/Media/univac.webm&quot;;&#xA;    string outFileName = &quot;audio_extracted.m4a&quot;;&#xA;&#xA;    int target_bit_rate = 128000,&#xA;        sample_rate = 22050,&#xA;        channels = 1;&#xA;    AVSampleFormat sample_fmt = AV_SAMPLE_FMT_S16;&#xA;    string filter_description = &quot;aresample=22050,aformat=sample_fmts=s16:channel_layouts=mono&quot;;&#xA;&#xA;    int log_averror(int errcode)&#xA;    {&#xA;            char *errbuf = (char *) calloc(AV_ERROR_MAX_STRING_SIZE, sizeof(char));&#xA;            av_strerror(errcode, errbuf, AV_ERROR_MAX_STRING_SIZE);&#xA;            std::cout &amp;lt;&amp;lt; &quot;Error - &quot; &amp;lt;&amp;lt; errbuf &amp;lt;&amp;lt; std::endl;&#xA;            delete [] errbuf;&#xA;            return -1;&#xA;    }&#xA;&#xA;    /**&#xA;     * Initialize conversion filter */&#xA;    int initialize_audio_filter()&#xA;    {&#xA;            char args[512];&#xA;            int ret;&#xA;            AVFilter *buffersrc = avfilter_get_by_name(&quot;abuffer&quot;);&#xA;            AVFilter *buffersink = avfilter_get_by_name(&quot;abuffersink&quot;);&#xA;            AVFilterInOut *outputs = avfilter_inout_alloc();&#xA;            AVFilterInOut *inputs = avfilter_inout_alloc();&#xA;            filter_graph = avfilter_graph_alloc();&#xA;            const enum AVSampleFormat out_sample_fmts[] = {sample_fmt, AV_SAMPLE_FMT_NONE};&#xA;            const int64_t out_channel_layouts[] = {av_get_default_channel_layout(out_fmt_ctx -&amp;gt; streams[0] -&amp;gt; codec -&amp;gt; channels), -1};&#xA;            const int out_sample_rates[] = {out_fmt_ctx -&amp;gt; streams[0] -&amp;gt; codec -&amp;gt; sample_rate, -1};&#xA;&#xA;            if (!dec_ctx-&amp;gt;channel_layout)&#xA;                    dec_ctx-&amp;gt;channel_layout = av_get_default_channel_layout(dec_ctx-&amp;gt;channels);&#xA;&#xA;            snprintf(args, sizeof(args), &quot;time_base=%d/%d:sample_rate=%d:sample_fmt=%s:channel_layout=0x%&quot; PRIx64,&#xA;                     in_fmt_ctx -&amp;gt; streams[select_stream] -&amp;gt; time_base.num, in_fmt_ctx -&amp;gt; streams[select_stream] -&amp;gt; time_base.den,&#xA;                     dec_ctx-&amp;gt;sample_rate,&#xA;                     av_get_sample_fmt_name(dec_ctx-&amp;gt;sample_fmt),&#xA;                     dec_ctx-&amp;gt;channel_layout);&#xA;            ret = avfilter_graph_create_filter(&amp;amp;buffersrc_ctx, buffersrc, &quot;in&quot;, args, NULL, filter_graph);&#xA;&#xA;            if (ret &amp;lt; 0) {&#xA;                    av_log(NULL, AV_LOG_ERROR, &quot;Cannot create buffer source\n&quot;);&#xA;                    return -1;&#xA;            }&#xA;&#xA;            ret = avfilter_graph_create_filter(&amp;amp;buffersink_ctx, buffersink, &quot;out&quot;, NULL, NULL, filter_graph);&#xA;&#xA;            if (ret &amp;lt; 0) {&#xA;                    av_log(NULL, AV_LOG_ERROR, &quot;Cannot create buffer sink\n&quot;);&#xA;                    return ret;&#xA;            }&#xA;&#xA;            ret = av_opt_set_int_list(buffersink_ctx, &quot;sample_fmts&quot;, out_sample_fmts, -1,&#xA;                                      AV_OPT_SEARCH_CHILDREN);&#xA;&#xA;            if (ret &amp;lt; 0) {&#xA;                    av_log(NULL, AV_LOG_ERROR, &quot;Cannot set output sample format\n&quot;);&#xA;                    return ret;&#xA;            }&#xA;&#xA;            ret = av_opt_set_int_list(buffersink_ctx, &quot;channel_layouts&quot;, out_channel_layouts, -1,&#xA;                                      AV_OPT_SEARCH_CHILDREN);&#xA;&#xA;            if (ret &amp;lt; 0) {&#xA;                    av_log(NULL, AV_LOG_ERROR, &quot;Cannot set output channel layout\n&quot;);&#xA;                    return ret;&#xA;            }&#xA;&#xA;            ret = av_opt_set_int_list(buffersink_ctx, &quot;sample_rates&quot;, out_sample_rates, -1,&#xA;                                      AV_OPT_SEARCH_CHILDREN);&#xA;&#xA;            if (ret &amp;lt; 0) {&#xA;                    av_log(NULL, AV_LOG_ERROR, &quot;Cannot set output sample rate\n&quot;);&#xA;                    return ret;&#xA;            }&#xA;&#xA;            /* Endpoints for the filter graph. */&#xA;            outputs -&amp;gt; name = av_strdup(&quot;in&quot;);&#xA;            outputs -&amp;gt; filter_ctx = buffersrc_ctx;&#xA;            outputs -&amp;gt; pad_idx = 0;&#xA;            outputs -&amp;gt; next = NULL;&#xA;            /* Endpoints for the filter graph. */&#xA;            inputs -&amp;gt; name = av_strdup(&quot;out&quot;);&#xA;            inputs -&amp;gt; filter_ctx = buffersink_ctx;&#xA;            inputs -&amp;gt; pad_idx = 0;&#xA;            inputs -&amp;gt; next = NULL;&#xA;            string filter_desc = filter_description;&#xA;&#xA;            if ((ret = avfilter_graph_parse_ptr(filter_graph, filter_desc.c_str(), &amp;amp;inputs, &amp;amp;outputs, NULL)) &amp;lt; 0) {&#xA;                    log_averror(ret);&#xA;                    exit(1);&#xA;            }&#xA;&#xA;            if ((ret = avfilter_graph_config(filter_graph, NULL)) &amp;lt; 0) {&#xA;                    log_averror(ret);&#xA;                    exit(1);&#xA;            }&#xA;&#xA;            /* Print summary of the sink buffer&#xA;             * Note: args buffer is reused to store channel layout string */&#xA;            AVFilterLink *outlink = buffersink_ctx-&amp;gt;inputs[0];&#xA;            av_get_channel_layout_string(args, sizeof(args), -1, outlink-&amp;gt;channel_layout);&#xA;            av_log(NULL, AV_LOG_INFO, &quot;Output: srate:%dHz fmt:%s chlayout:%s\n&quot;,&#xA;                   (int) outlink-&amp;gt;sample_rate,&#xA;                   (char *) av_x_if_null(av_get_sample_fmt_name((AVSampleFormat) outlink-&amp;gt;format), &quot;?&quot;),&#xA;                   args);&#xA;            return 0;&#xA;    }&#xA;&#xA;    /*&#xA;     *&#xA;     */&#xA;    int main(int argc, char **argv)&#xA;    {&#xA;            int ret;&#xA;            cout &amp;lt;&amp;lt; &quot;Hello World&quot; &amp;lt;&amp;lt; endl;&#xA;            printf(&quot;abcd&quot;);&#xA;            avcodec_register_all();&#xA;            av_register_all();&#xA;            avfilter_register_all();&#xA;&#xA;            /* open input file, and allocate format context */&#xA;            if (avformat_open_input(&amp;amp;in_fmt_ctx, inFileName.c_str(), NULL, NULL) &amp;lt; 0) {&#xA;                    std::cout &amp;lt;&amp;lt; &quot;error opening input file - &quot; &amp;lt;&amp;lt; inFileName &amp;lt;&amp;lt; std::endl;&#xA;                    return -1;&#xA;            }&#xA;&#xA;            /* retrieve stream information */&#xA;            if (avformat_find_stream_info(in_fmt_ctx, NULL) &amp;lt; 0) {&#xA;                    std::cerr &amp;lt;&amp;lt; &quot;Could not find stream information in the input file &quot; &amp;lt;&amp;lt; inFileName &amp;lt;&amp;lt; std::endl;&#xA;            }&#xA;&#xA;            /* Dump format details */&#xA;            printf(&quot;\n ---------------------------------------------------------------------- \n&quot;);&#xA;            av_dump_format(in_fmt_ctx, 0, inFileName.c_str(), 0);&#xA;            printf(&quot;\n ---------------------------------------------------------------------- \n&quot;);&#xA;            /* Choose a audio stream */&#xA;            select_stream = av_find_best_stream(in_fmt_ctx, AVMEDIA_TYPE_AUDIO, -1, -1, &amp;amp;dec_codec, 0);&#xA;&#xA;            if (select_stream == AVERROR_STREAM_NOT_FOUND) {&#xA;                    std::cerr &amp;lt;&amp;lt; &quot;No audio stream found&quot; &amp;lt;&amp;lt; std::endl;&#xA;                    return -1;&#xA;            }&#xA;&#xA;            if (select_stream == AVERROR_DECODER_NOT_FOUND) {&#xA;                    std::cerr &amp;lt;&amp;lt; &quot;No suitable decoder found&quot; &amp;lt;&amp;lt; std::endl;&#xA;                    return -1;&#xA;            }&#xA;&#xA;            dec_ctx = in_fmt_ctx -&amp;gt; streams[ select_stream] -&amp;gt; codec;&#xA;            av_opt_set_int(dec_ctx, &quot;refcounted_frames&quot;, 1, 0);&#xA;&#xA;            /* init the audio decoder */&#xA;            if ((ret = avcodec_open2(dec_ctx, dec_codec, NULL)) &amp;lt; 0) {&#xA;                    av_log(NULL, AV_LOG_ERROR, &quot;Cannot open audio decoder\n&quot;);&#xA;                    return ret;&#xA;            }&#xA;&#xA;            /* allocate output context */&#xA;            ret = avformat_alloc_output_context2(&amp;amp;out_fmt_ctx, NULL, NULL,&#xA;                                                 outFileName.c_str());&#xA;&#xA;            if (ret &amp;lt; 0) {&#xA;                    std::cerr &amp;lt;&amp;lt; &quot;Could not create output context for the file &quot; &amp;lt;&amp;lt; outFileName &amp;lt;&amp;lt; std::endl;&#xA;                    return -1;&#xA;            }&#xA;&#xA;            /* find the encoder */&#xA;            enum AVCodecID codec_id = out_fmt_ctx -&amp;gt; oformat -&amp;gt; audio_codec;&#xA;            enc_codec = avcodec_find_encoder(codec_id);&#xA;&#xA;            if (!(enc_codec)) {&#xA;                    std::cerr &amp;lt;&amp;lt; &quot;Could not find encoder for - &quot; &amp;lt;&amp;lt; avcodec_get_name(codec_id) &amp;lt;&amp;lt; std::endl;&#xA;                    return -1;&#xA;            }&#xA;&#xA;            /* add a new stream */&#xA;            audio_st = avformat_new_stream(out_fmt_ctx, enc_codec);&#xA;&#xA;            if (!audio_st) {&#xA;                    std::cerr &amp;lt;&amp;lt; &quot;Could not add audio stream - &quot; &amp;lt;&amp;lt; std::endl;&#xA;            }&#xA;&#xA;            /* Initialise audio codec */&#xA;            audio_st -&amp;gt; id = out_fmt_ctx -&amp;gt; nb_streams - 1;&#xA;            enc_ctx = audio_st -&amp;gt; codec;&#xA;            enc_ctx -&amp;gt; codec_id = codec_id;&#xA;            enc_ctx -&amp;gt; codec_type = AVMEDIA_TYPE_AUDIO;&#xA;            enc_ctx -&amp;gt; bit_rate = target_bit_rate;&#xA;            enc_ctx -&amp;gt; sample_rate = sample_rate;&#xA;            enc_ctx -&amp;gt; sample_fmt = sample_fmt;&#xA;            enc_ctx -&amp;gt; channels = channels;&#xA;            enc_ctx -&amp;gt; channel_layout = av_get_default_channel_layout(enc_ctx -&amp;gt; channels);&#xA;&#xA;            /* Some formats want stream headers to be separate. */&#xA;            if (out_fmt_ctx -&amp;gt; oformat -&amp;gt; flags &amp;amp; AVFMT_GLOBALHEADER) {&#xA;                    enc_ctx -&amp;gt; flags |= CODEC_FLAG_GLOBAL_HEADER;&#xA;            }&#xA;&#xA;            ret = avcodec_open2(out_fmt_ctx -&amp;gt; streams[0] -&amp;gt; codec, enc_codec, NULL);&#xA;&#xA;            if (ret &amp;lt; 0) {&#xA;                    std::cerr &amp;lt;&amp;lt; &quot;Could not create codec context for the file &quot; &amp;lt;&amp;lt; outFileName &amp;lt;&amp;lt; std::endl;&#xA;                    return -1;&#xA;            }&#xA;&#xA;            /* Initialize filter */&#xA;            initialize_audio_filter();&#xA;&#xA;            if (!(out_fmt_ctx -&amp;gt; oformat -&amp;gt; flags &amp;amp; AVFMT_NOFILE)) {&#xA;                    int ret = avio_open(&amp;amp; out_fmt_ctx -&amp;gt; pb, outFileName.c_str(),&#xA;                                        AVIO_FLAG_WRITE);&#xA;&#xA;                    if (ret &amp;lt; 0) {&#xA;                            log_averror(ret);&#xA;                            return -1;&#xA;                    }&#xA;            }&#xA;&#xA;            /* Write header */&#xA;            if (avformat_write_header(out_fmt_ctx, NULL) &amp;lt; 0) {&#xA;                    if (ret &amp;lt; 0) {&#xA;                            log_averror(ret);&#xA;                            return -1;&#xA;                    }&#xA;            }&#xA;&#xA;            /* Allocate frame */&#xA;            pFrame = av_frame_alloc();&#xA;&#xA;            if (!pFrame) {&#xA;                    std::cerr &amp;lt;&amp;lt; &quot;Could not allocate frame\n&quot;;&#xA;                    return -1;&#xA;            }&#xA;&#xA;            pFrameFiltered = av_frame_alloc();&#xA;&#xA;            if (!pFrameFiltered) {&#xA;                    std::cerr &amp;lt;&amp;lt; &quot;Could not allocate frame\n&quot;;&#xA;                    return -1;&#xA;            }&#xA;&#xA;            av_init_packet(&amp;amp;packet);&#xA;            packet.data = NULL;&#xA;            packet.size = 0;&#xA;&#xA;            /* Read packet from the stream */&#xA;            while (av_read_frame(in_fmt_ctx, &amp;amp;packet) &amp;gt;= 0) {&#xA;                    if (packet.stream_index == select_stream) {&#xA;                            avcodec_get_frame_defaults(pFrame);&#xA;                            ret = avcodec_decode_audio4(dec_ctx, pFrame, &amp;amp;got_frame, &amp;amp;packet);&#xA;&#xA;                            if (ret &amp;lt; 0) {&#xA;                                    log_averror(ret);&#xA;                                    return ret;&#xA;                            }&#xA;&#xA;                            printf(&quot;Decoded packet pts : %ld &quot;, packet.pts);&#xA;                            printf(&quot;Frame Best Effor pts : %ld \n&quot;, pFrame-&amp;gt;best_effort_timestamp);&#xA;                            /* Set frame pts */&#xA;                            pFrame -&amp;gt; pts = av_frame_get_best_effort_timestamp(pFrame);&#xA;&#xA;                            if (got_frame) {&#xA;                                    /* push the decoded frame into the filtergraph */&#xA;                                    ret = av_buffersrc_add_frame_flags(buffersrc_ctx, pFrame, AV_BUFFERSRC_FLAG_KEEP_REF);&#xA;&#xA;                                    if (ret &amp;lt; 0) {&#xA;                                            log_averror(ret);&#xA;                                            return ret;&#xA;                                    }&#xA;&#xA;                                    /* pull filtered frames from the filtergraph */&#xA;                                    while (1) {&#xA;                                            ret = av_buffersink_get_frame(buffersink_ctx, pFrameFiltered);&#xA;&#xA;                                            if ((ret == AVERROR(EAGAIN)) || (ret == AVERROR_EOF)) {&#xA;                                                    break;&#xA;                                            }&#xA;&#xA;                                            if (ret &amp;lt; 0) {&#xA;                                                    printf(&quot;Error while getting filtered frames from filtergraph\n&quot;);&#xA;                                                    log_averror(ret);&#xA;                                                    return -1;&#xA;                                            }&#xA;&#xA;                                            /* Initialize the packets */&#xA;                                            AVPacket encodedPacket = {0};&#xA;                                            av_init_packet(&amp;amp;encodedPacket);&#xA;                                            ret = avcodec_encode_audio2(out_fmt_ctx -&amp;gt; streams[0] -&amp;gt; codec, &amp;amp;encodedPacket, pFrameFiltered, &amp;amp;got_packet);&#xA;&#xA;                                            if (!ret &amp;amp;&amp;amp; got_packet &amp;amp;&amp;amp; encodedPacket.size) {&#xA;                                                    /* Set correct pts and dts */&#xA;                                                    if (encodedPacket.pts != AV_NOPTS_VALUE) {&#xA;                                                            encodedPacket.pts = av_rescale_q(encodedPacket.pts, buffersink_ctx -&amp;gt; inputs[0] -&amp;gt; time_base,&#xA;                                                                                             out_fmt_ctx -&amp;gt; streams[0] -&amp;gt; time_base);&#xA;                                                    }&#xA;&#xA;                                                    if (encodedPacket.dts != AV_NOPTS_VALUE) {&#xA;                                                            encodedPacket.dts = av_rescale_q(encodedPacket.dts, buffersink_ctx -&amp;gt; inputs[0] -&amp;gt; time_base,&#xA;                                                                                             out_fmt_ctx -&amp;gt; streams[0] -&amp;gt; time_base);&#xA;                                                    }&#xA;&#xA;                                                    printf(&quot;Encoded packet pts %ld\n&quot;, encodedPacket.pts);&#xA;                                                    /* Write the compressed frame to the media file. */&#xA;                                                    ret = av_interleaved_write_frame(out_fmt_ctx, &amp;amp;encodedPacket);&#xA;&#xA;                                                    if (ret &amp;lt; 0) {&#xA;                                                            log_averror(ret);&#xA;                                                            return -1;&#xA;                                                    }&#xA;                                            } else if (ret &amp;lt; 0) {&#xA;                                                    log_averror(ret);&#xA;                                                    return -1;&#xA;                                            }&#xA;&#xA;                                            av_frame_unref(pFrameFiltered);&#xA;                                    }&#xA;&#xA;                                    av_frame_unref(pFrame);&#xA;                            }&#xA;                    }&#xA;            }&#xA;&#xA;            /* Flush delayed frames from encoder*/&#xA;            got_packet=1;&#xA;            while (got_packet) {&#xA;                    AVPacket encodedPacket = {0};&#xA;                    av_init_packet(&amp;amp;encodedPacket);&#xA;                    ret = avcodec_encode_audio2(out_fmt_ctx -&amp;gt; streams[0] -&amp;gt; codec, &amp;amp;encodedPacket, NULL, &amp;amp;got_packet);&#xA;&#xA;                    if (!ret &amp;amp;&amp;amp; got_packet &amp;amp;&amp;amp; encodedPacket.size) {&#xA;                            /* Set correct pts and dts */&#xA;                            if (encodedPacket.pts != AV_NOPTS_VALUE) {&#xA;                                    encodedPacket.pts = av_rescale_q(encodedPacket.pts, buffersink_ctx -&amp;gt; inputs[0] -&amp;gt; time_base,&#xA;                                                                     out_fmt_ctx -&amp;gt; streams[0] -&amp;gt; time_base);&#xA;                            }&#xA;&#xA;                            if (encodedPacket.dts != AV_NOPTS_VALUE) {&#xA;                                    encodedPacket.dts = av_rescale_q(encodedPacket.dts, buffersink_ctx -&amp;gt; inputs[0] -&amp;gt; time_base,&#xA;                                                                     out_fmt_ctx -&amp;gt; streams[0] -&amp;gt; time_base);&#xA;                            }&#xA;&#xA;                            printf(&quot;Encoded packet pts %ld\n&quot;, encodedPacket.pts);&#xA;                            /* Write the compressed frame to the media file. */&#xA;                            ret = av_interleaved_write_frame(out_fmt_ctx, &amp;amp;encodedPacket);&#xA;&#xA;                            if (ret &amp;lt; 0) {&#xA;                                    log_averror(ret);&#xA;                                    return -1;&#xA;                            }&#xA;                    } else if (ret &amp;lt; 0) {&#xA;                            log_averror(ret);&#xA;                            return -1;&#xA;                    }&#xA;            }&#xA;&#xA;            /* Write Trailer */&#xA;            av_write_trailer(out_fmt_ctx);&#xA;            avfilter_graph_free(&amp;amp;filter_graph);&#xA;&#xA;            if (dec_ctx)&#xA;                    avcodec_close(dec_ctx);&#xA;&#xA;            avformat_close_input(&amp;amp;in_fmt_ctx);&#xA;            av_frame_free(&amp;amp;pFrame);&#xA;            av_frame_free(&amp;amp;pFrameFiltered);&#xA;&#xA;            if (!(out_fmt_ctx -&amp;gt; oformat -&amp;gt; flags &amp;amp; AVFMT_NOFILE))&#xA;                    avio_close(out_fmt_ctx -&amp;gt; pb);&#xA;            avcodec_close(out_fmt_ctx-&amp;gt;streams[0]-&amp;gt;codec);&#xA;            avformat_free_context(out_fmt_ctx);&#xA;            return 0;&#xA;    }&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The audio file after transcoding is same duration as the input. But its completely noisy. Can somebody tell me what I am doing wrong here!&lt;/p&gt;&#xA;" OwnerUserId="2254322" LastEditorUserId="2254322" LastEditDate="2013-12-20T05:12:17.000" LastActivityDate="2014-02-10T08:13:41.213" Title="FFMPEG audio transcoding using libav* libraries" Tags="&lt;c++&gt;&lt;audio&gt;&lt;ffmpeg&gt;&lt;libav&gt;&lt;transcoding&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="2" />
  <row Id="20465253" PostTypeId="1" CreationDate="2013-12-09T07:22:35.763" Score="1" ViewCount="3841" Body="&lt;p&gt;I keep getting these errors when trying to compile, All the solutions i have looked up are telling me its the linker thats the problem but i cannot find a way to fix it, I created a smaller program to try and work out the bug this is what i have.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;main.c&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;lib/navigation.h&quot;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;&#xA;location newLocation;&#xA;double a;&#xA;int main(void) {&#xA;&#xA;newLocation.lat=51.2;&#xA;newLocation.lng=-5;&#xA;&#xA; a=great_circle(newLocation,newLocation);&#xA; printf(&quot;%f&quot;, a);&#xA;&#xA;return (EXIT_SUCCESS);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;navigation.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef NAVIGATION_H&#xA;#define NAVIGATION_H&#xA;&#xA;typedef struct {&#xA;double lat;&#xA;double lng;&#xA;} location;&#xA;&#xA;double great_circle(location location_1, location location_2);&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif  /* NAVIGATION_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I'm trying to use the great_circle function which i have linked using netBeans to the Navigation.a file but this is the error i get when compiling:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;gcc     -o dist/Debug/Cygwin_4.x-Windows/ship_project build/Debug/Cygwin_4.x-Windows/main.o lib/libnavigation_32bit.a -lm&#xA;build/Debug/Cygwin_4.x-Windows/main.o: In function `main':&#xA;/cygdrive/c/Users/Random Guy A/Documents/NetBeansProjects/Ship Project/main.c:19: undefined reference to `great_circle'&#xA;collect2: error: ld returned 1 exit status&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Can anyone help me? thank you in advance.&lt;/p&gt;&#xA;" OwnerUserId="3081855" LastActivityDate="2013-12-09T07:22:35.763" Title="undefined reference to function, ld returned 1 exit status" Tags="&lt;c&gt;&lt;function&gt;&lt;netbeans&gt;&lt;reference&gt;&lt;undefined&gt;" AnswerCount="0" CommentCount="6" />
  <row Id="20602738" PostTypeId="1" CreationDate="2013-12-16T02:56:17.373" Score="1" ViewCount="736" Body="&lt;p&gt;Hello stackoverflow community.  I have been trying to teach myself static and dynamic libraries in C.  I am having an issue though.  My linking does not appear to be working at all.  I made a simple testing static library.  Here is the code for the .c file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;&#xA;void test(char * c)&#xA;{&#xA;    printf(c);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And the .h file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef TEST_H&#xA;#define TEST_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;&#xA;&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;extern void test(char * c);&#xA;&#xA;#endif  /* TEST_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Here are the steps I take to produce the issue.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;First, I build this static library project with NetBeans, which generates a .a library (I am using MinGW for compiling).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Then, I copy the .a file, as well as the library's .h file into a folder.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I then start a new C/C++ application project in NetBeans.  I right click this project, and click properties.  Then I go to the Build tab, and within that, the Linker tab.  This is the part I am having troubles with.  No matter what I link, NetBeans acts as if I have linked nothing.  I have tried linking with &quot;Additional Library Directories&quot; and &quot;Libraries&quot;.  Neither have worked.  I have even tried manually reparsing the file by right clicking the project, going to the code assistance menu option, and clicking Reparse Project.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any help on figuring out what is wrong would be appreciated, thanks.&lt;/p&gt;&#xA;" OwnerUserId="2577669" LastActivityDate="2013-12-16T03:14:34.323" Title="C Static Library linking problems with NetBeans" Tags="&lt;c&gt;&lt;netbeans&gt;&lt;static-libraries&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="20906861" PostTypeId="1" AcceptedAnswerId="21056082" CreationDate="2014-01-03T15:20:06.313" Score="1" ViewCount="1048" Body="&lt;p&gt;Some time ago I wrote a simple SMTP gate for automatic S/MIME processing and now it comes to testing. As typical for mail servers, &lt;strong&gt;main process forks a child for every incoming connection&lt;/strong&gt;. It is a good practice to limit the number of created child processes -- and so I done it.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;During heavy load (many connections from many clients at the same time) it appears that &lt;strong&gt;child processes are not correctly counted&lt;/strong&gt; -- the problem is in decreasing the counter when children exits. After a few minutes of heavy load counter is greater than actual number of child processes (ie. after 5 minutes it equals 14, but there are none).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I already did some research, but nothing worked. All zombie processes are reaped, so &lt;code&gt;SIGCHLD&lt;/code&gt; handling seem to be ok. I thought that it may be a synchronization problem, but adding a mutex and changing variable type to &lt;code&gt;volatile sig_atomic_t&lt;/code&gt; (as it is now) gives no change. It is also not a problem with signal masking, I tried masking all signal using &lt;code&gt;sigfillset(&amp;amp;act.sa_mask)&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I noticed that &lt;code&gt;waitpid()&lt;/code&gt; sometimes returns strange PID values (very large, like 172915914).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Questions and some code.&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Is it possible that other process (ie. &lt;code&gt;init&lt;/code&gt;) is reaping some of them?&lt;/li&gt;&#xA;&lt;li&gt;Can a process not become a zombie after exit? Can it be reaped automatically?&lt;/li&gt;&#xA;&lt;li&gt;How to fix it? Maybe there is a better way of counting them?&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;p&gt;Forking a child in &lt;code&gt;main()&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;volatile sig_atomic_t sproc_counter = 0;    /* forked subprocesses counter */&#xA;&#xA;/* S/MIME Gate main function */&#xA;int main (int argc, char **argv)&#xA;{&#xA;    [...]&#xA;&#xA;    /* set appropriate handler for SIGCHLD */&#xA;    Signal(SIGCHLD, sig_chld);&#xA;&#xA;    [...]&#xA;&#xA;    /* SMTP Server's main loop */&#xA;    for (;;) {&#xA;&#xA;        [...]&#xA;&#xA;        /* check whether subprocesses limit is not exceeded  */&#xA;        if (sproc_counter &amp;lt; MAXSUBPROC) {&#xA;            if ( (childpid = Fork()) == 0) {    /* child process */&#xA;                Close(listenfd);                /* close listening socket */&#xA;                smime_gate_service(connfd);     /* process the request */&#xA;                exit(0);&#xA;            }&#xA;            ++sproc_counter;&#xA;        }&#xA;        else&#xA;            err_msg(&quot;subprocesses limit exceeded, connection refused&quot;);&#xA;&#xA;        [...]&#xA;    }&#xA;    Close(connfd);  /* parent closes connected socket */&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Signal handling:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Sigfunc *signal (int signo, Sigfunc *func)&#xA;{&#xA;    struct sigaction    act, oact;&#xA;&#xA;    act.sa_handler = func;&#xA;    sigemptyset(&amp;amp;act.sa_mask);&#xA;    act.sa_flags = 0;&#xA;&#xA;    if (signo == SIGALRM) {&#xA;#ifdef  SA_INTERRUPT&#xA;        act.sa_flags |= SA_INTERRUPT;   /* SunOS 4.x */&#xA;#endif&#xA;    }&#xA;    else {&#xA;#ifdef  SA_RESTART&#xA;        act.sa_flags |= SA_RESTART;     /* SVR4, 44BSD */&#xA;#endif&#xA;    }&#xA;    if (sigaction(signo, &amp;amp;act, &amp;amp;oact) &amp;lt; 0)&#xA;        return SIG_ERR;&#xA;&#xA;    return oact.sa_handler;&#xA;}&#xA;&#xA;Sigfunc *Signal (int signo, Sigfunc *func)&#xA;{&#xA;    Sigfunc *sigfunc;&#xA;&#xA;    if ( (sigfunc = signal(signo, func)) == SIG_ERR)&#xA;        err_sys(&quot;signal error&quot;);&#xA;    return sigfunc;&#xA;}&#xA;&#xA;void sig_chld (int signo __attribute__((__unused__)))&#xA;{&#xA;    pid_t pid;&#xA;    int stat;&#xA;&#xA;    while ( (pid = waitpid(-1, &amp;amp;stat, WNOHANG)) &amp;gt; 0) {&#xA;        --sproc_counter;&#xA;        err_msg(&quot;child %d terminated&quot;, pid);&#xA;    }&#xA;    return;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;: All functions beginning with a capital letter (like &lt;code&gt;Fork()&lt;/code&gt;, &lt;code&gt;Close()&lt;/code&gt;, &lt;code&gt;Signal()&lt;/code&gt; etc.) do and behaves the same as they lower case friends (&lt;code&gt;fork()&lt;/code&gt;, &lt;code&gt;close()&lt;/code&gt;, &lt;code&gt;signal()&lt;/code&gt; etc.), but have better error handling -- so I don't have to check their return statuses.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;NOTE2&lt;/strong&gt;: I run and compile it under Debian Testing (&lt;code&gt;kernel v3.10.11&lt;/code&gt;) using &lt;code&gt;gcc 4.8.2&lt;/code&gt;.&lt;/p&gt;&#xA;" OwnerUserId="3157524" LastEditorUserId="3157524" LastEditDate="2014-01-06T21:24:43.530" LastActivityDate="2014-01-10T23:03:07.810" Title="How to properly count an actual number of forked child processes?" Tags="&lt;c&gt;&lt;linux&gt;&lt;signals&gt;&lt;fork&gt;&lt;waitpid&gt;" AnswerCount="2" CommentCount="3" />
  <row Id="20980815" PostTypeId="1" AcceptedAnswerId="20981837" CreationDate="2014-01-07T20:06:43.467" Score="2" ViewCount="4139" Body="&lt;p&gt;I am using Matlab R2013b and Xcode 5.0.2 on my MacBook to mex a file called &lt;code&gt;sfun_rttime.c&lt;/code&gt; using Matlab's command: &lt;code&gt;mex sfun_rrtime.c&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This results in the following error message:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;sfun_rttime.c:108:26: warning: implicit declaration of function 'min' is invalid in&#xA;      C99 [-Wimplicit-function-declaration]&#xA;   while (t_diff &amp;lt; (dt - min(dt,t_execution))) {&#xA;                         ^&#xA;1 warning generated.&#xA;Undefined symbols for architecture x86_64:&#xA;  &quot;_min&quot;, referenced from:&#xA;      _mdlOutputs in sfun_rttime.o&#xA;ld: symbol(s) not found for architecture x86_64&#xA;clang: error: linker command failed with exit code 1 (use -v to see invocation)&#xA;&#xA;    mex: link of ' &quot;sfun_rttime.mexmaci64&quot;' failed.&#xA;&#xA;Unable to complete successfully.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The .c file looks as follows:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define S_FUNCTION_LEVEL 2&#xA;#define S_FUNCTION_NAME  sfun_rttime&#xA;&#xA;#define TIME_SCALE_FACTOR(S) ssGetSFcnParam(S,0)&#xA;&#xA;/* Need to include simstruc.h for the definition of the SimStruct and&#xA; * its associated macro definitions. */&#xA;#include &amp;lt;simstruc.h&amp;gt;&#xA;&#xA;#if defined(_WIN32)&#xA;/* Include the windows SDK header for handling time functions. */&#xA;#include &amp;lt;windows.h&amp;gt;&#xA;#include &amp;lt;math.h&amp;gt;&#xA;&#xA;/* Function of the high performance counter (in seconds). */&#xA;__inline double hightimer()&#xA;{&#xA;    HANDLE hCurrentProcess = GetCurrentProcess();&#xA;    DWORD dwProcessAffinity;&#xA;    DWORD dwSystemAffinity;    &#xA;    LARGE_INTEGER frequency, counter;&#xA;    double sec_per_tick, total_ticks;&#xA;&#xA;    /* force thread on first cpu */&#xA;    GetProcessAffinityMask(hCurrentProcess,&amp;amp;dwProcessAffinity,&amp;amp;dwSystemAffinity);&#xA;    SetProcessAffinityMask(hCurrentProcess, 1);&#xA;&#xA;    /* retrieves the frequency of the high-resolution performance counter */&#xA;    QueryPerformanceFrequency(&amp;amp;frequency);&#xA;&#xA;    /* retrieves the current value of the high-resolution performance counter */&#xA;    QueryPerformanceCounter(&amp;amp;counter);&#xA;&#xA;     /* reset thread */&#xA;    SetProcessAffinityMask(hCurrentProcess,dwProcessAffinity);&#xA;&#xA;    /* time in seconds */&#xA;    sec_per_tick = (double)1/(double)frequency.QuadPart;&#xA;    total_ticks = (double)counter.QuadPart;    &#xA;    return sec_per_tick*total_ticks;&#xA;}   /* end hightimer */&#xA;#else&#xA;/* Include the standard ANSI C header for handling time functions. */&#xA;#include &amp;lt;time.h&amp;gt;&#xA;&#xA;/* Function of the high performance counter (in seconds). */&#xA;__inline double hightimer()&#xA;{    &#xA;    return (double)clock()/CLOCKS_PER_SEC;&#xA;}   /* end hightimer */&#xA;#endif&#xA;&#xA;static void mdlInitializeSizes(SimStruct *S)&#xA;{&#xA;   ssSetNumSFcnParams(S, 1);  /* Number of expected parameters */&#xA;   if (ssGetNumSFcnParams(S) != ssGetSFcnParamsCount(S)) return;&#xA;    ssSetNumContStates(S, 0);&#xA;    ssSetNumDiscStates(S, 1);&#xA;   if (!ssSetNumInputPorts(S, 0)) return;&#xA;   if (!ssSetNumOutputPorts(S, 1)) return;&#xA;   ssSetOutputPortWidth(S, 0, 1);&#xA;   ssSetNumSampleTimes(S, 1);&#xA;   ssSetNumRWork(S, 1);&#xA;   ssSetNumIWork(S, 0);&#xA;   ssSetNumPWork(S, 0);&#xA;   ssSetNumModes(S, 0);&#xA;   ssSetNumNonsampledZCs(S, 0);&#xA;   ssSetOptions(S, 0);&#xA;}&#xA;&#xA;#define MDL_INITIALIZE_SAMPLE_TIMES&#xA;static void mdlInitializeSampleTimes(SimStruct *S)&#xA;{&#xA;   ssSetSampleTime(S, 0, CONTINUOUS_SAMPLE_TIME);&#xA;   ssSetOffsetTime(S, 0, 0.0);&#xA;}&#xA;&#xA;#define MDL_START&#xA;static void mdlStart(SimStruct *S)&#xA;{&#xA;   ssSetRWorkValue(S,0,ssGetTStart(S));&#xA;}&#xA;&#xA;static void mdlOutputs(SimStruct *S, int_T tid)&#xA;{&#xA;   double            *t_x = ssGetDiscStates(S);&#xA;   double            *t_y = ssGetOutputPortRealSignal(S,0);&#xA;   double             t_previousSimTime = ssGetRWorkValue(S,0);&#xA;   const double      *scaleFactor = mxGetPr(TIME_SCALE_FACTOR(S));&#xA;   time_T             t_SimTime = ssGetT(S);&#xA;   double             t_diff = 0.0;&#xA;   double             dt;&#xA;   double             t_current;&#xA;   double             t_0;&#xA;   double             t_previous;&#xA;   double             t_elapsed;&#xA;   double             t_execution;&#xA;&#xA;   /* Desired Delta time */&#xA;   dt = (t_SimTime - t_previousSimTime)*(scaleFactor[0]);&#xA;&#xA;   /* Get clock time at the beginning of this step*/   &#xA;   t_previous = hightimer();&#xA;   t_0 = t_previous;&#xA;&#xA;   /* Wait to reach the desired time */&#xA;   t_execution = t_0-t_x[0];&#xA;   while (t_diff &amp;lt; (dt - min(dt,t_execution))) {&#xA;       t_current = hightimer();&#xA;       /* Look for wrapup */&#xA;       if (t_current&amp;lt;t_previous){&#xA;           t_elapsed = t_previous - t_0;&#xA;           t_0 = hightimer() - t_elapsed;&#xA;       }&#xA;       t_diff = t_current - t_0;&#xA;       t_previous = t_current;&#xA;   }&#xA;&#xA;   /* Store current time to be used in next time step*/&#xA;   t_y[0] = dt - t_execution;&#xA;   t_x[0] = t_previous;&#xA;   ssSetRWorkValue(S,0,t_SimTime);&#xA;}&#xA;&#xA;static void mdlTerminate(SimStruct *S)&#xA;{&#xA;    UNUSED_ARG(S); /* unused input argument */&#xA;}&#xA;&#xA;/* Required S-function trailer */&#xA;#ifdef  MATLAB_MEX_FILE    /* Is this file being compiled as a MEX-file? */&#xA;#include &quot;simulink.c&quot;      /* MEX-file interface mechanism */&#xA;#else&#xA;#include &quot;cg_sfun.h&quot;       /* Code generation registration function */&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I didn't write this file myself, and neither I have a clue what's wrong with it.&lt;/p&gt;&#xA;" OwnerUserId="2311202" LastEditorUserId="573218" LastEditDate="2014-01-07T20:10:27.243" LastActivityDate="2014-04-07T09:04:04.773" Title="Implicit declaration of function 'min'" Tags="&lt;c&gt;&lt;matlab&gt;&lt;mex&gt;" AnswerCount="2" CommentCount="3" />
  <row Id="21018466" PostTypeId="1" AcceptedAnswerId="21018588" CreationDate="2014-01-09T11:07:36.900" Score="2" ViewCount="109" Body="&lt;pre&gt;&lt;code&gt;#ifdef ???&#xA;    // code for VC++ 2010 compiler&#xA;#else&#xA;    // code for later compiler versions&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;What macro can I use instead of &lt;code&gt;???&lt;/code&gt;? I don't care about older compiler versions.&lt;/p&gt;&#xA;" OwnerUserId="279313" LastActivityDate="2014-01-09T11:24:51.053" Title="Distinguish between VC++ 2010 and later compiler versions" Tags="&lt;c++&gt;&lt;visual-studio-2010&gt;&lt;macros&gt;" AnswerCount="2" CommentCount="4" FavoriteCount="1" />
  <row Id="21046825" PostTypeId="1" AcceptedAnswerId="21047237" CreationDate="2014-01-10T14:28:32.720" Score="0" ViewCount="361" Body="&lt;p&gt;I'm trying to compile a C program, but receive many errors. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;The errors are encountered in standard C headers files (inttypes.h, stdio.h, stat.h, etc).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The source of the errors are the following undefined constants:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;__BEGIN_DECLS&#xA;__END_DECLS&#xA;__BEGIN_NAMESPACE_STD&#xA;__END_NAMESPACE_STD&#xA;__THROW&#xA;__CONCAT&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What these constants seem to have in common is that they are defined differently depending on whether the C or C++ compiler is being used. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;For example, this question &lt;a href=&quot;http://stackoverflow.com/questions/8087438/should-i-have-to-use-an-extern-c-block-to-include-the-c-headers/8087539#8087539&quot;&gt;this question&lt;/a&gt; shows the following definition for __BEGIN_DECLS&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* C++ needs to know that types and declarations are C, not C++.  */&#xA;#ifdef   __cplusplus&#xA;# define __BEGIN_DECLS  extern &quot;C&quot; {                                            &#xA;# define __END_DECLS }&#xA;#else&#xA;# define __BEGIN_DECLS&#xA;# define __END_DECLS&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Any guesses as to why I'm encountering these errors? &lt;/p&gt;&#xA;" OwnerUserId="507770" LastActivityDate="2014-01-10T14:47:19.160" Title="C Compiler error from standard headers - undefined C++ definitions" Tags="&lt;c++&gt;&lt;c&gt;&lt;linux&gt;&lt;ubuntu&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="21441302" PostTypeId="1" CreationDate="2014-01-29T19:57:15.897" Score="0" ViewCount="755" Body="&lt;p&gt;I am working with XC8 1.20 and a PIC18F66K80 and having some trouble with using the pwm.h library. Whenever I open pwm.h, the only functions that are actually being generated (IE, the #ifdef compile time conditionals are returning true) are for PWM1. After tracing through the code, I came to the pconfig.h file and went down to the section regarding the 18F66K80, and it was all being ignored.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The conditional that was returning false is:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  __18F66K80&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;In fact, there were no sections that were being compiled. It was like I  had no chip selected, even though the project was targeting the 18F66K80. I went into the compiler macro options and add __18F66K80 as a defined macro, and this block suddenly was compiling, giving me access to PWM2-5.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My question is - what is the correct way to tell pconfig.h what chip I am using? My project settings clearly show the PIC18F66K80 as the target device, but pconfig.h was acting like I had no chosen device. By adding this macro, it appears to work, but I have a feeling this is a hack and not the right way to do things.&lt;/p&gt;&#xA;" OwnerUserId="1459009" LastActivityDate="2014-01-29T19:57:15.897" Title="XC8 pconfig.h not selecting chip" Tags="&lt;c&gt;&lt;pic&gt;&lt;mplab&gt;" AnswerCount="0" CommentCount="3" />
  <row Id="21497131" PostTypeId="1" CreationDate="2014-02-01T10:54:41.430" Score="1" ViewCount="495" Body="&lt;p&gt;It's my first time struggling with ARM processors (ARMv6), and I need a bit of help while I'm trying to &quot;translate&quot; a block of ASM code written in a C++ source code.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The original code shows:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef _WIN32&#xA;__asm&#xA;{&#xA;    mov eax, var1&#xA;    xor edx, edx&#xA;    div var2&#xA;    mov var1, eax&#xA;    mov var3, edx&#xA;}&#xA;#else&#xA;__asm__ __volatile__ ( “mov %2, %%eax;”&#xA;                “xor %%edx, %%edx;”&#xA;                “divl %3;”&#xA;                “mov %%eax, %0;”&#xA;                “mov %%edx, %1;”&#xA;                : “=m” (var1), “=m” (var3)&#xA;                : “m” (var1), “m”(var2)&#xA;                : “%eax”, “%edx”&#xA;               );&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;So, I can assume that I have to add a new line to &quot;let the compiler 'identify' the ARM&quot;, doing something like:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#if defined _WIN32&#xA;    __asm&#xA;#elif defined __ARM_ARCH_6__&#xA;    //here my new code&#xA;#else&#xA;   __asm__ __volatile__&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But, as I said, it's my first time using ARM processor, so I have some questions...&#xA;By a link found here (stackoverflow) I found a manual of ARM ASM, in which says there're 16 registrers (r0 - r15), in which (I assume) r4 to r8 are avaliable for &quot;free use&quot;. It's that right?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;If this is right, I can &quot;translate&quot; [eax=r4, edx=r5] or something similar. But I really have no idea of how I must declare the block; I mean, is &quot;__asm__ __volatile__&quot; a correct &quot;signature&quot; in this case? Is another one correct?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;How I have to put the block? Between brackets ({})? How can I refer &quot;var1&quot;, &quot;var2&quot; and &quot;var3&quot;?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any link will be ok, &lt;strong&gt;I don't want&lt;/strong&gt; the &quot;translation&quot;, because I want to know about this topic...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks a lot in advance&lt;/p&gt;&#xA;&#xA;&lt;p&gt;__&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Edit:I was looking deeper (I have to confess that in first instance I only look at the #ifdef and #else, which is too bad) the source code, and I found this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;unsigned int var1 = (unsigned int)var0;&#xA;for (; i &amp;gt;= 0; i--){&#xA;    #ifdef __powerpc__&#xA;        var4[i] = var5[var1 % m_var2];&#xA;        var1 /= m_var2;&#xA;    #else&#xA;        unsigned int var2 = m_var2;&#xA;        unsigned int var3;&#xA;    #ifdef _WIN32&#xA;            __asm&#xA;            {&#xA;                mov eax, var1&#xA;                xor edx, edx&#xA;                div var2&#xA;                mov var1, eax&#xA;                mov var3, edx&#xA;            }&#xA;    #else&#xA;            __asm__ __volatile__ (  &quot;mov %2, %%eax;&quot;&#xA;                                    &quot;xor %%edx, %%edx;&quot;&#xA;                                    &quot;divl %3;&quot;&#xA;                                    &quot;mov %%eax, %0;&quot;&#xA;                                    &quot;mov %%edx, %1;&quot;&#xA;                                    : &quot;=m&quot;(var1), &quot;=m&quot;(var3)&#xA;                                    : &quot;m&quot;(var1), &quot;m&quot;(var2)&#xA;                                    : &quot;%eax&quot;, &quot;%edx&quot;&#xA;                                );&#xA;    #endif&#xA;            var4[i] = var5[var3];&#xA;    #endif&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;So, as I can see, the &quot;#ifdef &lt;strong&gt;powerpc&lt;/strong&gt; block will work fine in ARM since it's no using any ASM instruction, right? Taking that is true, I can rewrite&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#if defined(__powerpc__) || defined(__ARM_ARC_6__)&#xA;    //stuff here...&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It will works?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thakns again&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;Edit again: Better test before asking... It works! But now I have new problems with the linker... :-(&lt;/p&gt;&#xA;" OwnerUserId="1965939" LastEditorUserId="1965939" LastEditDate="2014-02-01T15:36:15.867" LastActivityDate="2014-02-01T15:36:15.867" Title="Using ASM instructions in ARM processor" Tags="&lt;c++&gt;&lt;assembly&gt;&lt;arm&gt;&lt;armv6&gt;" AnswerCount="0" CommentCount="8" />
  <row Id="21638522" PostTypeId="1" CreationDate="2014-02-07T21:56:40.950" Score="0" ViewCount="136" Body="&lt;p&gt;This is the CSortedList.cpp file, where I'm having trouble doing what I want to do.&#xA;For example, under the InsertItem function, I'm having trouble sorting the list.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The MoveListItem function is there in order to help sort the list by adding/removing items as needed - it was provided by the professor for this assignment, and I don't think it needs to be changed but I could be wrong. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;The RemoveItem function should do exactly what it says - if I were to remove an item from the list, it should be moving the items inside the array 'to the front', with the help of the MoveListItem function. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Finally, per the directions, our professor gave us this function - GetTargetIndex, but I have no idea what I'm supposed to do with it nor how I'm supposed to use it to help with the coding. &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include    &amp;lt;iostream&amp;gt;&#xA;using namespace std;&#xA;#include    &quot;CSortedList.h&quot;&#xA;&#xA;&#xA;void    CSortedList::DispRetVal(const char*  szMessage&#xA;                                                    , ListRetVal  value) const&#xA;{&#xA;    #ifdef  DEBUG_LIST&#xA;    cerr &amp;lt;&amp;lt; szMessage &amp;lt;&amp;lt; &quot;: &quot;;&#xA;    switch (value)&#xA;        {&#xA;        case   LIST_FULL:&#xA;            cerr &amp;lt;&amp;lt; &quot;LIST_FULL\n&quot;;&#xA;            break;&#xA;&#xA;        case   LIST_EMPTY:&#xA;            cerr &amp;lt;&amp;lt; &quot;LIST_EMPTY\n&quot;;&#xA;            break;&#xA;&#xA;        case   LIST_ERROR:&#xA;            cerr &amp;lt;&amp;lt; &quot;LIST_ERROR\n&quot;;&#xA;            break;&#xA;&#xA;        case   LIST_SUCCESS:&#xA;            cerr &amp;lt;&amp;lt; &quot;LIST_SUCCESS\n&quot;;&#xA;            break;&#xA;&#xA;        case   LIST_INVALID_INDEX:&#xA;            cerr &amp;lt;&amp;lt; &quot;LIST_INVALID_INDEX\n&quot;;&#xA;            break;&#xA;&#xA;        default:&#xA;            cerr &amp;lt;&amp;lt; &quot;Unrecognized error code\n&quot;;&#xA;            break;&#xA;        }&#xA;    #endif  // DEBUG_LIST&#xA;&#xA;} &#xA;&#xA;ListRetVal  CSortedList::GetListItem(int  index, ListItemType  &amp;amp;item) const&#xA;{&#xA;    // if the list is empty, return an error cocde&#xA;    if (true == IsListEmpty())&#xA;        {&#xA;        DispRetVal(&quot;GetListItem&quot;, LIST_EMPTY);&#xA;        return LIST_EMPTY;&#xA;        }&#xA;&#xA;    // if the target location is not within appropriate list boundaries (i.e.,&#xA;    // 0 to m_numItems-1), return an error code&#xA;    if ((index &amp;lt; 0)  ||  (index &amp;gt; (m_numItems - 1)))&#xA;        {&#xA;        DispRetVal(&quot;GetListItem&quot;, LIST_INVALID_INDEX);&#xA;        return LIST_INVALID_INDEX;&#xA;        }&#xA;&#xA;    // initialize the reference parameter and return&#xA;    item = m_items[index];&#xA;    return LIST_SUCCESS;&#xA;&#xA;}&#xA;&#xA;ListRetVal  CSortedList::InsertItem(const ListItemType  &amp;amp;newItem)&#xA;{&#xA;    // if the list is already full, return an error code&#xA;    if (true == IsListFull())&#xA;        {&#xA;        DispRetVal(&quot;InsertItem&quot;, LIST_FULL);&#xA;        return LIST_FULL;&#xA;        }&#xA;&#xA;    // Supposed to sort the array&#xA;    for (int i = 0; i &amp;lt; MAX_ITEMS; i++)&#xA;    {&#xA;        if (newItem &amp;lt; m_items[i])&#xA;        {&#xA;            MoveListItems(i, MOVE_TO_BACK);&#xA;            m_items[0] = newItem;&#xA;            break;&#xA;        }&#xA;        else&#xA;        {&#xA;            break;&#xA;        }&#xA;    }&#xA;&#xA;    m_items[0 + m_numItems] = newItem;&#xA;    ++m_numItems;&#xA;&#xA;    return LIST_SUCCESS;&#xA;&#xA;} &#xA;&#xA;int     CSortedList::MoveListItems(int  targetIndex, int  direction)&#xA;{&#xA;    int         destIndex;&#xA;    int         increment;&#xA;    int         sourceIndex;&#xA;    int         totalItemsMoved = 0;&#xA;&#xA;    // initialize the source and destination index values&#xA;    if (MOVE_TO_BACK == direction)&#xA;        {&#xA;        sourceIndex = m_numItems - 1;&#xA;        destIndex = m_numItems;&#xA;        increment = -1;     // move from higher to lower addresses&#xA;        }&#xA;    else    // MOVE_TO_FRONT&#xA;        {&#xA;        sourceIndex = targetIndex + 1;&#xA;        destIndex = targetIndex;&#xA;        increment = 1;      // move from lower to higher addresses&#xA;        }&#xA;&#xA;    // loop and &quot;move&quot; elements&#xA;    bool        bContinueLoop = true;&#xA;    do  {&#xA;        m_items[destIndex] = m_items[sourceIndex];&#xA;        destIndex += increment;&#xA;        sourceIndex += increment;&#xA;        ++totalItemsMoved;&#xA;&#xA;        if (MOVE_TO_BACK == direction)&#xA;            {&#xA;            if ((sourceIndex &amp;lt; targetIndex)  ||  (destIndex &amp;lt; 1))&#xA;                {&#xA;                bContinueLoop = false;&#xA;                }&#xA;            }&#xA;        else    // MOVE_TO_FRONT&#xA;            {&#xA;            if (sourceIndex &amp;gt;= m_numItems)&#xA;                {&#xA;                bContinueLoop = false;&#xA;                }&#xA;            }&#xA;&#xA;        }  while (true == bContinueLoop);&#xA;&#xA;    return totalItemsMoved;&#xA;&#xA;} &#xA;&#xA;ListRetVal  CSortedList::RemoveItem(const ListItemType  &amp;amp;targetItem)&#xA;{&#xA;    // if the list is empty, return an error cocde&#xA;    if (true == IsListEmpty())&#xA;        {&#xA;        DispRetVal(&quot;RemoveItem&quot;, LIST_EMPTY);&#xA;        return LIST_EMPTY;&#xA;        }&#xA;&#xA;   // Search for the given value inside the array, and if found&#xA;   // delete it.&#xA;    for (int i = 0; i &amp;lt; MAX_ITEMS; i++)&#xA;    {&#xA;        if (targetItem == m_items[i])&#xA;        {&#xA;            MoveListItems(i, MOVE_TO_FRONT);&#xA;        }&#xA;    }&#xA;&#xA;    return LIST_SUCCESS;&#xA;&#xA;}  &#xA;&#xA;// This function is going to be helpful in determining if an item is already in the list,&#xA;// or if it isn't, where it belongs.&#xA;bool CSortedList::GetTargetIndex(const ListItemType  &amp;amp;newItem, int  &amp;amp;targetIndex) const&#xA;{&#xA;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;In conclusion, my problems are these: I don't understand what 'GetListItem' and 'GetTargetIndex' are supposed to do - they just seem redundant and completely unnecessary, but I can't just not use them because obviously they're there for a reason. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Currently, when I try to sort my list with the given code (inside of 'InsertItem'), the last value is 'lost', so for example if I enter the following:&#xA;12&#xA;15&#xA;3&#xA;The following will be displayed:&#xA;3&#xA;12&#xA;3&#xA;Instead of what's supposed to be displayed:&#xA;3&#xA;12&#xA;15&lt;/p&gt;&#xA;&#xA;&lt;p&gt;And removing a value from the list ('RemoveItem') is just not working at all. If I enter&#xA;12&#xA;15&#xA;3&#xA;And I select to remove '3', this displays:&#xA;12&#xA;3&#xA;4217156 (basically a random number)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Now, obviously I don't want the code spoon fed to me - what I'm asking for is where my logic is wrong, and to explain some concepts I may be foggy with?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thank you.&lt;/p&gt;&#xA;" OwnerUserId="2776780" LastEditorUserId="2776780" LastEditDate="2014-02-07T22:16:08.500" LastActivityDate="2014-02-07T22:16:08.500" Title="How to sort the following list with the given class functions?" Tags="&lt;c++&gt;&lt;sorting&gt;" AnswerCount="0" CommentCount="6" />
  <row Id="21772256" PostTypeId="1" CreationDate="2014-02-14T06:25:50.787" Score="-1" ViewCount="1059" Body="&lt;p&gt;For some reason I need to define some nested definition. but the pre-processor &#xA;remove a part of my macro.&#xA;Look at following code:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define SINGLE_ITERATION y+=xext[++xIndex]*H[hCounter--];&#xA;#define LOOP_ITERATION  SINGLE_ITERATION  \&#xA;    SINGLE_ITERATION SINGLE_ITERATION \&#xA;    SINGLE_ITERATION SINGLE_ITERATION \&#xA;    SINGLE_ITERATION SINGLE_ITERATION \&#xA;    SINGLE_ITERATION&#xA;&#xA;#define DEBUG_CODE #ifdef MEMORIZE \&#xA;    myOutput[xCounter]=y;      \&#xA;    #endif                     \&#xA;    #ifdef STORING            \&#xA;    fprintf(fid,&quot;%f\r\n&quot;,y);  \&#xA;    #endif&#xA;&#xA;#define OUT_LOP_ITERATION y=0;           \ &#xA;                          xIndex=xCounter-HL;\&#xA;                          for(hCounter=HL_MINUS_1;hCounter&amp;gt;0;)&#xA;                          {LOOP_ITERATION}  \&#xA;                          SINGLE_ITERATION  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But the problem is when the MEMORIZE flag is defined. Here is the output of pre-processor created by compiler&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;for( xCounter=XL_MINUS_1;xCounter&amp;gt;=0;xCounter--)&#xA;{&#xA;y=0; &#xA;xIndex=xCounter-HL;&#xA;for(hCounter=HL_MINUS_1;hCounter&amp;gt;0;)&#xA;{&#xA;    y+=xext[++xIndex]*H[hCounter--];&#xA;    y+=xext[++xIndex]*H[hCounter--];&#xA;    y+=xext[++xIndex]*H[hCounter--];&#xA;    y+=xext[++xIndex]*H[hCounter--];&#xA;    y+=xext[++xIndex]*H[hCounter--];&#xA;    y+=xext[++xIndex]*H[hCounter--];&#xA;    y+=xext[++xIndex]*H[hCounter--];&#xA;    y+=xext[++xIndex]*H[hCounter--];&#xA;    }&#xA;    y+=xext[++xIndex]*H[hCounter--];&#xA;#ifdef  &#xA;myOutput[xCounter]=y;&#xA;#endif &#xA;#ifdef STORING &#xA;fprintf(fid,&quot;%f\r\n&quot;,y); &#xA;#endif&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;which has a problem in the last part.in the :&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  &#xA;myOutput[xCounter]=y;&#xA;#endif &#xA;#ifdef STORING &#xA;fprintf(fid,&quot;%f\r\n&quot;,y); &#xA;#endif&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;which must be &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  MEMORIZE&#xA;myOutput[xCounter]=y;&#xA;#endif &#xA;#ifdef STORING &#xA;fprintf(fid,&quot;%f\r\n&quot;,y); &#xA;#endif&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and the pre-processor omitted the MEMORIZE because it is defined currently.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Please help me to solve it.&lt;/p&gt;&#xA;" OwnerUserId="2733417" LastEditorUserId="4370109" LastEditDate="2015-11-30T23:58:22.387" LastActivityDate="2015-11-30T23:58:22.387" Title="C #define nested in #ifdef" Tags="&lt;c++&gt;&lt;c&gt;&lt;visual-c++&gt;&lt;c-preprocessor&gt;" AnswerCount="2" CommentCount="5" ClosedDate="2014-02-14T10:55:05.887" />
  <row Id="21807231" PostTypeId="1" CreationDate="2014-02-16T04:19:51.053" Score="1" ViewCount="185" Body="&lt;p&gt;I've been having a strange concurrency issue with linux 2.6 and a mutex located in mmap file backed memory.  It's a latch manager module.  Does the page fault logic restart an instruction entirely that includes a lock prefix?  It's acting like it doesn't include the lock prefix when it restarts.  If I set the MAP_LOCKED attribute in the mmap call, the problem clears up.  Anyone with any experience?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//  mode &amp;amp; definition for hash latch implementation&#xA;&#xA;enum {&#xA;  Mutex = 1,&#xA;  Write = 2,&#xA;  Pending = 4,&#xA;  Share = 8&#xA;} LockMode;&#xA;&#xA;// mutex locks the other fields&#xA;// exclusive is set for write access&#xA;// share is count of read accessors&#xA;&#xA;typedef struct {&#xA;  volatile ushort mutex:1;&#xA;  volatile ushort exclusive:1;&#xA;  volatile ushort pending:1;&#xA;  volatile ushort share:13;&#xA;} BtSpinLatch;&#xA;&#xA;//  wait for other read and write latches to relinquish&#xA;&#xA;void bt_spinwritelock(BtSpinLatch *latch)&#xA;{&#xA;  do {&#xA;#ifdef  unix&#xA;  while( __sync_fetch_and_or((ushort *)latch, Mutex | Pending) &amp;amp; Mutex )&#xA;    sched_yield();&#xA;#else&#xA;  while( _InterlockedOr16((ushort *)latch, Mutex | Pending) &amp;amp; Mutex )&#xA;    SwitchToThread();&#xA;#endif&#xA;  if( !(latch-&amp;gt;share | latch-&amp;gt;exclusive) ) {&#xA;#ifdef unix&#xA;    __sync_fetch_and_or((ushort *)latch, Write);&#xA;    __sync_fetch_and_and ((ushort *)latch, ~(Mutex | Pending));&#xA;#else&#xA;    _InterlockedOr16((ushort *)latch, Write);&#xA;    _InterlockedAnd16((ushort *)latch, ~(Mutex | Pending));&#xA;#endif&#xA;    return;&#xA;  }&#xA;&#xA;#ifdef unix&#xA;  __sync_fetch_and_and ((ushort *)latch, ~Mutex);&#xA;  sched_yield();&#xA;#else&#xA;  _InterlockedAnd16((ushort *)latch, ~Mutex);&#xA;  SwitchToThread();&#xA;#endif&#xA;  } while( 1 );&#xA;}&#xA;&#xA;void bt_spinreadlock(BtSpinLatch *latch)&#xA;{&#xA;ushort prev;&#xA;&#xA;  do {&#xA;#ifdef unix&#xA;    while( __sync_fetch_and_or((ushort *)latch, Mutex) &amp;amp; Mutex )&#xA;      sched_yield();&#xA;#else&#xA;    while( _InterlockedOr16((ushort *)latch, Mutex) &amp;amp; Mutex )&#xA;      SwitchToThread();&#xA;#endif&#xA;&#xA;//  see if exclusive request is granted or pending&#xA;&#xA;    if( prev = !(latch-&amp;gt;exclusive | latch-&amp;gt;pending) )&#xA;#ifdef unix&#xA;      __sync_fetch_and_add((ushort *)latch, Share);&#xA;#else&#xA;      _InterlockedExchangeAdd16 ((ushort *)latch, Share);&#xA;#endif&#xA;&#xA;#ifdef unix&#xA;    __sync_fetch_and_and ((ushort *)latch, ~Mutex);&#xA;#else&#xA;    _InterlockedAnd16((ushort *)latch, ~Mutex);&#xA;#endif&#xA;    if( prev )&#xA;      return;&#xA;#ifdef  unix&#xA;  } while( sched_yield(), 1 );&#xA;#else&#xA;  } while( SwitchToThread(), 1 );&#xA;#endif&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1949819" LastEditorUserId="1949819" LastEditDate="2014-02-18T14:19:47.487" LastActivityDate="2014-02-18T15:52:10.083" Title="mutex in linux page faulted memory" Tags="&lt;c&gt;&lt;linux&gt;&lt;mutex&gt;" AnswerCount="1" CommentCount="9" />
  <row Id="21818182" PostTypeId="1" CreationDate="2014-02-16T23:21:41.997" Score="0" ViewCount="59" Body="&lt;p&gt;I've run into a slight issue getting my program to compile. This is the first time I've worked with code being spread out between multiple files and it's giving me some issues.&#xA;I suppose my main issue is the 'CreditAccount' does not name a type error.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;CreditAccount.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  CREDIT_ACCOUNT_H&#xA;#define CREDIT_ACCOUNT_H&#xA;class CreditAccount&#xA;{&#xA;    private:&#xA;        char accountNum[20];&#xA;        char custName[21];&#xA;        double credLimit;&#xA;        double accountBal;  &#xA;&#xA;    public;&#xA;        CreditAccount();&#xA;        CreditAccount(char[], char[], double, double);  &#xA;};&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;CreditAccount.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;CreditAccount.h&quot;&#xA;#include &amp;lt;cstring&amp;gt;&#xA;CreditAccount::CreditAccount()&#xA;{&#xA;accountNum[0] = '\0';&#xA;custName[0] = '\0';&#xA;credLimit = 0;&#xA;accountBal = 0;&#xA;}&#xA;&#xA;CreditAccount::CreditAccount(char newAccountNum[], char newCustName[], double newCredLimit, double newAccountBal)&#xA;{&#xA;newAccountNum = strcpy(newAccountNum, accountNum);&#xA;newCustName = strcpy(newCustName, custName);&#xA;newCredLimit = credLimit;&#xA;newAccountBal = accountBal; &#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;assign2.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;iostream&amp;gt;&#xA;#include &quot;CreditAccount.h&quot;&#xA;&#xA;using std::cout;&#xA;using std::endl;&#xA;&#xA;int main()&#xA;{&#xA;char code1[20] = &quot;1111-1111-1111-1111&quot;;&#xA;char name1[21] = &quot;Jermaine Arnold&quot;;&#xA;char code2[20] = &quot;2222-2222-2222-2222&quot;;&#xA;char name2[21] = &quot;Vanessa Long&quot;;&#xA;&#xA;// Test default constructor&#xA;CreditAccount account1;&#xA;return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I'm pretty lost here, and any help would be greatly appreciated.&lt;/p&gt;&#xA;" OwnerUserId="3045039" LastActivityDate="2014-02-16T23:30:16.397" Title="ClassName does not have a type" Tags="&lt;c++&gt;&lt;header&gt;" AnswerCount="1" CommentCount="5" />
  <row Id="22160333" PostTypeId="1" AcceptedAnswerId="22160955" CreationDate="2014-03-04T00:16:22.723" Score="-4" ViewCount="47" Body="&lt;p&gt;I've been trying to teach myself c over spring break and it's been a lot more challenging than i had anticipated! I've made some good progress, however i seem to have hit a snag. I've been writing my own implementation of a doubly linked list. After about eight hours of plugging along, I've got what seems to be a fairly coherent program. The compiler is giving me the all clear ahead, and i've successfully built the project multiple times. Now, i started programming in java; so to my mind the aforementioned assurances constitute an ironclad guarantee of success. However C seems to c things differently (pardon the pun)! When i attempt to run my program, i get a 'segfault' run-time error. I've spent some time reading up on this error, and (as im sure i'm about to be informed) it's an issue of memory mis-allocation. I've tried to debug, but no matter where i set my breakpoints i cant seem to preempt the error. I'm in a bit of a quandry, and i'd really appreciate any insights y'all might have to offer me! I apologize for the monolith of text i've just scrawled out... and i'll try to keep the post script brief. Here's a rough outline of my setup:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;NetBeans 6.8 IDE with Cygwin environment &lt;/li&gt;&#xA;&lt;li&gt;Currently running windows 7 x64 &lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;I'll post my code below, but certainly don't feel obligated to go sifting through it. What i'm really hoping for is a few suggestions on how to handle segfaults in general. I get the feeling i'll be seeing them a lot, and i'd like to develop a strategy for troubleshooting this particular issue. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks in advance! without you guys i'd be up a serious creek!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;main.c&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;stdbool.h&amp;gt;&#xA;#include&quot;dll.h&quot;&#xA;&#xA;int main(int argc, char** argv) {&#xA;&#xA;    VECT coord1;&#xA;    coord1-&amp;gt;x = 0.0012345;&#xA;    coord1-&amp;gt;y = 0.012345;&#xA;    coord1-&amp;gt;z = 0.12345;&#xA;&#xA;    LIST coords = init_list();&#xA;    list_add(coords, coord1);&#xA;&#xA;    return (EXIT_SUCCESS);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;dll.c (doubley linked list source file)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;dll.h&quot;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#include&amp;lt;stdbool.h&amp;gt;&#xA;#include&quot;dll.h&quot;&#xA;&#xA;LIST init_list() {&#xA;    LIST list = (LIST) malloc(sizeof (struct list));&#xA;    list-&amp;gt;length = 0;&#xA;    list-&amp;gt;first = NULL;&#xA;    list-&amp;gt;last = NULL;&#xA;    list-&amp;gt;destructor = free;&#xA;    return list;&#xA;}&#xA;&#xA;LIST_ITR list_iterator(LIST list, bool from_front) {&#xA;    LIST_ITR iter = (LIST_ITR) malloc(sizeof (struct list_itr));&#xA;    if (from_front) {&#xA;        iter-&amp;gt;current = list-&amp;gt;first;&#xA;    } else if (!from_front) {&#xA;        iter-&amp;gt;current = list-&amp;gt;last;&#xA;    } else return NULL;&#xA;    iter-&amp;gt;started = 0;&#xA;    return iter;&#xA;}&#xA;&#xA;void list_add(LIST list, VECT coords) {&#xA;    NODE node = (NODE) malloc(sizeof (struct node));&#xA;    node-&amp;gt;coord_vector = coords;&#xA;&#xA;    if (list-&amp;gt;first == NULL) {&#xA;        node-&amp;gt;prev = NULL;&#xA;        node-&amp;gt;next = NULL;&#xA;        list-&amp;gt;first = node;&#xA;        list-&amp;gt;last = node;&#xA;    } else {&#xA;        list-&amp;gt;last-&amp;gt;next = node;&#xA;        node-&amp;gt;prev = list-&amp;gt;last;&#xA;        node-&amp;gt;next = NULL;&#xA;        list-&amp;gt;last = node;&#xA;    }&#xA;    list-&amp;gt;length++;&#xA;}&#xA;&#xA;VECT list_itr_current(LIST_ITR iter) {&#xA;    if (iter-&amp;gt;started &amp;amp;&amp;amp; iter-&amp;gt;current != NULL)&#xA;        return iter-&amp;gt;current-&amp;gt;coord_vector;&#xA;    else {&#xA;        return NULL;&#xA;    }&#xA;}&#xA;&#xA;VECT list_itr_next(LIST_ITR iter) {&#xA;    if (!iter-&amp;gt;started &amp;amp;&amp;amp; iter-&amp;gt;current != NULL) {&#xA;        iter-&amp;gt;started = 1;&#xA;        return iter-&amp;gt;current-&amp;gt;coord_vector;&#xA;    }&#xA;    if (iter-&amp;gt;current != NULL) {&#xA;        iter-&amp;gt;current = iter-&amp;gt;current-&amp;gt;next;&#xA;        return list_itr_current(iter);&#xA;    }&#xA;    return NULL;&#xA;}&#xA;&#xA;VECT list_prev(LIST_ITR iter) {&#xA;    if (!iter-&amp;gt;started &amp;amp;&amp;amp; iter-&amp;gt;current != NULL) {&#xA;        iter-&amp;gt;started = 1;&#xA;        return iter-&amp;gt;current-&amp;gt;coord_vector;&#xA;    }&#xA;    if (iter-&amp;gt;current != NULL) {&#xA;        iter-&amp;gt;current = iter-&amp;gt;current-&amp;gt;prev;&#xA;        return list_itr_current(iter);&#xA;    }&#xA;    return NULL;&#xA;}&#xA;&#xA;VECT list_get_first(LIST list) {&#xA;    return list-&amp;gt;first-&amp;gt;coord_vector;&#xA;}&#xA;&#xA;VECT list_get_last(LIST list) {&#xA;    return list-&amp;gt;last-&amp;gt;coord_vector;&#xA;}&#xA;&#xA;VECT list_pop(LIST list) {&#xA;    NODE last = list-&amp;gt;last;&#xA;    if (last == NULL) return NULL;&#xA;&#xA;    if (list-&amp;gt;first == list-&amp;gt;last) {&#xA;        list-&amp;gt;first = NULL;&#xA;        list-&amp;gt;last = NULL;&#xA;    } else {&#xA;        list-&amp;gt;last = last-&amp;gt;prev;&#xA;        last-&amp;gt;prev-&amp;gt;next = NULL;&#xA;    }&#xA;&#xA;    VECT data = last-&amp;gt;coord_vector;&#xA;    free(last);&#xA;    list-&amp;gt;length--;&#xA;    return data;&#xA;}&#xA;&#xA;VECT list_poll(LIST list) {&#xA;    NODE first = list-&amp;gt;first;&#xA;&#xA;    if (first == NULL)&#xA;        return NULL;&#xA;&#xA;    if (list-&amp;gt;first == list-&amp;gt;last) {&#xA;        list-&amp;gt;first = NULL;&#xA;        list-&amp;gt;last = NULL;&#xA;    } else {&#xA;        list-&amp;gt;first = first-&amp;gt;next;&#xA;        first-&amp;gt;next-&amp;gt;prev = NULL;&#xA;    }&#xA;&#xA;    VECT data = first-&amp;gt;coord_vector;&#xA;    free(first);&#xA;    list-&amp;gt;length--;&#xA;    return data;&#xA;}&#xA;&#xA;void list_remove(LIST list, bool from_front) {&#xA;    VECT data;&#xA;    if (from_front)&#xA;        data = list_poll(list);&#xA;    else if (!from_front)&#xA;        data = list_pop(list);&#xA;    else return;&#xA;    list-&amp;gt;destructor(data);&#xA;}&#xA;&#xA;void destroy_list(LIST list) {&#xA;    NODE current = list-&amp;gt;first;&#xA;    NODE next;&#xA;    while (current != NULL) {&#xA;        next = current-&amp;gt;next;&#xA;        list-&amp;gt;destructor(current-&amp;gt;coord_vector);&#xA;        free(current);&#xA;        current = next;&#xA;    }&#xA;    free(list);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;dll.h (doubley linked list header file)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include&amp;lt;stdbool.h&amp;gt;&#xA;&#xA;#ifndef _DLL_H&#xA;#define _DLL_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;    /* A C implementation of a doubly-linked list. Contains void pointer values.&#xA;   Can be used as a LIFO stack of FIFO queue. */&#xA;&#xA;#define FRONT 0&#xA;#define BACK 1&#xA;&#xA;struct vector{&#xA;    double x;&#xA;    double y;&#xA;    double z;&#xA;};&#xA;&#xA;typedef struct vector* VECT;&#xA;&#xA;struct node{&#xA;        VECT    coord_vector;&#xA;    struct node* next;&#xA;    struct node* prev;&#xA;};&#xA;&#xA;typedef struct node* NODE;&#xA;&#xA;struct list{&#xA;    int length;&#xA;    NODE first;&#xA;    NODE last;&#xA;    void (*destructor)(void*);&#xA;};&#xA;&#xA;typedef struct list * LIST;&#xA;&#xA;struct list_itr{&#xA;    NODE current;&#xA;    char started;&#xA;};&#xA;&#xA;typedef struct list_itr * LIST_ITR;&#xA;&#xA;//Initializes the list&#xA;LIST init_list();&#xA;&#xA;//initializes the list iterator&#xA;LIST_ITR list_iterator(LIST list, bool from_front);&#xA;&#xA;//append element to end&#xA;void list_add(LIST list, VECT coords);&#xA;&#xA;//Gets the data stored in the first item of the list or NULL if the list is empty&#xA;VECT list_get_first(LIST list);&#xA;&#xA;//Gets the data stored in the last item of the list or NULL if the list is empty&#xA;VECT list_get_last(LIST list);&#xA;&#xA;//LIFO pop: remove element and return data&#xA;VECT list_pop(LIST list);&#xA;&#xA;//FIFO poll: remove element and return data&#xA;VECT list_poll(LIST list);&#xA;&#xA;//Deletes element and frees memory&#xA;void list_remove(LIST list, bool from_front);&#xA;&#xA;//Delete list and free all memory&#xA;void destroy_list(LIST list);&#xA;&#xA;//returns the data of the element pointed to by current&#xA;VECT list_itr_current(LIST_ITR list_itr);&#xA;&#xA;//Increments the index of current by 1 and returns the data stored there&#xA;VECT list_itr_next(LIST_ITR list_itr);&#xA;&#xA;//Decrements the index of current by 1 and returns the data stored there&#xA;VECT list_prev(LIST_ITR list_itr);&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif  /* _DLL_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1775753" LastActivityDate="2014-03-04T01:13:37.657" Title="Learning C, segfailt confusion" Tags="&lt;c&gt;&lt;linked-list&gt;&lt;segmentation-fault&gt;" AnswerCount="1" CommentCount="6" />
  <row Id="22265610" PostTypeId="1" AcceptedAnswerId="22268031" CreationDate="2014-03-08T05:43:39.970" Score="4" ViewCount="8272" Body="&lt;p&gt;I have a portable program which uses ssize_t under the assumption it is a signed integer. Conceptually it does something like:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdint.h&amp;gt;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;&#xA;int main(int argc, char *argv[])&#xA;{&#xA;    size_t size_10 = 10;&#xA;    size_t size_20 = 20;&#xA;    ssize_t len_diff;&#xA;    len_diff = (ssize_t)size_10 - (ssize_t)size_20;&#xA;    if (len_diff &amp;lt; 0)&#xA;        printf(&quot;negative\n&quot;);&#xA;    else if (len_diff &amp;gt; 0)&#xA;        printf(&quot;positive\n&quot;);&#xA;    else&#xA;        printf(&quot;zero\n&quot;);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;One would expect the program to print 'negative' but instead it prints 'positive'. The reason is easy to see from how ssize_t is defined (in sourceannotations.h):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef _SSIZE_T_DEFINED&#xA;#ifdef  _WIN64&#xA;typedef unsigned __int64    ssize_t;&#xA;#else&#xA;typedef _W64 unsigned int   ssize_t;&#xA;#endif&#xA;#define _SSIZE_T_DEFINED&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And so, subtracting two unsigned values results in an unsigned value and hence the result.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;In older versions of the Windows SDK (e.g. V7.0A) the ssize_t was correctly defined as:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//&#xA;// SIZE_T used for counts or ranges which need to span the range of&#xA;// of a pointer.  SSIZE_T is the signed variation.&#xA;//&#xA;&#xA;typedef ULONG_PTR SIZE_T, *PSIZE_T;&#xA;typedef LONG_PTR SSIZE_T, *PSSIZE_T;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Can anyone explain this change? Are we supposed to stop using ssize_t  on Windows?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;em&gt;Update:&lt;/em&gt;&#xA;Based on all the answers, it appears to be a bug in Visual Studio 2010 which includes ssize_t but defined incorrectly. This is a sneaky and nasty bug.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;em&gt;Last Update:&lt;/em&gt;&#xA;This bug has been fixed in VS2012 and VS2016. Also from the comment discussion it appears that this way of calculating len_diff is problematic when the values compared are of different signs when casted to SSIZE_T&lt;/p&gt;&#xA;" OwnerUserId="98694" LastEditorUserId="98694" LastEditDate="2016-02-13T22:20:32.603" LastActivityDate="2016-02-13T22:20:32.603" Title="Why ssize_t in Visual Studio 2010 is defined as unsigned?" Tags="&lt;c&gt;&lt;windows&gt;&lt;types&gt;" AnswerCount="3" CommentCount="7" />
  <row Id="22567563" PostTypeId="1" CreationDate="2014-03-21T19:11:40.900" Score="2" ViewCount="84" Body="&lt;p&gt;I have some ALSA driver code that has many lines that have to change for going between two audio configurations: L/R stereo and mono, but I would like a single switch to choose between L/R mode or just mono mode. I currently have two files, one for L/R and one for mono, but the disadvantage is both files have to be maintained with the same updates. It would be nice to have everything in one file since so much is similar between the two.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For example:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;L/R Stereo:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;regmap_read(WM88-&amp;gt;regmapL, addr, &amp;amp;val_l);&#xA;regmap_read(WM88-&amp;gt;regmapR, addr, &amp;amp;val_r);&#xA;pr_info(&quot;%s: reg 0x%02X, val_l 0x%02X, val_r 0x%02X\n&quot;,&#xA;__func__, addr, val_l, val_r);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Mono:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;regmap_read(WM88-&amp;gt;regmapL, addr, &amp;amp;val_l);&#xA;pr_info(&quot;%s: reg 0x%02X, val_l 0x%02X\n&quot;,&#xA;__func__, addr, val_l);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;One option is to have a bunch of #ifdef #endif blocks, but it looks pretty ugly. Is there a better way to do this? It doesn't have to be a macro, but I thought that might be the best method.&lt;/p&gt;&#xA;" OwnerUserId="1018733" LastActivityDate="2014-03-21T20:55:02.843" Title="Using C macro to nicely combine two options in code" Tags="&lt;c&gt;&lt;macros&gt;&lt;kernel&gt;&lt;driver&gt;&lt;alsa&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="22568939" PostTypeId="1" CreationDate="2014-03-21T20:30:32.917" Score="0" ViewCount="251" Body="&lt;p&gt;Can you embed #ifdef and #endif?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For example:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef B&#xA;    run1();&#xA;    #ifdef C&#xA;        run2();&#xA;    #endif&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Desired result is run2() only occurs if both B and C are defined&lt;/p&gt;&#xA;" OwnerUserId="1018733" LastActivityDate="2014-03-21T20:35:13.743" Title="C preprocessor macro embedded #ifdef #endif" Tags="&lt;macros&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="22661464" PostTypeId="1" AcceptedAnswerId="22661573" CreationDate="2014-03-26T12:44:04.933" Score="0" ViewCount="300" Body="&lt;p&gt;I'm facing some scaling challenges at the company I work for and I would like to have new features implemented with an off switch so that if the feature is not ready to ship we can turn it off and have it ready for the next release.&#xA;I know Facebook, Twitter, Podio and probably other companies have this.&#xA;The easiest way I can think of would be to embed the code in a #ifdef - #endif block but I would like to have an internal settings panel when I can turn features on and off at runtime which would be more easy to test.&#xA;Any ideas how something like that could be implemented? Any suggestions are very much appreciated. Thanks&lt;/p&gt;&#xA;" OwnerUserId="1339876" LastActivityDate="2014-03-26T12:53:16.377" Title="How to implement feature off switch on iOS" Tags="&lt;ios&gt;&lt;objective-c&gt;&lt;runtime&gt;&lt;feature-selection&gt;" AnswerCount="2" CommentCount="0" ClosedDate="2014-03-26T18:24:41.067" />
  <row Id="22763040" PostTypeId="1" CreationDate="2014-03-31T13:36:31.970" Score="1" ViewCount="236" Body="&lt;p&gt;This question is a continuation of the problem I described &lt;a href=&quot;http://stackoverflow.com/questions/22615645/mipmap-generation-fails-second-time&quot;&gt;here&lt;/a&gt; .This is one of the weirdest bugs I have ever seen.I have my engine running in 2 modes:display mode and offscreen.The OS is Linux.I generate mipmaps for the textures and in Display mode it all works fine.In that mode I use GLFW3 for context creation.Now,the funny part:in the offscreen mode,context for which I create manually with the code below,the mipmap generation fails OCCASIONALLY!That's on some runs the resulting output looks ok,and in other the missing levels are clearly seen as the frame is full of texture junk data or entirely empty.&#xA;At first I though I had my mipmap gen routine wrong which goes like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;glGenTextures(1, &amp;amp;textureName);&#xA;glBindTexture(GL_TEXTURE_2D, textureName);          &#xA;glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, imageInfo.Width, imageInfo.Height, 0, imageInfo.Format, imageInfo.Type, imageInfo.Data);&#xA;glTexParameteri  ( GL_TEXTURE_2D, GL_TEXTURE_BASE_LEVEL, 0 );&#xA;&#xA;&#xA;  glGenerateMipmap(GL_TEXTURE_2D);&#xA;  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR); &#xA;  glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR); &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I also tried to play with this param:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;glTexParameteri  ( GL_TEXTURE_2D, GL_TEXTURE_MAX_LEVEL, XXX); &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;including Max level detection formula:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;  int numMipmaps =  1 + floor(log2(glm::max(imageInfoOut.width, imageInfoOut.height)));&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But all this stuff didn't work consistently.Out of 10-15 runs 3-4 come out with broken Mipmaps.What I then found was that switching to GL_LINEAR solved it.Also in mipmap mode,setting just 1 level worked as well.Finally I started thinking there could a problem on a context level because in screen mode it works!I switched context creation to GLFW3 and it works.So I wonder what's going on here?Do I miss something in Pbuffer setup which breaks mipmaps generation?I doubt it because AFAIK it is done by the driver.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is my custom off-screen context creation setup:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;  int visual_attribs[] = {&#xA;             GLX_RENDER_TYPE,&#xA;        GLX_RGBA_BIT,&#xA;        GLX_RED_SIZE, 8,&#xA;        GLX_GREEN_SIZE, 8,&#xA;        GLX_BLUE_SIZE, 8,&#xA;        GLX_ALPHA_SIZE, 8,&#xA;        GLX_DEPTH_SIZE, 24,&#xA;        GLX_STENCIL_SIZE, 8,&#xA;            None&#xA;        };&#xA;        int context_attribs[] = {&#xA;            GLX_CONTEXT_MAJOR_VERSION_ARB, vmaj,&#xA;            GLX_CONTEXT_MINOR_VERSION_ARB, vmin,&#xA;            GLX_CONTEXT_FLAGS_ARB,&#xA;&#xA;            GLX_CONTEXT_ROBUST_ACCESS_BIT_ARB&#xA;#ifdef  DEBUG           &#xA;            |  GLX_CONTEXT_DEBUG_BIT_ARB &#xA;#endif&#xA;            ,  &#xA;            GLX_CONTEXT_PROFILE_MASK_ARB, GLX_CONTEXT_COMPATIBILITY_PROFILE_BIT_ARB,&#xA;            None&#xA;        };&#xA;&#xA;        _xdisplay = XOpenDisplay(NULL);&#xA;        int fbcount = 0;&#xA;        _fbconfig = NULL;&#xA;&#xA;&#xA;        //  _render_context&#xA;        if (!_xdisplay) {&#xA;                            throw();&#xA;        }&#xA;        /* get framebuffer configs, any is usable (might want to add proper attribs) */&#xA;        if (!(_fbconfig = glXChooseFBConfig(_xdisplay, DefaultScreen(_xdisplay), visual_attribs, &amp;amp;fbcount))) {&#xA;                       throw();&#xA;        }&#xA;&#xA;        /* get the required extensions */&#xA;        glXCreateContextAttribsARB = (glXCreateContextAttribsARBProc) glXGetProcAddressARB((const GLubyte *) &quot;glXCreateContextAttribsARB&quot;);&#xA;        glXMakeContextCurrentARB = (glXMakeContextCurrentARBProc) glXGetProcAddressARB((const GLubyte *) &quot;glXMakeContextCurrent&quot;);&#xA;&#xA;&#xA;        if (!(glXCreateContextAttribsARB &amp;amp;&amp;amp; glXMakeContextCurrentARB)) {&#xA;&#xA;            XFree(_fbconfig);&#xA;                              throw();&#xA;&#xA;        }&#xA;&#xA;        /* create a context using glXCreateContextAttribsARB */&#xA;        if (!(_render_context = glXCreateContextAttribsARB(_xdisplay, _fbconfig[0], 0, True, context_attribs))) {&#xA;&#xA;            XFree(_fbconfig);&#xA;                            throw();&#xA;&#xA;        }&#xA;&#xA;                  //  GLX_MIPMAP_TEXTURE_EXT&#xA;        /* create temporary pbuffer */&#xA;        int pbuffer_attribs[] = {&#xA;            GLX_PBUFFER_WIDTH, 128,&#xA;            GLX_PBUFFER_HEIGHT, 128,&#xA;            None&#xA;        };&#xA;&#xA;        _pbuff = glXCreatePbuffer(_xdisplay, _fbconfig[0], pbuffer_attribs);&#xA;&#xA;        XFree(_fbconfig);&#xA;        XSync(_xdisplay, False);&#xA;&#xA;        /* try to make it the current context */&#xA;        if (!glXMakeContextCurrent(_xdisplay, _pbuff, _pbuff, _render_context)) {&#xA;            /* some drivers does not support context without default framebuffer, so fallback on&#xA;             * using the default window.&#xA;             */&#xA;            if (!glXMakeContextCurrent(_xdisplay, DefaultRootWindow(_xdisplay),&#xA;                    DefaultRootWindow(_xdisplay), _render_context)) {&#xA;&#xA;                throw();&#xA;&#xA;            }&#xA;        }&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Almost forgot:My system and hardware:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Kubuntu 13.04 64bit. GPU: NVidia Geforce GTX 680 . The engine uses OpenGL 4.2 API&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Full OpenGL info:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;**OpenGL vendor string: NVIDIA Corporation&lt;/p&gt;&#xA;&#xA;&lt;p&gt;OpenGL renderer string: GeForce GTX 680/PCIe/SSE2&lt;/p&gt;&#xA;&#xA;&lt;p&gt;OpenGL version string: 4.4.0 NVIDIA 331.49&lt;/p&gt;&#xA;&#xA;&lt;p&gt;OpenGL shading language version string: 4.40 NVIDIA via Cg compiler**&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Btw,I used also older drivers and it doesn't matter.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;UPDATE:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Seems like my assumption regarding GLFW was wrong.When I compile the engine and run it from the terminal the same is happening.BUT - if I run the engine from IDE (debug or release )there are no issues with the mipmaps.Is it possible the standalone app works against different SOs? &lt;/p&gt;&#xA;&#xA;&lt;p&gt;To make it clear,I dont't use Pbuffers to render into.I render into custom Frame buffers.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;UPDATE1:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have read that non-power of 2 textures can be tricky to auto generate mipmaps.And that in case OpenGL fails to generate all the levels it turns of texture usage.Is it possible that's what I am experiencing here?Because once the mipmapped texture goes wrong the rest of textures (non mipmapped) disappear too.But if this is the case then why this behavior is inconsistent?  &lt;/p&gt;&#xA;" OwnerUserId="507043" LastEditorUserId="507043" LastEditDate="2014-03-31T19:22:35.537" LastActivityDate="2014-03-31T19:22:35.537" Title="Can't generate mipmaps with off-screen OpenGL context on Linux" Tags="&lt;c++&gt;&lt;linux&gt;&lt;opengl&gt;" AnswerCount="1" CommentCount="9" />
  <row Id="22858721" PostTypeId="1" AcceptedAnswerId="22873227" CreationDate="2014-04-04T09:24:55.733" Score="0" ViewCount="199" Body="&lt;p&gt;I'm trying to write a composite widget using GTK+3 in C.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;the composite widget set property and get property are using alsa_device_item ** which is a type struct to _alsa_device_items.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;my include file is this;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef AUDIO_DEVICE_DIALOG_WIDGET_H&#xA;#define AUDIO_DEVICE_DIALOG_WIDGET_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;&#xA;#include &amp;lt;gtk-3.0/gtk/gtk.h&amp;gt;&#xA;&#xA;#define AUDIO_DEVICE_DIALOG_WIDGET_TYPE (audio_device_dialog_widget_get_type())&#xA;#define AUDIO_DEVICE_DIALOG_WIDGET(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), AUDIO_DEVICE_DIALOG_WIDGET_TYPE, AudioDeviceDialogWidget))&#xA;GType           audio_device_dialog_widget_get_type    (void);&#xA;&#xA;typedef struct _audio_device_dialog_widget AudioDeviceDialogWidget;&#xA;typedef struct _audio_device_dialog_widget_class AudioDeviceDialogWidgetClass;&#xA;&#xA;struct _audio_device_item {&#xA; char *device_name;&#xA; char *device_desc;&#xA; gboolean is_available;&#xA;};&#xA;&#xA;typedef struct _audio_device_item audio_device_item;&#xA;&#xA;AudioDeviceDialogWidget     *audio_device_dialog_widget_new         (audio_device_item **device_items);        &#xA;&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif  /* AUDIO_DEVICE_DIALOG_WIDGET_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;as you see in the include file i define the struct and typedef of alsa_device_item.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;the c file is this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;gtk-3.0/gtk/gtk.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#include &quot;audio_device_dialog_widget.h&quot;&#xA;#include &quot;audio_dev_box_widget.h&quot;&#xA;&#xA;typedef struct audio_device_dialog_widget_private AudioDeviceDialogWidgetPrivate;&#xA;&#xA;&#xA;struct _audio_device_dialog_widget &#xA;{&#xA;GtkDialog parent;&#xA;AudioDeviceDialogWidgetPrivate *priv;&#xA;&#xA; };&#xA;&#xA; struct _audio_device_dialog_widget_class&#xA;{&#xA;GtkDialogClass parent_class;&#xA;};&#xA;&#xA;struct audio_device_dialog_widget_private &#xA;{&#xA;GtkWidget *save_button, *cancel_button, *audio_dialog_box;&#xA;&#xA;};&#xA;&#xA;&#xA;&#xA;G_DEFINE_TYPE_WITH_PRIVATE(AudioDeviceDialogWidget,audio_device_dialog_widget,GTK_TYPE_DIALOG);&#xA;&#xA;enum {&#xA;PROP_0,&#xA;PROP_DEVICE_NAMES&#xA;};&#xA;&#xA;&#xA;static void audio_device_dialog_widget_init(AudioDeviceDialogWidget *widget) {&#xA;widget-&amp;gt;priv = G_TYPE_INSTANCE_GET_PRIVATE(widget, AUDIO_DEVICE_DIALOG_WIDGET_TYPE, AudioDeviceDialogWidgetPrivate);&#xA;gtk_widget_init_template(GTK_WIDGET(widget));    &#xA;}&#xA;&#xA;&#xA;AudioDeviceDialogWidget *audio_device_dialog_widget_new(audio_device_item **device_items) {&#xA;return g_object_new(AUDIO_DEVICE_DIALOG_WIDGET_TYPE,&quot;devices_list&quot;,device_items,NULL);&#xA;}&#xA;&#xA;static void audio_device_dialog_widget_set_devices(AudioDeviceDialogWidget *widget,const audio_device_item **device_items) {&#xA;g_return_if_fail(AUDIO_DEVICE_DIALOG_WIDGET(widget));&#xA;int i=0;&#xA;while (device_items[i] != NULL) {&#xA;    AudioDevBoxWidget *audio_dev_box_widget = audio_dev_box_widget_new(device_items[i]-&amp;gt;device_name, device_items[i]-&amp;gt;device_desc, device_items[i]-&amp;gt;is_available);&#xA;    gtk_box_pack_start(GTK_BOX(widget-&amp;gt;priv-&amp;gt;audio_dialog_box),GTK_WIDGET(audio_dev_box_widget),FALSE, FALSE, 0);        &#xA;    i++;&#xA;}&#xA;}&#xA;&#xA;const audio_device_item **audio_device_dialog_widget_get_devices(AudioDeviceDialogWidget *widget) {&#xA;    g_return_val_if_fail (AUDIO_DEVICE_DIALOG_WIDGET (widget), NULL);&#xA;   const audio_device_item **devices = NULL;&#xA;    return devices;&#xA;}&#xA;&#xA;static void&#xA;audio_device_dialog_widget_set_property (GObject         *object,&#xA;                     guint            prop_id,&#xA;                     const GValue    *value,&#xA;                     GParamSpec      *pspec)&#xA;{&#xA;  AudioDeviceDialogWidget *widget = AUDIO_DEVICE_DIALOG_WIDGET (object);&#xA;&#xA;  switch (prop_id)&#xA;    {&#xA;case PROP_DEVICE_NAMES:&#xA;    audio_device_dialog_widget_set_devices(widget, g_value_get_pointer(value));&#xA;      break;&#xA;default:&#xA;  G_OBJECT_WARN_INVALID_PROPERTY_ID (object, prop_id, pspec);&#xA;  break;&#xA;}&#xA;}&#xA;&#xA;static void&#xA;audio_device_dialog_widget_get_property (GObject         *object,&#xA;                    guint            prop_id,&#xA;                    GValue          *value,&#xA;                    GParamSpec      *pspec)&#xA; {^&#xA;  AudioDeviceDialogWidget *widget = AUDIO_DEVICE_DIALOG_WIDGET (object);&#xA;&#xA;switch (prop_id)&#xA;{&#xA;case PROP_DEVICE_NAMES:&#xA;  g_value_set_pointer (value, audio_device_dialog_widget_get_devices(widget));      &#xA;  break;&#xA;default:&#xA;  G_OBJECT_WARN_INVALID_PROPERTY_ID (object, prop_id, pspec);&#xA;  break;&#xA;}&#xA;}&#xA;&#xA;&#xA;static void audio_device_dialog_widget_class_init(AudioDeviceDialogWidgetClass *class) {&#xA;GtkWidgetClass *widget_class = GTK_WIDGET_CLASS(class);&#xA;GObjectClass *gobject_class = G_OBJECT_CLASS(class);&#xA;&#xA;gobject_class-&amp;gt;set_property=audio_device_dialog_widget_set_property;&#xA;gobject_class-&amp;gt;get_property=audio_device_dialog_widget_get_property;&#xA;GParamSpec *obj_properties = &#xA;        g_param_spec_string(&quot;devices_list&quot;,&quot;Devices List&quot;,&quot;Devices List&quot;,NULL,G_PARAM_READWRITE);&#xA;&#xA;&#xA;g_object_class_install_property(gobject_class, PROP_DEVICE_NAMES,obj_properties);&#xA;&#xA;  gtk_widget_class_set_template_from_resource (widget_class,&#xA;                                           &quot;/com/tuxin/tuxmusicstudio/audio_device_dialog.glade&quot;);&#xA;&#xA; gtk_widget_class_bind_template_child_private(widget_class, AudioDeviceDialogWidget, save_button);&#xA; gtk_widget_class_bind_template_child_private(widget_class, AudioDeviceDialogWidget, cancel_button);&#xA; gtk_widget_class_bind_template_child_private(widget_class, AudioDeviceDialogWidget, audio_dialog_box);&#xA;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;when I run my application i get the following critical message:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;(tuxmusicstudio:15946): GLib-GObject-CRITICAL **: g_value_get_pointer: assertion 'G_VALUE_HOLDS_POINTER (value)' failed&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;so as you can see the g_value_get_pointer won't accept my typedef struct pointer.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;any ideas?^&lt;/p&gt;&#xA;" OwnerUserId="80932" LastActivityDate="2014-04-04T21:20:39.280" Title="using g_value_get_pointer on a typedef struct ** in a gtk+ composite widget" Tags="&lt;c&gt;&lt;gtk&gt;&lt;glib&gt;&lt;composite&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="22965411" PostTypeId="1" CreationDate="2014-04-09T14:17:13.843" Score="1" ViewCount="113" Body="&lt;p&gt;&lt;strong&gt;Short story:&lt;/strong&gt; I want to enforce a run-time condition check in certain conditionally-compiled code blocks, but not others.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Long story:&lt;/strong&gt;&#xA;Our &lt;strong&gt;C&lt;/strong&gt; code base relies heavily on profiling. &#xA;We have lots of different profiles, and almost each module has &lt;code&gt;#ifdef&lt;/code&gt;s for at least 5-6 different profiles, wrapping large segments of code.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;We have added a new requirement - for certain profiles (Let's say &lt;code&gt;&amp;lt;A&amp;gt;&lt;/code&gt; and &lt;code&gt;&amp;lt;B&amp;gt;&lt;/code&gt;), the conditionally-compiled code will only be run if a specific condition is met. For the other profiles (Let's say &lt;code&gt;&amp;lt;C&amp;gt;&lt;/code&gt;) this is not required.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;i.e., this is how the code looks now:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef &amp;lt;A&amp;gt;&#xA;    /* Profiled code… */&#xA;#endif /* &amp;lt;A&amp;gt; */&#xA;&#xA;#ifdef &amp;lt;B&amp;gt;&#xA;    /* Profiled code… */&#xA;#endif /* &amp;lt;B&amp;gt; */&#xA;&#xA;#ifdef &amp;lt;C&amp;gt;&#xA;    /* Profiled code… */&#xA;#endif /* &amp;lt;C&amp;gt; */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This is how we need it to look:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef &amp;lt;A&amp;gt;&#xA;    if (new_condition)&#xA;    {&#xA;        /* Profiled code… */&#xA;    }&#xA;#endif /* &amp;lt;A&amp;gt; */&#xA;&#xA;#ifdef &amp;lt;B&amp;gt;&#xA;    if (new_condition)&#xA;    {&#xA;        /* Profiled code… */&#xA;    }&#xA;#endif /* &amp;lt;B&amp;gt; */&#xA;&#xA;#ifdef &amp;lt;C&amp;gt;&#xA;    /* Profiled code… */&#xA;#endif /* &amp;lt;C&amp;gt; */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;So far, so good.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;However, with the above implementation the new requirement isn't really maintainable.&#xA;It doesn't stop anyone not familiar with the requirement to add a new profiled code block, without adding the check for &lt;code&gt;new_condition&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So I want to force our engineers to check for this condition whenever adding new blocks that are profiled under &lt;code&gt;&amp;lt;A&amp;gt;&lt;/code&gt; and &lt;code&gt;&amp;lt;B&amp;gt;&lt;/code&gt;, but not for code profiled under &lt;code&gt;&amp;lt;C&amp;gt;&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Theoretically, the best solution would probably be a way to fail the build process, if there exists an &lt;code&gt;#ifdef &amp;lt;A&amp;gt;&lt;/code&gt; or &lt;code&gt;#ifdef &amp;lt;B&amp;gt;&lt;/code&gt; that isn't directly followed by &lt;code&gt;if (new_condition)&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thing is, I have no idea to do that. Do any of you have?&lt;/p&gt;&#xA;" OwnerUserId="2776936" LastEditorUserId="4370109" LastEditDate="2016-05-16T15:10:00.667" LastActivityDate="2016-05-16T15:10:00.667" Title="Enforce a condition check before C code blocks" Tags="&lt;c&gt;&lt;c-preprocessor&gt;&lt;conditional-compilation&gt;" AnswerCount="3" CommentCount="2" />
  <row Id="22991068" PostTypeId="1" AcceptedAnswerId="22994077" CreationDate="2014-04-10T14:30:54.337" Score="0" ViewCount="855" Body="&lt;p&gt;I have a makefile that used to work with make 3.80.&#xA;Now I updated to 3.81 and I obtain the following error: &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Makefile:185: *** invalid syntax in conditional.  Stop.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Line 185 corresponds to:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ifdef $(FDEP_FILES)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;A few lines above I define FDEP_FILES&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;FDEP_FILES   += $(addsuffix .df, $(TEST_BASENAMES_FC))&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;TEST_BASENAMES_FC      += $(basename  $(shell ls *.fc  2&amp;gt; /dev/null ))&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The makefile works when there is only one .fc file in the folder, while it fails in case of multiple makefile.&lt;/p&gt;&#xA;" OwnerUserId="1911118" LastActivityDate="2014-04-10T16:44:59.007" Title="ifdef &amp; make 3.81: invalid syntax in conditional" Tags="&lt;makefile&gt;&lt;conditional-compilation&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="23021328" PostTypeId="1" AcceptedAnswerId="23021603" CreationDate="2014-04-11T19:45:04.143" Score="1" ViewCount="152" Body="&lt;p&gt;My project uses a Settings.h to store common configuration settings like the server url etc. I have been tasked to create a new app from this code where only few parameters such as the server url , icon etc are different. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have a new target in my xcode workspace for this. I have 2 Settings.h in separate folders like&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;awesomeProject/Settings/Settings.h&#xA;oldProject/Settings/Settings.h&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The Settings.h is included in a few places in the project (not loaded via .pch). I have tried setting header search path for both the targets and this didn't work (as in the compiling awesomeProject target included the oldProject's Settings.h).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there a way to #include Settings.h based on the target without resorting to sprinkling #ifdef .. #endif constructs ?&lt;/p&gt;&#xA;" OwnerUserId="1103848" LastActivityDate="2014-04-12T14:09:19.810" Title="include header based on xcode scheme" Tags="&lt;ios&gt;&lt;objective-c&gt;&lt;xcode&gt;&lt;xcode5&gt;" AnswerCount="2" CommentCount="2" />
  <row Id="23159031" PostTypeId="1" CreationDate="2014-04-18T17:27:10.910" Score="2" ViewCount="518" Body="&lt;p&gt;Following code is fragment shader which I created using &lt;a href=&quot;https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g2d/SpriteBatch.java#L123&quot; rel=&quot;nofollow&quot;&gt;default LibGDX SpriteBatch shader&lt;/a&gt; simply modified to scramble RGB channels, and it works just fine on both Android and PC:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef GL_ES&#xA;#define LOWP lowp&#xA;precision mediump float;&#xA;#else&#xA;#define LOWP&#xA;#endif&#xA;varying LOWP vec4 v_color;&#xA;varying vec2 v_texCoord;&#xA;uniform sampler2D u_texture;&#xA;&#xA;void main()&#xA;{&#xA;    gl_FragColor = v_color * texture2D(u_texture, v_texCoord);&#xA;    gl_FragColor.rgb = vec3(gl_FragColor.g, gl_FragColor.r, gl_FragColor.b)&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;however when I try to add any variable to shader program like so (i excluded #ifdef ... u_texture; but it's still in shader itself):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;float test;&#xA;&#xA;void main()&#xA;{&#xA;    gl_FragColor = v_color * texture2D(u_texture, v_texCoord);&#xA;    test = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0f;&#xA;    gl_FragColor.rgb = vec3(test, test, test);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;it works on pc, but crashes on android - shader compiles fine on android too, but when SpriteBatch ApplyShader method is called app is crashing (according to logcat).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Tried defining variable inline like so:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;float test = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0f;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But it doesn't change a thing - still works perfectly fine on PC but not on Android. Moreover it crashes even if I write something like:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;test = 0.4f;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="627334" LastEditorUserId="44729" LastEditDate="2014-04-19T06:24:09.073" LastActivityDate="2014-04-19T06:24:09.073" Title="Shaders and variables in OpenGL 2 on Android / LibGDX" Tags="&lt;java&gt;&lt;android&gt;&lt;opengl-es&gt;&lt;libgdx&gt;&lt;glsl&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="23429327" PostTypeId="1" CreationDate="2014-05-02T13:27:36.260" Score="0" ViewCount="264" Body="&lt;p&gt;Writing a small nostalgia-bombing program that displays a gallery of icon resources. Here is the relevant section of code, as I need to show it before I can ask the question:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;void addGroup(HWND listview, char *name, int id)&#xA;{&#xA;    LVGROUP g;&#xA;    LRESULT n;&#xA;    TCHAR *wname;&#xA;&#xA;    ZeroMemory(&amp;amp;g, sizeof (LVGROUP));&#xA;    g.cbSize = sizeof (LVGROUP);&#xA;    g.mask = LVGF_HEADER | LVGF_GROUPID;&#xA;    wname = toWideString(name);&#xA;    g.pszHeader = wname;&#xA;    // for some reason the group ID and the index returned by LVM_INSERTGROUP are separate concepts... so we have to provide an ID.&#xA;    // (thanks to roxfan in irc.efnet.net/#winprog for confirming)&#xA;    g.iGroupId = id;&#xA;    n = SendMessage(listview, LVM_INSERTGROUP,&#xA;        (WPARAM) -1, (LPARAM) &amp;amp;g);&#xA;    if (n == (LRESULT) -1)&#xA;        panic(&quot;error adding list view group \&quot;%s\&quot;&quot;, name);&#xA;    free(wname);        // list views copy the name (thanks maztheman in irc.freenode.net/#winapi)&#xA;}&#xA;&#xA;void buildUI(HWND mainwin)&#xA;{&#xA;#define CSTYLE (WS_CHILD | WS_VISIBLE)&#xA;#define CXSTYLE (0)&#xA;#define SETFONT(hwnd) SendMessage(hwnd, WM_SETFONT, (WPARAM) controlfont, (LPARAM) TRUE);&#xA;&#xA;    listview = CreateWindowEx(CXSTYLE,&#xA;        WC_LISTVIEW, L&quot;&quot;,&#xA;        LVS_ICON | WS_VSCROLL | CSTYLE,&#xA;        0, 0, 100, 100,&#xA;        mainwin, NULL, hInstance, NULL);&#xA;    if (listview == NULL)&#xA;        panic(&quot;error creating list view&quot;);&#xA;&#xA;    int itemid = 0;&#xA;&#xA;    // we need to have an item to be able to add a group&#xA;    LVITEM dummy;&#xA;&#xA;    ZeroMemory(&amp;amp;dummy, sizeof (LVITEM));&#xA;    dummy.mask = LVIF_TEXT;&#xA;    dummy.pszText = L&quot;dummy&quot;;&#xA;    dummy.iItem = itemid++;&#xA;    if (SendMessage(listview, LVM_INSERTITEM,&#xA;        0, (LPARAM) &amp;amp;dummy) == (LRESULT) -1)&#xA;        panic(&quot;error adding dummy item to list view&quot;);&#xA;    // the dummy item has index 0&#xA;&#xA;    HIMAGELIST icons;&#xA;&#xA;    icons = ImageList_Create(32, 32, ILC_COLOR32, 100, 100);&#xA;    if (icons == NULL)&#xA;        panic(&quot;error creating icon list for list view&quot;);&#xA;    if (SendMessage(listview, LVM_SETIMAGELIST,&#xA;        LVSIL_NORMAL, (LPARAM) icons) == (LRESULT) NULL)&#xA;;//     panic(&quot;error giving icon list to list view&quot;);&#xA;&#xA;    if (SendMessage(listview, LVM_ENABLEGROUPVIEW,&#xA;        (WPARAM) TRUE, (LPARAM) NULL) == (LRESULT) -1)&#xA;        panic(&quot;error enabling groups in list view&quot;);&#xA;&#xA;    DIR *dir;&#xA;    int groupid = 0;&#xA;&#xA;    dir = opendir(dirname);&#xA;    if (dir == NULL)&#xA;        panic(&quot;error opening \&quot;%s\&quot;: %s&quot;, dirname, strerror(errno));&#xA;    for (;;) {&#xA;        struct dirent *entry;&#xA;        char *filename;&#xA;        TCHAR *wfilename;&#xA;&#xA;        errno = 0;&#xA;        entry = readdir(dir);&#xA;        if (entry == NULL) {&#xA;            if (errno != 0)&#xA;                panic(&quot;error reading \&quot;%s\&quot;: %s&quot;, dirname, strerror(errno));&#xA;            break;      // otherwise, we're done&#xA;        }&#xA;&#xA;        if (asprintf(&amp;amp;filename, &quot;%s\\%s&quot;, dirname, entry-&amp;gt;d_name) == -1)&#xA;            panic(&quot;error allocating combined filename %s\\%s: %s&quot;,&#xA;                dirname, entry-&amp;gt;d_name, strerror(errno));&#xA;        wfilename = toWideString(filename);&#xA;        free(filename);&#xA;&#xA;        UINT i, nIcons;&#xA;&#xA;        addGroup(listview, entry-&amp;gt;d_name, groupid);&#xA;&#xA;        nIcons = (UINT) ExtractIcon(hInstance, wfilename, -1);&#xA;        // no need to check for no icons; nothing will happen&#xA;        for (i = 0; i &amp;lt; nIcons; i++) {&#xA;            HICON icon;&#xA;            int index;&#xA;&#xA;            icon = ExtractIcon(hInstance, wfilename, i);&#xA;            if (icon == NULL || icon == (HICON) 1)      // NULL if no icons; 1 if cannot hold icons&#xA;                break;&#xA;            index = ImageList_AddIcon(icons, icon);&#xA;            if (index == -1)&#xA;                panic(&quot;error adding icon %u from %s to image list&quot;, i, entry-&amp;gt;d_name);&#xA;&#xA;            LVITEM item;&#xA;&#xA;            ZeroMemory(&amp;amp;item, sizeof (LVITEM));&#xA;            item.mask = LVIF_IMAGE | LVIF_GROUPID | LVIF_TEXT;&#xA;            item.iImage = index;&#xA;            item.iGroupId = groupid;&#xA;            char *q;&#xA;            asprintf(&amp;amp;q, &quot;%d&quot;, itemid);&#xA;            item.pszText = toWideString(q);&#xA;            free(q);&#xA;            item.iItem = itemid++;&#xA;            if (SendMessage(listview, LVM_INSERTITEM,&#xA;                (WPARAM) -1, (LPARAM) &amp;amp;item) == (LRESULT) -1)&#xA;                panic(&quot;error adding icon %u from %s to list view&quot;, i, entry-&amp;gt;d_name);&#xA;        }&#xA;        free(wfilename);&#xA;        groupid++;&#xA;    }&#xA;    closedir(dir);&#xA;&#xA;    // and we're done with the dummy item&#xA;    if (SendMessage(listview, LVM_DELETEITEM, 0, 0) == FALSE)&#xA;        panic(&quot;error removing dummy item from list view&quot;);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;(Assume that &lt;code&gt;toWideString()&lt;/code&gt; calls &lt;code&gt;malloc()&lt;/code&gt;.) The dummy item is there to satisfy the requirement for LVM_INSERTGROUP that the list view not be empty. However, I get strange behavior:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;if I take out the LVM_ENABLEGROUPVIEW but keep the LVM_DELETEITEM, the dummy item appears at the top of the list and the last item I add does not appear&lt;/li&gt;&#xA;&lt;li&gt;if I take out the LVM_ENABLEGROUPVIEW but take out the LVM_DELETEITEM, the dummy item does not appear and the last item I add appears, but it appears at the top of the list, not the bottom&#xA;&lt;ul&gt;&#xA;&lt;li&gt;and in some cases, extra items may appear at the bottom of the list as well! for instance, this happens on Windows XP, but not on wine, if &lt;code&gt;C:\Windows\System32&lt;/code&gt; is scanned&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/li&gt;&#xA;&lt;li&gt;if I keep the LVM_ENABLEGROUPVIEIW, regardless of whether or not I keep the LVM_DELETEITEM, the dummy item does not appear and the last item of the list appears where it should&#xA;&lt;ul&gt;&#xA;&lt;li&gt;I haven't checked if the extra icons show up in this case or not&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;see updates below&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;Can anyone explain what's going on? A complete program is listed below, however at present it relies on MinGW (I may change thsi later). Thanks.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// pietro gagliardi 1 may 2014&#xA;// scratch Windows program by pietro gagliardi 17 april 2014&#xA;// fixed typos and added toWideString() 1 may 2014&#xA;// borrows code from the scratch GTK+ program (16-17 april 2014) and from code written 31 march 2014 and 11-12 april 2014&#xA;#define _UNICODE&#xA;#define UNICODE&#xA;#define STRICT&#xA;#define _GNU_SOURCE     // needed to declare asprintf()/vasprintf()&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#include &amp;lt;stdarg.h&amp;gt;&#xA;#include &amp;lt;getopt.h&amp;gt;&#xA;#include &amp;lt;windows.h&amp;gt;&#xA;#include &amp;lt;commctrl.h&amp;gt;       // needed for InitCommonControlsEx() (thanks Xeek in irc.freenode.net/#winapi for confirming)&#xA;#include &amp;lt;sys/types.h&amp;gt;&#xA;#include &amp;lt;dirent.h&amp;gt;&#xA;#include &amp;lt;errno.h&amp;gt;&#xA;&#xA;#ifdef  _MSC_VER&#xA;#error sorry! the scratch windows program relies on mingw-only functionality! (specifically: asprintf(), getopt_long_only(), directory reading facilities)&#xA;#endif&#xA;&#xA;// cheating: we store the help string in the flag argument, collect them, then overwrite them with NULL in init() so getopt_long_only() will return val and not overwrite a string (apparently I'm not the first to think of this: GerbilSoft says GNU tools do this too)&#xA;#define flagBool(name, help, short) { name, no_argument, (int *) help, short }&#xA;#define flagString(name, help, short) { name, required_argument, (int *) help, short }&#xA;static struct option flags[] = {&#xA;    // place other options here&#xA;    flagBool(&quot;help&quot;, &quot;show help and quit&quot;, 'h'),&#xA;    { 0, 0, 0, 0 },&#xA;};&#xA;&#xA;HMODULE hInstance;&#xA;HICON hDefaultIcon;&#xA;HCURSOR hDefaultCursor;&#xA;HFONT controlfont;&#xA;&#xA;void panic(char *fmt, ...);&#xA;TCHAR *toWideString(char *what);&#xA;&#xA;void init(int argc, char *argv[]);&#xA;&#xA;char *dirname = NULL;&#xA;&#xA;char *args = &quot;dir&quot;;     // other command-line arguments here, if any&#xA;&#xA;BOOL parseArgs(int argc, char *argv[])&#xA;{&#xA;//  if (optind != argc - 1)     // equivalent to argc != 2&#xA;//      return FALSE;&#xA;//  dirname = argv[optind];&#xA;dirname = &quot;C:\\Windows\\System32&quot;;&#xA;    return TRUE;&#xA;}&#xA;&#xA;HWND listview = NULL;&#xA;&#xA;LRESULT CALLBACK wndproc(HWND hwnd, UINT msg, WPARAM wparam, LPARAM lparam)&#xA;{&#xA;    switch (msg) {&#xA;    case WM_CLOSE:&#xA;        PostQuitMessage(0);&#xA;        return 0;&#xA;    case WM_SIZE:&#xA;        if (listview != NULL) {&#xA;            RECT r;&#xA;&#xA;            if (GetClientRect(hwnd, &amp;amp;r) == 0)&#xA;                panic(&quot;error getting new list view size&quot;);&#xA;            if (MoveWindow(listview, 0, 0, r.right - r.left, r.bottom - r.top, TRUE) == 0)&#xA;                panic(&quot;error resizing list view&quot;);&#xA;        }&#xA;        return 0;&#xA;    default:&#xA;        return DefWindowProc(hwnd, msg, wparam, lparam);&#xA;    }&#xA;    panic(&quot;oops: message %ud does not return anything; bug in wndproc()&quot;, msg);&#xA;}&#xA;&#xA;HWND makeMainWindow(void)&#xA;{&#xA;    WNDCLASS cls;&#xA;    HWND hwnd;&#xA;&#xA;    ZeroMemory(&amp;amp;cls, sizeof (WNDCLASS));&#xA;    cls.lpszClassName = L&quot;mainwin&quot;;&#xA;    cls.lpfnWndProc = wndproc;&#xA;    cls.hInstance = hInstance;&#xA;    cls.hIcon = hDefaultIcon;&#xA;    cls.hCursor = hDefaultCursor;&#xA;    cls.hbrBackground = (HBRUSH) (COLOR_BTNFACE + 1);&#xA;    if (RegisterClass(&amp;amp;cls) == 0)&#xA;        panic(&quot;error registering window class&quot;);&#xA;    hwnd = CreateWindowEx(0,&#xA;        L&quot;mainwin&quot;, L&quot;Main Window&quot;,&#xA;        WS_OVERLAPPEDWINDOW,&#xA;        CW_USEDEFAULT, CW_USEDEFAULT,&#xA;        CW_USEDEFAULT, CW_USEDEFAULT,&#xA;        NULL, NULL, hInstance, NULL);&#xA;    if (hwnd == NULL)&#xA;        panic(&quot;opening main window failed&quot;);&#xA;    return hwnd;&#xA;}&#xA;&#xA;void addGroup(HWND listview, char *name, int id)&#xA;{&#xA;    LVGROUP g;&#xA;    LRESULT n;&#xA;    TCHAR *wname;&#xA;&#xA;    ZeroMemory(&amp;amp;g, sizeof (LVGROUP));&#xA;    g.cbSize = sizeof (LVGROUP);&#xA;    g.mask = LVGF_HEADER | LVGF_GROUPID;&#xA;    wname = toWideString(name);&#xA;    g.pszHeader = wname;&#xA;    // for some reason the group ID and the index returned by LVM_INSERTGROUP are separate concepts... so we have to provide an ID.&#xA;    // (thanks to roxfan in irc.efnet.net/#winprog for confirming)&#xA;    g.iGroupId = id;&#xA;    n = SendMessage(listview, LVM_INSERTGROUP,&#xA;        (WPARAM) -1, (LPARAM) &amp;amp;g);&#xA;    if (n == (LRESULT) -1)&#xA;        panic(&quot;error adding list view group \&quot;%s\&quot;&quot;, name);&#xA;    free(wname);        // list views copy the name (thanks maztheman in irc.freenode.net/#winapi)&#xA;}&#xA;&#xA;void buildUI(HWND mainwin)&#xA;{&#xA;#define CSTYLE (WS_CHILD | WS_VISIBLE)&#xA;#define CXSTYLE (0)&#xA;#define SETFONT(hwnd) SendMessage(hwnd, WM_SETFONT, (WPARAM) controlfont, (LPARAM) TRUE);&#xA;&#xA;    listview = CreateWindowEx(CXSTYLE,&#xA;        WC_LISTVIEW, L&quot;&quot;,&#xA;        LVS_ICON | WS_VSCROLL | CSTYLE,&#xA;        0, 0, 100, 100,&#xA;        mainwin, NULL, hInstance, NULL);&#xA;    if (listview == NULL)&#xA;        panic(&quot;error creating list view&quot;);&#xA;&#xA;    int itemid = 0;&#xA;&#xA;    // we need to have an item to be able to add a group&#xA;    LVITEM dummy;&#xA;&#xA;    ZeroMemory(&amp;amp;dummy, sizeof (LVITEM));&#xA;    dummy.mask = LVIF_TEXT;&#xA;    dummy.pszText = L&quot;dummy&quot;;&#xA;    dummy.iItem = itemid++;&#xA;    if (SendMessage(listview, LVM_INSERTITEM,&#xA;        0, (LPARAM) &amp;amp;dummy) == (LRESULT) -1)&#xA;        panic(&quot;error adding dummy item to list view&quot;);&#xA;    // the dummy item has index 0&#xA;&#xA;    HIMAGELIST icons;&#xA;&#xA;    icons = ImageList_Create(32, 32, ILC_COLOR32, 100, 100);&#xA;    if (icons == NULL)&#xA;        panic(&quot;error creating icon list for list view&quot;);&#xA;    if (SendMessage(listview, LVM_SETIMAGELIST,&#xA;        LVSIL_NORMAL, (LPARAM) icons) == (LRESULT) NULL)&#xA;;//     panic(&quot;error giving icon list to list view&quot;);&#xA;&#xA;    if (SendMessage(listview, LVM_ENABLEGROUPVIEW,&#xA;        (WPARAM) TRUE, (LPARAM) NULL) == (LRESULT) -1)&#xA;        panic(&quot;error enabling groups in list view&quot;);&#xA;&#xA;    DIR *dir;&#xA;    int groupid = 0;&#xA;&#xA;    dir = opendir(dirname);&#xA;    if (dir == NULL)&#xA;        panic(&quot;error opening \&quot;%s\&quot;: %s&quot;, dirname, strerror(errno));&#xA;    for (;;) {&#xA;        struct dirent *entry;&#xA;        char *filename;&#xA;        TCHAR *wfilename;&#xA;&#xA;        errno = 0;&#xA;        entry = readdir(dir);&#xA;        if (entry == NULL) {&#xA;            if (errno != 0)&#xA;                panic(&quot;error reading \&quot;%s\&quot;: %s&quot;, dirname, strerror(errno));&#xA;            break;      // otherwise, we're done&#xA;        }&#xA;&#xA;        if (asprintf(&amp;amp;filename, &quot;%s\\%s&quot;, dirname, entry-&amp;gt;d_name) == -1)&#xA;            panic(&quot;error allocating combined filename %s\\%s: %s&quot;,&#xA;                dirname, entry-&amp;gt;d_name, strerror(errno));&#xA;        wfilename = toWideString(filename);&#xA;        free(filename);&#xA;&#xA;        UINT i, nIcons;&#xA;&#xA;        addGroup(listview, entry-&amp;gt;d_name, groupid);&#xA;&#xA;        nIcons = (UINT) ExtractIcon(hInstance, wfilename, -1);&#xA;        // no need to check for no icons; nothing will happen&#xA;        for (i = 0; i &amp;lt; nIcons; i++) {&#xA;            HICON icon;&#xA;            int index;&#xA;&#xA;            icon = ExtractIcon(hInstance, wfilename, i);&#xA;            if (icon == NULL || icon == (HICON) 1)      // NULL if no icons; 1 if cannot hold icons&#xA;                break;&#xA;            index = ImageList_AddIcon(icons, icon);&#xA;            if (index == -1)&#xA;                panic(&quot;error adding icon %u from %s to image list&quot;, i, entry-&amp;gt;d_name);&#xA;&#xA;            LVITEM item;&#xA;&#xA;            ZeroMemory(&amp;amp;item, sizeof (LVITEM));&#xA;            item.mask = LVIF_IMAGE | LVIF_GROUPID | LVIF_TEXT;&#xA;            item.iImage = index;&#xA;            item.iGroupId = groupid;&#xA;            char *q;&#xA;            asprintf(&amp;amp;q, &quot;%d&quot;, itemid);&#xA;            item.pszText = toWideString(q);&#xA;            free(q);&#xA;            item.iItem = itemid++;&#xA;            if (SendMessage(listview, LVM_INSERTITEM,&#xA;                (WPARAM) -1, (LPARAM) &amp;amp;item) == (LRESULT) -1)&#xA;                panic(&quot;error adding icon %u from %s to list view&quot;, i, entry-&amp;gt;d_name);&#xA;        }&#xA;        free(wfilename);&#xA;        groupid++;&#xA;    }&#xA;    closedir(dir);&#xA;&#xA;    // and we're done with the dummy item&#xA;    if (SendMessage(listview, LVM_DELETEITEM, 0, 0) == FALSE)&#xA;        panic(&quot;error removing dummy item from list view&quot;);&#xA;}&#xA;&#xA;void firstShowWindow(HWND hwnd);&#xA;&#xA;int main(int argc, char *argv[])&#xA;{&#xA;    HWND mainwin;&#xA;    MSG msg;&#xA;&#xA;    init(argc, argv);&#xA;&#xA;    mainwin = makeMainWindow();&#xA;    buildUI(mainwin);&#xA;    firstShowWindow(mainwin);&#xA;&#xA;    for (;;) {&#xA;        BOOL gmret;&#xA;&#xA;        gmret = GetMessage(&amp;amp;msg, NULL, 0, 0);&#xA;        if (gmret == -1)&#xA;            panic(&quot;error getting message&quot;);&#xA;        if (gmret == 0)&#xA;            break;&#xA;        TranslateMessage(&amp;amp;msg);&#xA;        DispatchMessage(&amp;amp;msg);&#xA;    }&#xA;    return 0;&#xA;}&#xA;&#xA;DWORD iccFlags =&#xA;//  ICC_ANIMATE_CLASS |         // animation control&#xA;//  ICC_BAR_CLASSES |               // toolbar, statusbar, trackbar, tooltip&#xA;//  ICC_COOL_CLASSES |          // rebar&#xA;//  ICC_DATE_CLASSES |          // date and time picker&#xA;//  ICC_HOTKEY_CLASS |          // hot key&#xA;//  ICC_INTERNET_CLASSES |      // IP address entry field&#xA;//  ICC_LINK_CLASS |                // hyperlink&#xA;    ICC_LISTVIEW_CLASSES |          // list-view, header&#xA;//  ICC_NATIVEFNTCTL_CLASS |        // native font&#xA;//  ICC_PAGESCROLLER_CLASS |        // pager&#xA;//  ICC_PROGRESS_CLASS |            // progress bar&#xA;//  ICC_STANDARD_CLASSES |      // &quot;one of the intrinsic User32 control classes&quot;&#xA;//  ICC_TAB_CLASSES |               // tab, tooltip&#xA;//  ICC_TREEVIEW_CLASSES |      // tree-view, tooltip&#xA;//  ICC_UPDOWN_CLASS |          // up-down&#xA;//  ICC_USEREX_CLASSES |            // ComboBoxEx&#xA;//  ICC_WIN95_CLASSES |         // some of the above&#xA;    0;&#xA;&#xA;void initwin(void)&#xA;{&#xA;    INITCOMMONCONTROLSEX icc;&#xA;    NONCLIENTMETRICS ncm;&#xA;&#xA;    hInstance = GetModuleHandle(NULL);&#xA;    if (hInstance == NULL)&#xA;        panic(&quot;error getting hInstance&quot;);&#xA;    hDefaultIcon = LoadIcon(NULL, MAKEINTRESOURCE(IDI_APPLICATION));&#xA;    if (hDefaultIcon == NULL)&#xA;        panic(&quot;error getting default window class icon&quot;);&#xA;    hDefaultCursor = LoadCursor(NULL, MAKEINTRESOURCE(IDC_ARROW));&#xA;    if (hDefaultCursor == NULL)&#xA;        panic(&quot;error getting default window cursor&quot;);&#xA;    icc.dwSize = sizeof (INITCOMMONCONTROLSEX);&#xA;    icc.dwICC = iccFlags;&#xA;    if (InitCommonControlsEx(&amp;amp;icc) == FALSE)&#xA;        panic(&quot;error initializing Common Controls&quot;);&#xA;    ncm.cbSize = sizeof (NONCLIENTMETRICS);&#xA;    if (SystemParametersInfo(SPI_GETNONCLIENTMETRICS,&#xA;        sizeof (NONCLIENTMETRICS), &amp;amp;ncm, 0) == 0)&#xA;        panic(&quot;error getting non-client metrics for getting control font&quot;);&#xA;    controlfont = CreateFontIndirect(&amp;amp;ncm.lfMessageFont);&#xA;    if (controlfont == NULL)&#xA;        panic(&quot;error getting control font&quot;);&#xA;}&#xA;&#xA;void init(int argc, char *argv[])&#xA;{&#xA;    int usageExit = 1;&#xA;    char *opthelp[512];     // more than enough&#xA;    int i;&#xA;&#xA;    for (i = 0; flags[i].name != 0; i++) {&#xA;        opthelp[i] = (char *) flags[i].flag;&#xA;        flags[i].flag = NULL;&#xA;    }&#xA;&#xA;    for (;;) {&#xA;        int c;&#xA;&#xA;        c = getopt_long_only(argc, argv, &quot;&quot;, flags, NULL);&#xA;        if (c == -1)&#xA;            break;&#xA;        switch (c) {&#xA;        case 'h':       // -help&#xA;            usageExit = 0;&#xA;            goto usage;&#xA;        case '?':&#xA;            // getopt_long_only() should have printed something since we did not set opterr to 0&#xA;            goto usage;&#xA;        default:&#xA;            fprintf(stderr, &quot;internal error: getopt_long_only() returned %d\n&quot;, c);&#xA;            exit(1);&#xA;        }&#xA;    }&#xA;&#xA;    if (parseArgs(argc, argv) != TRUE)&#xA;        goto usage;&#xA;&#xA;    initwin();&#xA;    return;&#xA;&#xA;usage:&#xA;    fprintf(stderr, &quot;usage: %s [options]&quot;, argv[0]);&#xA;    if (args != NULL &amp;amp;&amp;amp; *args != '\0')&#xA;        fprintf(stderr, &quot; %s&quot;, args);&#xA;    fprintf(stderr, &quot;\n&quot;);&#xA;    for (i = 0; flags[i].name != 0; i++)&#xA;        fprintf(stderr, &quot;\t-%s%s - %s\n&quot;,&#xA;            flags[i].name,&#xA;            (flags[i].has_arg == required_argument) ? &quot; string&quot; : &quot;&quot;,&#xA;            opthelp[i]);&#xA;    exit(usageExit);&#xA;}&#xA;&#xA;void panic(char *fmt, ...)&#xA;{&#xA;    char *msg;&#xA;    TCHAR *lerrmsg;&#xA;    char *fullmsg;&#xA;    va_list arg;&#xA;    DWORD lasterr;&#xA;    DWORD lerrsuccess;&#xA;&#xA;    lasterr = GetLastError();&#xA;    va_start(arg, fmt);&#xA;    if (vasprintf(&amp;amp;msg, fmt, arg) == -1) {&#xA;        fprintf(stderr, &quot;critical error: vasprintf() failed in panic() preparing panic message; fmt = \&quot;%s\&quot;\n&quot;, fmt);&#xA;        abort();&#xA;    }&#xA;    // according to http://msdn.microsoft.com/en-us/library/windows/desktop/ms680582%28v=vs.85%29.aspx&#xA;    lerrsuccess = FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,&#xA;        NULL, lasterr,&#xA;        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),&#xA;        (LPTSTR) &amp;amp;lerrmsg, 0, NULL);&#xA;    if (lerrsuccess == 0) {&#xA;        fprintf(stderr, &quot;critical error: FormatMessage() failed in panic() preparing GetLastError() string; panic message = \&quot;%s\&quot;, last error in panic(): %ld, last error from FormatMessage(): %ld\n&quot;, msg, lasterr, GetLastError());&#xA;        abort();&#xA;    }&#xA;    // note to self: use %ws instead of %S (thanks jon_y in irc.oftc.net/#mingw-w64)&#xA;    if (asprintf(&amp;amp;fullmsg, &quot;panic: %s\nlast error: %ws\n&quot;, msg, lerrmsg) == -1) {&#xA;        fprintf(stderr, &quot;critical error: asprintf() failed in panic() preparing full report; panic message = \&quot;%s\&quot;, last error message: \&quot;%ws\&quot;\n&quot;, msg, lerrmsg);&#xA;        abort();&#xA;    }&#xA;    fprintf(stderr, &quot;%s\n&quot;, fullmsg);&#xA;    va_end(arg);&#xA;    exit(1);&#xA;}&#xA;&#xA;void firstShowWindow(HWND hwnd)&#xA;{&#xA;    // we need to get nCmdShow&#xA;    int nCmdShow;&#xA;    STARTUPINFO si;&#xA;&#xA;    nCmdShow = SW_SHOWDEFAULT;&#xA;    GetStartupInfo(&amp;amp;si);&#xA;    if ((si.dwFlags &amp;amp; STARTF_USESHOWWINDOW) != 0)&#xA;        nCmdShow = si.wShowWindow;&#xA;    ShowWindow(hwnd, nCmdShow);&#xA;    if (UpdateWindow(hwnd) == 0)&#xA;        panic(&quot;UpdateWindow(hwnd) failed in first show&quot;);&#xA;}&#xA;&#xA;TCHAR *toWideString(char *what)&#xA;{&#xA;    TCHAR *buf;&#xA;    int n;&#xA;    size_t len;&#xA;&#xA;    len = strlen(what);&#xA;    if (len == 0) {&#xA;        buf = (TCHAR *) malloc(sizeof (TCHAR));&#xA;        if (buf == NULL)&#xA;            goto mallocfail;&#xA;        buf[0] = L'\0';&#xA;    } else {&#xA;        n = MultiByteToWideChar(CP_UTF8, 0, what, -1, NULL, 0);&#xA;        if (n == 0)&#xA;            panic(&quot;error getting number of bytes to convert \&quot;%s\&quot; to UTF-16&quot;, what);&#xA;        buf = (TCHAR *) malloc((n + 1) * sizeof (TCHAR));&#xA;        if (buf == NULL)&#xA;            goto mallocfail;&#xA;        if (MultiByteToWideChar(CP_UTF8, 0, what, -1, buf, n) == 0)&#xA;            panic(&quot;erorr converting \&quot;%s\&quot; to UTF-16&quot;, what);&#xA;    }&#xA;    return buf;&#xA;mallocfail:&#xA;    panic(&quot;error allocating memory for UTF-16 version of \&quot;%s\&quot;&quot;, what);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h2&gt;Updates&lt;/h2&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;[Fri May  2 20:00:48 EDT 2014] I added sorting of the group names (NOT reflected in the above code), and now in the first case (!LVM_ENABLEGROUPVIEW &amp;amp;&amp;amp; LVM_DELETEITEM), that last item shows up again... I'm starting to think something isn't being defined, but I'm not sure what&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;" OwnerUserId="3408572" LastEditorUserId="3408572" LastEditDate="2014-05-03T00:02:44.803" LastActivityDate="2014-05-03T00:02:44.803" Title="winapi: LVM_DELETEITEM behaves in unusual ways with grouped list views" Tags="&lt;c&gt;&lt;listview&gt;&lt;winapi&gt;" AnswerCount="0" CommentCount="2" />
  <row Id="23465797" PostTypeId="1" CreationDate="2014-05-05T06:02:15.333" Score="1" ViewCount="196" Body="&lt;p&gt;I am working on APP includes c++ code. I am using     __android_     macro to distinguish the IOS and C++ specific code in eclipse ADT.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ex. &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef __ANDROID__&#xA;#define android&#xA;#endif&#xA;&#xA;#ifdef (android)&#xA;//Android specific code&#xA;#else&#xA;//IOS specific code&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It was working fine since couple of moths, but Suddenly the macro is not defined in ADT.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have tried:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Creating new workspace &lt;/li&gt;&#xA;&lt;li&gt;using additional &quot;ANDROID&quot; macro&lt;/li&gt;&#xA;&lt;li&gt;using different ADT version.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;I have referred the thread&#xA;&lt;a href=&quot;http://stackoverflow.com/questions/15328751/android-macro-suddenly-not-defined&quot;&gt;__ANDROID__ macro suddenly not defined&lt;/a&gt;&#xA;But I guess its been left by the user and the solution is not yet provided..&lt;/p&gt;&#xA;&#xA;&lt;p&gt;thanks in advance&lt;/p&gt;&#xA;" OwnerUserId="3603092" LastActivityDate="2014-05-05T06:02:15.333" Title="&quot;__ANDROID__ macro is not defined" Tags="&lt;android&gt;&lt;macros&gt;&lt;defined&gt;" AnswerCount="0" CommentCount="2" FavoriteCount="1" />
  <row Id="23750693" PostTypeId="1" AcceptedAnswerId="23765974" CreationDate="2014-05-20T03:47:41.767" Score="0" ViewCount="63" Body="&lt;p&gt;I am a new C programmer and so you will have to excuse my lack of knowledge. Slowly but surely I am improving. I am wondering why I am unable to access the members of my structure after I have sent them to a function that intends to modify them. This issue occurs in the code shown below. Basically my program analyzes an XML document and looks for certain patterns to extract text. In my main function I make the struct: &lt;code&gt;artinfo artIn[128] = {};&lt;/code&gt; which is defined in my header file as being:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef FILE_TABLE_H&#xA;#define FILE_TABLE_H&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;    typedef struct article_info {&#xA;        char author1[512];&#xA;        char author2[512];&#xA;        char author3[512];&#xA;        char author4[512];&#xA;        char author5[512];&#xA;        char author6[512];&#xA;        char title[2048];&#xA;        char version[4];&#xA;        char year[4];&#xA;        char page[64];&#xA;        char abstract[4096];&#xA;        char notes[4096];&#xA;} artinfo;&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;#endif  &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;After instantiating this and clearing it with memset I proceed to send it to another function which will extract text and intends to put it back in the structure. The function is shown below.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;bool readerParser(FILE *input, FILE *output, textlbuf *lbuf, artinfo *artIn[]){&#xA;&#xA;int isNewline;             /* Boolean indicating we've read a CR or LF */&#xA;long lFileLen;             /* Length of file */&#xA;long lIndex;               /* Index into cThisLine array */&#xA;long lLineCount;           /* Current line number */&#xA;long lLineLen;             /* Current line length */&#xA;long lStartPos;            /* Offset of start of current line */&#xA;long lTotalChars;          /* Total characters read */&#xA;char cThisLine[BUFSIZE];     /* Contents of current line */&#xA;char *cFile;                  /* Dynamically allocated buffer (entire file) */&#xA;char *cThisPtr;               /* Pointer to current position in cFile */&#xA;char cNextLine[BUFSIZE];&#xA;char buffer[BUFSIZE];&#xA;char title[] = &quot;&amp;lt;text top=\&quot;245\&quot;&quot;;&#xA;char ending[] = &quot;$&quot;;&#xA;char author[] = &quot;$&amp;lt;/text&amp;gt;&quot;;&#xA;bool tfound, afound;&#xA;char *match, *cNextLinePtr;&#xA;long lNextLineCount;&#xA;int i, j;&#xA;&#xA;//initialize some values&#xA;tfound = false;&#xA;afound = false;&#xA;fseek(input, 0L, SEEK_END);  /* Position to end of file */&#xA;lFileLen = ftell(input);     /* Get file length */&#xA;rewind(input);               /* Back to start of file */&#xA;memset(&amp;amp;cThisLine,0,sizeof(cThisLine));&#xA;memset(&amp;amp;cNextLine,0,sizeof(cNextLine));&#xA;memset(&amp;amp;buffer,0,sizeof(buffer));&#xA;&#xA;printf(&quot;TEST: Entered read parser\n&quot;);&#xA;cFile = calloc(lFileLen + 1, sizeof(char));&#xA;printf(&quot;TEST:\n&quot;);&#xA;if(cFile == NULL )&#xA;{&#xA;    printf(&quot;\nInsufficient memory to read file.\n&quot;);&#xA;    return 0;&#xA;}&#xA;&#xA;fread(cFile, lFileLen, 1, input); /* Read the entire file into cFile */&#xA;printf(&quot;TEST: read the file in\n&quot;);&#xA;lLineCount  = 0L;&#xA;lTotalChars = 0L;&#xA;&#xA;cThisPtr    = cFile;              /* Point to beginning of array */&#xA;printf(&quot;TEST: Got to here.\n&quot;);&#xA;&#xA;while (*cThisPtr)                 /* Read until reaching null char */&#xA;{&#xA;    //printf(&quot;TEST: Got to here.\n&quot;);&#xA;    lIndex    = 0L;                 /* Reset counters and flags */&#xA;    isNewline = 0;&#xA;    lStartPos = lTotalChars;&#xA;&#xA;    while (*cThisPtr)               /* Read until reaching null char */&#xA;    {&#xA;        if (!isNewline)               /* Haven't read a CR or LF yet */&#xA;        {&#xA;            if (*cThisPtr == CR || *cThisPtr == LF) /* This char IS a CR or LF */&#xA;            isNewline = 1;                        /* Set flag */&#xA;            //printf(&quot;Flag was set&quot;);&#xA;            //exit(0);&#xA;        }&#xA;&#xA;        else if (*cThisPtr != CR &amp;amp;&amp;amp; *cThisPtr != LF) /* Already found CR or LF */&#xA;            break;                                     /* Done with line */&#xA;&#xA;        cThisLine[lIndex++] = *cThisPtr++; /* Add char to output and increment */&#xA;        ++lTotalChars;&#xA;&#xA;    } /* end while (*cThisPtr) */&#xA;&#xA;    cThisLine[lIndex] = '\0';     /* Terminate the string */&#xA;    ++lLineCount;                 /* Increment the line counter */&#xA;    lLineLen = strlen(cThisLine); /* Get length of line */&#xA;    /* THIS is where I look for the matches to the patterns for my info. */&#xA;//    printf(&quot;TEST: Printing 1 line\n%s&quot;, cThisLine);&#xA;//    exit(0);&#xA;&#xA;    if(strstr(cThisLine,title)!= NULL &amp;amp;&amp;amp; tfound == false)&#xA;    {&#xA;        printf(&quot;TEST: Looking for title info.\n&quot;);&#xA;        match = strstr(cThisLine,&quot;&amp;gt;&quot;);&#xA;        //printf(&quot;TEST: match first points to %c\n&quot;, *match);&#xA;        //exit(0);&#xA;        j = 0;&#xA;        match++;&#xA;        //printf(&quot;TEST: match points to %c\n&quot;, *match);&#xA;        while(*match!='&amp;lt;')&#xA;        {&#xA;            //pridntf(&quot;TEST: match is %c\n&quot;, *match);&#xA;            //printf(&quot;TEST: %c&quot;, *match);&#xA;            buffer[j] = *match;&#xA;            //printf(&quot;TEST: %c&quot;, buffer);&#xA;            j++;&#xA;            match++;&#xA;        }&#xA;        lNextLineCount = lLineCount;&#xA;        do&#xA;        {&#xA;            lNextLineCount = lNextLineCount + 1;&#xA;            readaheadone(cFile, lNextLineCount, cNextLinePtr, lbuf);&#xA;            strcpy(cNextLine, lbuf-&amp;gt;bline);&#xA;            cNextLinePtr = cNextLine;&#xA;            printf(&quot;TEST: the current line is - %s\nthe next line is %s\n&quot;,cThisLine,cNextLine);&#xA;            //printf(&quot;TEST: Before test exit&quot;);&#xA;            //exit(0);&#xA;            if(strstr(cNextLinePtr,ending)!=NULL)&#xA;            {&#xA;                printf(&quot;TEST: Author Info spans more than 1 line.\n&quot;);&#xA;                match = strstr(cThisLine,&quot;&amp;gt;&quot;);&#xA;                j++; //i DON'T RESET COUNTER SO IT JUST KEEPS FILLING THE BUFFER AFTER LEAVING A SPACE&#xA;                match++;&#xA;                //printf(&quot;TEST: match points to %c\n&quot;, *match);&#xA;                while(*match!='&amp;lt;')&#xA;                {&#xA;                    //pridntf(&quot;TEST: match is %c\n&quot;, *match);&#xA;                    //printf(&quot;TEST: %c&quot;, *match);&#xA;                    buffer[j] = *match;&#xA;                    //printf(&quot;TEST: %c&quot;, buffer);&#xA;                    j++;&#xA;                    match++;&#xA;                }&#xA;            }&#xA;&#xA;        } while(strstr(cNextLinePtr,ending)!=NULL);&#xA;&#xA;    strcpy((*artIn[0]).title, buffer);&#xA;    printf(&quot;The title is: %s\n&quot;, buffer);//artinfo[0].author);&#xA;    printf(&quot;The title is: %s\n&quot;, (*artIn[0]).title);&#xA;    tfound = true;&#xA;    }&#xA;&#xA;    if(strstr(cThisLine,author)!= NULL &amp;amp;&amp;amp; afound == false)&#xA;    {&#xA;        printf(&quot;TEST: Looking for author info.\n&quot;);&#xA;        match = strstr(cThisLine,&quot;&amp;gt;&quot;);&#xA;&#xA;    }&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Everything seems to work just fine until its reaches the: &lt;code&gt;strcpy((*artIn[0]).title, buffer);&lt;/code&gt; and &lt;code&gt;printf(&quot;The title is: %s\n&quot;, ((*artIn[0]).title);&lt;/code&gt; statements. I always get an error and a stack dump - i.e. 1 [main]Parst_Text 7296 open_stackdumpfile: Dumping stack trace to Parse_Text.exe.stackdump &#xA;I am not really sure what I am doing wrong - I think it is the call to access the member of the struct array as if I remove these statements the program runs without flaw. I am not sure if I am just putting too much on the stack or how to use the stack dump to figure out the problem. All advice is appreciated but please keep it constructive. Thanks. Also please let me know if I overloaded this question as I wasn't sure how much detail to provide.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;EDIT: as per request here is the function which calls reader parser&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#include &amp;lt;unistd.h&amp;gt;   //for close()&#xA;#include &amp;lt;ctype.h&amp;gt;    //for toupper()&#xA;#include &amp;lt;stdbool.h&amp;gt;  //for bool type&#xA;#include &amp;lt;errno.h&amp;gt;    //where the standard error is written for calls to OS&#xA;#include &quot;file_table.h&quot;&#xA;#define BUFSIZE 1024&#xA;#define CR 13            /* Decimal code of Carriage Return char */&#xA;#define LF 10            /* Decimal code of Line Feed char */&#xA;#define EOF_MARKER 26    /* Decimal code of DOS end-of-file marker */&#xA;&#xA;void fillFileTable(char *filedir, ftable *table, bool populate, ftinfo *info);&#xA;bool readerParser(FILE *InputFile, FILE *OutputFile, textlbuf *lbuf, artinfo *artIn[]);&#xA;void readaheadone(char *cFile, long nextLineCount ,char *currentPtr, textlbuf *lbuf);&#xA;&#xA;int main()&#xA;{&#xA;    /*Define variables &amp;amp; Instantiate Structs.*/&#xA;    ftable files[128];&#xA;    ftinfo info;&#xA;    artinfo artIn[128] = {};&#xA;    textlbuf store[1];&#xA;    char buffer[BUFSIZE];&#xA;    char dir[260] = &quot;C:/DTEST/Parse_Text/91_1_text&quot;; //would be better if user could enter this - fix for later&#xA;    ftinfo *fti = &amp;amp;info; &#xA;    textlbuf *lbuf = &amp;amp;store;&#xA;    FILE *fp, *op; //fp is input file, op is output file&#xA;    int i, j, k;&#xA;    bool iReadReturn;&#xA;&#xA;    /*Clear Out Memory Structures*/&#xA;    memset(&amp;amp;files,0,sizeof(files));&#xA;    memset(&amp;amp;info,0,sizeof(info));&#xA;    memset(&amp;amp;artIn,0,sizeof(artIn));&#xA;    memset(&amp;amp;buffer,0,sizeof(buffer));&#xA;    memset(&amp;amp;store,0,sizeof(store));&#xA;&#xA;    /*Fill the File Table*/&#xA;    printf(&quot;TEST: Preparing to fill the file table...\n&quot;);&#xA;    fillFileTable(dir,files,true,fti);&#xA;    if(info.success == false)&#xA;    {&#xA;        printf(&quot;Something went wrong. Now exiting&quot;);&#xA;        exit(1);&#xA;    }&#xA;    printf(&quot;File table has been filled: %s\n&quot;,info.notes);&#xA;    printf(&quot;File table contains: %d\n&quot;, info.fileCount);&#xA;    printf(&quot;TEST: 'fillFileTable' is successful? --- %s\n&quot;, info.success?&quot;true&quot;:&quot;false&quot;);&#xA;    for(i=0;i&amp;lt;info.fileCount;i++)&#xA;    {&#xA;        if(files[i].type == 'd')&#xA;            printf(&quot;File Folder is: %s\t its size is %d\n&quot;,files[i].fileName,files[i].fileSize);&#xA;        else&#xA;            printf(&quot;File is: %s\t its size is %d\n&quot;,files[i].fileName,files[i].fileSize);&#xA;    }&#xA;    printf(&quot;\n\n&quot;);&#xA;   //printf(&quot;TESTd: Exiting after file table printout.\n\n&quot;); exit(0);&#xA;&#xA;   op=fopen(&quot;./test_Out.txt&quot;, &quot;a&quot;);&#xA;   if (op == NULL )             /* Could not open file */&#xA;    {&#xA;        printf(&quot;Error opening output file: %s (%u)\n&quot;, strerror(errno), errno);&#xA;        return 1;&#xA;    }&#xA;&#xA;    //for(i=0;i&amp;lt;info.fileCount;i++) //Figure out how to loop through all files - improvement for later&#xA;    fp=fopen(&quot;./91_1_text/test1.txt&quot;, &quot;r&quot;);&#xA;    if (fp == NULL )             /* Could not open file */&#xA;    {&#xA;        printf(&quot;Error opening input file: %s (%u)\n&quot;, strerror(errno), errno);&#xA;        return 1;&#xA;    }&#xA;&#xA;    iReadReturn = readerParser(fp, op, lbuf, artIn); /* Read the file and print output */&#xA;    if (iReadReturn == false)&#xA;    {&#xA;        printf(&quot;ERROR: The file did not read correctly.\n&quot;);&#xA;        exit(1);&#xA;    }&#xA;    k = fclose(fp);&#xA;    if (k != 0)&#xA;        exit(k);&#xA;&#xA;    k = fclose(op);&#xA;    if (k != 0)&#xA;        exit(k);&#xA;    printf(&quot;Program Completed Successfuly.\n&quot;);&#xA;    return 0;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;}&lt;/p&gt;&#xA;" OwnerUserId="3317269" LastEditorUserId="3317269" LastEditDate="2014-05-20T17:01:23.903" LastActivityDate="2014-05-20T17:24:32.597" Title="Issues accessing a struct array when it is sent into a function" Tags="&lt;c&gt;&lt;arrays&gt;&lt;struct&gt;&lt;member-access&gt;" AnswerCount="2" CommentCount="9" />
  <row Id="23891347" PostTypeId="1" AcceptedAnswerId="23955188" CreationDate="2014-05-27T13:52:33.127" Score="2" ViewCount="248" Body="&lt;p&gt;This is a school thing.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here's the problem:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;We're working on a Bomberman clone, and we have to implement a scripting interface, allowing the user to make his own &quot;artificial intelligence&quot;.&#xA;We chose to use Perl. Right now, I build the perl module like this:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here are the files (test purpose):&lt;/p&gt;&#xA;&#xA;&lt;p&gt;SaibApi.xs:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;#include &quot;EXTERN.h&quot;&#xA;#include &quot;perl.h&quot;&#xA;#include &quot;XSUB.h&quot;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;#include &quot;ppport.h&quot;&#xA;#include &quot;SaibApi.hpp&quot;&#xA;&#xA;MODULE = SaibApi                PACKAGE = SaibApi&#xA;&#xA;SaibApi *&#xA;SaibApi::new()&#xA;&#xA;void&#xA;SaibApi::DESTROY()&#xA;&#xA;void&#xA;SaibApi::PrintLol()&#xA;&#xA;void&#xA;SaibApi::PrintPvar()&#xA;&#xA;void&#xA;SaibApi::setLol(int arg)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;SaibApi.hpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef         SAIBAPI_HPP_&#xA;# define        SAIBAPI_HPP_&#xA;&#xA;#include &amp;lt;iostream&amp;gt;&#xA;&#xA;class           SaibApi {&#xA;public:&#xA; SaibApi() {}&#xA; ~SaibApi() {}&#xA; void          PrintLol() { std::cout &amp;lt;&amp;lt; &quot;lol\n&quot;; }&#xA; void          PrintPvar() { std::cout &amp;lt;&amp;lt; _lol &amp;lt;&amp;lt; &quot;\n&quot;; }&#xA; void          setLol(int arg) {_lol = arg;}&#xA;private:&#xA; int           _lol;&#xA;};&#xA;&#xA;#endif          /* !SAIBAPI_HPP_ */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Makefike.PL:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;use 5.014002;&#xA;use ExtUtils::MakeMaker;&#xA;&#xA;my $CC =                'g++';&#xA;&#xA;# See lib/ExtUtils/MakeMaker.pm for details of how to influence&#xA;# the contents of the Makefile that is written.&#xA;WriteMakefile(&#xA; NAME              =&amp;gt; 'SaibApi',&#xA; VERSION_FROM      =&amp;gt; 'lib/SaibApi.pm', # finds $VERSION  &#xA; PREREQ_PM         =&amp;gt; {}, # e.g., Module::Name =&amp;gt; 1.1&#xA; ($] &amp;gt;= 5.005 ?     ## Add these new keywords supported since 5.005&#xA; (ABSTRACT_FROM  =&amp;gt; 'lib/SaibApi.pm', # retrieve abstract from module &#xA;  AUTHOR         =&amp;gt; 'Arkeopix &amp;lt;arkeopix@&amp;gt;') : ()),&#xA; LIBS              =&amp;gt; [''], # e.g., '-lm' &#xA; DEFINE            =&amp;gt; '', # e.g., '-DHAVE_SOMETHING'&#xA; INC               =&amp;gt; '-I.', # e.g., '-I. -I/usr/include/other'&#xA;       # Un-comment this if you add C files to link with later:   &#xA;       # OBJECT            =&amp;gt; '$(O_FILES)', # link all the C files too &#xA; CC                =&amp;gt; $CC,&#xA; LD                =&amp;gt; '$(CC)',&#xA; XSOPT             =&amp;gt; '-C++',&#xA; TYPEMAPS          =&amp;gt; ['perlobject.map'],&#xA;);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;For clarity purpose, i excluded typemaps files.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The module is correctly built and i'm able to instantiate the SaibApi class in perl.&#xA;Now our problem is that there is apparently no way to instantiate the class in c++ and in perl at the same time. What we're trying to do is to give the user a simple API, allowing to get objects from our C++ code (lots of std::list containing maps, players etc...) via simple methods. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;eg:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#! /usr/bin/perl -w&#xA;#use SaibApi;&#xA;&#xA;my $ai = new SaibApi();&#xA;my @map = ai-&amp;gt;GetMap();&#xA;# some more code here...&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;We've made a lot of research but the documentation about XS is a bit scarce. We're stuck right now. How one would instantiate the class in c++ and in perl at the same time, allowing to set &lt;code&gt;_lol&lt;/code&gt; in the c++ part and print it in the perl part without having to use the &lt;code&gt;SetLol()&lt;/code&gt; method ? And if not possible, what are the alternatives ?&lt;/p&gt;&#xA;" OwnerUserId="2385503" LastActivityDate="2014-05-30T12:56:48.210" Title="How to interface c++ and perl using XS?" Tags="&lt;c++&gt;&lt;perl&gt;&lt;xs&gt;" AnswerCount="2" CommentCount="1" />
  <row Id="23932172" PostTypeId="1" CreationDate="2014-05-29T11:22:44.817" Score="0" ViewCount="461" Body="&lt;p&gt;I am using &lt;code&gt;-D_FILE_OFFSET_BITS=64&lt;/code&gt; flag while compiling my application on Unix. It gets built properly on &lt;code&gt;RHEL&lt;/code&gt;, &lt;code&gt;SuSE&lt;/code&gt;, &lt;code&gt;HP-uX&lt;/code&gt; and &lt;code&gt;AIX&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;On Solaris, I am getting an error for following:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;long lPos = 0L;&#xA;long UTMPSIZE = sizeof(struct utmp);&#xA;int fd = 0;&#xA;&#xA;fd = open(&quot;/etc/utmp&quot;, O_RDONLY);&#xA;UTMPSIZE = sizeof(struct utmpx);&#xA;lPos = lseek(fd, -UTMPSIZE, SEEK_END); // error: conversion from `long int' to non-scalar type `off_t' requested&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I read somewhere that using &lt;code&gt;-D_FILE_OFFSET_BITS=64&lt;/code&gt;, the long gets #defined to &lt;code&gt;off_t&lt;/code&gt;. &#xA;If that is so, why this error happens?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I wrote the same steps in a cpp program, compiled and executed on a soalris system, and it works. However only while compiling the application, the error is seen.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This is what i have in types.h:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#if __STDC__ - 0 == 0 &amp;amp;&amp;amp; !defined(_NO_LONGLONG)&#xA;typedef long long               longlong_t;&#xA;typedef unsigned long long      u_longlong_t;&#xA;#else&#xA;/* used to reserve space and generate alignment */&#xA;typedef union {&#xA;        double  _d;&#xA;        int32_t _l[2];&#xA;} longlong_t;&#xA;typedef union {&#xA;        double          _d;&#xA;        uint32_t        _l[2];&#xA;} u_longlong_t;&#xA;#endif  /* __STDC__ - 0 == 0 &amp;amp;&amp;amp; !defined(_NO_LONGLONG) */&#xA;&#xA;#ifndef _OFF_T&#xA;#define _OFF_T&#xA;&#xA;#if defined(_LP64) || _FILE_OFFSET_BITS == 32&#xA;typedef long            off_t;          /* offsets within files */&#xA;#elif _FILE_OFFSET_BITS == 64&#xA;typedef longlong_t      off_t;          /* offsets within files */&#xA;#endif&#xA;&#xA;#if defined(_LARGEFILE64_SOURCE)&#xA;#ifdef _LP64&#xA;typedef off_t           off64_t;        /* offsets within files */&#xA;#else&#xA;typedef longlong_t      off64_t;        /* offsets within files */&#xA;#endif&#xA;#endif  /* _LARGEFILE64_SOURCE */&#xA;&#xA;#endif /* _OFF_T */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;If I use long long in code, the error is now changed to &quot;long long int&quot;. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;To solve above problem, I have added #define _FILE_OFFSET_BITS 64. It was found that in one of the header same flag value was set to 32. I don't know what happened but, using compile time flag did not override that #define. I then added following after the #include: &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef &amp;lt;SunOS&amp;gt;&#xA;#undef _FILE_OFFSET_BITS&#xA;#define _FILE_OFFSET_BITS 64&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This rectifies the compile time error. But now there is another problem, the stat structure members after stat() call are not getting populated properly. I have no clue why is it happening so. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any help here is much appreciated..&lt;/p&gt;&#xA;" OwnerUserId="1787572" LastEditorUserId="1787572" LastEditDate="2014-06-03T08:34:55.890" LastActivityDate="2014-06-03T08:34:55.890" Title="lseek error when -D_FILE_OFFSET_BITS=64 is used on solaris" Tags="&lt;c++&gt;&lt;c&gt;&lt;solaris&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="24073974" PostTypeId="1" AcceptedAnswerId="24074674" CreationDate="2014-06-06T04:03:07.930" Score="-6" ViewCount="961" Body="&lt;p&gt;There is a problem with the chatter.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;(A simple chatter consisting out of an rich edit box and an edit.)&#xA;(first one shows messages from both sides, second one is used to type in a new message)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The following command clears the edit box. (see SetFocus below)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I don't want that.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This behaviour changed from windows xp to windows 7 or between delphi versions not sure which.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Last time I looked at this I think it may have been a changed in windows versions, delphi's edit box may have been implemented with windows apis.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;It didn't use to do that on windows xp and/or previous versions of Delphi.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The problem is with:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;vActiveControl.SetFocus;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This clears the edit box... I don't want that.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This is a problem when the user is entering a new message and a message arrives from the other side... the code switches focus back and forth between rich edit messages and edit box..&#xA;which causes the newly typed message to be cleared, which is ofcourse annoying.&#xA;(One possible solution which comes to mind is remembering what was typed and re-pasting it after this flip flop happens)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Focus must be set back to this edit box after the rich edit chatter messages were updated.&#xA;So that the user can continue typing in new messages.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there an easy fix ? (Perhaps the remember trick and repasting might work, perhaps there are other solutions)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;It would also be nice if the rich edit chatter messages would auto scroll down&#xA;without requiring focus... now focus flip flops between&#xA;chatter messages, and chatter edit box to type new message.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;If user wanted to enter messages real fast... it might end up in the rich edit box&#xA;cause the set focus back to chat edit box didnt happen fast enough..&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I may try and replace vcl with firemonkey... I am not sure if firemonkey&#xA;has better support for writing network chat apps and focussing and text scrolling and such.&#xA;I may investigate that also.&#xA;Copy &amp;amp; paste for text is also nice.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;(It would be preferred if fixes work across windows versions, perhaps the remember and repaste trick might work, I am aware that firemonkey may not work on all windows versions, I am considering to make a dual version, one vcl and one firemonkey version.)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;procedure TFormMain.ChatterMessageReceived( Sender : TObject );&#xA;var&#xA;    vActiveControl : TWinControl;&#xA;begin&#xA;    vActiveControl := Screen.ActiveControl;&#xA;&#xA;&#xA;//  RichEditChatterMessages.Lines.Add( ProtocolWrapper.Chatter.OtherNickname + ': ' + ProtocolWrapper.Chatter.OtherMessage );&#xA;    RichEditChatterMessages.Lines.Add( 'Remote: ' + ProtocolWrapper.Chatter.OtherMessage );&#xA;&#xA;&#xA;&#xA;//  RichEditChatterMessages.Perform(EM_LineScroll, 0, RichEditChatterMessages.Lines.Count); // werkt niet goed&#xA;    if ColoredPageControl1.ActivePage = ColoredTabSheetChatter then&#xA;    begin&#xA;        RichEditChatterMessages.SetFocus; // must set focus first for perform scroll caret to work&#xA;    end;&#xA;&#xA;    RichEditChatterMessages.Perform (em_scrollcaret,0,0);&#xA;&#xA;    if vActiveControl &amp;lt;&amp;gt; nil then&#xA;    begin&#xA;        vActiveControl.SetFocus;&#xA;    end;&#xA;&#xA;    ColoredTabSheetChatter.TabColor := clLime;&#xA;    FlashApplication;&#xA;end;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The internet has been updated since I discovered this problem.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I came across this solution which seems to work so far... will have to test on different windows versions and situations and such... looks promising, deleting this question for now, cause it might be a duplicate already:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;procedure ScrollToEnd(ARichEdit: TRichEdit);&#xA;var&#xA;isSelectionHidden: Boolean;&#xA;begin&#xA;  with ARichEdit do&#xA;begin&#xA;    SelStart := Perform(Messages.EM_LINEINDEX, Lines.Count, 0);//Set caret at end&#xA;    isSelectionHidden := HideSelection;&#xA;    try&#xA;      HideSelection := False;&#xA;    Perform(Messages.EM_SCROLLCARET, 0, 0);  // Scroll to caret&#xA;    finally&#xA;    HideSelection := isSelectionHidden;&#xA;    end;&#xA;end;&#xA;end;&#xA;&#xA;procedure TFormMain.ChatterMessageReceived( Sender : TObject );&#xA;begin&#xA;&#xA;//  RichEditChatterMessages.Lines.Add( ProtocolWrapper.Chatter.OtherNickname + ': ' + ProtocolWrapper.Chatter.OtherMessage );&#xA;    RichEditChatterMessages.Lines.Add( 'Remote: ' + ProtocolWrapper.Chatter.OtherMessage );&#xA;&#xA;    ScrollToEnd(RichEditChatterMessages);&#xA;&#xA;    ColoredTabSheetChatter.TabColor := clLime;&#xA;    FlashApplication;&#xA;end;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I am undeleting this question though.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This solution has other drawbacks though.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;User might not be able to select text anymore if other user is chatting.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Also it seems to raise exceptions. (Not sure why, maybe it happens when user tries to select text, or maybe the cause of the exception was from something else... investigating...)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This is one nasty problem...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I think the solution is to use a solution that works for whatever version of RichEdit dll delphi is using. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;This creates a bit of a tricky situation... if one wants to write code that works in all delphi versions...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For now just using this seems to work in Delphi XE6:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Perform(Messages.EM_SCROLLCARET, 0, 0);  // Scroll to caret&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I may have to use {$ifdef } here and there if I want this code to work for all delphi versions...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So I may again have to investigate this problem in the future.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is a nice link to microsoft document about this control:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/windows/desktop/bb787873%28v=vs.85%29.aspx&quot; rel=&quot;nofollow&quot;&gt;http://msdn.microsoft.com/en-us/library/windows/desktop/bb787873(v=vs.85).aspx&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;There are 4 versions:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;•Versions of Rich Edit &#xA; ◦Rich Edit Version 1.0&#xA; ◦Rich Edit Version 2.0&#xA; ◦Rich Edit Version 3.0&#xA; ◦Rich Edit Version 4.1&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I am not sure which Delphi versions use which control version.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;And which version of the control has the scroll issue...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;To be continued...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;(For now I ll focus on Delphi XE6 and perhaps in the future return to this issue if I want my software to work on different windows versions and delphi versions)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This could be a cool solution:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/2294962/how-to-test-if-a-control-is-a-richedit-control&quot;&gt;How to test if a control is a RichEdit control&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;^ Detecting at runtime which version of the control is being used by any delphi version.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Then coding a solution per control version, that would be nice.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Further hints:&#xA;ComCtrls unit has this code which determines which version is being loaded:&#xA;RichEditModuleName = 'RICHED20.DLL';&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Maybe it's possible to replace rich edit with simply a Tmemo... or maybe not... maybe Tmemo doesn't scroll or maybe it's the same kind of control... or didn't look good... not sure why rich edit was preferred. I think I was worried Tmemo can only contain a limited ammount of lines ?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This perform solution is also not very good.&#xA;If the user switches focus to other controls... it will interfere with the carrot of those controls.&#xA;Woops forgot to include RichEditControl..&#xA;Instead of:&#xA;Perform(Messages.EM_SCROLLCARET, 0, 0);  // Scroll to caret&#xA;This code works better:&#xA;RichEditChatterMessages.Perform(Messages.EM_SCROLLCARET, 0, 0);  // Scroll to caret&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Performance monitoring control was refreshing itself so was also not a good way to test this effect... so far so good.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Perhaps switching to a better GUI like firemonkey might be a solution. Though perhaps firemonkey would introduce new problems, seeing all these problems with vcl/richedit... it's worth a try. Though firemonkey... not sure which windows versions that would work on... For now still interesting to investigate vcl/richedit and so forth for old os-es and such.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Also what has not yet been discussed is why Tedit is clear when it receives .SetFocus... hmm...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The problem was found by one of the commentors below. TEdit.AutoSelect property when set to True creates this clearing behaviour... see test code below provided by &quot;despatcher&quot;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;One remaining problem that remains is... the richedit does not scroll if it's not visible/in focus or something... so for example another tab is visible. I tried using .SetFocus on the richedit but doesn't seem to help... actually there was a branch in front of it... it will only set focus if tab was selected by user... therefore SetFocus was not being applied... hmm... ofcourse I can't interrupt the user with a setfocus like that anyway... hmmm... so setfocus is probably out of the question... must find a different way to scroll the richedit downwards so its nicely position on most recent messages or so... hmmm...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Ok finally all problems solved:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;SendMessage(RichEditChatterMessages.Handle, WM_VSCROLL, SB_BOTTOM, 0);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Works perfectly for scrolling down... as long as all event handlers use this method for the rich edit.&lt;/p&gt;&#xA;" OwnerUserId="700914" LastEditorUserId="700914" LastEditDate="2014-06-06T07:00:19.203" LastActivityDate="2014-06-06T07:00:19.203" Title="SetFocus clears edit box. (Different behaviour across windows and/or delphi versions)" Tags="&lt;delphi&gt;" AnswerCount="1" CommentCount="17" />
  <row Id="24124484" PostTypeId="1" CreationDate="2014-06-09T16:22:33.330" Score="4" ViewCount="309" Body="&lt;p&gt;I am looking for some preprocessor functionality in nasm that would allow having one source code for both x86 and x64 architectures. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I mean something in the vein of ifdef some_constant. Like C preprocessor uses if it wants to detect say if it's compiled on Windows or Linux.&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;Edit&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;I know about nasm flags. I use them. I just want to have the very same source code and expect preprocessor to handle it correctly based on those flags. I'd use ifdef ... else for stack operations and so one, having the core code same for both architectures.&lt;/p&gt;&#xA;" OwnerUserId="1342976" LastEditorUserId="895245" LastEditDate="2015-04-20T20:35:29.750" LastActivityDate="2015-04-27T09:20:03.783" Title="How to detect architecture in nasm at compile time so that I could have one source code for both x64 and x86?" Tags="&lt;assembly&gt;&lt;x86&gt;&lt;preprocessor&gt;&lt;nasm&gt;&lt;x86-64&gt;" AnswerCount="3" CommentCount="2" />
  <row Id="24128158" PostTypeId="1" AcceptedAnswerId="24128190" CreationDate="2014-06-09T20:10:04.340" Score="0" ViewCount="156" Body="&lt;p&gt;I have a simple gnu makefile:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ifdef $(DEBUGGING)&#xA;  CFLAGS = -g -O0 -Wall&#xA;else&#xA;  CFLAGS = -O3 -Wall&#xA;endif&#xA;&#xA;test:&#xA;    @echo DEBUGGING is $(DEBUGGING)&#xA;    @echo $(CFLAGS)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;When I invoke it like this, I see that DEBUGGING is set to true, but &lt;code&gt;ifdef $DEBUGGING&lt;/code&gt; appears to be false:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ DEBUGGING=true make test&#xA;DEBUGGING is true&#xA;-O3 -Wall&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I would expect that CFLAGS would be set to &quot;-g -O0 -Wall&quot;.  What am I missing?&lt;/p&gt;&#xA;" OwnerUserId="558639" LastEditorUserId="558639" LastEditDate="2014-06-09T21:47:18.843" LastActivityDate="2014-06-09T21:47:18.843" Title="using an ifdef conditional to set a Make flag" Tags="&lt;makefile&gt;&lt;gnu-make&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="24132030" PostTypeId="1" AcceptedAnswerId="24132090" CreationDate="2014-06-10T02:41:52.020" Score="1" ViewCount="128" Body="&lt;p&gt;I am learning C by programming a chess application and I have a problem with circular references. My linkedList.h looks like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef LINKEDLIST_H&#xA;#define LINKEDLIST_H&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;#endif  /* LINKEDLIST_H */&#xA;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &quot;squares.h&quot;&#xA;&#xA;typedef struct node {&#xA;tSquare c;&#xA;struct node * next;&#xA;} node_square;&#xA;&#xA;&#xA;&#xA;void createEmptyList(node_square* n);&#xA;int isEmptyList(node_square* n);&#xA;int insertAtBeginning(node_square** n, tSquare c); &#xA;void print_list(node_square * head);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And in my squares.h I want to include the linkedList.h functionality so that I can return a linked list of squares threatened by one of the sides (black or white):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef SQUARES_H&#xA;#define SQUARES_H&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;#endif  /* SQUARES_H */&#xA;&#xA;typedef struct {&#xA;    int file;&#xA;    int rank;&#xA;} tSquare;&#xA;&#xA;node_square* listOfThreatenedSquares(tColor color); &amp;lt;--- undefined types in compilation time&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I've read that what I should use is forward referencing; I am trying to use it so that in the squares.h file I can use types node_square and tColor (which is defined in another file called pieces.h) but no matter how I declare the types, it just isn't working. I guess it's something like &lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;typedef struct node_square node_square;&#xA;typedef struct tColor tColor;&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;in the squares.h. Ideas?&lt;/p&gt;&#xA;" OwnerUserId="1688591" LastActivityDate="2014-06-10T02:50:52.390" Title="Cannot forward declare a typedef?" Tags="&lt;c&gt;&lt;struct&gt;&lt;typedef&gt;&lt;forward-declaration&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="24144652" PostTypeId="1" CreationDate="2014-06-10T15:14:47.637" Score="0" ViewCount="42" Body="&lt;p&gt;I'm experiencing a very weird issue.&#xA;My c++ program uses a DLL that I've written.&#xA;This DLL exports a class MyDocument.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  WIN32&#xA;#   if defined(CORE_EXPORTS)&#xA;#       define CORE_API __declspec(dllexport)&#xA;#   elif defined(MCORE_IMPORTS)&#xA;#       define CORE_API __declspec(dllimport)&#xA;#   else&#xA;#       define CORE_API&#xA;#   endif&#xA;#else&#xA;#   define CORE_API&#xA;#endif&#xA;&#xA;    class CORE_API MyDocument&#xA;    {&#xA;    public:&#xA;    ...&#xA;    };&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;As my client program attempts to create an array of this object, it takes more than 7 seconds (almost 10)in debug mode.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;MyDocument *docs = new MyDocuments[550];&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I read about using _NO_DEBUG_HEAP=1 in the env variables but it doesn't change anything.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Moreoever, I found out something weird. Instead of exporting the class MyDocument, I put the whole code in the header file so I can use it by just including its header file.&#xA;In that case, the same allocation statement is almost instantaneous.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;MyDocument *docs = new MyDocuments[550];&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Honnestly, I don't know what's happening there.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any suggestion ?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My config: XP with VS Express 2008.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Z.&lt;/p&gt;&#xA;" OwnerUserId="2931220" LastActivityDate="2014-06-10T15:29:19.220" Title="Performance issue when allocating an object imported from a DLL" Tags="&lt;c++&gt;&lt;performance&gt;&lt;memory-management&gt;&lt;dll&gt;&lt;visual-studio-debugging&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="24185952" PostTypeId="1" CreationDate="2014-06-12T13:40:21.913" Score="3" ViewCount="213" Body="&lt;p&gt;I would like to add some class operators to a record, but I still want to code to compile under older Delphi versions.  &lt;/p&gt;&#xA;&#xA;&lt;p&gt;What define should I use so that the operator will compile in all versions that support it, but will be ignored in older Delphi versions.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;type&#xA;  Iso8601 = {$ifndef UNICODE}object{$else}record{$endif}&#xA;    data: Integer;&#xA;    {$ifdef ????} &amp;lt;-- what to put here&#xA;    class operator Add(A: Iso8601): Iso8601;&#xA;    {$endif}&#xA;  end;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I know that records with member functions coincide with the Unicode update, but what define do I use for the class operators?&lt;/p&gt;&#xA;" OwnerUserId="650492" LastActivityDate="2014-08-15T07:51:48.260" Title="What ifdef should I use to check for class operators" Tags="&lt;delphi&gt;&lt;conditional-compilation&gt;" AnswerCount="1" CommentCount="5" FavoriteCount="1" />
  <row Id="24686003" PostTypeId="1" AcceptedAnswerId="24718370" CreationDate="2014-07-10T20:47:51.797" Score="0" ViewCount="1772" Body="&lt;p&gt;I'm trying to debugging my code on the PIC24F04KA200. But when i start debugging, i get the message: &#xA;&lt;em&gt;The target device is not ready for debugging. Please check your configuration bit settings and program the device before proceeding. The most common causes for this failure are oscillator and/or PGC/PGD settings.&lt;/em&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I readed the PicKit3 User guide, but i don't find the answer. The PicKit is connected to the PGC2 and PGD2 pins. My configuration bits:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* &#xA; * File:   config.h&#xA; *&#xA; */&#xA;&#xA;#ifndef CONFIG_H&#xA;#define CONFIG_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif  /* CONFIG_H */&#xA;&#xA;&#xA;#include &amp;lt;p24F04KA200.h&amp;gt;&#xA;&#xA;&#xA;// PIC24F04KA200 Configuration Bit Settings&#xA;&#xA;// 'C' source line config statements&#xA;&#xA;#include &amp;lt;xc.h&amp;gt;&#xA;&#xA;// FBS&#xA;&#xA;// FGS&#xA;#pragma config GWRP = OFF               // General Segment Code Flash Write Protection bit (General segment may be written)&#xA;#pragma config GCP = OFF                // General Segment Code Flash Code Protection bit (No protection)&#xA;&#xA;// FOSCSEL&#xA;#pragma config FNOSC = FRCDIV           // Oscillator Select (8 MHz FRC oscillator with divide-by-N (FRCDIV))&#xA;#pragma config IESO = OFF               // Internal External Switch Over bit (Internal External Switchover mode disabled (Two-Speed Start-up disabled))&#xA;&#xA;// FOSC&#xA;#pragma config POSCMOD = NONE           // Primary Oscillator Configuration bits (Primary oscillator disabled)&#xA;#pragma config OSCIOFNC = ON            // CLKO Enable Configuration bit (CLKO output disabled)&#xA;#pragma config POSCFREQ = MS            // Primary Oscillator Frequency Range Configuration bits (Primary oscillator/external clock input frequency between 100 kHz and 8 MHz)&#xA;#pragma config SOSCSEL = SOSCHP         // SOSC Power Selection Configuration bits (Secondary oscillator configured for high-power operation)&#xA;#pragma config FCKSM = CSECMD           // Clock Switching and Monitor Selection (Clock switching is enabled, Fail-Safe Clock Monitor is disabled)&#xA;&#xA;// FWDT&#xA;#pragma config WDTPS = PS32768          // Watchdog Timer Postscale Select bits (1:32,768)&#xA;#pragma config FWPSA = PR128            // WDT Prescaler (WDT prescaler ratio of 1:128)&#xA;#pragma config WINDIS = OFF             // Windowed Watchdog Timer Disable bit (Standard WDT selected; windowed WDT disabled)&#xA;#pragma config FWDTEN = OFF             // Watchdog Timer Enable bit (WDT disabled (control is placed on the SWDTEN bit))&#xA;&#xA;// FPOR&#xA;#pragma config BOREN = BOR0             // Brown-out Reset Enable bits (Brown-out Reset disabled in hardware; SBOREN bit disabled)&#xA;#pragma config PWRTEN = OFF             // Power-up Timer Enable bit (PWRT disabled)&#xA;#pragma config BORV = LPBOR             // Brown-out Reset Voltage bits (Low-Power Brown-out reset occurs around 2.0V)&#xA;#pragma config MCLRE = ON               // MCLR Pin Enable bit (MCLR pin enabled; RA5 input pin disabled)&#xA;&#xA;// FICD&#xA;#pragma config ICS = PGx2               // Reserved (PGC2/PGD2 are used for programming the device)&#xA;&#xA;// FDS&#xA;#pragma config DSWDTPS = DSWDTPSF       // Deep Sleep Watchdog Timer Postscale Select bits (1:2,147,483,648 (25.7 Days))&#xA;#pragma config DSLPBOR = OFF            // Deep Sleep Zero-Power BOR Enable bit (Deep Sleep BOR disabled in Deep Sleep)&#xA;#pragma config DSWDTEN = OFF            // Deep Sleep Watchdog Timer Enable bit (DSWDT disabled)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And my main file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* &#xA; * File:   main.c&#xA; */&#xA;#include &quot;config.h&quot;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;&#xA;&#xA;int main(int argc, char** argv)&#xA;{&#xA;    while(1)&#xA;    {&#xA;        ;&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The processor is running. I have a blinkerLed program running. &#xA;Does anyone have a suggestion?&lt;/p&gt;&#xA;" OwnerUserId="3383139" LastEditorUserId="3383139" LastEditDate="2014-07-10T20:54:04.883" LastActivityDate="2014-07-13T00:00:13.337" Title="PIC24 PicKit3 can't debug" Tags="&lt;debugging&gt;&lt;microchip&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="24722241" PostTypeId="1" CreationDate="2014-07-13T11:38:15.480" Score="0" ViewCount="1309" Body="&lt;p&gt;I am working with the following &lt;a href=&quot;http://www.aliexpress.com/store/product/Development-board-ARM-Crotex-M3-STM32F103VET6-board-7-TFT-MP3-CAN-485-Internet-support-Wireless/217299_643786417.html&quot; rel=&quot;nofollow&quot;&gt;evaluation board&lt;/a&gt;: SZWB-sail, STM32f103VET6 KIT v3.1&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I want to use the stm32f103 usart in synchronous mode, and I used &#xA;STM32F10x_StdPeriph_Lib_V3.5.0\Project\STM32F10x_StdPeriph_Examples\USART\Synchronous&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I modified the code in an attempt to use &lt;code&gt;USART2&lt;/code&gt;/&lt;code&gt;SPI1&lt;/code&gt;, as opposed to the working code provided via STMicro, which uses &lt;code&gt;USART1&lt;/code&gt;/&lt;code&gt;SPI1&lt;/code&gt;. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;The &lt;a href=&quot;https://github.com/jhgorse/gcc-arm-none-eabi_samples/blob/master/STM32F10x_StdPeriph_Lib_V3.5.0/Project/STM32F10x_StdPeriph_Examples/USART/Synchronous/readme.txt&quot; rel=&quot;nofollow&quot;&gt;README&lt;/a&gt; for this example states that: &lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;blockquote&gt;&#xA;    &lt;p&gt;&quot;USARTy and SPIy can be USART1 and SPI1 or USART2 and SPI3, depending on the STMicroelectronics EVAL board you are using.&quot;&lt;/p&gt;&#xA;  &lt;/blockquote&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;Despite this, I attempted to physically connect &lt;code&gt;USART2&lt;/code&gt; Tx/Rx/Ck pins (PA2,PA3,PA4) to &lt;code&gt;SPI1&lt;/code&gt; SCK/MISO/MOSI (PA5,PA6,PA7). Is there a software reason for why this won't work? Or might it be hardware connections on the eval board?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is my code: &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;int main(void)&#xA;{&#xA;    SystemInit();&#xA;    Init_NVIC();&#xA;    /* System Clocks Configuration */&#xA;    RCC_Configuration();&#xA;    /* Configure the GPIO ports */&#xA;    GPIO_Configuration();&#xA;    SPI_Configuration();&#xA;    USART_Configuration();&#xA;&#xA;&#xA;    while(NbrOfDataToRead2--)&#xA;    {&#xA;&#xA;        USART2_Send_Byte(TxBuffer1[TxCounter1++]);&#xA;&#xA;        while(USART_GetFlagStatus(USART2, USART_FLAG_TC) == RESET)&#xA;        {&#xA;        }&#xA;        while(SPI_I2S_GetFlagStatus(SPI1, SPI_I2S_FLAG_RXNE) == RESET)&#xA;        {&#xA;        }&#xA;&#xA;        RxBuffer2[RxCounter2++] = SPI_I2S_ReceiveData(SPI1);&#xA;    }&#xA;&#xA;&#xA;    USART2_Receive_Byte();&#xA;&#xA;    while(NbrOfDataToRead1--)&#xA;    {&#xA;&#xA;        while(SPI_I2S_GetFlagStatus(SPI1, SPI_I2S_FLAG_TXE)== RESET)&#xA;        {&#xA;        }&#xA;        SPI_I2S_SendData(SPI1, TxBuffer2[TxCounter2++]);&#xA;&#xA;&#xA;        USART2_Send_Byte(DYMMY_BYTE);&#xA;&#xA;        while(USART_GetFlagStatus(USART2, USART_FLAG_TC) == RESET)&#xA;        {&#xA;        }&#xA;&#xA;        while(USART_GetFlagStatus(USART2, USART_FLAG_RXNE) == RESET)&#xA;        {&#xA;        }&#xA;&#xA;        RxBuffer1[RxCounter1++] = USART2_Receive_Byte();&#xA;    }&#xA;&#xA;&#xA;    TransferStatus1 = Buffercmp(TxBuffer1, RxBuffer2, TxBufferSize1);&#xA;&#xA;    TransferStatus2 = Buffercmp(TxBuffer2, RxBuffer1, TxBufferSize2);&#xA;&#xA;&#xA;    while(1)&#xA;    {&#xA;    }&#xA;}&#xA;&#xA;void Init_NVIC(void)&#xA;{&#xA;    NVIC_InitTypeDef    NVIC_InitStructure;&#xA;&#xA;    #ifdef  VECT_TAB_RAM&#xA;&#xA;    NVIC_SetVectorTable(NVIC_VectTab_RAM, 0x0);&#xA;    #else&#xA;&#xA;    NVIC_SetVectorTable(NVIC_VectTab_FLASH, 0x0);&#xA;    #endif&#xA;    NVIC_PriorityGroupConfig(NVIC_PriorityGroup_0);&#xA;&#xA;    NVIC_InitStructure.NVIC_IRQChannel = TIM2_IRQn;&#xA;    NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;&#xA;&#xA;    NVIC_InitStructure.NVIC_IRQChannelSubPriority = 1;&#xA;    NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;&#xA;    NVIC_Init(&amp;amp;NVIC_InitStructure);&#xA;}&#xA;void RCC_Configuration(void)&#xA;{&#xA;    RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA , ENABLE );&#xA;    RCC_APB2PeriphClockCmd(RCC_APB2Periph_SPI1 , ENABLE);&#xA;    RCC_APB2PeriphClockCmd(RCC_APB2Periph_USART1 , ENABLE);&#xA;    RCC_APB1PeriphClockCmd(RCC_APB1Periph_USART2 , ENABLE);&#xA;}&#xA;void GPIO_Configuration(void)&#xA;{&#xA;    GPIO_InitTypeDef GPIO_InitStructure1,GPIO_InitStructure2;&#xA;    GPIO_InitTypeDef  GPIO_InitStructure3,GPIO_InitStructure4,GPIO_InitStructure5,GPIO_InitStructure6;&#xA;&#xA;    /* Configure USART1 Rx as input floating */&#xA;    GPIO_InitStructure1.GPIO_Pin =GPIO_Pin_10;&#xA;    GPIO_InitStructure1.GPIO_Speed = GPIO_Speed_50MHz;&#xA;    GPIO_InitStructure1.GPIO_Mode = GPIO_Mode_IN_FLOATING;&#xA;    GPIO_Init(GPIOA, &amp;amp;GPIO_InitStructure1);&#xA;&#xA;    /* Configure USART1 Tx as alternate function push-pull */&#xA;    GPIO_InitStructure2.GPIO_Pin =GPIO_Pin_9;&#xA;    GPIO_InitStructure2.GPIO_Speed = GPIO_Speed_50MHz;&#xA;    GPIO_InitStructure2.GPIO_Mode = GPIO_Mode_AF_PP;&#xA;    GPIO_Init(GPIOA, &amp;amp;GPIO_InitStructure2);&#xA;&#xA;    /* Configure USART2 Rx as input floating */&#xA;    GPIO_InitStructure3.GPIO_Pin =GPIO_Pin_3;&#xA;    GPIO_InitStructure3.GPIO_Speed = GPIO_Speed_50MHz;&#xA;    GPIO_InitStructure3.GPIO_Mode = GPIO_Mode_IN_FLOATING;&#xA;    GPIO_Init(GPIOA, &amp;amp;GPIO_InitStructure3);&#xA;&#xA;    /* Configure USART2 Tx as alternate function push-pull */&#xA;    GPIO_InitStructure4.GPIO_Pin =GPIO_Pin_2;&#xA;    GPIO_InitStructure4.GPIO_Speed = GPIO_Speed_50MHz;&#xA;    GPIO_InitStructure4.GPIO_Mode = GPIO_Mode_AF_PP;&#xA;    GPIO_Init(GPIOA, &amp;amp;GPIO_InitStructure4);&#xA;&#xA;    /* Configure USART2 Ck as alternate function push-pull */&#xA;    GPIO_InitStructure5.GPIO_Pin = GPIO_Pin_4;&#xA;    GPIO_InitStructure5.GPIO_Mode = GPIO_Mode_AF_PP;&#xA;    GPIO_InitStructure5.GPIO_Speed = GPIO_Speed_50MHz;&#xA;    GPIO_Init(GPIOA, &amp;amp;GPIO_InitStructure5);&#xA;&#xA;    /* Configure SPI1 pins: SCK, MISO and MOSI */&#xA;    GPIO_InitStructure6.GPIO_Pin = GPIO_Pin_5 | GPIO_Pin_6 | GPIO_Pin_7;&#xA;    GPIO_Init(GPIOA, &amp;amp;GPIO_InitStructure6);&#xA;&#xA;}&#xA;void USART_Configuration(void)&#xA;{&#xA;    USART_InitTypeDef USART_InitStructure1,USART_InitStructure2;&#xA;    USART_ClockInitTypeDef USART_ClkInitStructure;&#xA;&#xA;    USART_InitStructure1.USART_BaudRate = 115200;&#xA;    USART_InitStructure1.USART_WordLength =USART_WordLength_8b ;&#xA;    USART_InitStructure1.USART_StopBits = USART_StopBits_1;&#xA;    USART_InitStructure1.USART_Parity = USART_Parity_No;&#xA;    USART_InitStructure1.USART_HardwareFlowControl = USART_HardwareFlowControl_None;&#xA;    USART_InitStructure1.USART_Mode = USART_Mode_Rx | USART_Mode_Tx;&#xA;&#xA;    /* Configure USART1 */&#xA;    USART_Init(USART1,&amp;amp;USART_InitStructure1);&#xA;&#xA;    //USART_ITConfig(USART1,USART_IT_RXNE,ENABLE);&#xA;    /* Enable the USART1 */&#xA;    USART_Cmd(USART1,ENABLE);&#xA;&#xA;    USART_ClkInitStructure.USART_Clock=USART_Clock_Enable;&#xA;    USART_ClkInitStructure.USART_CPOL=USART_CPOL_High;&#xA;    USART_ClkInitStructure.USART_CPHA=USART_CPHA_2Edge;&#xA;    USART_ClkInitStructure.USART_LastBit=USART_LastBit_Enable;&#xA;    USART_ClockInit(USART2, &amp;amp;USART_ClkInitStructure);&#xA;&#xA;    USART_InitStructure2.USART_BaudRate = 115200;&#xA;    USART_InitStructure2.USART_WordLength =USART_WordLength_8b ;&#xA;    USART_InitStructure2.USART_StopBits = USART_StopBits_1;&#xA;    USART_InitStructure2.USART_Parity = USART_Parity_No;&#xA;    USART_InitStructure2.USART_HardwareFlowControl = USART_HardwareFlowControl_None;&#xA;    USART_InitStructure2.USART_Mode = USART_Mode_Rx | USART_Mode_Tx;&#xA;&#xA;    /* Configure USART2 */&#xA;    USART_Init(USART2,&amp;amp;USART_InitStructure2);&#xA;&#xA;    //USART_ITConfig(USART2,USART_IT_RXNE,ENABLE);&#xA;    /* Enable the USART2 */&#xA;    USART_Cmd(USART2,ENABLE);&#xA;}&#xA;void SPI_Configuration(void)&#xA;{&#xA;    SPI_InitTypeDef SPI_InitStructure;&#xA;&#xA;    SPI_StructInit(&amp;amp;SPI_InitStructure);&#xA;&#xA;    SPI_I2S_DeInit(SPI1);&#xA;&#xA;    /* SPIy Config */&#xA;    SPI_InitStructure.SPI_Direction = SPI_Direction_2Lines_FullDuplex;&#xA;    SPI_InitStructure.SPI_Mode = SPI_Mode_Slave;&#xA;    SPI_InitStructure.SPI_DataSize = SPI_DataSize_8b;&#xA;    SPI_InitStructure.SPI_CPOL = SPI_CPOL_High;&#xA;    SPI_InitStructure.SPI_CPHA = SPI_CPHA_2Edge;&#xA;    SPI_InitStructure.SPI_NSS = SPI_NSS_Soft;&#xA;    SPI_InitStructure.SPI_FirstBit = SPI_FirstBit_LSB;&#xA;&#xA;    /* Configure SPIy */&#xA;    SPI_Init(SPI1, &amp;amp;SPI_InitStructure);&#xA;&#xA;    SPI_I2S_ITConfig(SPI1,SPI_I2S_IT_RXNE,ENABLE);&#xA;    /* SPIy enable */&#xA;    SPI_Cmd(SPI1, ENABLE);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3781961" LastEditorUserId="786356" LastEditDate="2014-07-23T18:35:20.243" LastActivityDate="2014-07-23T18:35:20.243" Title="synchronous mode of usart(spi mode) in stm32" Tags="&lt;c&gt;&lt;synchronous&gt;&lt;stm32&gt;&lt;spi&gt;&lt;usart&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="24874273" PostTypeId="1" AcceptedAnswerId="24874668" CreationDate="2014-07-21T20:37:42.023" Score="1" ViewCount="109" Body="&lt;p&gt;I am wondering if there are pre-processor directives in fortran that is similar to C's &lt;code&gt;#ifdef ... #endif&lt;/code&gt;?&lt;/p&gt;&#xA;" OwnerUserId="1260682" LastActivityDate="2014-07-21T21:07:14.877" Title="are there pre-processor directives in fortran like those in C?" Tags="&lt;fortran&gt;&lt;fortran90&gt;&lt;preprocessor-directive&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="25224541" PostTypeId="1" AcceptedAnswerId="25291859" CreationDate="2014-08-10T00:56:30.633" Score="2" ViewCount="4704" Body="&lt;p&gt;Hey there StackOverflow!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My question concerns errors being reporting within the program pasted (far) below. The target device is the &lt;strong&gt;PIC12LF1552&lt;/strong&gt;, it has one serial peripheral on it that I assumed could be used in conjunction with the library supplied with Microchip's XC8 compiler. Some sources on the internet have said that only higher end devices in the PIC18 line would support the library functions, other sources have said the library functions work just fine. So I decided that I didn't want to rewrite the I2C functions from scratch, nor did I want to write any amount of assembly for this project. Thus I settled on using the provided peripheral library that comes with XC8. I read up on the compiler documentation for how to source them (as seen in &lt;code&gt;i2c.h&lt;/code&gt; below). I know theres some error checking to do on those commands as per the documentation and some examples I've seen, but for the time being I'm assuming that both the master and the slave will behave perfectly just so I can get this thing off the ground.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have included all relevant paths, which is why I assume it gets this far in the compilation process. My level of knowledge when it comes to the inner workings of a C language and compiler is very limited, I only know how to use these tools at a basic level, so there might be something fundamental I'm missing here.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Anyways, when I compile this code in MPLABX v1.95, I get this:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;:0: error: undefined symbols:&#xA;        _AckI2C(dist/pickit3/production\strobe.X.production.obj) _ReadI2C(dist/pickit3/production\strobe.X.production.obj) _IdleI2C(dist/pickit3/production\strobe.X.production.obj) _OpenI2C(dist/pickit3/production\strobe.X.production.obj) _StopI2C(dist/pickit3/production\strobe.X.production.obj) _NotAckI2C(dist/pickit3/production\strobe.X.production.obj) _WriteI2C(dist/pickit3/production\strobe.X.production.obj) _StartI2C(dist/pickit3/production\strobe.X.production.obj)&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I couldn't find anything relevant on Google, StackOverflow, or otherwise concerning this problem from my specific context (another guy had a very similar issue when porting from Microchip's legacy C18 compiler, but I already did everything that guy did to solve his problem).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;So I guess, the question is, why am I getting this compiler error, and what is the mechanism behind it in the C language or Microchip's implementation of it that is causing this?&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* &#xA; * File:   i2c.h&#xA; * Author: James&#xA; *&#xA; * Created on July 23, 2014, 9:02 PM&#xA; */&#xA;&#xA;#ifndef I2C_H&#xA;#define I2C_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#include &amp;lt;plib\pconfig.h&amp;gt;&#xA;#include &amp;lt;plib\i2c.h&amp;gt;&#xA;&#xA;#define SLAVE_ADDRESS 0b11110000&#xA;&#xA;void Connect();&#xA;void Disconnect();&#xA;void Read(unsigned char address, unsigned char * data, unsigned char length);&#xA;void Write(unsigned char address, unsigned char * data, unsigned char length);&#xA;&#xA;#endif  /* I2C_H */&#xA;&#xA;&#xA;#include &quot;i2c.h&quot;&#xA;&#xA;void Connect()&#xA;{&#xA;    OpenI2C(MASTER, SLEW_OFF);&#xA;}&#xA;&#xA;void Disconnect()&#xA;{&#xA;    CloseI2C();&#xA;}&#xA;&#xA;void Read(unsigned char address, unsigned char * data, unsigned char length)&#xA;{&#xA;    IdleI2C();                                          // Wait until the bus is idle&#xA;    StartI2C();                                         // Send START condition&#xA;    IdleI2C();                                          // Wait for the end of the START condition&#xA;    if (WriteI2C(SLAVE_ADDRESS | 0x01)) return;         // Send slave address with R/W cleared for write&#xA;    IdleI2C();                                          // Wait for ACK&#xA;    if (WriteI2C(address)) return;                      // Send register address&#xA;    IdleI2C();                                          // Wait for ACK&#xA;    for(int i = 0; i &amp;lt; length; i++)&#xA;    {&#xA;        data[i] = ReadI2C();                            // Write nth byte of data&#xA;        AckI2C();                                       // Wait for ACK&#xA;    }&#xA;    NotAckI2C();                                        // Send NACK&#xA;    StopI2C();                                          // Hang up, send STOP condition&#xA;}&#xA;&#xA;void Write(unsigned char address, unsigned char * data, unsigned char length)&#xA;{&#xA;    IdleI2C();                                          // Wait until the bus is idle&#xA;    StartI2C();                                         // Send START condition&#xA;    IdleI2C();                                          // Wait for the end of the START condition&#xA;    if (WriteI2C(SLAVE_ADDRESS | 0x01)) return;         // Send slave address with R/W cleared for write&#xA;    IdleI2C();                                          // Wait for ACK&#xA;    if (WriteI2C(address)) return;                      // Send register address&#xA;    IdleI2C();                                          // Wait for ACK&#xA;    for(int i = 0; i &amp;lt; length; i++)&#xA;    {&#xA;        WriteI2C(data[i]);                              // Write nth byte of data&#xA;        IdleI2C();                                      // Wait for ACK&#xA;    }&#xA;    StopI2C();                                          // Hang up, send STOP condition&#xA;}&#xA;&#xA;/* &#xA; * File:   main.c&#xA; * Author: James&#xA; *&#xA; * Created on July 14, 2014, 11:00 PM&#xA; */&#xA;&#xA;/******************************************************************************/&#xA;/* Files to Include                                                           */&#xA;/******************************************************************************/&#xA;&#xA;#if defined(__XC)&#xA;    #include &amp;lt;xc.h&amp;gt;         /* XC8 General Include File */&#xA;#endif&#xA;&#xA;#include &amp;lt;stdint.h&amp;gt;        /* For uint8_t definition */&#xA;#include &amp;lt;stdbool.h&amp;gt;       /* For true/false definition */&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;pic12lf1552.h&amp;gt;&#xA;#include &quot;i2c.h&quot;&#xA;&#xA;/******************************************************************************/&#xA;/* Defines                                                                    */&#xA;/******************************************************************************/&#xA;&#xA;//#define SYS_FREQ        16000000L&#xA;//#define FCY             SYS_FREQ/4&#xA;#define _XTAL_FREQ      500000&#xA;&#xA;__CONFIG&#xA;(&#xA;    MCLRE_ON &amp;amp;&#xA;    CP_OFF &amp;amp;&#xA;    BOREN_OFF &amp;amp;&#xA;    WDTE_OFF &amp;amp;&#xA;    PWRTE_OFF &amp;amp;&#xA;    FOSC_INTOSC&#xA;);&#xA;&#xA;void main(void)&#xA;{&#xA;    ANSELA = 0;&#xA;    TRISA = 0b101111;&#xA;    OPTION_REG = 0b01111111;&#xA;    APFCONbits.SDSEL = 1;&#xA;&#xA;    unsigned char state = 0;&#xA;    unsigned char count = 0;&#xA;    unsigned char data[8] = { 0 };&#xA;&#xA;    Connect();&#xA;    Read&#xA;    (&#xA;        0x01, // System register&#xA;        data, // Data buffer&#xA;        0x01  // Read length&#xA;    );&#xA;    LATAbits.LATA4 = data[0];&#xA;&#xA;    while(1)&#xA;    {&#xA;        switch (state)&#xA;        {&#xA;            case 0: // IDLE/OFF&#xA;                if (LATAbits.LATA4) LATAbits.LATA4 = 0;&#xA;                break;&#xA;            case 1: // ON&#xA;                if (!LATAbits.LATA4) LATAbits.LATA4 = 1;&#xA;                break;&#xA;            case 2: // BLINK (slow)&#xA;                LATAbits.LATA4 = !LATAbits.LATA4;&#xA;                __delay_ms(100);&#xA;                break;&#xA;            case 3: // BLINK (fast)&#xA;                LATAbits.LATA4 = !LATAbits.LATA4;&#xA;                __delay_ms(50);&#xA;                break;&#xA;            case 4: // BEAT DETECT&#xA;                LATAbits.LATA4 = PORTAbits.RA5;&#xA;                break;&#xA;            default:&#xA;                state = 0;&#xA;                break;&#xA;        }&#xA;&#xA;        if (TMR0 &amp;gt; 0)&#xA;        {&#xA;            while (count &amp;lt; 20)&#xA;            {&#xA;                if (!PORTAbits.RA2) count = 0;&#xA;                __delay_ms(10);&#xA;                count++;&#xA;            }&#xA;            TMR0 = 0;&#xA;            state++;&#xA;        }&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3381770" LastActivityDate="2014-10-05T17:02:04.987" Title="Receiving &quot;undefined symbols&quot; error with XC8 concerning plib I2C functions" Tags="&lt;c&gt;&lt;pic&gt;&lt;microchip&gt;&lt;mplab&gt;&lt;xc8&gt;" AnswerCount="2" CommentCount="7" />
  <row Id="25254614" PostTypeId="1" CreationDate="2014-08-12T00:53:35.893" Score="1" ViewCount="564" Body="&lt;p&gt;I'm trying to learn how to do threaded gl with Qt for the purpose of offloading a lot of QPainter draws in a separate thread.  I have a QGLWidget in the main gui thread drawing some lines from a vbo and displaying a texture.  In the QGLWidget's initializeGL() function, I create a QOffscreenSurface, QOpenGLContext and a QThread and then move the QOpenGLContext to the new QThread.  The GLWidget's context and the QOpenGLContext are set as sharing.  The QThread is started, it creates a QGLFramebufferObject as a paint device for a QPainter.  When the QPainter is finished, the threat emits a signal to the QGLWidget to redraw with the finished texture from the fbo.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;On the nvidia open source nouveau driver on Kubuntu 14.04 machine, if many draws are made, the program seg faults and can puke out video driver stuff. If few draws are made using the QPainter, all is well.  Seems fine on a Nexus 4, Kubuntu 14.04 Intel 2nd Generation Core and Intel 82945G/GZ Kubuntu 14.04.  I suspect the nouveau is just less tolerance of my unknown mistake?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;nouveau: kernel rejected pushbuf: Invalid argument&#xA;nouveau: ch0: krec 0 pushes 3 bufs 12 relocs 0&#xA;nouveau: ch0: buf 00000000 00000002 00000004 00000004 00000000&amp;lt;\br&amp;gt;&#xA;nouveau: ch0: buf 00000001 00000013 00000002 00000000 00000002&#xA;nouveau: ch0: buf 00000002 00000016 00000002 00000002 00000000&#xA;nouveau: ch0: buf 00000003 00000007 00000002 00000002 00000000&#xA;nouveau: ch0: buf 00000004 0000000a 00000002 00000002 00000000&#xA;nouveau: ch0: buf 00000005 0000000b 00000002 00000002 00000000&#xA;nouveau: ch0: buf 00000006 00000008 00000002 00000002 00000000&#xA;nouveau: ch0: buf 00000007 00000006 00000004 00000000 00000004&#xA;nouveau: ch0: buf 00000008 00000003 00000004 00000004 00000000&#xA;nouveau: ch0: buf 00000009 0000000e 00000002 00000002 00000000&#xA;nouveau: ch0: buf 0000000a 00000017 00000002 00000000 00000002&#xA;nouveau: ch0: buf 0000000b 00000018 00000002 00000000 00000002&#xA;Segmentation fault (core dumped)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;test.pro&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;QT += core gui widgets opengl&#xA;&#xA;TARGET = test&#xA;TEMPLATE = app&#xA;&#xA;SOURCES = main.cpp textThread.cpp&#xA;HEADERS = main.h textThread.h&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;main.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;QGLWidget&amp;gt;&#xA;#include &amp;lt;QGLFunctions&amp;gt;&#xA;#include &amp;lt;QGLShader&amp;gt;&#xA;#include &amp;lt;QTimer&amp;gt;&#xA;#include &quot;textThread.h&quot;&#xA;&#xA;class glview : public QGLWidget, protected QGLFunctions&#xA;{&#xA;    Q_OBJECT&#xA;&#xA;public:&#xA;    explicit glview(QWidget *parent = 0);&#xA;    ~glview();&#xA;    QSize sizeHint() const;&#xA;&#xA;protected:&#xA;    void initializeGL();&#xA;    void resizeGL(int w, int h);&#xA;    void paintGL();&#xA;&#xA;private:&#xA;    QTimer repaintTimer;&#xA;    QGLShaderProgram *program, *txtovlp;&#xA;    textThread *maketext;&#xA;    quint32 vbo_id[2];&#xA;&#xA;private slots:&#xA;    void repaint(void);&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;main.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;QApplication&amp;gt;&#xA;#include &quot;main.h&quot;&#xA;&#xA;struct vrtx {&#xA;    GLfloat x;&#xA;    GLfloat y;&#xA;    GLfloat z;&#xA;    GLfloat r;&#xA;    GLfloat g;&#xA;    GLfloat b;&#xA;}__attribute__((packed)) line_geo[] = {&#xA;//   x, y, z, r, g, b&#xA;    {1, 1, 0, 1, 0, 0},&#xA;    {1, 2, 0, 0, 1, 0},&#xA;    {1, 2, 0, 0, 1, 0},&#xA;    {2, 2, 0, 1, 0, 0},&#xA;    {2, 2, 0, 1, 0, 0},&#xA;    {2, 1, 0, 0, 1, 0},&#xA;    {2, 1, 0, 0, 1, 0},&#xA;    {1, 1, 0, 1, 0, 0},&#xA;};&#xA;&#xA;struct txtr_vrtx {&#xA;    GLfloat   x;&#xA;    GLfloat   y;&#xA;    GLfloat   z;&#xA;    GLfloat   tx;&#xA;    GLfloat   ty;&#xA;}__attribute__((packed)) txtr_geo[] = {&#xA;//   x, y, z, tx,ty&#xA;    {3, 1, 0, 0, 0},&#xA;    {3, 2, 0, 0, 1},&#xA;    {4, 2, 0, 1, 1},&#xA;    {4, 1, 0, 1, 0},&#xA;};&#xA;&#xA;glview::glview(QWidget *parent) : QGLWidget(parent)&#xA;{&#xA;    connect(&amp;amp;repaintTimer, SIGNAL(timeout()), this, SLOT(repaint()));&#xA;    repaintTimer.start(20);&#xA;}&#xA;&#xA;glview::~glview()&#xA;{&#xA;    delete maketext-&amp;gt;context;&#xA;    delete maketext-&amp;gt;offscrnsf;&#xA;    delete maketext;&#xA;    delete program;&#xA;    delete txtovlp;&#xA;}&#xA;&#xA;QSize glview::sizeHint() const&#xA;{&#xA;    return QSize(500, 300);&#xA;}&#xA;&#xA;void glview::initializeGL()&#xA;{&#xA;    initializeGLFunctions();&#xA;    qglClearColor(Qt::white);&#xA;&#xA;    QGLShader *vshader = new QGLShader(QGLShader::Vertex, this);&#xA;    const char *vsrc =&#xA;        &quot;attribute highp vec4 vertex;\n&quot;&#xA;        &quot;attribute mediump vec4 colour;\n&quot;&#xA;        &quot;varying mediump vec4 f_colour;\n&quot;&#xA;        &quot;uniform mediump mat4 matrix;\n&quot;&#xA;        &quot;void main(void)\n&quot;&#xA;        &quot;{\n&quot;&#xA;        &quot;    gl_Position = matrix * vertex;\n&quot;&#xA;        &quot;    f_colour = colour;\n&quot;&#xA;        &quot;}\n&quot;;&#xA;    vshader-&amp;gt;compileSourceCode(vsrc);&#xA;&#xA;    QGLShader *fshader = new QGLShader(QGLShader::Fragment, this);&#xA;    const char *fsrc =&#xA;        &quot;varying mediump vec4 f_colour;\n&quot;&#xA;        &quot;void main(void)\n&quot;&#xA;        &quot;{\n&quot;&#xA;        &quot;    gl_FragColor = f_colour;\n&quot;&#xA;        &quot;}\n&quot;;&#xA;    fshader-&amp;gt;compileSourceCode(fsrc);&#xA;&#xA;    program = new QGLShaderProgram(this);&#xA;    program-&amp;gt;addShader(vshader);&#xA;    program-&amp;gt;addShader(fshader);&#xA;    program-&amp;gt;link();&#xA;&#xA;    QGLShader *txtovlp_vshader = new QGLShader(QGLShader::Vertex, this);&#xA;    const char *txtovlp_vsrc =&#xA;        &quot;attribute highp vec4 vertex;\n&quot;&#xA;        &quot;attribute mediump vec2 texCoord;\n&quot;&#xA;        &quot;varying mediump vec2 texc;\n&quot;&#xA;        &quot;uniform mediump mat4 matrix;\n&quot;&#xA;        &quot;void main(void)\n&quot;&#xA;        &quot;{\n&quot;&#xA;        &quot;    gl_Position = matrix * vertex;\n&quot;&#xA;        &quot;    texc = texCoord;\n&quot;&#xA;        &quot;}\n&quot;;&#xA;    txtovlp_vshader-&amp;gt;compileSourceCode(txtovlp_vsrc);&#xA;&#xA;    QGLShader *txtovlp_fshader = new QGLShader(QGLShader::Fragment, this);&#xA;    const char *txtovlp_fsrc =&#xA;        &quot;uniform sampler2D texture;\n&quot;&#xA;        &quot;varying mediump vec2 texc;\n&quot;&#xA;        &quot;void main(void)\n&quot;&#xA;        &quot;{\n&quot;&#xA;        &quot;    gl_FragColor = texture2D(texture, texc.st);\n&quot;&#xA;        &quot;}\n&quot;;&#xA;    txtovlp_fshader-&amp;gt;compileSourceCode(txtovlp_fsrc);&#xA;&#xA;    txtovlp = new QGLShaderProgram(this);&#xA;    txtovlp-&amp;gt;addShader(txtovlp_vshader);&#xA;    txtovlp-&amp;gt;addShader(txtovlp_fshader);&#xA;    txtovlp-&amp;gt;link();&#xA;&#xA;    glGenBuffers(2, vbo_id);&#xA;    glBindBuffer(GL_ARRAY_BUFFER, vbo_id[0]);&#xA;    glBufferData(GL_ARRAY_BUFFER, sizeof(line_geo), line_geo, GL_STATIC_DRAW);&#xA;&#xA;    glBindBuffer(GL_ARRAY_BUFFER, vbo_id[1]);&#xA;    glBufferData(GL_ARRAY_BUFFER, sizeof(txtr_geo), txtr_geo, GL_STATIC_DRAW);&#xA;&#xA;    glEnable(GL_DEPTH_TEST);&#xA;    doneCurrent();&#xA;&#xA;    maketext = new textThread;&#xA;    maketext-&amp;gt;offscrnsf = new QOffscreenSurface();&#xA;    maketext-&amp;gt;offscrnsf-&amp;gt;create();&#xA;    if (!maketext-&amp;gt;offscrnsf-&amp;gt;isValid()) {&#xA;        qDebug() &amp;lt;&amp;lt; &quot;Surface Failed&quot;;&#xA;        exit(1);&#xA;    }&#xA;&#xA;    maketext-&amp;gt;context = new QOpenGLContext();&#xA;    maketext-&amp;gt;context-&amp;gt;setShareContext(this-&amp;gt;context()-&amp;gt;contextHandle());&#xA;    maketext-&amp;gt;context-&amp;gt;create();&#xA;    if (!maketext-&amp;gt;context-&amp;gt;isValid()) {&#xA;        qDebug() &amp;lt;&amp;lt; &quot;Context Failed&quot;;&#xA;        exit(1);&#xA;    }&#xA;    if (!maketext-&amp;gt;context-&amp;gt;areSharing(this-&amp;gt;context()-&amp;gt;contextHandle(), maketext-&amp;gt;context)) {&#xA;        qDebug() &amp;lt;&amp;lt; &quot;Sharing Failed&quot;;&#xA;        exit(1);&#xA;    }&#xA;    maketext-&amp;gt;context-&amp;gt;moveToThread(maketext);&#xA;&#xA;    //connect(maketext, SIGNAL(finished()), this, SLOT(repaint()));&#xA;    connect(maketext, SIGNAL(finished()), this, SLOT(repaint()), Qt::QueuedConnection);&#xA;    maketext-&amp;gt;start();&#xA;}&#xA;&#xA;void glview::resizeGL(int w, int h)&#xA;{&#xA;    makeCurrent();&#xA;    glViewport(0, 0, w, h);&#xA;}&#xA;&#xA;void glview::repaint(void)&#xA;{&#xA;    repaintTimer.start(20);&#xA;    updateGL();&#xA;}&#xA;&#xA;void glview::paintGL()&#xA;{&#xA;    static quint32 i;&#xA;&#xA;    i++;&#xA;&#xA;    printf(&quot;Pa&quot;);&#xA;    makeCurrent();&#xA;    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);&#xA;&#xA;    QMatrix4x4 matrix;&#xA;    matrix.ortho(0, 5, 0, 3, -1, 1);&#xA;&#xA;    program-&amp;gt;bind();&#xA;    program-&amp;gt;setUniformValue(&quot;matrix&quot;, matrix);&#xA;&#xA;    glBindBuffer(GL_ARRAY_BUFFER, vbo_id[0]);&#xA;    int vertexLocation = program-&amp;gt;attributeLocation(&quot;vertex&quot;);&#xA;    program-&amp;gt;enableAttributeArray(vertexLocation);&#xA;    glVertexAttribPointer(vertexLocation, 3, GL_FLOAT, GL_FALSE, sizeof(struct vrtx), 0);&#xA;&#xA;    int colourLocation = program-&amp;gt;attributeLocation(&quot;colour&quot;);&#xA;    program-&amp;gt;enableAttributeArray(colourLocation);&#xA;    glVertexAttribPointer(colourLocation, 3, GL_FLOAT, GL_FALSE, sizeof(struct vrtx), ((char*)NULL + 12));&#xA;&#xA;    glDrawArrays(GL_LINES, 0, sizeof(line_geo) / sizeof(struct vrtx));&#xA;&#xA;    txtovlp-&amp;gt;bind();&#xA;    txtovlp-&amp;gt;setUniformValue(&quot;matrix&quot;, matrix);&#xA;&#xA;    maketext-&amp;gt;textLock.lock();&#xA;    if (maketext-&amp;gt;done) {&#xA;        maketext-&amp;gt;textLock.unlock();&#xA;        //qDebug() &amp;lt;&amp;lt; &quot;Painting with text&quot; &amp;lt;&amp;lt; i;&#xA;        glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);&#xA;        glEnable(GL_BLEND);&#xA;        glEnable(GL_TEXTURE_2D);&#xA;&#xA;        glBindBuffer(GL_ARRAY_BUFFER, vbo_id[1]);&#xA;        glBindTexture(GL_TEXTURE_2D, maketext-&amp;gt;texture_id);&#xA;&#xA;        int txtr_vertexLocation = txtovlp-&amp;gt;attributeLocation(&quot;vertex&quot;);&#xA;        txtovlp-&amp;gt;enableAttributeArray(txtr_vertexLocation);&#xA;        glVertexAttribPointer(txtr_vertexLocation, 3, GL_FLOAT, GL_FALSE, sizeof(struct txtr_vrtx), 0);&#xA;&#xA;        int texCoordLocation = txtovlp-&amp;gt;attributeLocation(&quot;texCoord&quot;);&#xA;        txtovlp-&amp;gt;enableAttributeArray(texCoordLocation);&#xA;        glVertexAttribPointer(texCoordLocation, 2, GL_FLOAT, GL_FALSE, sizeof(struct txtr_vrtx), ((char*)NULL + 12));&#xA;&#xA;        glDrawArrays(GL_TRIANGLE_FAN, 0, 4);&#xA;&#xA;        glDisable(GL_TEXTURE_2D);&#xA;        glDisable(GL_BLEND);&#xA;    }&#xA;    else {&#xA;        maketext-&amp;gt;textLock.unlock();&#xA;        //qDebug() &amp;lt;&amp;lt; &quot;Painting&quot; &amp;lt;&amp;lt; i;&#xA;    }&#xA;&#xA;    glFlush();&#xA;    printf(&quot;int\n&quot;);&#xA;}&#xA;&#xA;int main(int argc, char *argv[])&#xA;{&#xA;    QCoreApplication::setAttribute(Qt::AA_X11InitThreads);&#xA;    QApplication app(argc, argv);&#xA;    glview widget;&#xA;    widget.show();&#xA;    return app.exec();&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;textThread.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef textThread_h&#xA;#define textThread_h&#xA;&#xA;#include &amp;lt;QThread&amp;gt;&#xA;#include &amp;lt;QMutex&amp;gt;&#xA;#include &amp;lt;QOpenGLContext&amp;gt;&#xA;#include &amp;lt;QOffscreenSurface&amp;gt;&#xA;#include &amp;lt;QGLFramebufferObject&amp;gt;&#xA;#include &amp;lt;QFont&amp;gt;&#xA;#include &amp;lt;QDebug&amp;gt;&#xA;&#xA;class textThread : public QThread&#xA;{&#xA;    Q_OBJECT&#xA;&#xA;public:&#xA;    textThread();&#xA;    ~textThread();&#xA;    QMutex textLock;&#xA;    QOffscreenSurface *offscrnsf;&#xA;    QOpenGLContext *context;&#xA;    bool done;&#xA;    quint32 texture_id;&#xA;&#xA;signals:&#xA;    void finished(void);&#xA;&#xA;protected:&#xA;    void run();&#xA;&#xA;private:&#xA;    QGLFramebufferObject *fbo;&#xA;    QFont font;&#xA;};&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;textThread.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;QPainter&amp;gt;&#xA;#include &quot;textThread.h&quot;&#xA;&#xA;#define QPAINT_A_LOT&#xA;&#xA;textThread::textThread()&#xA;{&#xA;    done = 0;&#xA;    fbo = NULL;&#xA;    font.setFamily(&quot;Helvetica&quot;);&#xA;}&#xA;&#xA;textThread::~textThread()&#xA;{&#xA;    delete fbo;&#xA;}&#xA;&#xA;void textThread::run()&#xA;{&#xA;    context-&amp;gt;makeCurrent(offscrnsf);&#xA;    qDebug() &amp;lt;&amp;lt; &quot;Thread&quot;;&#xA;&#xA;    if (!fbo)&#xA;        fbo = new QGLFramebufferObject(100, 100, GL_TEXTURE_2D);&#xA;    fbo-&amp;gt;bind();&#xA;    texture_id = fbo-&amp;gt;texture();&#xA;&#xA;    QPainter painter(fbo);&#xA;    font.setPointSize(20);&#xA;    painter.setFont(font);&#xA;    painter.eraseRect(0,0,100,100);&#xA;    painter.setPen(Qt::blue);&#xA;#ifdef  QPAINT_A_LOT&#xA;    quint32 i;&#xA;    for (i=0; i&amp;lt;140000; i++) {&#xA;        //if (!(i%32768))&#xA;        if (!(i%1024))&#xA;            qDebug() &amp;lt;&amp;lt; i;&#xA;        painter.drawText(0, 60, &quot;FBO&quot;);&#xA;    }&#xA;#else&#xA;    painter.drawText(0, 60, &quot;FBO&quot;);&#xA;    sleep(1);&#xA;#endif&#xA;    painter.end();&#xA;    fbo-&amp;gt;release();&#xA;&#xA;    context-&amp;gt;doneCurrent();&#xA;    textLock.lock();&#xA;    done = 1;&#xA;    textLock.unlock();&#xA;    emit finished();&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="2757704" LastEditorUserId="2757704" LastEditDate="2014-08-26T00:05:07.337" LastActivityDate="2014-08-26T00:13:53.577" Title="QPainter with shared QOpenGLContext in QThread - seg faulting on nouveau" Tags="&lt;multithreading&gt;&lt;qt&gt;&lt;opengl&gt;&lt;qt5&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="25354448" PostTypeId="1" AcceptedAnswerId="25354621" CreationDate="2014-08-17T23:04:42.503" Score="0" ViewCount="128" Body="&lt;p&gt;Simple problem this time, but one I'm not seeing on searches: I have a list view control with state images that should show up in one column. In wine, Windows Vista, Windows 7, and Windows 8.1, things look correct. But in Windows XP, the state images don't show up, showing only white space where the image should be. Common Controls version 6 required. What am I doing wrong?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is a sample program that demonstrates this.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// 17 august 2014&#xA;// scratch Windows program by pietro gagliardi 17 april 2014&#xA;// fixed typos and added toWideString() 1 may 2014&#xA;// borrows code from the scratch GTK+ program (16-17 april 2014) and from code written 31 march 2014 and 11-12 april 2014&#xA;#define _UNICODE&#xA;#define UNICODE&#xA;#define STRICT&#xA;#define _GNU_SOURCE     // needed to declare asprintf()/vasprintf()&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#include &amp;lt;stdarg.h&amp;gt;&#xA;#include &amp;lt;windows.h&amp;gt;&#xA;#include &amp;lt;commctrl.h&amp;gt;       // needed for InitCommonControlsEx() (thanks Xeek in irc.freenode.net/#winapi for confirming)&#xA;&#xA;#ifdef  _MSC_VER&#xA;#error sorry! the scratch windows program relies on mingw-only functionality! (specifically: asprintf())&#xA;#endif&#xA;&#xA;HMODULE hInstance;&#xA;HICON hDefaultIcon;&#xA;HCURSOR hDefaultCursor;&#xA;HFONT controlfont;&#xA;&#xA;void panic(char *fmt, ...);&#xA;TCHAR *toWideString(char *what);&#xA;void init(void);&#xA;&#xA;LRESULT CALLBACK wndproc(HWND hwnd, UINT msg, WPARAM wparam, LPARAM lparam)&#xA;{&#xA;    NMHDR *nmhdr = (NMHDR *) lparam;&#xA;    NMLVDISPINFOW *fill = (NMLVDISPINFO *) lparam;&#xA;&#xA;    switch (msg) {&#xA;    case WM_NOTIFY:&#xA;        if (nmhdr-&amp;gt;code == LVN_GETDISPINFO) {&#xA;            if (fill-&amp;gt;item.iSubItem == 0) {&#xA;                fill-&amp;gt;item.state = INDEXTOSTATEIMAGEMASK(fill-&amp;gt;item.iItem + 1);&#xA;                fill-&amp;gt;item.stateMask = LVIS_STATEIMAGEMASK;&#xA;            } else&#xA;                fill-&amp;gt;item.pszText = L&quot;No State Image Here&quot;;&#xA;            return 0;&#xA;        }&#xA;        return DefWindowProc(hwnd, msg, wparam, lparam);&#xA;    case WM_CLOSE:&#xA;        PostQuitMessage(0);&#xA;        return 0;&#xA;    default:&#xA;        return DefWindowProc(hwnd, msg, wparam, lparam);&#xA;    }&#xA;    panic(&quot;oops: message %ud does not return anything; bug in wndproc()&quot;, msg);&#xA;}&#xA;&#xA;HWND makeMainWindow(void)&#xA;{&#xA;    WNDCLASS cls;&#xA;    HWND hwnd;&#xA;&#xA;    ZeroMemory(&amp;amp;cls, sizeof (WNDCLASS));&#xA;    cls.lpszClassName = L&quot;mainwin&quot;;&#xA;    cls.lpfnWndProc = wndproc;&#xA;    cls.hInstance = hInstance;&#xA;    cls.hIcon = hDefaultIcon;&#xA;    cls.hCursor = hDefaultCursor;&#xA;    cls.hbrBackground = (HBRUSH) (COLOR_BTNFACE + 1);&#xA;    if (RegisterClass(&amp;amp;cls) == 0)&#xA;        panic(&quot;error registering window class&quot;);&#xA;    hwnd = CreateWindowEx(0,&#xA;        L&quot;mainwin&quot;, L&quot;Main Window&quot;,&#xA;        WS_OVERLAPPEDWINDOW,&#xA;        CW_USEDEFAULT, CW_USEDEFAULT,&#xA;        300, 300,&#xA;        NULL, NULL, hInstance, NULL);&#xA;    if (hwnd == NULL)&#xA;        panic(&quot;opening main window failed&quot;);&#xA;    return hwnd;&#xA;}&#xA;&#xA;void buildUI(HWND mainwin)&#xA;{&#xA;#define CSTYLE (WS_CHILD | WS_VISIBLE)&#xA;#define CXSTYLE (0)&#xA;#define SETFONT(hwnd) SendMessage(hwnd, WM_SETFONT, (WPARAM) controlfont, (LPARAM) TRUE);&#xA;&#xA;    HWND lv;&#xA;    LVCOLUMN column;&#xA;    HIMAGELIST imglist;&#xA;&#xA;    lv = CreateWindowEx(WS_EX_CLIENTEDGE | CXSTYLE,&#xA;        WC_LISTVIEW, L&quot;&quot;,&#xA;        LVS_REPORT | LVS_OWNERDATA | LVS_NOSORTHEADER | LVS_SHOWSELALWAYS | WS_HSCROLL | WS_VSCROLL | WS_TABSTOP | CSTYLE,&#xA;        10, 10, 250, 250,&#xA;        mainwin, (HMENU) 100, hInstance, NULL);&#xA;    if (lv == NULL)&#xA;        panic(&quot;error making list view&quot;);&#xA;    SETFONT(lv);&#xA;    SendMessageW(lv, LVM_SETEXTENDEDLISTVIEWSTYLE,&#xA;        LVS_EX_FULLROWSELECT | LVS_EX_SUBITEMIMAGES,&#xA;        LVS_EX_FULLROWSELECT | LVS_EX_SUBITEMIMAGES);&#xA;&#xA;    // error checking elided from this point to where otherwise noted&#xA;&#xA;    imglist = ImageList_Create(&#xA;        GetSystemMetrics(SM_CXSMICON),&#xA;        GetSystemMetrics(SM_CYSMICON),&#xA;        ILC_COLOR32, 20, 20);&#xA;    ImageList_AddIcon(imglist, LoadIconW(NULL, IDI_ERROR));&#xA;    ImageList_AddIcon(imglist, LoadIconW(NULL, IDI_QUESTION));&#xA;    ImageList_AddIcon(imglist, LoadIconW(NULL, IDI_WARNING));&#xA;    SendMessageW(lv, LVM_SETIMAGELIST, LVSIL_STATE, (LPARAM) imglist);&#xA;&#xA;    ZeroMemory(&amp;amp;column, sizeof (LVCOLUMN));&#xA;    column.mask = LVCF_FMT | LVCF_TEXT | LVCF_SUBITEM | LVCF_ORDER;&#xA;    column.fmt = LVCFMT_LEFT;&#xA;    column.pszText = L&quot;State Image&quot;;&#xA;    column.iSubItem = 0;&#xA;    column.iOrder = 0;&#xA;    SendMessageW(lv, LVM_INSERTCOLUMN, 0, (LPARAM) (&amp;amp;column));&#xA;    ZeroMemory(&amp;amp;column, sizeof (LVCOLUMN));&#xA;    column.mask = LVCF_FMT | LVCF_TEXT | LVCF_SUBITEM | LVCF_ORDER;&#xA;    column.fmt = LVCFMT_LEFT;&#xA;    column.pszText = L&quot;No State Image&quot;;&#xA;    column.iSubItem = 1;&#xA;    column.iOrder = 1;&#xA;    SendMessageW(lv, LVM_INSERTCOLUMN, 1, (LPARAM) (&amp;amp;column));&#xA;&#xA;    // end of error eliding&#xA;&#xA;    if (SendMessageW(lv, LVM_SETITEMCOUNT, 3, 0) == 0)&#xA;        panic(&quot;error setting number of items in list view&quot;);&#xA;}&#xA;&#xA;void firstShowWindow(HWND hwnd);&#xA;&#xA;int main(void)&#xA;{&#xA;    HWND mainwin;&#xA;    MSG msg;&#xA;&#xA;    init();&#xA;&#xA;    mainwin = makeMainWindow();&#xA;    buildUI(mainwin);&#xA;    firstShowWindow(mainwin);&#xA;&#xA;    for (;;) {&#xA;        BOOL gmret;&#xA;&#xA;        gmret = GetMessage(&amp;amp;msg, NULL, 0, 0);&#xA;        if (gmret == -1)&#xA;            panic(&quot;error getting message&quot;);&#xA;        if (gmret == 0)&#xA;            break;&#xA;        TranslateMessage(&amp;amp;msg);&#xA;        DispatchMessage(&amp;amp;msg);&#xA;    }&#xA;    return 0;&#xA;}&#xA;&#xA;DWORD iccFlags =&#xA;//  ICC_ANIMATE_CLASS |         // animation control&#xA;//  ICC_BAR_CLASSES |               // toolbar, statusbar, trackbar, tooltip&#xA;//  ICC_COOL_CLASSES |          // rebar&#xA;//  ICC_DATE_CLASSES |          // date and time picker&#xA;//  ICC_HOTKEY_CLASS |          // hot key&#xA;//  ICC_INTERNET_CLASSES |      // IP address entry field&#xA;//  ICC_LINK_CLASS |                // hyperlink&#xA;    ICC_LISTVIEW_CLASSES |          // list-view, header&#xA;//  ICC_NATIVEFNTCTL_CLASS |        // native font&#xA;//  ICC_PAGESCROLLER_CLASS |        // pager&#xA;//  ICC_PROGRESS_CLASS |            // progress bar&#xA;//  ICC_STANDARD_CLASSES |      // &quot;one of the intrinsic User32 control classes&quot;&#xA;//  ICC_TAB_CLASSES |               // tab, tooltip&#xA;//  ICC_TREEVIEW_CLASSES |      // tree-view, tooltip&#xA;//  ICC_UPDOWN_CLASS |          // up-down&#xA;//  ICC_USEREX_CLASSES |            // ComboBoxEx&#xA;//  ICC_WIN95_CLASSES |         // some of the above&#xA;    0;&#xA;&#xA;void init(void)&#xA;{&#xA;    INITCOMMONCONTROLSEX icc;&#xA;    NONCLIENTMETRICS ncm;&#xA;&#xA;    hInstance = GetModuleHandle(NULL);&#xA;    if (hInstance == NULL)&#xA;        panic(&quot;error getting hInstance&quot;);&#xA;    hDefaultIcon = LoadIcon(NULL, MAKEINTRESOURCE(IDI_APPLICATION));&#xA;    if (hDefaultIcon == NULL)&#xA;        panic(&quot;error getting default window class icon&quot;);&#xA;    hDefaultCursor = LoadCursor(NULL, MAKEINTRESOURCE(IDC_ARROW));&#xA;    if (hDefaultCursor == NULL)&#xA;        panic(&quot;error getting default window cursor&quot;);&#xA;    icc.dwSize = sizeof (INITCOMMONCONTROLSEX);&#xA;    icc.dwICC = iccFlags;&#xA;    if (InitCommonControlsEx(&amp;amp;icc) == FALSE)&#xA;        panic(&quot;error initializing Common Controls&quot;);&#xA;    ncm.cbSize = sizeof (NONCLIENTMETRICS);&#xA;    if (SystemParametersInfo(SPI_GETNONCLIENTMETRICS,&#xA;        sizeof (NONCLIENTMETRICS), &amp;amp;ncm, 0) == 0)&#xA;        panic(&quot;error getting non-client metrics for getting control font&quot;);&#xA;    controlfont = CreateFontIndirect(&amp;amp;ncm.lfMessageFont);&#xA;    if (controlfont == NULL)&#xA;        panic(&quot;error getting control font&quot;);&#xA;}&#xA;&#xA;void panic(char *fmt, ...)&#xA;{&#xA;    char *msg;&#xA;    TCHAR *lerrmsg;&#xA;    char *fullmsg;&#xA;    va_list arg;&#xA;    DWORD lasterr;&#xA;    DWORD lerrsuccess;&#xA;&#xA;    lasterr = GetLastError();&#xA;    va_start(arg, fmt);&#xA;    if (vasprintf(&amp;amp;msg, fmt, arg) == -1) {&#xA;        fprintf(stderr, &quot;critical error: vasprintf() failed in panic() preparing panic message; fmt = \&quot;%s\&quot;\n&quot;, fmt);&#xA;        abort();&#xA;    }&#xA;    // according to http://msdn.microsoft.com/en-us/library/windows/desktop/ms680582%28v=vs.85%29.aspx&#xA;    lerrsuccess = FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,&#xA;        NULL, lasterr,&#xA;        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),&#xA;        (LPTSTR) &amp;amp;lerrmsg, 0, NULL);&#xA;    if (lerrsuccess == 0) {&#xA;        fprintf(stderr, &quot;critical error: FormatMessage() failed in panic() preparing GetLastError() string; panic message = \&quot;%s\&quot;, last error in panic(): %ld, last error from FormatMessage(): %ld\n&quot;, msg, lasterr, GetLastError());&#xA;        abort();&#xA;    }&#xA;    // note to self: use %ws instead of %S (thanks jon_y in irc.oftc.net/#mingw-w64)&#xA;    if (asprintf(&amp;amp;fullmsg, &quot;panic: %s\nlast error: %ws\n&quot;, msg, lerrmsg) == -1) {&#xA;        fprintf(stderr, &quot;critical error: asprintf() failed in panic() preparing full report; panic message = \&quot;%s\&quot;, last error message: \&quot;%ws\&quot;\n&quot;, msg, lerrmsg);&#xA;        abort();&#xA;    }&#xA;    fprintf(stderr, &quot;%s\n&quot;, fullmsg);&#xA;    va_end(arg);&#xA;    exit(1);&#xA;}&#xA;&#xA;void firstShowWindow(HWND hwnd)&#xA;{&#xA;    // we need to get nCmdShow&#xA;    int nCmdShow;&#xA;    STARTUPINFO si;&#xA;&#xA;    nCmdShow = SW_SHOWDEFAULT;&#xA;    GetStartupInfo(&amp;amp;si);&#xA;    if ((si.dwFlags &amp;amp; STARTF_USESHOWWINDOW) != 0)&#xA;        nCmdShow = si.wShowWindow;&#xA;    ShowWindow(hwnd, nCmdShow);&#xA;    if (UpdateWindow(hwnd) == 0)&#xA;        panic(&quot;UpdateWindow(hwnd) failed in first show&quot;);&#xA;}&#xA;&#xA;TCHAR *toWideString(char *what)&#xA;{&#xA;    TCHAR *buf;&#xA;    int n;&#xA;    size_t len;&#xA;&#xA;    len = strlen(what);&#xA;    if (len == 0) {&#xA;        buf = (TCHAR *) malloc(sizeof (TCHAR));&#xA;        if (buf == NULL)&#xA;            goto mallocfail;&#xA;        buf[0] = L'\0';&#xA;    } else {&#xA;        n = MultiByteToWideChar(CP_UTF8, 0, what, -1, NULL, 0);&#xA;        if (n == 0)&#xA;            panic(&quot;error getting number of bytes to convert \&quot;%s\&quot; to UTF-16&quot;, what);&#xA;        buf = (TCHAR *) malloc((n + 1) * sizeof (TCHAR));&#xA;        if (buf == NULL)&#xA;            goto mallocfail;&#xA;        if (MultiByteToWideChar(CP_UTF8, 0, what, -1, buf, n) == 0)&#xA;            panic(&quot;erorr converting \&quot;%s\&quot; to UTF-16&quot;, what);&#xA;    }&#xA;    return buf;&#xA;mallocfail:&#xA;    panic(&quot;error allocating memory for UTF-16 version of \&quot;%s\&quot;&quot;, what);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3408572" LastEditorUserId="3408572" LastEditDate="2014-08-17T23:17:27.097" LastActivityDate="2014-08-17T23:33:58.007" Title="Why do my owner data list view state images come up as blank on Windows XP?" Tags="&lt;c&gt;&lt;listview&gt;&lt;winapi&gt;&lt;windows-xp&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="25462989" PostTypeId="1" AcceptedAnswerId="25466308" CreationDate="2014-08-23T14:30:27.017" Score="1" ViewCount="982" Body="&lt;p&gt;I have a custom window class intended as an editor view, and since I'm handling keyboard events directly, I want to have a standard edit control on top for entering text. My problem is simple: I also want to grab focus when the user clicks on the custom window class, so I handle &lt;code&gt;WM_MOUSEACTIVATE&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    case WM_MOUSEACTIVATE:&#xA;        SetFocus(hwnd);&#xA;        return MA_ACTIVATE;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But I also want the edit control to disappear when it loses focus:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    case WM_COMMAND:&#xA;        if (HIWORD(wparam) == EN_KILLFOCUS) {&#xA;            MessageBeep(-1);&#xA;            ShowWindow(edit, SW_HIDE);&#xA;            return 0;&#xA;        }&#xA;        return DefWindowProc(hwnd, msg, wparam, lparam);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Except that for some reason, the &lt;code&gt;WM_MOUSEACTIVATE&lt;/code&gt; handler fires when I click on the (visible) edit control; this causes it to lose and regain focus, but not before I hide the edit control!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The complete test program is below; if you click anywhere in the window's client area, you'll see the edit control. Click it once to give it focus, then click it again. You should hear a beep, followed by the edit control disappearing. Common Controls 6 required.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This also happens if I subclass the edit control and handle &lt;code&gt;WM_KILLFOCUS&lt;/code&gt; there. (This was what I originally had.)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What's going on? Thanks.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// 22-23 august 2014&#xA;// edited from wineditoverlaytest 22 august 2014&#xA;// scratch Windows program by pietro gagliardi 17 april 2014&#xA;// fixed typos and added toWideString() 1 may 2014&#xA;// borrows code from the scratch GTK+ program (16-17 april 2014) and from code written 31 march 2014 and 11-12 april 2014&#xA;#define _UNICODE&#xA;#define UNICODE&#xA;#define STRICT&#xA;#define _GNU_SOURCE     // needed to declare asprintf()/vasprintf()&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#include &amp;lt;stdarg.h&amp;gt;&#xA;#include &amp;lt;windows.h&amp;gt;&#xA;#include &amp;lt;commctrl.h&amp;gt;       // needed for InitCommonControlsEx() (thanks Xeek in irc.freenode.net/#winapi for confirming)&#xA;#include &amp;lt;windowsx.h&amp;gt;&#xA;&#xA;#ifdef  _MSC_VER&#xA;#error sorry! the scratch windows program relies on mingw-only functionality! (specifically: asprintf())&#xA;#endif&#xA;&#xA;HMODULE hInstance;&#xA;HICON hDefaultIcon;&#xA;HCURSOR hDefaultCursor;&#xA;HFONT controlfont;&#xA;&#xA;void panic(char *fmt, ...);&#xA;&#xA;HWND area;&#xA;HWND edit;&#xA;&#xA;LRESULT CALLBACK wndproc(HWND hwnd, UINT msg, WPARAM wparam, LPARAM lparam)&#xA;{&#xA;    RECT r;&#xA;&#xA;    switch (msg) {&#xA;    case WM_SIZE:&#xA;        GetClientRect(hwnd, &amp;amp;r);&#xA;        MoveWindow(area, r.left, r.top, r.right - r.left, r.bottom - r.top, TRUE);&#xA;        return 0;&#xA;    case WM_CLOSE:&#xA;        PostQuitMessage(0);&#xA;        return 0;&#xA;    default:&#xA;        return DefWindowProc(hwnd, msg, wparam, lparam);&#xA;    }&#xA;    panic(&quot;oops: message %ud does not return anything; bug in wndproc()&quot;, msg);&#xA;}&#xA;&#xA;LRESULT CALLBACK areawndproc(HWND hwnd, UINT msg, WPARAM wparam, LPARAM lparam)&#xA;{&#xA;    switch (msg) {&#xA;    case WM_MOUSEACTIVATE:&#xA;        SetFocus(hwnd);&#xA;        return MA_ACTIVATE;&#xA;    case WM_COMMAND:&#xA;        if (HIWORD(wparam) == EN_KILLFOCUS) {&#xA;            MessageBeep(-1);&#xA;            ShowWindow(edit, SW_HIDE);&#xA;            return 0;&#xA;        }&#xA;        return DefWindowProc(hwnd, msg, wparam, lparam);&#xA;    case WM_LBUTTONUP:&#xA;        MoveWindow(edit, GET_X_LPARAM(lparam), GET_Y_LPARAM(lparam), 100, 20, TRUE);&#xA;        ShowWindow(edit, SW_SHOW);&#xA;        return 0;&#xA;    default:&#xA;        return DefWindowProc(hwnd, msg, wparam, lparam);&#xA;    }&#xA;    panic(&quot;oops: message %ud does not return anything; bug in wndproc()&quot;, msg);&#xA;}&#xA;&#xA;HWND makeMainWindow(void)&#xA;{&#xA;    WNDCLASS cls;&#xA;    HWND hwnd;&#xA;&#xA;    ZeroMemory(&amp;amp;cls, sizeof (WNDCLASS));&#xA;    cls.lpszClassName = L&quot;mainwin&quot;;&#xA;    cls.lpfnWndProc = wndproc;&#xA;    cls.hInstance = hInstance;&#xA;    cls.hIcon = hDefaultIcon;&#xA;    cls.hCursor = hDefaultCursor;&#xA;    cls.hbrBackground = (HBRUSH) (COLOR_BTNFACE + 1);&#xA;    if (RegisterClass(&amp;amp;cls) == 0)&#xA;        panic(&quot;error registering window class&quot;);&#xA;    hwnd = CreateWindowEx(0,&#xA;        L&quot;mainwin&quot;, L&quot;Main Window&quot;,&#xA;        WS_OVERLAPPEDWINDOW,&#xA;        CW_USEDEFAULT, CW_USEDEFAULT,&#xA;        CW_USEDEFAULT, CW_USEDEFAULT,&#xA;        NULL, NULL, hInstance, NULL);&#xA;    if (hwnd == NULL)&#xA;        panic(&quot;opening main window failed&quot;);&#xA;    return hwnd;&#xA;}&#xA;&#xA;void buildUI(HWND mainwin)&#xA;{&#xA;#define CSTYLE (WS_CHILD | WS_VISIBLE)&#xA;#define CXSTYLE (0)&#xA;#define SETFONT(hwnd) SendMessage(hwnd, WM_SETFONT, (WPARAM) controlfont, (LPARAM) TRUE);&#xA;    // build GUI here; use CSTYLE and CXSTYLE in CreateWindowEx() and call SETFONT() on each new widget&#xA;&#xA;    WNDCLASS cls;&#xA;&#xA;    ZeroMemory(&amp;amp;cls, sizeof (WNDCLASS));&#xA;    cls.lpszClassName = L&quot;area&quot;;&#xA;    cls.lpfnWndProc = areawndproc;&#xA;    cls.hInstance = hInstance;&#xA;    cls.hIcon = hDefaultIcon;&#xA;    cls.hCursor = hDefaultCursor;&#xA;    cls.hbrBackground = (HBRUSH) (COLOR_GRADIENTACTIVECAPTION + 1);&#xA;    if (RegisterClass(&amp;amp;cls) == 0)&#xA;        panic(&quot;error registering area window class&quot;);&#xA;    area = CreateWindowEx(0,&#xA;        L&quot;area&quot;, L&quot;&quot;,&#xA;        WS_CHILD | WS_VISIBLE,&#xA;        CW_USEDEFAULT, CW_USEDEFAULT,&#xA;        CW_USEDEFAULT, CW_USEDEFAULT,&#xA;        mainwin, NULL, hInstance, NULL);&#xA;    if (area == NULL)&#xA;        panic(&quot;opening main window failed&quot;);&#xA;&#xA;    edit = CreateWindowEx(WS_EX_CLIENTEDGE,&#xA;        L&quot;edit&quot;, L&quot;&quot;,&#xA;        WS_CHILD | ES_AUTOHSCROLL | ES_LEFT | ES_NOHIDESEL | WS_TABSTOP,&#xA;        0, 0, 0, 0,&#xA;        area, NULL, hInstance, NULL);&#xA;    if (edit == NULL)&#xA;        panic(&quot;edit creation failed&quot;);&#xA;    SETFONT(edit);&#xA;}&#xA;&#xA;void firstShowWindow(HWND hwnd);&#xA;void initwin(void);&#xA;&#xA;int main(int argc, char *argv[])&#xA;{&#xA;    HWND mainwin;&#xA;    MSG msg;&#xA;&#xA;    initwin();&#xA;&#xA;    mainwin = makeMainWindow();&#xA;    buildUI(mainwin);&#xA;    firstShowWindow(mainwin);&#xA;&#xA;    for (;;) {&#xA;        BOOL gmret;&#xA;&#xA;        gmret = GetMessage(&amp;amp;msg, NULL, 0, 0);&#xA;        if (gmret == -1)&#xA;            panic(&quot;error getting message&quot;);&#xA;        if (gmret == 0)&#xA;            break;&#xA;        TranslateMessage(&amp;amp;msg);&#xA;        DispatchMessage(&amp;amp;msg);&#xA;    }&#xA;    return 0;&#xA;}&#xA;&#xA;DWORD iccFlags =&#xA;//  ICC_ANIMATE_CLASS |         // animation control&#xA;//  ICC_BAR_CLASSES |               // toolbar, statusbar, trackbar, tooltip&#xA;//  ICC_COOL_CLASSES |          // rebar&#xA;//  ICC_DATE_CLASSES |          // date and time picker&#xA;//  ICC_HOTKEY_CLASS |          // hot key&#xA;//  ICC_INTERNET_CLASSES |      // IP address entry field&#xA;//  ICC_LINK_CLASS |                // hyperlink&#xA;//  ICC_LISTVIEW_CLASSES |          // list-view, header&#xA;//  ICC_NATIVEFNTCTL_CLASS |        // native font&#xA;//  ICC_PAGESCROLLER_CLASS |        // pager&#xA;//  ICC_PROGRESS_CLASS |            // progress bar&#xA;    ICC_STANDARD_CLASSES |      // &quot;one of the intrinsic User32 control classes&quot;&#xA;//  ICC_TAB_CLASSES |               // tab, tooltip&#xA;//  ICC_TREEVIEW_CLASSES |      // tree-view, tooltip&#xA;//  ICC_UPDOWN_CLASS |          // up-down&#xA;//  ICC_USEREX_CLASSES |            // ComboBoxEx&#xA;//  ICC_WIN95_CLASSES |         // some of the above&#xA;    0;&#xA;&#xA;void initwin(void)&#xA;{&#xA;    INITCOMMONCONTROLSEX icc;&#xA;    NONCLIENTMETRICS ncm;&#xA;&#xA;    hInstance = GetModuleHandle(NULL);&#xA;    if (hInstance == NULL)&#xA;        panic(&quot;error getting hInstance&quot;);&#xA;    hDefaultIcon = LoadIcon(NULL, MAKEINTRESOURCE(IDI_APPLICATION));&#xA;    if (hDefaultIcon == NULL)&#xA;        panic(&quot;error getting default window class icon&quot;);&#xA;    hDefaultCursor = LoadCursor(NULL, MAKEINTRESOURCE(IDC_ARROW));&#xA;    if (hDefaultCursor == NULL)&#xA;        panic(&quot;error getting default window cursor&quot;);&#xA;    icc.dwSize = sizeof (INITCOMMONCONTROLSEX);&#xA;    icc.dwICC = iccFlags;&#xA;    if (InitCommonControlsEx(&amp;amp;icc) == FALSE)&#xA;        panic(&quot;error initializing Common Controls&quot;);&#xA;    ncm.cbSize = sizeof (NONCLIENTMETRICS);&#xA;    if (SystemParametersInfo(SPI_GETNONCLIENTMETRICS,&#xA;        sizeof (NONCLIENTMETRICS), &amp;amp;ncm, 0) == 0)&#xA;        panic(&quot;error getting non-client metrics for getting control font&quot;);&#xA;    controlfont = CreateFontIndirect(&amp;amp;ncm.lfMessageFont);&#xA;    if (controlfont == NULL)&#xA;        panic(&quot;error getting control font&quot;);&#xA;}&#xA;&#xA;void panic(char *fmt, ...)&#xA;{&#xA;    char *msg;&#xA;    TCHAR *lerrmsg;&#xA;    char *fullmsg;&#xA;    va_list arg;&#xA;    DWORD lasterr;&#xA;    DWORD lerrsuccess;&#xA;&#xA;    lasterr = GetLastError();&#xA;    va_start(arg, fmt);&#xA;    if (vasprintf(&amp;amp;msg, fmt, arg) == -1) {&#xA;        fprintf(stderr, &quot;critical error: vasprintf() failed in panic() preparing panic message; fmt = \&quot;%s\&quot;\n&quot;, fmt);&#xA;        abort();&#xA;    }&#xA;    // according to http://msdn.microsoft.com/en-us/library/windows/desktop/ms680582%28v=vs.85%29.aspx&#xA;    lerrsuccess = FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,&#xA;        NULL, lasterr,&#xA;        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),&#xA;        (LPTSTR) &amp;amp;lerrmsg, 0, NULL);&#xA;    if (lerrsuccess == 0) {&#xA;        fprintf(stderr, &quot;critical error: FormatMessage() failed in panic() preparing GetLastError() string; panic message = \&quot;%s\&quot;, last error in panic(): %ld, last error from FormatMessage(): %ld\n&quot;, msg, lasterr, GetLastError());&#xA;        abort();&#xA;    }&#xA;    // note to self: use %ws instead of %S (thanks jon_y in irc.oftc.net/#mingw-w64)&#xA;    if (asprintf(&amp;amp;fullmsg, &quot;panic: %s\nlast error: %ws\n&quot;, msg, lerrmsg) == -1) {&#xA;        fprintf(stderr, &quot;critical error: asprintf() failed in panic() preparing full report; panic message = \&quot;%s\&quot;, last error message: \&quot;%ws\&quot;\n&quot;, msg, lerrmsg);&#xA;        abort();&#xA;    }&#xA;    fprintf(stderr, &quot;%s\n&quot;, fullmsg);&#xA;    va_end(arg);&#xA;    exit(1);&#xA;}&#xA;&#xA;void firstShowWindow(HWND hwnd)&#xA;{&#xA;    // we need to get nCmdShow&#xA;    int nCmdShow;&#xA;    STARTUPINFO si;&#xA;&#xA;    nCmdShow = SW_SHOWDEFAULT;&#xA;    GetStartupInfo(&amp;amp;si);&#xA;    if ((si.dwFlags &amp;amp; STARTF_USESHOWWINDOW) != 0)&#xA;        nCmdShow = si.wShowWindow;&#xA;    ShowWindow(hwnd, nCmdShow);&#xA;    if (UpdateWindow(hwnd) == 0)&#xA;        panic(&quot;UpdateWindow(hwnd) failed in first show&quot;);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3408572" LastEditorUserId="3408572" LastEditDate="2014-08-23T14:45:04.193" LastActivityDate="2014-08-23T20:55:13.360" Title="Why am I getting WM_MOUSEACTIVATE when I click on my child window? I have it change focus to the parent, which screws child kill focus logic" Tags="&lt;c&gt;&lt;winapi&gt;&lt;focus&gt;" AnswerCount="1" CommentCount="4" />
  <row Id="25507833" PostTypeId="1" CreationDate="2014-08-26T14:05:47.467" Score="2" ViewCount="79" Body="&lt;p&gt;This is my first venture into assembly, and I'd love a few pointers regarding organization/ style. This code takes an integer and prints the cube (I'm running it on Windows, via NASM), and while the code works, most of it is cannibalized and rewritten from code samples I found online, so a lot of it is still nonsense to me. What I'd like to know is 1) Am I doing anything particularly stupid here? and 2) Is there any way to make assembly code look even remotely elegant/ neat?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;global main&#xA;extern printf&#xA;extern scanf &#xA;;This header makes sure it works on Windows/Linux, got from drpaulcarter.com/pcasm/&#xA;&#xA;&#xA;%ifdef &#xA;WIN32_TYPE  &#xA;%define scanf _scanf    &#xA;%define printf _printf&#xA;%endif&#xA;&#xA;%ifdef&#xA;OBJ_TYPE&#xA;&#xA;section .data&#xA;public align=4&#xA;class=data&#xA;use32&#xA;%else&#xA;section .data&#xA;%endif&#xA;&#xA;prompt   db &quot;Please enter an integer to cube: &quot;, 0&#xA;msg&#xA;db ` is the cube.\n`, 0&#xA;format   db &quot;%i&quot;, 0&#xA;section .bss&#xA;input resb 1000&#xA;&#xA;section .text&#xA;exit.&#xA;&#xA;main:&#xA;push ebp&#xA;mov ebp, esp    &#xA;push prompt&#xA;call printf     &#xA;add esp, 4&#xA;push input      &#xA;push dword format&#xA;call scanf&#xA;&#xA;add esp, 8&#xA;mov eax, [input]&#xA;mov edx, [input]&#xA;imul eax, edx&#xA;imul eax, edx&#xA;push eax&#xA;push dword format&#xA;call printf&#xA;add esp, 4&#xA;push msg&#xA;&#xA;call printf&#xA;mov esp, ebp&#xA;pop ebp&#xA;nop&#xA;ret&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3979301" LastActivityDate="2014-08-26T16:41:11.600" Title="Questions about style/ organization in Assembly" Tags="&lt;assembly&gt;&lt;nasm&gt;" AnswerCount="1" CommentCount="3" ClosedDate="2014-08-27T00:46:03.950" />
  <row Id="25539111" PostTypeId="1" CreationDate="2014-08-28T00:50:16.443" Score="2" ViewCount="120" Body="&lt;p&gt;I'm using state images to fake having checkboxes in every column of a standard list view control, and I've come across one weird anomaly on Windows XP that I'm not understanding: the top-left pixel of state image 1 is white, regardless of what that image actually is.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&quot;http://imgur.com/cM7yUSt&quot; rel=&quot;nofollow&quot;&gt;Here's a (zoomed in) example.&lt;/a&gt; You'll notice that the top-left pixel of the first image is blank.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;It does not matter which state I draw for the first state image (change the first element of the &lt;code&gt;themestates&lt;/code&gt; array in the same program below to see for yourself); all that seems to matter is that this only happens to state image 1 (index 0 in the HIMAGELIST).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;IIRC this doesn't happen unthemed, and IIRC it doesn't happen on Windows 7.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The sample program below demonstrates this behavior (so I know it's not me accidentally overwriting memory in another part of my library, at least???).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What's going on? Thanks.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// 27 august 2014&#xA;// modified from winstateimglist.c 17 august 2014&#xA;// scratch Windows program by pietro gagliardi 17 april 2014&#xA;// fixed typos and added toWideString() 1 may 2014&#xA;// borrows code from the scratch GTK+ program (16-17 april 2014) and from code written 31 march 2014 and 11-12 april 2014&#xA;#define _UNICODE&#xA;#define UNICODE&#xA;#define STRICT&#xA;#define _GNU_SOURCE     // needed to declare asprintf()/vasprintf()&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#include &amp;lt;stdarg.h&amp;gt;&#xA;#include &amp;lt;windows.h&amp;gt;&#xA;#include &amp;lt;commctrl.h&amp;gt;       // needed for InitCommonControlsEx() (thanks Xeek in irc.freenode.net/#winapi for confirming)&#xA;#include &amp;lt;uxtheme.h&amp;gt;&#xA;#include &amp;lt;vsstyle.h&amp;gt;&#xA;#include &amp;lt;vssym32.h&amp;gt;&#xA;&#xA;#ifdef  _MSC_VER&#xA;#error sorry! the scratch windows program relies on mingw-only functionality! (specifically: asprintf())&#xA;#endif&#xA;&#xA;HMODULE hInstance;&#xA;HICON hDefaultIcon;&#xA;HCURSOR hDefaultCursor;&#xA;HFONT controlfont;&#xA;&#xA;void panic(char *fmt, ...);&#xA;TCHAR *toWideString(char *what);&#xA;void init(void);&#xA;&#xA;LRESULT CALLBACK wndproc(HWND hwnd, UINT msg, WPARAM wparam, LPARAM lparam)&#xA;{&#xA;    NMHDR *nmhdr = (NMHDR *) lparam;&#xA;    NMLVDISPINFOW *fill = (NMLVDISPINFO *) lparam;&#xA;&#xA;    switch (msg) {&#xA;    case WM_NOTIFY:&#xA;        if (nmhdr-&amp;gt;code == LVN_GETDISPINFO) {&#xA;            if (fill-&amp;gt;item.iSubItem == 0) {&#xA;                fill-&amp;gt;item.state = INDEXTOSTATEIMAGEMASK(fill-&amp;gt;item.iItem + 1);&#xA;                fill-&amp;gt;item.stateMask = LVIS_STATEIMAGEMASK;&#xA;            } else&#xA;                fill-&amp;gt;item.pszText = L&quot;No State Image Here&quot;;&#xA;            return 0;&#xA;        }&#xA;        return DefWindowProc(hwnd, msg, wparam, lparam);&#xA;    case WM_CLOSE:&#xA;        PostQuitMessage(0);&#xA;        return 0;&#xA;    default:&#xA;        return DefWindowProc(hwnd, msg, wparam, lparam);&#xA;    }&#xA;    panic(&quot;oops: message %ud does not return anything; bug in wndproc()&quot;, msg);&#xA;}&#xA;&#xA;HWND makeMainWindow(void)&#xA;{&#xA;    WNDCLASS cls;&#xA;    HWND hwnd;&#xA;&#xA;    ZeroMemory(&amp;amp;cls, sizeof (WNDCLASS));&#xA;    cls.lpszClassName = L&quot;mainwin&quot;;&#xA;    cls.lpfnWndProc = wndproc;&#xA;    cls.hInstance = hInstance;&#xA;    cls.hIcon = hDefaultIcon;&#xA;    cls.hCursor = hDefaultCursor;&#xA;    cls.hbrBackground = (HBRUSH) (COLOR_BTNFACE + 1);&#xA;    if (RegisterClass(&amp;amp;cls) == 0)&#xA;        panic(&quot;error registering window class&quot;);&#xA;    hwnd = CreateWindowEx(0,&#xA;        L&quot;mainwin&quot;, L&quot;Main Window&quot;,&#xA;        WS_OVERLAPPEDWINDOW,&#xA;        CW_USEDEFAULT, CW_USEDEFAULT,&#xA;        300, 300,&#xA;        NULL, NULL, hInstance, NULL);&#xA;    if (hwnd == NULL)&#xA;        panic(&quot;opening main window failed&quot;);&#xA;    return hwnd;&#xA;}&#xA;&#xA;void buildUI(HWND mainwin)&#xA;{&#xA;#define CSTYLE (WS_CHILD | WS_VISIBLE)&#xA;#define CXSTYLE (0)&#xA;#define SETFONT(hwnd) SendMessage(hwnd, WM_SETFONT, (WPARAM) controlfont, (LPARAM) TRUE);&#xA;&#xA;    HWND lv;&#xA;    LVCOLUMN column;&#xA;    HIMAGELIST imglist;&#xA;&#xA;    lv = CreateWindowEx(WS_EX_CLIENTEDGE | CXSTYLE,&#xA;        WC_LISTVIEW, L&quot;&quot;,&#xA;        LVS_REPORT | LVS_OWNERDATA | LVS_NOSORTHEADER | LVS_SHOWSELALWAYS | WS_HSCROLL | WS_VSCROLL | WS_TABSTOP | CSTYLE,&#xA;        10, 10, 250, 250,&#xA;        mainwin, (HMENU) 100, hInstance, NULL);&#xA;    if (lv == NULL)&#xA;        panic(&quot;error making list view&quot;);&#xA;    SETFONT(lv);&#xA;    SendMessageW(lv, LVM_SETEXTENDEDLISTVIEWSTYLE,&#xA;        LVS_EX_FULLROWSELECT | LVS_EX_SUBITEMIMAGES,&#xA;        LVS_EX_FULLROWSELECT | LVS_EX_SUBITEMIMAGES);&#xA;&#xA;    // error checking elided from this point to where otherwise noted&#xA;&#xA;    HTHEME theme = NULL;&#xA;    HIMAGELIST makeCheckboxImageList(HWND hwnddc, HTHEME *theme);&#xA;&#xA;    SendMessageW(lv, LVM_SETIMAGELIST, LVSIL_STATE, (LPARAM) makeCheckboxImageList(lv, &amp;amp;theme));&#xA;&#xA;    ZeroMemory(&amp;amp;column, sizeof (LVCOLUMN));&#xA;    column.mask = LVCF_FMT | LVCF_TEXT | LVCF_SUBITEM | LVCF_ORDER;&#xA;    column.fmt = LVCFMT_LEFT;&#xA;    column.pszText = L&quot;State Image&quot;;&#xA;    column.iSubItem = 0;&#xA;    column.iOrder = 0;&#xA;    SendMessageW(lv, LVM_INSERTCOLUMN, 0, (LPARAM) (&amp;amp;column));&#xA;    ZeroMemory(&amp;amp;column, sizeof (LVCOLUMN));&#xA;    column.mask = LVCF_FMT | LVCF_TEXT | LVCF_SUBITEM | LVCF_ORDER;&#xA;    column.fmt = LVCFMT_LEFT;&#xA;    column.pszText = L&quot;No State Image&quot;;&#xA;    column.iSubItem = 1;&#xA;    column.iOrder = 1;&#xA;    SendMessageW(lv, LVM_INSERTCOLUMN, 1, (LPARAM) (&amp;amp;column));&#xA;&#xA;    // end of error eliding&#xA;&#xA;        if (SendMessageW(lv, LVM_SETCALLBACKMASK, LVIS_STATEIMAGEMASK, 0) == FALSE)&#xA;        panic(&quot;error marking state image list as application-managed&quot;);&#xA;    if (SendMessageW(lv, LVM_SETITEMCOUNT, 8, 0) == 0)&#xA;        panic(&quot;error setting number of items in list view&quot;);&#xA;}&#xA;&#xA;void firstShowWindow(HWND hwnd);&#xA;&#xA;int main(void)&#xA;{&#xA;    HWND mainwin;&#xA;    MSG msg;&#xA;&#xA;    init();&#xA;&#xA;    mainwin = makeMainWindow();&#xA;    buildUI(mainwin);&#xA;    firstShowWindow(mainwin);&#xA;&#xA;    for (;;) {&#xA;        BOOL gmret;&#xA;&#xA;        gmret = GetMessage(&amp;amp;msg, NULL, 0, 0);&#xA;        if (gmret == -1)&#xA;            panic(&quot;error getting message&quot;);&#xA;        if (gmret == 0)&#xA;            break;&#xA;        TranslateMessage(&amp;amp;msg);&#xA;        DispatchMessage(&amp;amp;msg);&#xA;    }&#xA;    return 0;&#xA;}&#xA;&#xA;DWORD iccFlags =&#xA;//  ICC_ANIMATE_CLASS |         // animation control&#xA;//  ICC_BAR_CLASSES |               // toolbar, statusbar, trackbar, tooltip&#xA;//  ICC_COOL_CLASSES |          // rebar&#xA;//  ICC_DATE_CLASSES |          // date and time picker&#xA;//  ICC_HOTKEY_CLASS |          // hot key&#xA;//  ICC_INTERNET_CLASSES |      // IP address entry field&#xA;//  ICC_LINK_CLASS |                // hyperlink&#xA;    ICC_LISTVIEW_CLASSES |          // list-view, header&#xA;//  ICC_NATIVEFNTCTL_CLASS |        // native font&#xA;//  ICC_PAGESCROLLER_CLASS |        // pager&#xA;//  ICC_PROGRESS_CLASS |            // progress bar&#xA;//  ICC_STANDARD_CLASSES |      // &quot;one of the intrinsic User32 control classes&quot;&#xA;//  ICC_TAB_CLASSES |               // tab, tooltip&#xA;//  ICC_TREEVIEW_CLASSES |      // tree-view, tooltip&#xA;//  ICC_UPDOWN_CLASS |          // up-down&#xA;//  ICC_USEREX_CLASSES |            // ComboBoxEx&#xA;//  ICC_WIN95_CLASSES |         // some of the above&#xA;    0;&#xA;&#xA;void init(void)&#xA;{&#xA;    INITCOMMONCONTROLSEX icc;&#xA;    NONCLIENTMETRICS ncm;&#xA;&#xA;    hInstance = GetModuleHandle(NULL);&#xA;    if (hInstance == NULL)&#xA;        panic(&quot;error getting hInstance&quot;);&#xA;    hDefaultIcon = LoadIcon(NULL, MAKEINTRESOURCE(IDI_APPLICATION));&#xA;    if (hDefaultIcon == NULL)&#xA;        panic(&quot;error getting default window class icon&quot;);&#xA;    hDefaultCursor = LoadCursor(NULL, MAKEINTRESOURCE(IDC_ARROW));&#xA;    if (hDefaultCursor == NULL)&#xA;        panic(&quot;error getting default window cursor&quot;);&#xA;    icc.dwSize = sizeof (INITCOMMONCONTROLSEX);&#xA;    icc.dwICC = iccFlags;&#xA;    if (InitCommonControlsEx(&amp;amp;icc) == FALSE)&#xA;        panic(&quot;error initializing Common Controls&quot;);&#xA;    ncm.cbSize = sizeof (NONCLIENTMETRICS);&#xA;    if (SystemParametersInfo(SPI_GETNONCLIENTMETRICS,&#xA;        sizeof (NONCLIENTMETRICS), &amp;amp;ncm, 0) == 0)&#xA;        panic(&quot;error getting non-client metrics for getting control font&quot;);&#xA;    controlfont = CreateFontIndirect(&amp;amp;ncm.lfMessageFont);&#xA;    if (controlfont == NULL)&#xA;        panic(&quot;error getting control font&quot;);&#xA;}&#xA;&#xA;void panic(char *fmt, ...)&#xA;{&#xA;    char *msg;&#xA;    TCHAR *lerrmsg;&#xA;    char *fullmsg;&#xA;    va_list arg;&#xA;    DWORD lasterr;&#xA;    DWORD lerrsuccess;&#xA;&#xA;    lasterr = GetLastError();&#xA;    va_start(arg, fmt);&#xA;    if (vasprintf(&amp;amp;msg, fmt, arg) == -1) {&#xA;        fprintf(stderr, &quot;critical error: vasprintf() failed in panic() preparing panic message; fmt = \&quot;%s\&quot;\n&quot;, fmt);&#xA;        abort();&#xA;    }&#xA;    // according to http://msdn.microsoft.com/en-us/library/windows/desktop/ms680582%28v=vs.85%29.aspx&#xA;    lerrsuccess = FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,&#xA;        NULL, lasterr,&#xA;        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),&#xA;        (LPTSTR) &amp;amp;lerrmsg, 0, NULL);&#xA;    if (lerrsuccess == 0) {&#xA;        fprintf(stderr, &quot;critical error: FormatMessage() failed in panic() preparing GetLastError() string; panic message = \&quot;%s\&quot;, last error in panic(): %ld, last error from FormatMessage(): %ld\n&quot;, msg, lasterr, GetLastError());&#xA;        abort();&#xA;    }&#xA;    // note to self: use %ws instead of %S (thanks jon_y in irc.oftc.net/#mingw-w64)&#xA;    if (asprintf(&amp;amp;fullmsg, &quot;panic: %s\nlast error: %ws\n&quot;, msg, lerrmsg) == -1) {&#xA;        fprintf(stderr, &quot;critical error: asprintf() failed in panic() preparing full report; panic message = \&quot;%s\&quot;, last error message: \&quot;%ws\&quot;\n&quot;, msg, lerrmsg);&#xA;        abort();&#xA;    }&#xA;    fprintf(stderr, &quot;%s\n&quot;, fullmsg);&#xA;    va_end(arg);&#xA;    exit(1);&#xA;}&#xA;&#xA;void firstShowWindow(HWND hwnd)&#xA;{&#xA;    // we need to get nCmdShow&#xA;    int nCmdShow;&#xA;    STARTUPINFO si;&#xA;&#xA;    nCmdShow = SW_SHOWDEFAULT;&#xA;    GetStartupInfo(&amp;amp;si);&#xA;    if ((si.dwFlags &amp;amp; STARTF_USESHOWWINDOW) != 0)&#xA;        nCmdShow = si.wShowWindow;&#xA;    ShowWindow(hwnd, nCmdShow);&#xA;    if (UpdateWindow(hwnd) == 0)&#xA;        panic(&quot;UpdateWindow(hwnd) failed in first show&quot;);&#xA;}&#xA;&#xA;TCHAR *toWideString(char *what)&#xA;{&#xA;    TCHAR *buf;&#xA;    int n;&#xA;    size_t len;&#xA;&#xA;    len = strlen(what);&#xA;    if (len == 0) {&#xA;        buf = (TCHAR *) malloc(sizeof (TCHAR));&#xA;        if (buf == NULL)&#xA;            goto mallocfail;&#xA;        buf[0] = L'\0';&#xA;    } else {&#xA;        n = MultiByteToWideChar(CP_UTF8, 0, what, -1, NULL, 0);&#xA;        if (n == 0)&#xA;            panic(&quot;error getting number of bytes to convert \&quot;%s\&quot; to UTF-16&quot;, what);&#xA;        buf = (TCHAR *) malloc((n + 1) * sizeof (TCHAR));&#xA;        if (buf == NULL)&#xA;            goto mallocfail;&#xA;        if (MultiByteToWideChar(CP_UTF8, 0, what, -1, buf, n) == 0)&#xA;            panic(&quot;erorr converting \&quot;%s\&quot; to UTF-16&quot;, what);&#xA;    }&#xA;    return buf;&#xA;mallocfail:&#xA;    panic(&quot;error allocating memory for UTF-16 version of \&quot;%s\&quot;&quot;, what);&#xA;}&#xA;&#xA;#define checkboxnStates 8&#xA;&#xA;static int themestates[checkboxnStates] = {&#xA;    CBS_UNCHECKEDNORMAL,            // 0&#xA;    CBS_CHECKEDNORMAL,              // checked&#xA;    CBS_UNCHECKEDHOT,               // hot&#xA;    CBS_CHECKEDHOT,                 // checked | hot&#xA;    CBS_UNCHECKEDPRESSED,           // pushed&#xA;    CBS_CHECKEDPRESSED,             // checked | pushed&#xA;    CBS_UNCHECKEDPRESSED,           // hot | pushed&#xA;    CBS_CHECKEDPRESSED,             // checked | hot | pushed&#xA;};&#xA;&#xA;static SIZE getStateSize(HDC dc, int cbState, HTHEME theme)&#xA;{&#xA;    SIZE s;&#xA;    HRESULT res;&#xA;&#xA;    res = GetThemePartSize(theme, dc, BP_CHECKBOX, themestates[cbState], NULL, TS_DRAW, &amp;amp;s);&#xA;    if (res != S_OK)&#xA;        panic(&quot;error getting theme part size; HRESULT: %x&quot;, res);&#xA;    return s;&#xA;}&#xA;&#xA;static void themeImage(HDC dc, RECT *r, int cbState, HTHEME theme)&#xA;{&#xA;    HRESULT res;&#xA;&#xA;    res = DrawThemeBackground(theme, dc, BP_CHECKBOX, themestates[cbState], r, NULL);&#xA;    if (res != S_OK)&#xA;        panic(&quot;error drawing checkbox image; HRESULT: %x&quot;, res);&#xA;}&#xA;&#xA;static void themeSize(HDC dc, int *width, int *height, HTHEME theme)&#xA;{&#xA;    SIZE size;&#xA;    int cbState;&#xA;&#xA;    size = getStateSize(dc, 0, theme);&#xA;    for (cbState = 1; cbState &amp;lt; checkboxnStates; cbState++) {&#xA;        SIZE against;&#xA;&#xA;        against = getStateSize(dc, cbState, theme);&#xA;        if (size.cx != against.cx || size.cy != against.cy)&#xA;            panic(&quot;size mismatch in checkbox states&quot;);&#xA;    }&#xA;    *width = (int) size.cx;&#xA;    *height = (int) size.cy;&#xA;}&#xA;&#xA;static HBITMAP makeCheckboxImageListEntry(HDC dc, int width, int height, int cbState, void (*drawfunc)(HDC, RECT *, int, HTHEME), HTHEME theme)&#xA;{&#xA;    BITMAPINFO bi;&#xA;    VOID *ppvBits;&#xA;    HBITMAP bitmap;&#xA;    RECT r;&#xA;    HDC drawDC;&#xA;    HBITMAP prevbitmap;&#xA;&#xA;    r.left = 0;&#xA;    r.top = 0;&#xA;    r.right = width;&#xA;    r.bottom = height;&#xA;    ZeroMemory(&amp;amp;bi, sizeof (BITMAPINFO));&#xA;    bi.bmiHeader.biSize = sizeof (BITMAPINFOHEADER);&#xA;    bi.bmiHeader.biWidth = (LONG) width;&#xA;    bi.bmiHeader.biHeight = -((LONG) height);           // negative height to force top-down drawing;&#xA;    bi.bmiHeader.biPlanes = 1;&#xA;    bi.bmiHeader.biBitCount = 32;&#xA;    bi.bmiHeader.biCompression = BI_RGB;&#xA;    bi.bmiHeader.biSizeImage = (DWORD) (width * height * 4);&#xA;    bitmap = CreateDIBSection(NULL, &amp;amp;bi, DIB_RGB_COLORS, &amp;amp;ppvBits, 0, 0);&#xA;    if (bitmap == NULL)&#xA;        panic(&quot;error creating HBITMAP for unscaled ImageList image copy&quot;);&#xA;&#xA;    drawDC = CreateCompatibleDC(dc);&#xA;    if (drawDC == NULL)&#xA;        panic(&quot;error getting DC for checkbox image list bitmap&quot;);&#xA;    prevbitmap = SelectObject(drawDC, bitmap);&#xA;    if (prevbitmap == NULL)&#xA;        panic(&quot;error selecting checkbox image list bitmap into DC&quot;);&#xA;    (*drawfunc)(drawDC, &amp;amp;r, cbState, theme);&#xA;    if (SelectObject(drawDC, prevbitmap) != bitmap)&#xA;        panic(&quot;error selecting previous bitmap into checkbox image's DC&quot;);&#xA;    if (DeleteDC(drawDC) == 0)&#xA;        panic(&quot;error deleting checkbox image's DC&quot;);&#xA;&#xA;    return bitmap;&#xA;}&#xA;&#xA;static HIMAGELIST newCheckboxImageList(HWND hwnddc, void (*sizefunc)(HDC, int *, int *, HTHEME), void (*drawfunc)(HDC, RECT *, int, HTHEME), HTHEME theme)&#xA;{&#xA;    int width, height;&#xA;    int cbState;&#xA;    HDC dc;&#xA;    HIMAGELIST il;&#xA;&#xA;    dc = GetDC(hwnddc);&#xA;    if (dc == NULL)&#xA;        panic(&quot;error getting DC for making the checkbox image list&quot;);&#xA;    (*sizefunc)(dc, &amp;amp;width, &amp;amp;height, theme);&#xA;    il = ImageList_Create(width, height, ILC_COLOR32, 20, 20);      // should be reasonable&#xA;    if (il == NULL)&#xA;        panic(&quot;error creating checkbox image list&quot;);&#xA;    for (cbState = 0; cbState &amp;lt; checkboxnStates; cbState++) {&#xA;        HBITMAP bitmap;&#xA;&#xA;        bitmap = makeCheckboxImageListEntry(dc, width, height, cbState, drawfunc, theme);&#xA;        if (ImageList_Add(il, bitmap, NULL) == -1)&#xA;            panic(&quot;error adding checkbox image to image list&quot;);&#xA;        if (DeleteObject(bitmap) == 0)&#xA;            panic(&quot;error deleting checkbox bitmap&quot;);&#xA;    }&#xA;    if (ReleaseDC(hwnddc, dc) == 0)&#xA;        panic(&quot;error deleting checkbox image list DC&quot;);&#xA;    return il;&#xA;}&#xA;&#xA;HIMAGELIST makeCheckboxImageList(HWND hwnddc, HTHEME *theme)&#xA;{&#xA;    if (*theme != NULL) {&#xA;        HRESULT res;&#xA;&#xA;        res = CloseThemeData(*theme);&#xA;        if (res != S_OK)&#xA;            panic(&quot;error closing theme; HRESULT: %x&quot;, res);&#xA;        *theme = NULL;&#xA;    }&#xA;    // ignore error; if it can't be done, we can fall back to DrawFrameControl()&#xA;    if (*theme == NULL)     // try to open the theme&#xA;        *theme = OpenThemeData(hwnddc, L&quot;button&quot;);&#xA;    if (*theme != NULL)     // use the theme&#xA;        return newCheckboxImageList(hwnddc, themeSize, themeImage, *theme);&#xA;    panic(&quot;error loading theme&quot;);&#xA;    return NULL;        // unreached&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3408572" LastActivityDate="2014-08-28T00:50:16.443" Title="Why is the top-left pixel of state image 1 in my DrawThemeBackground-based list view state image list clear on Windows XP?" Tags="&lt;c&gt;&lt;listview&gt;&lt;winapi&gt;&lt;imagelist&gt;" AnswerCount="0" CommentCount="2" />
  <row Id="25544587" PostTypeId="1" AcceptedAnswerId="25567419" CreationDate="2014-08-28T08:49:53.277" Score="0" ViewCount="720" Body="&lt;p&gt;I have the following definition in the header file dcm.h:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;typedef struct&#xA;{    &#xA;    double alpha;&#xA;    double gamma;&#xA;    double tau;&#xA;} ThetaDCM;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I want to import it in cython, so I have:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;cdef extern from &quot;dcm.h&quot;:&#xA;&#xA;    ctypedef struct ThetaDCM:&#xA;&#xA;        np.float64_t alpha&#xA;        np.float64_t gamma&#xA;        np.float64_t tau&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Now I want to allocate memory to an array of ThetaDCM's. I have the following:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;cdef ThetaDCM *c_theta = &amp;lt;ThetaDCM *&amp;gt; malloc(nt * nb * sizeof(ThetaDCM))&#xA;&#xA;free(c_theta)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This did not compile and reported the following error:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;error: ‘ThetaDCM’ undeclared (first use in this function)&#xA;   __pyx_v_c_theta = ((ThetaDCM *)malloc(((__pyx_v_nt * __pyx_v_nb) * (sizeof(ThetaDCM)))));&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;There where other errors related to this one. If I define ThetaDCM outside the extern block, the code compiles without problem. Therefore, if I import Theta, cython cannot see my declaration. Is there any standard way to solve this?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Edit:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The header of my file was a bit more complicated than what I posted. It was&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;# ifdef __CUDACC__&#xA;# ifndef DDM_HEADER&#xA;# define DDM_HEADER&#xA;&#xA;#include &quot;math.h&quot;&#xA;#include &quot;curand_kernel.h&quot;&#xA;#include &quot;curand.h&quot;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;...&#xA;# endif &#xA;&#xA;# ifdef __CUDACC__&#xA;# define BDDM_EXTERN extern &quot;C&quot;&#xA;# else&#xA;# define BDDM_DEVICE&#xA;# endif&#xA;&#xA;BDDM_EXTERN&#xA;int llh_m0t( double *x, double *y, double *u,&#xA;    double *theta, double *ptheta, int ny, int nt, double *llh);&#xA;...&#xA;typedef struct&#xA;{    &#xA;    double alpha;&#xA;    double gamma;&#xA;    double tau;&#xA;} ThetaDCM;&#xA;&#xA;# endif &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The directive on top is used to check if the compiler is nvcc, a compiler for cuda code. Now I realize that there was an error and that I should have had:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;# ifndef DDM_HEADER&#xA;# define DDM_HEADER&#xA;# ifdef __CUDACC__&#xA;&#xA;#include &quot;math.h&quot;&#xA;#include &quot;curand_kernel.h&quot;&#xA;#include &quot;curand.h&quot;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;...&#xA;# endif&#xA;&#xA;BDDM_EXTERN&#xA;int llh_m0t( double *x, double *y, double *u,&#xA;    double *theta, double *ptheta, int ny, int nt, double *llh);&#xA;...&#xA;&#xA;typedef struct&#xA;{    &#xA;    double alpha;&#xA;    double gamma;&#xA;    double tau;&#xA;} ThetaDCM;&#xA;# endif &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;What confused me is that the &lt;em&gt;cython&lt;/em&gt; code compiled despite of the # ifdef &lt;strong&gt;CUDACC&lt;/strong&gt;. I used cython to wrap c functions defined inside the first #ifdef statement (like llh_m0t), so the confusing thing is that cython could see those function definitions. &lt;/p&gt;&#xA;" OwnerUserId="1302145" LastEditorUserId="1302145" LastEditDate="2014-08-29T11:03:26.533" LastActivityDate="2014-08-29T11:32:09.040" Title="Using typedef'd struct in cython" Tags="&lt;python&gt;&lt;c&gt;&lt;typedef&gt;&lt;cython&gt;" AnswerCount="2" CommentCount="6" />
  <row Id="25620281" PostTypeId="1" CreationDate="2014-09-02T09:37:17.597" Score="0" ViewCount="121" Body="&lt;p&gt;I have two different deployment in my project! for those two deployment i am having different structure members, But with the same structure name. For example I am using the below model to do-&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef SATHISH&#xA;typedef struct{&#xA;       int id;&#xA;       char name[10];&#xA;}data;&#xA;#else&#xA;typedef struct{&#xA;       struct student s1;&#xA;       double average;&#xA;}data;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;In this case when the &lt;code&gt;SATHISH&lt;/code&gt; flag enabled first structure will be evaluated, if the flag is not defined second structure will be evaluated!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there any other best alternative way to do the same thing with out using preprocessor directives (like &lt;code&gt;#ifdef .... #endif&lt;/code&gt; or &lt;code&gt;#ifndef .... #endif&lt;/code&gt;)?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any suggestion is appreciated!&lt;/p&gt;&#xA;" OwnerUserId="3782727" LastEditorUserId="3782727" LastEditDate="2014-09-02T11:19:03.243" LastActivityDate="2014-09-02T12:16:38.397" Title="Is there any other way to avoid conflicting types other then using preprocessor directives?" Tags="&lt;c&gt;&lt;preprocessor-directive&gt;&lt;ifdefine&gt;" AnswerCount="1" CommentCount="8" />
  <row Id="25674476" PostTypeId="1" CreationDate="2014-09-04T20:29:37.620" Score="1" ViewCount="107" Body="&lt;p&gt;im using this &lt;a href=&quot;https://github.com/openjudge/sandbox&quot; rel=&quot;nofollow&quot;&gt;https://github.com/openjudge/sandbox&lt;/a&gt; project to control my program execution on server. I have done almost everything except i cant understand how part of sample code works. The part is:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;int16_t abi32(int scno)&#xA;{&#xA;    assert((scno &amp;gt;= 0) &amp;amp;&amp;amp; (scno &amp;lt; 1024));&#xA;#ifdef __x86_64__&#xA;    return (int16_t)(scno | (1 &amp;lt;&amp;lt; 10));&#xA;#else /* __i386__ */&#xA;    return (int16_t)(scno);&#xA;#endif /* __x86_64__ */&#xA;}&#xA;&#xA;...&#xA;const int16_t sc_safe[] =&#xA;{&#xA;    abi32(0), abi32(3), abi32(4), abi32(19), abi32(45), abi32(54),&#xA;    abi32(90), abi32(91), abi32(122), abi32(125), abi32(140), abi32(163),&#xA;    abi32(192), abi32(197), abi32(224), abi32(243), abi32(252),&#xA;#ifdef __x86_64__&#xA;    0, 1, 5, 8, 9, 10, 11, 12, 16, 25, 63, 158, 219, 231,&#xA;#endif /* __x86_64__ */&#xA;    -1, /* sentinel */&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The sc_safe array is whitelist of syscalls and since they differ between os types, there is macros #ifdef &lt;strong&gt;x86_64&lt;/strong&gt;. But why arent the 32 bit syscalls in #else branch and why should it work for 64bit os if 32bit syscall %eax is increased by 1024? Is it ignored that way or something??&lt;/p&gt;&#xA;" OwnerUserId="916387" LastActivityDate="2014-09-04T20:29:37.620" Title="32 and 64 bit linux system calls" Tags="&lt;linux&gt;&lt;sandbox&gt;&lt;system-calls&gt;" AnswerCount="0" CommentCount="0" />
  <row Id="25707982" PostTypeId="1" CreationDate="2014-09-07T07:16:58.237" Score="1" ViewCount="690" Body="&lt;p&gt;I am working with the timer(TIM2) of stm32f103 to make a clock by set and reset an output pin(PA1) in the interrupt routine of timer. so when i set parameters of timer as below :&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;TIM_BaseInitStructure.TIM_Period=36;                                                    &#xA;TIM_BaseInitStructure.TIM_Prescaler = 0;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;i just saw 478 Khz clock frequency for that output pin in logic Analyzer instead 1Mhz.&#xA;and when i decreased the TIM_Period, clock frequency didn't change and was about 500 Khz.&#xA;what is the problem?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; int main(void)&#xA;{&#xA;GPIO_InitTypeDef GPIO_InitStructure;&#xA;SystemInit();           &#xA;Init_NVIC();                &#xA;&#xA;RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA | RCC_APB2Periph_GPIOB | RCC_APB2Periph_GPIOE | RCC_APB2Periph_AFIO, ENABLE);&#xA;&#xA;/*PA1 CLK TIM2_CH2*/&#xA;GPIO_InitStructure.GPIO_Pin = GPIO_Pin_1 ;               &#xA;GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;&#xA;GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;           &#xA;GPIO_Init(GPIOA ,&amp;amp;GPIO_InitStructure);&#xA;&#xA;/*PB0 CK*/&#xA;GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0 ;               &#xA;GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;&#xA;GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;           &#xA;GPIO_Init(GPIOB ,&amp;amp;GPIO_InitStructure);&#xA;Init_TIMER();               &#xA;while(1)&#xA;{  &#xA;&#xA;}     &#xA;}&#xA; void Init_NVIC(void)&#xA;{   &#xA;NVIC_InitTypeDef    NVIC_InitStructure;&#xA;&#xA;#ifdef  VECT_TAB_RAM                                    &#xA;&#xA;  NVIC_SetVectorTable(NVIC_VectTab_RAM, 0x0);           &#xA;#else  &#xA;&#xA;  NVIC_SetVectorTable(NVIC_VectTab_FLASH, 0x0);           &#xA;#endif&#xA;NVIC_PriorityGroupConfig(NVIC_PriorityGroup_0);     &#xA;&#xA;NVIC_InitStructure.NVIC_IRQChannel = TIM2_IRQn;         &#xA;NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;   &#xA;&#xA;NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;      &#xA;NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;         &#xA;NVIC_Init(&amp;amp;NVIC_InitStructure);                         &#xA;}&#xA;void Init_TIMER(void)&#xA;{&#xA;TIM_TimeBaseInitTypeDef  TIM_BaseInitStructure;         &#xA;TIM_OCInitTypeDef  TIM_OCInitStructure;&#xA;&#xA;RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2, ENABLE);    &#xA;&#xA;TIM_DeInit( TIM2);                                      &#xA;&#xA;TIM_InternalClockConfig(TIM2);                      &#xA;&#xA;TIM_BaseInitStructure.TIM_Period = 18;                                                                  &#xA;&#xA;&#xA;TIM_BaseInitStructure.TIM_Prescaler = 0;                &#xA;&#xA;TIM_BaseInitStructure.TIM_ClockDivision = TIM_CKD_DIV1; &#xA;TIM_BaseInitStructure.TIM_CounterMode = TIM_CounterMode_Up;   &#xA;&#xA;&#xA; TIM_TimeBaseInit(TIM2, &amp;amp;TIM_BaseInitStructure);        &#xA;&#xA;TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_Toggle;&#xA;TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Enable;&#xA;TIM_OCInitStructure.TIM_Pulse = 18;&#xA;TIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High;&#xA;TIM_OC2Init(TIM2, &amp;amp;TIM_OCInitStructure);&#xA;&#xA;TIM_OC2PreloadConfig(TIM2, TIM_OCPreload_Disable);&#xA;&#xA;TIM_ClearFlag(TIM2, TIM_IT_CC2);                     &#xA;&#xA;TIM_ITConfig(TIM2,TIM_IT_CC2, ENABLE);                      &#xA;TIM_Cmd(TIM2, ENABLE);&#xA;&#xA;}&#xA;void TIM2_IRQHandler(void)&#xA;{&#xA;CK=~CK;&#xA;&#xA;if (TIM_GetITStatus(TIM2, TIM_IT_CC2) != RESET)         &#xA;{                                      &#xA;    TIM_ClearITPendingBit(TIM2, TIM_IT_CC2);                    &#xA;}&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/eOGLq.png&quot; alt=&quot;enter image description here&quot;&gt;&lt;/p&gt;&#xA;" OwnerUserId="3781961" LastEditorUserId="3781961" LastEditDate="2014-09-10T10:05:44.083" LastActivityDate="2014-09-10T10:05:44.083" Title="Are there a Limitation for frequency in Timer stm32" Tags="&lt;timer&gt;&lt;stm32&gt;" AnswerCount="0" CommentCount="11" />
  <row Id="25854618" PostTypeId="1" CreationDate="2014-09-15T18:35:59.380" Score="0" ViewCount="80" Body="&lt;p&gt;I have a unit with record definitions and some helper routines.  &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Because there are strings to share the first uses must look like:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;unit SharedStuff;&#xA;&#xA;interface&#xA;&#xA;uses&#xA;  ShareMem,....&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I want to only use the &lt;code&gt;ShareMem&lt;/code&gt; if the unit is used in the context of a dll.  &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there a &lt;code&gt;{$ifdef ...}&lt;/code&gt; that allows me to see if the unit is used by a libary or an executable?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;uses&#xA;  {$ifdef InLibrary}  &amp;lt;&amp;lt;--?&#xA;  ShareMem,&#xA;  {$else}&#xA;  FastMM,&#xA;  {$ifend} &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="650492" LastActivityDate="2014-09-15T18:38:50.560" Title="Is there a compiler define to see if a unit is used by a library?" Tags="&lt;delphi&gt;&lt;dll&gt;&lt;ifdefine&gt;" AnswerCount="0" CommentCount="2" ClosedDate="2014-09-15T18:39:31.017" />
  <row Id="25955898" PostTypeId="1" CreationDate="2014-09-21T04:45:06.743" Score="0" ViewCount="112" Body="&lt;p&gt;I tried to write a simple D Program and use it to access a simple C library but there is unknown error.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My c Code, Box.c&#xA;    #include &quot;Box.h&quot;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;int SayHello( int _int)&#xA;{&#xA;    _int ++;&#xA;    return _int;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;My c header file, Box.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef BOX_H_INCLUDED&#xA;#define BOX_H_INCLUDED&#xA;&#xA;/* export interfaces */&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;int SayHello( int _int);&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif // BOX_H_INCLUDED&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I compile it&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;gcc -c Box.c Box.h&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;resulting files&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Box.o&#xA;Box.h.gch&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I place them to my D Program's project directory&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My D Code&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;module main;&#xA;&#xA;import std.stdio;&#xA;import std.conv;&#xA;import std.c.stdio;&#xA;import clib;&#xA;&#xA;int main(string[] args)&#xA;{&#xA;    // test external c library&#xA;    auto s = to!string(  SayHello(3) ) ;&#xA;    writefln( &quot;my int is &quot;~ s );&#xA;    readln();&#xA;    return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;My D interface file ( clib ), trying to link to my C library &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;module clib;&#xA;&#xA;import std.c.stdio;&#xA;&#xA;extern (C)  int SayHello( int _int);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The error I get when I compile it using codeblocks&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Compiling: hello.d&#xA;Linking console executable: bin/Debug/tutorial03-access-c-library4&#xA;obj/Debug/hello.o: In function `_Dmain':&#xA;/home/hamilton/Tutorial/tutorial03-access-c-library4/hello.d:11: **undefined reference to `SayHello'**&#xA;collect2: ld returned 1 exit status&#xA;Process terminated with status 1 (0 minutes, 0 seconds)&#xA;0 errors, 0 warnings&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Error is &quot;undefined reference to `SayHello'&quot;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;There is no error I get when I compile it using command in console&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ dmd  Box.o hello.d  clib.di&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;it will be very painful if I cannot use codeblocks as I need the debugging functionality. &#xA;Thanks&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Update:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Compiler setting in codeblocks as followed&#xA;Linker for dynamic libs: gcc -m32 -lrt&#xA;Linker for static libs: ar&#xA;Debugger: gdb&lt;/p&gt;&#xA;" OwnerUserId="1596886" LastEditorUserId="876497" LastEditDate="2014-09-22T07:51:29.843" LastActivityDate="2014-09-22T07:51:29.843" Title="D access C library on CentOS 6.5" Tags="&lt;c&gt;&lt;codeblocks&gt;&lt;d&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="26128182" PostTypeId="1" CreationDate="2014-09-30T19:02:24.137" Score="5" ViewCount="444" Body="&lt;p&gt;I got this crash report from Crashlytics &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;UIKit   _wrapRunLoopWithAutoreleasePoolHandler + 36&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And it just happened only one time from total users of my app and I have never seen this crash before when it is in debug version. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;From searching ,it is related to too many &quot;release&quot; but my project is actually using ARCs and all of the 3rd party module ,they are all ARCs . Only one module I found that still have non-ARC is MBProgressHUD .But it call &quot;release&quot; in dealloc() and with #ifdef  !_has_feature(obj_arc)  . So the release should not be called at all . Here is the code &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;- (void)dealloc {&#xA;    [self unregisterFromNotifications];&#xA;    [self unregisterFromKVO];&#xA;#if !__has_feature(objc_arc)&#xA;    [color release];&#xA;    [indicator release];&#xA;    [label release];&#xA;    [detailsLabel release];&#xA;    [labelText release];&#xA;    [detailsLabelText release];&#xA;    [graceTimer release];&#xA;    [minShowTimer release];&#xA;    [showStarted release];&#xA;    [customView release];&#xA;    [labelFont release];&#xA;    [labelColor release];&#xA;    [detailsLabelFont release];&#xA;    [detailsLabelColor release];&#xA;#if NS_BLOCKS_AVAILABLE&#xA;    [completionBlock release];&#xA;#endif&#xA;    [super dealloc];&#xA;#endif&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Can I conclude that this crash is just randomly happened ? Because non of my code call &quot;release&quot; (my app still has a relatively small-user base) &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks in advance&lt;/p&gt;&#xA;" OwnerUserId="1626220" LastEditorUserId="1527934" LastEditDate="2015-05-27T06:21:06.330" LastActivityDate="2015-05-27T06:21:06.330" Title="UIKit _wrapRunLoopWithAutoreleasePoolHandler + 36 : Occurred occasionally from Crashlytics Report" Tags="&lt;ios&gt;&lt;xcode&gt;&lt;cocoa-touch&gt;&lt;crashlytics&gt;&lt;mbprogresshud&gt;" AnswerCount="0" CommentCount="3" FavoriteCount="1" />
  <row Id="26320210" PostTypeId="1" AcceptedAnswerId="26320230" CreationDate="2014-10-11T23:11:47.290" Score="0" ViewCount="79" Body="&lt;p&gt;I've added a bunch of &quot;debug(x)&quot; statements to my code using preprocessing macros in a header file.  I've also implemented a toggle (via an #ifdef / #else structure in the header file) that lets me turn off the debug statements.  I'm having trouble getting this toggle to work and am hoping someone can figure out the reason.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Rather than re-posting the actual code (which is lengthy), I'm including an illustrative example (which does compile).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here's our .h file.  It consists of a macro for a function named &quot;superman&quot;.  The statement should print if and only if KRYPTONITE is not defined in our .c file.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;test.h:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef __test_h__&#xA;#define __test_h__&#xA;&#xA;#ifdef KRYPTONITE&#xA;#define superman(...)&#xA;#else&#xA;#define superman(xs) printf(&quot;%s\n\n&quot;,xs)&#xA;#endif&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;As you can see in the cases below, adding a &quot;#define KRYPTONITE 1&quot; statement to the beginning of our .c file does not toggle off the &quot;superman&quot; function (Case 2 below).  However, we do successfully toggle off if we define KRYPTONITE via a flag in our compile instruction (Case 3).  &lt;/p&gt;&#xA;&#xA;&lt;p&gt;What else do I need to do in order to toggle off the &quot;superman&quot; function via a &quot;#define&quot; statement in the .c file?&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;Case 1: KRYPTONITE not defined in the .c file (it's commented out).  As expected, the statement prints. (The .c file and output is below.)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;test1.c:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &quot;test.h&quot;&#xA;//#define KRYPTONITE&#xA;&#xA;int main (int argc, char *argv[])&#xA;{&#xA;  printf(&quot;\nSuperman, are you here?\n\n&quot;);&#xA;  superman(&quot;I'm here&quot;);&#xA;  return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Output:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;dchaudh@dchaudhUbuntu:~/SO$ gcc test1.c -o test1&#xA;dchaudh@dchaudhUbuntu:~/SO$ ./test1&#xA;&#xA;Superman, are you here?&#xA;I'm here&#xA;&#xA;dchaudh@dchaudhUbuntu:~/SO$&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;Case 2: KRYPTONITE is defined in our .c file, yet the statement prints.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;test2.c:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &quot;test.h&quot;&#xA;&#xA;#define KRYPTONITE&#xA;&#xA;int main (int argc, char *argv[])&#xA;{&#xA;  printf(&quot;\nSuperman, are you here?\n\n&quot;);&#xA;  superman(&quot;I'm here&quot;);&#xA;  return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Output:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;dchaudh@dchaudhUbuntu:~/SO$ gcc test2.c -o test2&#xA;dchaudh@dchaudhUbuntu:~/SO$ ./test2&#xA;&#xA;Superman, are you here?&#xA;I'm here&#xA;&#xA;dchaudh@dchaudhUbuntu:~/SO$&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;Case 3: KRYPTONITE is not defined in our .c file but we define it via a flag when compiling.  In this case, the superman function is successfully toggled off.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Output:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;dchaudh@dchaudhUbuntu:~/SO$ gcc -DKRYPTONITE test1.c -o test3&#xA;dchaudh@dchaudhUbuntu:~/SO$ ./test3&#xA;&#xA;Superman, are you here?&#xA;&#xA;dchaudh@dchaudhUbuntu:~/SO$&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="4089188" LastEditorUserId="4370109" LastEditDate="2016-05-21T12:15:44.823" LastActivityDate="2016-05-21T12:15:44.823" Title="C: Confused about preprocessor macros" Tags="&lt;c&gt;&lt;macros&gt;&lt;c-preprocessor&gt;" AnswerCount="1" CommentCount="5" />
  <row Id="26407608" PostTypeId="1" CreationDate="2014-10-16T14:59:52.847" Score="0" ViewCount="108" Body="&lt;p&gt;I was trying to create a shorthand for the following code.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef   TEST_DEF  &#xA;#define  MY_TEST_DEF TEST_DEF &#xA;#else&#xA;#define  MY_TEST_DEF 120 &#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;How do I write the above code as a single line macro  &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;SAFE_DEF(TEST_DEF,MY_TEST_DEF,120)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="472485" LastActivityDate="2014-10-23T10:50:59.910" Title="Macro for a multi line C preprocessor directive" Tags="&lt;c&gt;&lt;c-preprocessor&gt;&lt;compiler-directives&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="0" />
  <row Id="26624020" PostTypeId="1" CreationDate="2014-10-29T06:32:24.200" Score="-1" ViewCount="315" Body="&lt;p&gt;I usually write my debugging code inside an &lt;code&gt;ifdef-endif&lt;/code&gt; block. The block is turned on by a macro, which is named in a certain way: Eg. &lt;code&gt;DRAW_DEBUG&lt;/code&gt;, &lt;code&gt;TOPO_DEBUG&lt;/code&gt;, &lt;code&gt;MTS_DEBUG&lt;/code&gt; - i.e., all debug code is controlled by some macro ending with '&lt;code&gt;_DEBUG&lt;/code&gt;'. Thus, a typical debug code-block looks like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef DRAW_DEBUG&#xA;    //Do something&#xA;    // Do something else&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I want to highlight all such debug code blocks in Vim. It should be easy to do since such blocks are easy to identify. How can I do this?&lt;/p&gt;&#xA;" OwnerUserId="364651" LastActivityDate="2014-10-29T07:58:07.847" Title="Vim: How to highlight code inside #ifdef - #endif block?" Tags="&lt;vim&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="26729319" PostTypeId="1" CreationDate="2014-11-04T06:55:34.003" Score="5" ViewCount="860" Body="&lt;p&gt;My code uses libcxx, sdl and some other libs all the time. How can I generate .pch taking into account every header can include some other headers (even with complex conditions like #ifdef #include #endif. That's why it's difficult to understand needed header files list. Should I just use just all header files found in that folders to create .pch? What about usage of such .pch performance in that case?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;UPDATE: if it matters i'm going to use it with Clang (not GCC) and to be more specific via Clang C API.&#xA;UPDATE2:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;i've created pch for single header file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;MBA-Anton:pch asmirnov$ clang++ -x c++-header header.h -emit-pch -o header.pch&#xA;MBA-Anton:pch asmirnov$ clang++ -include-pch header.pch source.cpp -o source -x c++&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but i was unable to generate pch for multiple files:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;MBA-Anton:pch asmirnov$ clang++ -x c++-header header.h header2.h -emit-pch -o headers.pch&#xA;clang: error: cannot specify -o when generating multiple output files&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1103561" LastEditorUserId="1103561" LastEditDate="2014-11-05T18:14:39.650" LastActivityDate="2014-11-05T18:14:39.650" Title="How to generate .pch for lots of headers?" Tags="&lt;c++&gt;&lt;gcc&gt;&lt;clang&gt;&lt;pch&gt;" AnswerCount="2" CommentCount="1" />
  <row Id="26782897" PostTypeId="1" AcceptedAnswerId="26977349" CreationDate="2014-11-06T15:16:19.647" Score="1" ViewCount="515" Body="&lt;p&gt;Found the cause, answer below. &lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;I just cloned a remote git repository. It has a workspace with 2 projects. The main and the Pods. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;When I try to run my main project, I got an error &lt;/p&gt;&#xA;&#xA;&lt;p&gt;&quot;Lexical or preprocessor Issue: '../Pods-Environment.h' file not found.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The UI7Kit is importing this file, &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//&#xA;//  UI7Kit.h&#xA;//  UI7Kit&#xA;//&#xA;//  Created by Jeong YunWon on 13. 6. 11..&#xA;//  Copyright (c) 2013 youknowone.org. All rights reserved.&#xA;//&#xA;&#xA;/*!&#xA; *      #import &amp;lt;UI7Kit/UI7Kit.h&amp;gt;&#xA; *      [UI7Kit pssatchIfNeeded]; // in main.m, before UIApplicationMain()&#xA; */&#xA;&#xA;&#xA;#ifdef    COCOAPODS&#xA;#include    &quot;../Pods-environment.h&quot;&#xA;#else // no cocoapods, so enable everything&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I tried to resynch, but nothing is different, any idea how to fix this?&lt;/p&gt;&#xA;" OwnerUserId="2300224" LastEditorUserId="2300224" LastEditDate="2014-11-17T16:36:37.757" LastActivityDate="2014-11-17T16:36:37.757" Title="'../Pods-Environment.h' file not found" Tags="&lt;objective-c&gt;&lt;xcode&gt;&lt;cocoapods&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="27104182" PostTypeId="1" AcceptedAnswerId="27104708" CreationDate="2014-11-24T11:50:30.053" Score="-1" ViewCount="100" Body="&lt;p&gt;I've been tried to make working a program, the compiler don't show me neither warnings nor errors, just shows me RUN FINISHED Segmentation fault core dumped, I guess it has something to do with assignment of the values to the pointers but I didn't find the error, Could you help me?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Struct person&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef PERSONSTRUCT_H&#xA;#define PERSONSTRUCT_H&#xA;#define TRUE 1&#xA;#define FALSE 0&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;typedef struct {&#xA;    int edad;&#xA;    char nombre[100];&#xA;}persona;&#xA;&#xA;persona *getNodoPerson();&#xA;void setEdad(int, persona *);&#xA;void setNombre(char *, persona *);&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;struct nodo&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define TRUE 1&#xA;#define FALSE 0&#xA;#ifndef LISTASIMPLEMENLAZADA_H&#xA;#define LISTASIMPLEMENLAZADA_H&#xA;#include &quot;PersonStruct.h&quot;&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;    struct nodo{&#xA;        struct nodo *siguiente;&#xA;        persona *person;&#xA;    };&#xA;&#xA;    typedef struct nodo *ptrNodo;&#xA;    typedef struct nodo *lista;&#xA;&#xA;    void freeNode(ptrNodo);&#xA;    ptrNodo getNodo();&#xA;    int empty(lista);&#xA;    ptrNodo buscar(char[],int, lista);&#xA;    int contar(lista);&#xA;    void addAtEnd(char *, int, lista);&#xA;    void del(lista,char *,int);&#xA;    void imprimirDatos(lista);&#xA;    int getPos(lista, persona *);&#xA;    lista getLista();&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Functions for struct nodo&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;ListaSimplemEnlazada.h&quot;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;&#xA;//Esta funcion elimina de memoria el nodo enviado &#xA;void freeNode(ptrNodo p)&#xA;{&#xA;    free(p);&#xA;}&#xA;&#xA;//Esta funcion crea el espacio de memoria para un nodo&#xA;ptrNodo getNodo()&#xA;{&#xA;    ptrNodo p;&#xA;    p=(ptrNodo)malloc(sizeof(struct nodo));&#xA;    return p;&#xA;}&#xA;&#xA;lista getLista()&#xA;{&#xA;    lista l;&#xA;    l=(lista)malloc(sizeof(struct nodo));&#xA;    l-&amp;gt;person=NULL;&#xA;    return l;&#xA;}&#xA;&#xA;//Esta funcion revisa si una lista esta vacia;&#xA;int empty(lista l)&#xA;{&#xA;    int x;&#xA;    if(l-&amp;gt;siguiente==NULL)&#xA;    {&#xA;        x=TRUE;&#xA;    }&#xA;    else&#xA;    {&#xA;        x=FALSE;&#xA;    }&#xA;&#xA;    return x;&#xA;}&#xA;&#xA;//Esta funcion cuenta el numero de elementos que tiene una lista enlazada&#xA;int contar(lista l)&#xA;{&#xA;    int cont=0;&#xA;    ptrNodo aux=getNodo();&#xA;    aux=l-&amp;gt;siguiente;&#xA;    while(aux!=NULL)&#xA;    {&#xA;        aux=aux-&amp;gt;siguiente;&#xA;        cont++;&#xA;    }&#xA;    return cont;&#xA;}&#xA;&#xA;//Esta funcion busca en la lista especificada, el nodo en el que se encuentra la estructura se encuentra especificada&#xA;//si la estructura es encontrada, devuelve un puntero al nodo donde esta la estructura &#xA;//si no devuelve un puntero nulo&#xA;ptrNodo buscar(char *nom,int age, lista l)&#xA;{&#xA;    ptrNodo aux=getNodo(),retorno=getNodo();&#xA;    retorno=NULL;&#xA;    if(!empty(l))&#xA;    {&#xA;        aux=l-&amp;gt;siguiente;&#xA;        while(aux!=NULL)&#xA;        {&#xA;            if ((aux-&amp;gt;person-&amp;gt;edad==age) &amp;amp;&amp;amp; (strcmp(aux-&amp;gt;person-&amp;gt;nombre,nom)==0))&#xA;            {&#xA;                retorno=aux;&#xA;                break;&#xA;            }&#xA;            aux=aux-&amp;gt;siguiente;&#xA;        }&#xA;    }&#xA;    return retorno;&#xA;}&#xA;&#xA;//Ingresa un nodo al final de la lista, si la lista es vacia, lo ingresa como el primer elemento de la lista&#xA;void addAtEnd(char *nombre,int age,lista l)&#xA;{&#xA;    ptrNodo aux1=getNodo(),aux2=getNodo();&#xA;    aux2-&amp;gt;person-&amp;gt;edad=age;&#xA;    strcpy(aux2-&amp;gt;person-&amp;gt;nombre,nombre);&#xA;    aux2-&amp;gt;siguiente=NULL;&#xA;    if(!empty(l))&#xA;    {&#xA;        aux1=buscar(nombre,age,l);&#xA;        if(aux1==NULL)&#xA;        {&#xA;            aux1=l-&amp;gt;siguiente;&#xA;            while(aux1!=NULL)&#xA;            {&#xA;                aux1=aux1-&amp;gt;siguiente;&#xA;            }&#xA;            aux1-&amp;gt;siguiente=aux2;&#xA;        }&#xA;        else&#xA;        {&#xA;            printf(&quot;El valor ya se encuentra en la lista&quot;);&#xA;        }&#xA;    }&#xA;    else&#xA;    {&#xA;        l-&amp;gt;siguiente=aux2;&#xA;    }&#xA;&#xA;}&#xA;&#xA;//Envia la posicion numerica del nodo en la lista, retornara 0 si no encuentra el nodo&#xA;int getPos(lista l, persona *p)&#xA;{&#xA;    ptrNodo aux=getNodo();&#xA;    int x=0;&#xA;    if(!empty(l))&#xA;    {&#xA;        aux=buscar(p-&amp;gt;nombre,p-&amp;gt;edad,l);&#xA;        if(aux!=NULL)&#xA;        {&#xA;            aux=l-&amp;gt;siguiente;&#xA;            while(aux-&amp;gt;person-&amp;gt;edad==p-&amp;gt;edad &amp;amp;&amp;amp; (strcmp(aux-&amp;gt;person-&amp;gt;nombre,p-&amp;gt;nombre)==0))&#xA;            {&#xA;                x++;&#xA;                aux=aux-&amp;gt;siguiente;&#xA;            }&#xA;        }&#xA;    }&#xA;    return x;&#xA;}&#xA;&#xA;//Este metodo elimina el valor de lista&#xA;void del(lista l,char *nom,int age)&#xA;{&#xA;    ptrNodo aux1=getNodo(),aux2=getNodo();&#xA;    int x,i;&#xA;    if(!empty(l))&#xA;    {&#xA;            aux1=buscar(nom,age,l);&#xA;            if(aux1!=NULL)&#xA;            {&#xA;                x=getPos(l,aux1-&amp;gt;person);&#xA;                aux2=l-&amp;gt;siguiente;&#xA;                for(i=1;i&amp;lt;=(x-1);i++)&#xA;                {&#xA;                    aux2=aux2-&amp;gt;siguiente;&#xA;                }&#xA;                aux2-&amp;gt;siguiente=aux1-&amp;gt;siguiente;&#xA;                printf(&quot;\nLa persona %s y edad %d&quot;,aux1-&amp;gt;person-&amp;gt;nombre,aux1-&amp;gt;person-&amp;gt;edad);&#xA;                freeNode(aux1);&#xA;            }&#xA;     }&#xA;}&#xA;&#xA;void imprimirDatos(lista l)&#xA;{&#xA;    ptrNodo aux=getNodo();&#xA;    int i=1;&#xA;    if(!empty(l))&#xA;    {&#xA;        aux=l-&amp;gt;siguiente;&#xA;        while(aux!=NULL)&#xA;        {&#xA;            printf(&quot;\nLa persona numero %d con \tNombre:%s y edad:%d&quot;,i,aux-&amp;gt;person-&amp;gt;nombre,aux-&amp;gt;person-&amp;gt;edad);&#xA;            i++;&#xA;        }&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;main&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &quot;ListaSimplemEnlazada.h&quot;&#xA;#include &quot;PersonStruct.h&quot;&#xA;&#xA;/*&#xA; * &#xA; */&#xA;int main(int argc, char** argv) {&#xA;    argc=argc;&#xA;    argv=argv;&#xA;&#xA;    char *nombres[5]={&quot;Alberto&quot;, &quot;Manuel&quot;,&quot;Enrique&quot;,&quot;Josue&quot;,&quot;Ronald&quot;};&#xA;    int edad[5]={25,39,45,12,21};&#xA;    int i;&#xA;    lista l=getLista();&#xA;    for (i=0;i&amp;lt;=4;i++)&#xA;    {&#xA;        addAtEnd(nombres[i],edad[i],l);&#xA;    }&#xA;    imprimirDatos(l);&#xA;    del(l,nombres[0],edad[0]);&#xA;    imprimirDatos(l &#xA;             );&#xA;&#xA;    return (EXIT_SUCCESS);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;sorry for the big amount of code but perhaps you will need it for understanding what I've done wrong with my program &lt;/p&gt;&#xA;" OwnerUserId="2688080" LastActivityDate="2014-11-24T12:16:51.367" Title="program doesn't run(getting RUN FINISHED Segmentation fault core dumped)" Tags="&lt;c&gt;&lt;struct&gt;" AnswerCount="1" CommentCount="5" FavoriteCount="1" />
  <row Id="27170165" PostTypeId="1" AcceptedAnswerId="27351558" CreationDate="2014-11-27T11:55:50.177" Score="0" ViewCount="250" Body="&lt;p&gt;Is there a way to replace a class name #import through a #define macro? I want it to be made in all my project and not just in one file. So I don't want to make a #ifdef / #ifndef in each class that include the #import that I want to replace.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Something like... I have &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#import &quot;ClassSomething.h&quot; &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;in 5 classes. I want to replace it with an &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#import &quot;ClassSomethingCustom.h&quot; &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but only &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef SomethingIsDefined&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1329644" LastActivityDate="2014-12-08T04:43:34.860" Title="Objective-c - Replace #import with #define" Tags="&lt;objective-c&gt;&lt;xcode&gt;&lt;preprocessor-directive&gt;" AnswerCount="4" CommentCount="4" />
  <row Id="27399366" PostTypeId="1" AcceptedAnswerId="27416085" CreationDate="2014-12-10T11:02:47.353" Score="1" ViewCount="405" Body="&lt;p&gt;i have written a simple s-function which calls a function inside a c code which models the single track model. i am using constant variables for storing mass,yaw moment of inertia,steering ratio etc. I wanted to know how to make these variables tunable. i want to create a subsystem out of my s-function and then use realtime workshop-&gt;generate s-function and select the tunable parameters from the list. but for now am not able to find any tunable parameters since i have not specified anything as tunable&lt;/p&gt;&#xA;&#xA;&lt;p&gt;this is my s-function code&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define S_FUNCTION_NAME  single_track&#xA;#define S_FUNCTION_LEVEL 2&#xA;&#xA;#include &quot;simstruc.h&quot;&#xA;&#xA;&#xA;#include &quot;single_track_func.c&quot;&#xA;&#xA;&#xA;#define MDL_START  /* Change to #undef to remove function */ &#xA;#if defined(MDL_START) &#xA;&#xA;static void mdlStart(SimStruct *S) &#xA;  { &#xA;&#xA;    initialization();&#xA;&#xA;  } &#xA;#endif&#xA;&#xA;&#xA;static void mdlInitializeSizes(SimStruct *S)&#xA;{&#xA;    ssSetNumSFcnParams(S, 0);&#xA;&#xA;&#xA;    if (ssGetNumSFcnParams(S) != ssGetSFcnParamsCount(S)) {&#xA;        return; /* Parameter mismatch will be reported by Simulink */&#xA;    }&#xA;&#xA;    if (!ssSetNumInputPorts(S, 2)) return;&#xA;    ssSetInputPortWidth(S, 0, 1);&#xA;    ssSetInputPortDirectFeedThrough(S, 0, 1);&#xA;    ssSetInputPortWidth(S, 1, 1);&#xA;    ssSetInputPortDirectFeedThrough(S, 1, 1);&#xA;&#xA;&#xA;    if (!ssSetNumOutputPorts(S,3)) return;&#xA;    ssSetOutputPortWidth(S, 0, 1);&#xA;    ssSetOutputPortWidth(S, 1, 1);&#xA;    ssSetOutputPortWidth(S, 2, 1);&#xA;   ssSetNumSampleTimes(S, 1);&#xA;&#xA;&#xA;    ssSetSimStateCompliance(S, USE_DEFAULT_SIM_STATE);&#xA;&#xA;&#xA;    ssSetOptions(S,&#xA;                 SS_OPTION_WORKS_WITH_CODE_REUSE |&#xA;                 SS_OPTION_EXCEPTION_FREE_CODE |&#xA;                 SS_OPTION_USE_TLC_WITH_ACCELERATOR);&#xA;}&#xA;&#xA;static void mdlInitializeSampleTimes(SimStruct *S)&#xA;{&#xA;    ssSetSampleTime(S, 0, INHERITED_SAMPLE_TIME);&#xA;    ssSetOffsetTime(S, 0, 0.0);&#xA;    ssSetModelReferenceSampleTimeDefaultInheritance(S); &#xA;}&#xA;&#xA;&#xA;static void mdlOutputs(SimStruct *S, int_T tid)&#xA;{&#xA;    retvale obj_b;&#xA;&#xA;    InputRealPtrsType v_1 = ssGetInputPortRealSignalPtrs(S,0);               //velocity&#xA;    InputRealPtrsType delta_1 = ssGetInputPortRealSignalPtrs(S,1);         //steering angle&#xA;&#xA;    real_T            *a_y_1    = ssGetOutputPortRealSignal(S,0);          //lateral acceleration           &#xA;    real_T            *psi_dot_1    = ssGetOutputPortRealSignal(S,1);      //yaw velocity   &#xA;    real_T            *beta_1    = ssGetOutputPortRealSignal(S,2);         //attitude angle   &#xA;&#xA;&#xA;&#xA;                obj_b=singletrack((double)*(*v_1),(double)*(*delta_1));&#xA;                *a_y_1    = obj_b.a_y;          //lateral acceleration           &#xA;                *psi_dot_1 =obj_b.psi_dot;       //yaw velocity   &#xA;                *beta_1    =obj_b.beta;&#xA;&#xA;}&#xA;&#xA;static void mdlTerminate(SimStruct *S)&#xA;{&#xA;}&#xA;&#xA;&#xA;&#xA;#ifdef  MATLAB_MEX_FILE    /* Is this file being compiled as a MEX-file? */&#xA;#include &quot;simulink.c&quot;      /* MEX-file interface mechanism */&#xA;#else&#xA;#include &quot;cg_sfun.h&quot;       /* Code generation registration function */&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and this is the logic file which has the function singletrack()&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;single_track_func.h&quot;&#xA;&#xA;float a_1_1,a_1_2,a_2_1,a_2_2,b_1_1,b_2_1,psi_dot_prev,beta_prev;&#xA;int count;&#xA;&#xA;const int cv=75000;                  //cornering stiffness front      &#xA;const int ch=150000;                //cornering stiffness rear axle          &#xA;const int m=1550;                                    //mass of the vehicle kg&#xA;const int lv=1.344;                 //distance from center of gravity to front wheel&#xA;const int lh=1.456;                 //distance from center of gravity to rear wheel  &#xA;const int theta=2800;                //yaw moment of inertia      &#xA;const int I_s=16;                    //overall steering ratio      &#xA;const float dt=0.001;&#xA;&#xA;retvale singletrack(double a,double b)&#xA;{&#xA;    retvale my_obj;&#xA;&#xA;&#xA;&#xA;    static float beta_dot=0; &#xA;    static float psi_double_dot=0; &#xA;    static float beta_previous=0; &#xA;    static float psi_dot_previous=0;&#xA;&#xA;&#xA;    beta_previous       = beta_prev;&#xA;    psi_dot_previous    = psi_dot_prev;&#xA;    a_1_1               = ((-cv-ch)/((m)*(a)));&#xA;    a_1_2               = ((m*(a)*(a))-((ch*lh)-(cv*lv)))/(m*(a)*(a));    &#xA;    a_2_1               = (-(ch*lh)+(cv*lv))/theta;&#xA;    a_2_2               = ((-ch*lh*lh)-(cv*lv*lv))/(theta*(a));&#xA;    b_1_1               = -cv/(m*(a));&#xA;    b_2_1               = (cv*lv)/(theta);&#xA;&#xA;    beta_dot            = a_1_1 * beta_previous + a_1_2 * psi_dot_previous - b_1_1*((b)/I_s);&#xA;    psi_double_dot      = a_2_1 * beta_previous + a_2_2 * psi_dot_previous + b_2_1*((b)/I_s);                             &#xA;    my_obj.beta             = beta_dot          * dt + beta_previous;&#xA;    my_obj.psi_dot          = psi_double_dot    * dt + psi_dot_previous;&#xA;    my_obj.a_y              = (a*((my_obj.psi_dot)-(beta_dot)));&#xA;    beta_prev=my_obj.beta;&#xA;    psi_dot_prev=my_obj.psi_dot; &#xA;    return my_obj;&#xA;&#xA;}&#xA;void initialization()&#xA;{&#xA;    psi_dot_prev=0;&#xA;    beta_prev=0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and the corresponding .h file&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef _SINGLE_TRACK_FUNC_&#xA;#define _SINGLE_TRACK_FUNC_&#xA;&#xA;typedef struct retvale&#xA;{&#xA;double a_y;&#xA;double psi_dot;&#xA;double beta;&#xA;} retvale;&#xA;&#xA;extern struct retvale singletrack(double a,double b);&#xA;extern void initialization();&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I know i have to use ssSetSFcnParamTunable() but even after looking at examples have no idea how to do it!!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;update:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;i declared the variables as global real_T&#xA;real_T  *m_s,*cv_s,*ch_s,*lv_s,*lh_s,*theta_s,*I_s_s,*dt_s;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;and added these lines of codes in my mdlInitializeSizes(). i mex it and everything is fine. but when i use the s-function block and just change the name of the s-function to the mex file the matlab crashes. also i pass these arguments as pointers to my  single_track () function&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ssSetNumSFcnParams(S, 8);&#xA; m_s=mxGetPr(ssGetSFcnParam(S,0));&#xA; cv_s=mxGetPr(ssGetSFcnParam(S,1));&#xA; ch_s=mxGetPr(ssGetSFcnParam(S,2));&#xA; lv_s=mxGetPr(ssGetSFcnParam(S,3));&#xA; lh_s=mxGetPr(ssGetSFcnParam(S,4));&#xA; theta_s=mxGetPr(ssGetSFcnParam(S,5));&#xA; I_s_s=mxGetPr(ssGetSFcnParam(S,6));&#xA; dt_s=mxGetPr(ssGetSFcnParam(S,7));&#xA; ssSetSFcnParamTunable(S,0,SS_PRM_SIM_ONLY_TUNABLE);&#xA; ssSetSFcnParamTunable(S,1,SS_PRM_SIM_ONLY_TUNABLE);&#xA; ssSetSFcnParamTunable(S,2,SS_PRM_SIM_ONLY_TUNABLE);&#xA; ssSetSFcnParamTunable(S,3,SS_PRM_SIM_ONLY_TUNABLE);&#xA; ssSetSFcnParamTunable(S,4,SS_PRM_SIM_ONLY_TUNABLE);&#xA; ssSetSFcnParamTunable(S,5,SS_PRM_SIM_ONLY_TUNABLE);&#xA; ssSetSFcnParamTunable(S,6,SS_PRM_SIM_ONLY_TUNABLE);&#xA; ssSetSFcnParamTunable(S,7,SS_PRM_SIM_ONLY_TUNABLE);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;any idea why there is a crash?&lt;/p&gt;&#xA;" OwnerUserId="4194177" LastEditorUserId="4194177" LastEditDate="2014-12-11T09:58:55.063" LastActivityDate="2014-12-11T09:58:55.063" Title="how to make constant variables being used in s-functions as tunable in matlab" Tags="&lt;matlab&gt;&lt;variables&gt;&lt;simulink&gt;&lt;s-function&gt;" AnswerCount="1" CommentCount="1" FavoriteCount="0" />
  <row Id="27411947" PostTypeId="1" CreationDate="2014-12-10T22:20:03.937" Score="0" ViewCount="217" Body="&lt;p&gt;I am trying to make the native code from &lt;a href=&quot;https://software.intel.com/sites/default/files/managed/79/e5/OpenGL%20ES%20Tessellation.zip&quot; rel=&quot;nofollow&quot;&gt;https://software.intel.com/sites/default/files/managed/79/e5/OpenGL%20ES%20Tessellation.zip&lt;/a&gt; work on my Samsung Galaxy S5. I have disabled Tessellation in the code. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have also changed the code to use OpenGLS ES 3.0. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;The program runs and successfully compiles the attached shader but when the program calls glLinkProgram with compiled shader, glLinkProgram crashes. The program calls glError when compiling the shader and there is no error at that time. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Can someone help me how to debug this? &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//--------------------------------------------------------------------------------------&#xA;// Copyright 2014 Intel Corporation&#xA;// All Rights Reserved&#xA;//&#xA;// Permission is granted to use, copy, distribute and prepare derivative works of this&#xA;// software for any purpose and without fee, provided, that the above copyright notice&#xA;// and this statement appear in all copies.  Intel makes no representations about the&#xA;// suitability of this software for any purpose.  THIS SOFTWARE IS PROVIDED &quot;AS IS.&quot;&#xA;// INTEL SPECIFICALLY DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, AND ALL LIABILITY,&#xA;// INCLUDING CONSEQUENTIAL AND OTHER INDIRECT DAMAGES, FOR THE USE OF THIS SOFTWARE,&#xA;// INCLUDING LIABILITY FOR INFRINGEMENT OF ANY PROPRIETARY RIGHTS, AND INCLUDING THE&#xA;// WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  Intel does not&#xA;// assume any responsibility for any errors which may appear in this software nor any&#xA;// responsibility to update it.&#xA;//--------------------------------------------------------------------------------------&#xA;// Generated by ShaderGenerator.exe version 0.13&#xA;//--------------------------------------------------------------------------------------&#xA;&#xA;// Fog color in both shaders&#xA;// Skybox&#xA;&#xA;const float TessellationHeight = 5500.0; // Height of a 1.0 in the height map (height map * TessellationHeight)&#xA;&#xA;const int NumLights = 2;&#xA;const vec3 LightDirections[NumLights] = vec3[]( vec3(-1.0, -1.0,  -1.0),&#xA;                                                vec3(0.5, -1.0,  1.0) );&#xA;const vec3 LightColors[NumLights] = vec3[]( vec3(0.362, 0.526, 0.575),&#xA;                                            vec3(0.630, 0.914, 1.0));&#xA;&#xA;// -------------------------------------&#xA;layout (std140, row_major) uniform cbPerModelValues&#xA;{&#xA;   mat4 World;&#xA;   mat4 NormalMatrix;&#xA;   mat4 WorldViewProjection;&#xA;   mat4 InverseWorld;&#xA;   mat4 LightWorldViewProjection;&#xA;   vec4 BoundingBoxCenterWorldSpace;&#xA;   vec4 BoundingBoxHalfWorldSpace;&#xA;   vec4 BoundingBoxCenterObjectSpace;&#xA;   vec4 BoundingBoxHalfObjectSpace;&#xA;};&#xA;&#xA;// -------------------------------------&#xA;layout (std140, row_major) uniform cbPerFrameValues&#xA;{&#xA;   mat4  View;&#xA;   mat4  InverseView;&#xA;   mat4  Projection;&#xA;   mat4  ViewProjection;&#xA;   vec4  AmbientColor;&#xA;   vec4  LightColor;&#xA;   vec4  LightDirection;&#xA;   vec4  EyePosition;&#xA;   vec4  MaxTessellation;&#xA;};&#xA;// -------------------------------------&#xA;uniform sampler2D Texture0;&#xA;uniform sampler2D Texture1;&#xA;uniform sampler2D Texture2;&#xA;// -------------------------------------&#xA;#ifdef GLSL_VERTEX_SHADER&#xA;precision highp float;&#xA;&#xA;#define POSITION  0&#xA;#define NORMAL    1&#xA;#define BINORMAL  2&#xA;#define TANGENT   3&#xA;#define COLOR   4&#xA;#define TEXCOORD0 5&#xA;// -------------------------------------&#xA;layout (location = POSITION)  in vec3 Position; // Projected position&#xA;layout (location = NORMAL)    in vec3 Normal;&#xA;layout (location = TANGENT)   in vec3 Tangent;&#xA;layout (location = BINORMAL)  in vec3 Binormal;&#xA;layout (location = TEXCOORD0) in vec2 UV0;&#xA;// -------------------------------------&#xA;out vec4 outPosition;&#xA;out vec3 outNormal;&#xA;out vec3 outTangent;&#xA;out vec3 outBinormal;&#xA;out vec2 outUV0;&#xA;out vec3 outWorldPosition; // Object space position &#xA;#endif //GLSL_VERTEX_SHADER&#xA;#ifdef GLSL_FRAGMENT_SHADER&#xA;precision highp float;&#xA;// -------------------------------------&#xA;in vec4 outPosition;&#xA;in vec3 outNormal;&#xA;in vec3 outTangent;&#xA;in vec3 outBinormal;&#xA;in vec2 outUV0;&#xA;in vec3 outWorldPosition; // Object space position &#xA;in vec3 outTriDistance;&#xA;// -------------------------------------&#xA;vec4 DIFFUSETMP( )&#xA;{&#xA;    return texture(Texture0,(((outUV0)) *(20.0)) );&#xA;}&#xA;&#xA;// -------------------------------------&#xA;vec4 NORMAL( )&#xA;{&#xA;    return texture(Texture1,(((outUV0)) *(1.0)) ) * 2.0 - 1.0;&#xA;}&#xA;&#xA;// -------------------------------------&#xA;vec4 AOMAP( )&#xA;{&#xA;    return texture(Texture2,(((outUV0)) *(1.0)) );&#xA;}&#xA;&#xA;// -------------------------------------&#xA;vec4 DIFFUSE( )&#xA;{&#xA;    vec4 diffuse = DIFFUSETMP() * AOMAP();&#xA;#ifdef OPENGL_ES&#xA;    diffuse.rgb = pow(diffuse.rgb, vec3(2.2));&#xA;#endif&#xA;    return diffuse*vec4(2.0);&#xA;}&#xA;&#xA;// -------------------------------------&#xA;vec4 AMBIENT( )&#xA;{&#xA;    return DIFFUSE();&#xA;}&#xA;&#xA;// -------------------------------------&#xA;#endif //GLSL_FRAGMENT_SHADER&#xA;&#xA;#ifdef GLSL_VERTEX_SHADER&#xA;// -------------------------------------&#xA;void main( )&#xA;{&#xA;    outPosition = vec4( Position, 1.0);&#xA;    outWorldPosition = (outPosition * World).xyz;&#xA;    outNormal   = Normal   * mat3(World);&#xA;    outTangent  = Tangent  * mat3(World);&#xA;    outBinormal = Binormal * mat3(World);&#xA;    outUV0 = UV0;&#xA;}&#xA;&#xA;#endif //GLSL_VERTEX_SHADER&#xA;#ifdef  GLSL_TESS_CONTROL_SHADER&#xA;&#xA;precision highp float;&#xA;&#xA;#ifdef OPENGL_ES&#xA;#extension GL_INTEL_tessellation:require&#xA;#endif&#xA;&#xA;layout(vertices = 3) out;&#xA;&#xA;in vec4 outPosition[];&#xA;in vec3 outNormal[];&#xA;in vec3 outTangent[];&#xA;in vec3 outBinormal[];&#xA;in vec2 outUV0[];&#xA;in vec3 outWorldPosition[];&#xA;&#xA;out  vec4  tcPosition[3];&#xA;out  vec3  tcNormal[3];&#xA;out  vec3  tcTangent[3];&#xA;out  vec3  tcBinormal[3];&#xA;out  vec2  tcUV0[3];&#xA;out  vec3  tcWorldPosition[3];&#xA;&#xA;float level(float d)&#xA;{&#xA;    d = d/55000.0; // d = [0..1]&#xA;    float s = clamp(1.0*(d), 0.0, 1.0);&#xA;    return mix(MaxTessellation.x,1.0, s);&#xA;}&#xA;void main()&#xA;{&#xA;    tcPosition[gl_InvocationID] = outPosition[gl_InvocationID];&#xA;    tcWorldPosition[gl_InvocationID] = outWorldPosition[gl_InvocationID];&#xA;&#xA;    tcNormal[gl_InvocationID] = outNormal[gl_InvocationID];&#xA;    tcBinormal[gl_InvocationID] = outBinormal[gl_InvocationID];&#xA;    tcTangent[gl_InvocationID] = outTangent[gl_InvocationID];&#xA;    tcUV0[gl_InvocationID] = outUV0[gl_InvocationID];&#xA;&#xA;    if(gl_InvocationID == 0) {&#xA;        vec3 CamPos = EyePosition.xyz;&#xA;&#xA;        float d0 = distance(CamPos, outWorldPosition[0]);&#xA;        float d1 = distance(CamPos, outWorldPosition[1]);&#xA;        float d2 = distance(CamPos, outWorldPosition[2]);&#xA;&#xA;        gl_TessLevelOuter[2] = level(mix(d0,d1,0.5));&#xA;        gl_TessLevelOuter[0] = level(mix(d1,d2,0.5));&#xA;        gl_TessLevelOuter[1] = level(mix(d2,d0,0.5));&#xA;&#xA;        float inner = max(max(gl_TessLevelOuter[0], gl_TessLevelOuter[1]),gl_TessLevelOuter[2]);&#xA;        gl_TessLevelInner[0] = inner;&#xA;    }&#xA;}&#xA;&#xA;#endif  //GLSL_TESS_CONTROL_SHADER&#xA;&#xA;#ifdef GLSL_TESS_EVALUATION_SHADER&#xA;&#xA;precision highp float;&#xA;&#xA;#ifdef OPENGL_ES&#xA;#extension GL_INTEL_tessellation:require&#xA;#endif // OPENGL_ES&#xA;&#xA;layout(triangles,fractional_odd_spacing,ccw) in;&#xA;&#xA;in  vec4  tcPosition[];&#xA;in  vec3  tcNormal[];&#xA;in  vec3  tcTangent[];&#xA;in  vec3  tcBinormal[];&#xA;in  vec2  tcUV0[];&#xA;in  vec3  tcWorldPosition[];&#xA;&#xA;out vec4 outPosition;&#xA;out vec3 outNormal;&#xA;out vec3 outTangent;&#xA;out vec3 outBinormal;&#xA;out vec2 outUV0;&#xA;out vec3 outWorldPosition;&#xA;&#xA;vec2 interpolate(vec2 a, vec2 b, vec2 c)&#xA;{&#xA;    vec2 p0 = vec2(gl_TessCoord.x) * a;&#xA;    vec2 p1 = vec2(gl_TessCoord.y) * b;&#xA;    vec2 p2 = vec2(gl_TessCoord.z) * c;&#xA;    return p0+p1+p2;&#xA;}&#xA;vec3 interpolate(vec3 a, vec3 b, vec3 c)&#xA;{&#xA;    vec3 p0 = vec3(gl_TessCoord.x) * a;&#xA;    vec3 p1 = vec3(gl_TessCoord.y) * b;&#xA;    vec3 p2 = vec3(gl_TessCoord.z) * c;&#xA;    return p0+p1+p2;&#xA;}&#xA;vec4 interpolate(vec4 a, vec4 b, vec4 c)&#xA;{&#xA;    vec4 p0 = vec4(gl_TessCoord.x) * a;&#xA;    vec4 p1 = vec4(gl_TessCoord.y) * b;&#xA;    vec4 p2 = vec4(gl_TessCoord.z) * c;&#xA;    return p0+p1+p2;&#xA;}&#xA;&#xA;void main()&#xA;{&#xA;    outPosition = interpolate(tcPosition[0],tcPosition[1],tcPosition[2]);&#xA;    outUV0 = interpolate(tcUV0[0],tcUV0[1],tcUV0[2]);&#xA;    outWorldPosition = interpolate(tcWorldPosition[0],tcWorldPosition[1],tcWorldPosition[2]);&#xA;    outNormal = interpolate(tcNormal[0],tcNormal[1],tcNormal[2]);&#xA;    outTangent = interpolate(tcTangent[0],tcTangent[1],tcTangent[2]);&#xA;    outBinormal = interpolate(tcBinormal[0],tcBinormal[1],tcBinormal[2]);&#xA;&#xA;    float y = texture(Texture1,(outUV0)).a * TessellationHeight;&#xA;    outPosition.y = y;&#xA;&#xA;    outPosition   = outPosition * WorldViewProjection;&#xA;&#xA;    gl_Position = outPosition;&#xA;}&#xA;#endif  //GLSL_TESS_EVALUATION_SHADER&#xA;&#xA;#ifdef GLSL_FRAGMENT_SHADER&#xA;out vec4 fragColor;// -------------------------------------&#xA;&#xA;void main( )&#xA;{&#xA;    vec4 result = vec4(0.0,0.0,0.0,1.0);&#xA;&#xA;    vec3 normal   = outNormal;&#xA;    vec3 tangent  = outTangent;&#xA;    vec3 binormal = outBinormal;&#xA;    mat3 tangentToWorld = mat3(tangent, binormal, normal);&#xA;    normal = normalize( tangentToWorld * NORMAL().bgr );&#xA;    float  shadowAmount = 1.0;&#xA;&#xA;    // Ambient-related computation&#xA;    vec3 ambient = AmbientColor.rgb * AMBIENT().rgb;&#xA;    result.xyz +=  ambient;&#xA;    vec3 lightDirection = -LightDirection.xyz;&#xA;&#xA;    // Diffuse-related computation&#xA;    vec3 albedo = DIFFUSE().rgb;&#xA;&#xA;    for(int ii=0; ii&amp;lt;NumLights; ++ii) {&#xA;        lightDirection = -LightDirections[ii];&#xA;        float  nDotL = max( 0.0,dot( normal, lightDirection ) );&#xA;        vec3 diffuse = LightColors[ii] * nDotL * shadowAmount  * albedo;&#xA;        result.xyz += diffuse * (1.0/float(NumLights));&#xA;    }&#xA;&#xA;    fragColor =  result;&#xA;&#xA;    const vec4 FogColor = vec4(0.211,0.223,0.226,1.0);&#xA;    const float MinFogDistance = 5000.0;&#xA;    const float MaxFogDistance = 75000.0;&#xA;    float dist = distance(outWorldPosition, EyePosition.xyz);&#xA;    float fog_factor = clamp((MaxFogDistance - dist)/(MaxFogDistance - MinFogDistance),0.0,1.0);&#xA;    fragColor =  mix(fragColor,FogColor,1.0-fog_factor);&#xA;&#xA;    #ifdef OPENGL_ES&#xA;    fragColor.rgb = pow(fragColor.rgb, vec3(0.454545454545));&#xA;    #endif&#xA;}&#xA;&#xA;#endif //GLSL_FRAGMENT_SHADER&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3384987" LastActivityDate="2015-02-14T11:39:21.290" Title="glLinkProgram crashes even though glCompileShader does not return any error" Tags="&lt;android&gt;&lt;c++&gt;&lt;opengl-es&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="27580957" PostTypeId="1" CreationDate="2014-12-20T14:04:43.903" Score="0" ViewCount="719" Body="&lt;p&gt;After issues I met, trying to read from COM port with Simulink, as I wrote in &lt;a href=&quot;http://stackoverflow.com/questions/21957839/some-help-writing-a-s-function-to-read-data-from-serial-port&quot;&gt;this discussion&lt;/a&gt;, I would like to follow Phil Goddard's suggestion on writing a C S-function for that. My problem is that I am not able to write C-code, so I hope in some help from you.&#xA;I have found this two scripts on the net about C S-function for serial communication:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;1)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define S_FUNCTION_NAME sfun_comport&#xA;&#xA;#define S_FUNCTION_LEVEL 2&#xA;&#xA;#include &quot;simstruc.h&quot;&#xA;&#xA;#include &quot;windows.h&quot;&#xA;&#xA;#include &quot;Strsafe.h&quot;&#xA;&#xA;#define MDL_START&#xA;&#xA;#if defined(MDL_START)&#xA;&#xA;/* Function: mdlStart =================================================*/&#xA;static void mdlStart(SimStruct *S)&#xA;{&#xA;    HANDLE hCom;&#xA;    DCB dcb;&#xA;    COMMTIMEOUTS uCtm;&#xA;    char pcCommPort[10];&#xA;    uint8_T comport = 4;&#xA;      //-------------------------------------------------------------------&#xA;      StringCbPrintfA((STRSAFE_LPSTR)&amp;amp;pcCommPort,&#xA;                      sizeof(pcCommPort),&#xA;                      &quot;COM%d&quot;,&#xA;                      comport);&#xA;      //-------------------------------------------------------------------&#xA;      hCom = CreateFileA (pcCommPort,&#xA;                          GENERIC_READ | GENERIC_WRITE,&#xA;                          0,&#xA;                          NULL,&#xA;                          OPEN_EXISTING,&#xA;                          0,&#xA;                          NULL);&#xA;      if (hCom == INVALID_HANDLE_VALUE)&#xA;      {&#xA;          ssSetErrorStatus(S,&quot;COM-Port konnte nicht geoeffnet werden!&quot;);&#xA;          return;&#xA;      }&#xA;      //-------------------------------------------------------------------&#xA;      SecureZeroMemory(&amp;amp;dcb, sizeof(dcb));&#xA;      memset(&amp;amp;dcb, 0, sizeof(dcb));&#xA;      dcb.DCBlength = sizeof(dcb);&#xA;      dcb.BaudRate  = (uint16_T)9600;&#xA;      dcb.ByteSize  = 8;&#xA;      dcb.Parity    = NOPARITY;&#xA;      dcb.StopBits  = ONESTOPBIT;&#xA;      //-------------------------------------------------------------------&#xA;      uCtm.ReadIntervalTimeout         = MAXDWORD;&#xA;      uCtm.ReadTotalTimeoutMultiplier  = 0;&#xA;      uCtm.ReadTotalTimeoutConstant    = 0;&#xA;      uCtm.WriteTotalTimeoutMultiplier = 0;&#xA;      uCtm.WriteTotalTimeoutConstant   = 0;&#xA;      //-------------------------------------------------------------------&#xA;      if ((!SetCommState(hCom, &amp;amp;dcb)) | (!SetCommTimeouts(hCom, &amp;amp;uCtm)))&#xA;      {&#xA;          CloseHandle(hCom);&#xA;          ssSetErrorStatus(S,&quot;Konfigurationsfehler des COM-Ports!&quot;);&#xA;          return;&#xA;      }&#xA;      //-------------------------------------------------------------------&#xA;      ssSetPWorkValue(S, 0, hCom);&#xA;  }&#xA;#endif&#xA;/* Function: mdlOutputs =================================================*/&#xA;&#xA;static void mdlOutputs(SimStruct *S, int_T tid) {&#xA;&#xA;    const real_T *u0 = (const real_T*) ssGetInputPortSignal(S,0);&#xA;    real_T       *y0 = ssGetOutputPortSignal(S,0);&#xA;    HANDLE hCom = (HANDLE*)ssGetPWorkValue(S, 0);&#xA;    uint32_T read_cnt;&#xA;    uint32_T write_cnt;&#xA;    char getbuffer[] = &quot;test&quot;;&#xA;    char putbuffer[] = &quot;Dies ist ein Test\r&quot;;&#xA;    //int i;&#xA;    //---------------------------------------------------------------------&#xA;    read_cnt = sizeof(putbuffer)-1;&#xA;    ReadFile(hCom, putbuffer, read_cnt, &amp;amp;read_cnt, NULL);&#xA;    //---------------------------------------------------------------------    &#xA;    write_cnt = sizeof(putbuffer)-1;&#xA;    WriteFile(hCom, putbuffer, write_cnt, &amp;amp;write_cnt, NULL);&#xA;    //---------------------------------------------------------------------&#xA;    Sleep(3000);&#xA;}&#xA;#define MDL_UPDATE&#xA;&#xA;#if defined(MDL_UPDATE)&#xA;&#xA;/* Function: mdlUpdate ================================================*/&#xA;static void mdlUpdate(SimStruct *S, int_T tid)&#xA;{&#xA;}&#xA;#endif&#xA;/* Function: mdlTerminate ===============================================*/&#xA;&#xA;static void mdlTerminate(SimStruct *S) {&#xA;&#xA;    CloseHandle((HANDLE*)ssGetPWorkValue(S, 0));&#xA;}&#xA;&#xA;&#xA;&#xA;#ifdef  MATLAB_MEX_FILE    /* Is this file being compiled as a MEX-file? */&#xA;#include &quot;simulink.c&quot;      /* MEX-file interface mechanism */&#xA;#else&#xA;#include &quot;cg_sfun.h&quot;       /* Code generation registration function */&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But when I try to compile it by &lt;code&gt;mex sfun_comport.c&lt;/code&gt; it returns following errors:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(449) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(1692) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(1701) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(1724) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2373) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2380) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2393) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2402) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2408) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2448) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2459) : error C2065: 'mdlInitializeSizes' : undeclared identifier &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2459) : warning C4047: '=' : 'mdlInitializeSizesFcn' differs in levels of indirection from 'int' &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2548) : error C2065: 'mdlInitializeSampleTimes' : undeclared identifier &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2548) : warning C4047: '=' : 'mdlInitializeSampleTimesFcn' differs in levels of indirection from 'int' &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2679) : warning C4013: 'mdlInitializeSizes' undefined; assuming extern returning int &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2948) : warning C4013: 'mdlInitializeSampleTimes' undefined; assuming extern returning int &#xA;&#xA;  C:\PROGRA~1\MATLAB\R2013B\BIN\MEX.PL: Error: Compile of 'sfun_comport.c' failed. &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;2) &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define S_FUNCTION_NAME  sfun_tryserial&#xA;#define S_FUNCTION_LEVEL 2&#xA;&#xA;&#xA;#include &quot;simstruc.h&quot; &#xA;#include &quot;windows.h&quot; &#xA;#include &quot;strsafe.h&quot; &#xA;#include &quot;stdio.h&quot; &#xA;#include &quot;string.h&quot; &#xA;#include &quot;stdlib.h&quot; &#xA;&#xA;&#xA;static void mdlStart(SimStruct *S) &#xA;{ &#xA;    HANDLE hCom; &#xA;    DCB dcb; &#xA;    COMMTIMEOUTS uCtm;     &#xA;    char pcCommPort[12]; &#xA;    //char pcCommPort[10]=&quot;COM4&quot;; &#xA;    uint8_T comport = mxGetScalar(ssGetSFcnParam(S, 0)); &#xA;&#xA;    StringCbPrintfA((STRSAFE_LPSTR)&amp;amp;pcCommPort, sizeof(pcCommPort), &quot;COM%d:&quot;, comport); &#xA;    //--------------------------------------------------------------- &#xA;    hCom = CreateFileA (pcCommPort, &#xA;               GENERIC_READ | GENERIC_WRITE, &#xA;               0, &#xA;               NULL, &#xA;               OPEN_EXISTING, &#xA;               0, &#xA;               NULL); &#xA;&#xA;    if (hCom == INVALID_HANDLE_VALUE) &#xA;    { &#xA;   ssSetErrorStatus(S,&quot;COM-Port konnte nicht geoeffnet werden!&quot;); &#xA;        return; &#xA;    } &#xA;    //--------------------------------------------------------------- &#xA;    SecureZeroMemory(&amp;amp;dcb, sizeof(dcb)); &#xA;    memset(&amp;amp;dcb, 0, sizeof(dcb)); &#xA;    dcb.DCBlength = sizeof(dcb); &#xA;    dcb.BaudRate = (uint16_T)9600; &#xA;    dcb.ByteSize = 8; &#xA;    dcb.Parity = NOPARITY; &#xA;    dcb.StopBits = ONESTOPBIT; &#xA;    //dcb.fDtrControl = 0X01; //ENABLE &#xA;    //dcb.fRtsControl = 0x01; //ENABLE &#xA;    //---------------------------------------------------------------   &#xA;    uCtm.ReadIntervalTimeout = MAXDWORD; &#xA;    uCtm.ReadTotalTimeoutMultiplier = 0; &#xA;    uCtm.ReadTotalTimeoutConstant = 0; &#xA;    uCtm.WriteTotalTimeoutMultiplier = 0; &#xA;    uCtm.WriteTotalTimeoutConstant = 0; &#xA;    //--------------------------------------------------------------- &#xA;    if ((!SetCommState(hCom, &amp;amp;dcb)) | (!SetCommTimeouts(hCom, &amp;amp;uCtm))) &#xA;    { &#xA;        CloseHandle(hCom); &#xA;        ssSetErrorStatus(S,&quot;Konfigurationsfehler des COM-Ports!&quot;); &#xA;        return; &#xA;    } &#xA;    //--------------------------------------------------------------- &#xA;    ssSetErrorStatus(S,&quot;Konfigurationsfehler des COM-Ports!&quot;); &#xA;    ssSetPWorkValue(S, 0, &amp;amp;hCom); &#xA;} &#xA;&#xA;&#xA;static void mdlOutputs(SimStruct *S, int_T tid) &#xA;{ &#xA;    const real_T   *u0 = (const real_T*)ssGetInputPortSignal(S, 0); &#xA;    real_T           *y0 = (real_T *)ssGetOutputPortRealSignal(S, 0); &#xA;&#xA;    uint32_T read_cnt; &#xA;    uint32_T write_cnt; &#xA;    char getbuffer[255] = {0}; &#xA;    char putbuffer[255] = {0}; &#xA;&#xA;    HANDLE hCom = (HANDLE*)ssGetPWorkValue(S, 0); &#xA;&#xA;    //++++++++++++++++++++++++++++++++++++++++++++++ &#xA;    if (ReadFile(hCom, getbuffer, sizeof(getbuffer), &amp;amp;read_cnt, NULL)) &#xA;    { &#xA;        // Daten auswerten, read_cnt enthält die Anzahl gelesener Bytes &#xA;    } &#xA;    else &#xA;    { &#xA;        // keine Daten empfangen &#xA;        // z.B. Fehlermeldung oder nix machen &#xA;    }     &#xA;     //++++++++++++++++++++++++++++++++++++++++++++++ &#xA;    if (!WriteFile(hCom, putbuffer, write_cnt, &amp;amp;read_cnt, NULL)); &#xA;    { &#xA;        // Fehlermeldung, weil die Daten nicht verschickt werden konnten &#xA;    } &#xA;    //++++++++++++++++++++++++++++++++++++++++++++++ &#xA;} &#xA;&#xA;static void mdlTerminate(SimStruct *S) &#xA;{ &#xA;    CloseHandle((HANDLE*)ssGetPWorkValue(S, 0)); &#xA;} &#xA;&#xA;#ifdef  MATLAB_MEX_FILE    /* Is this file being compiled as a MEX-file? */&#xA;#include &quot;simulink.c&quot;      /* MEX-file interface mechanism */&#xA;#else&#xA;#include &quot;cg_sfun.h&quot;       /* Code generation registration function */&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This produces:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;sfun_tryserial.c(20) : warning C4244: 'initializing' : conversion from 'double' to 'uint8_T', possible loss of data &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(449) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(1692) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(1701) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(1724) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2373) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2380) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2393) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2402) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2408) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2448) : warning C4995: 'sprintf': name was marked as #pragma deprecated &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2459) : error C2065: 'mdlInitializeSizes' : undeclared identifier &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2459) : warning C4047: '=' : 'mdlInitializeSizesFcn' differs in levels of indirection from 'int' &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2548) : error C2065: 'mdlInitializeSampleTimes' : undeclared identifier &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2548) : warning C4047: '=' : 'mdlInitializeSampleTimesFcn' differs in levels of indirection from 'int' &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2679) : warning C4013: 'mdlInitializeSizes' undefined; assuming extern returning int &#xA;C:\Program Files\MATLAB\R2013b\simulink\include\simulink.c(2948) : warning C4013: 'mdlInitializeSampleTimes' undefined; assuming extern returning int &#xA;&#xA;  C:\PROGRA~1\MATLAB\R2013B\BIN\MEX.PL: Error: Compile of 'sfun_provaseriale2.c' failed. &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;As you can notice common errors between two S-function are about:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;'mdlInitializeSizes'&#xA;'mdlInitializeSizesFcn'&#xA;'mdlInitializeSampleTimes'&#xA;'mdlInitializeSampleTimesFcn'&#xA;'mdlInitializeSizes'&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Do you have some suggestion to fix those errors ?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;PS: I have MATLAB 2013b 64-bit, 64-bit Windows 7, Microsoft Visual C++ 2010 (32-bit) as compiler (it has worked fine in 64-bit matlab to produce mex files)&lt;/p&gt;&#xA;" OwnerUserId="3063488" LastEditorUserId="2257388" LastEditDate="2014-12-22T09:57:54.043" LastActivityDate="2016-05-18T15:41:33.773" Title="C S-function to read data from serial" Tags="&lt;matlab&gt;&lt;serial-port&gt;&lt;simulink&gt;&lt;s-function&gt;" AnswerCount="1" CommentCount="12" />
  <row Id="27616789" PostTypeId="1" AcceptedAnswerId="27616843" CreationDate="2014-12-23T08:40:32.410" Score="1" ViewCount="79" Body="&lt;p&gt;Is there any way to check the arguments used to compile?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Like:&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;gcc -std=c99 -ggdb3 source.c -o sate-enak&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;In &lt;code&gt;source.c&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre class=&quot;lang-c prettyprint-override&quot;&gt;&lt;code&gt;...&#xA;#ifdef (-ggdb3 variable is defined)&#xA;    do_some_function();&#xA;#else&#xA;    do_another_function();&#xA;#endif&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;With using this method, I can find out if the program is compiled for production or product.&lt;/p&gt;&#xA;" OwnerUserId="1705800" LastEditorUserId="4370109" LastEditDate="2015-11-27T11:15:22.570" LastActivityDate="2015-11-27T11:15:22.570" Title="Get built arguments in C" Tags="&lt;c&gt;&lt;gcc&gt;&lt;compilation&gt;&lt;c-preprocessor&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="27707451" PostTypeId="1" AcceptedAnswerId="27707651" CreationDate="2014-12-30T14:45:28.693" Score="-4" ViewCount="102" Body="&lt;p&gt;There are code below and worked well before&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;unit Unit1;&#xA;  {$DEFINE _Full}&#xA; // {$DEFINE _Trial}&#xA;&#xA;interface&#xA;&#xA;uses Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms;&#xA;&#xA;&#xA;{$ifdef  _Trial}&#xA;&#xA;_programname='abc';&#xA;&#xA;&#xA;{$endif}&#xA;&#xA;{$ifdef  _Full}&#xA;&#xA;_programname='abc';&#xA;&#xA;&#xA;{$endif}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but today I run Delphi and try to compile, it reported&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Identifier redeclared: '_programname'&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;it looks like &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;  {$DEFINE _Full}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;does not work&lt;/p&gt;&#xA;&#xA;&lt;p&gt;your comment welcome&lt;/p&gt;&#xA;" OwnerUserId="262325" LastActivityDate="2014-12-30T17:19:25.273" Title="former worked code does not work" Tags="&lt;delphi&gt;&lt;delphi-xe2&gt;&lt;delphi-7&gt;&lt;delphi-xe&gt;" AnswerCount="2" CommentCount="6" />
  <row Id="27920632" PostTypeId="1" CreationDate="2015-01-13T11:03:41.060" Score="0" ViewCount="98" Body="&lt;p&gt;I have a framework that uses two other frameworks, all of which I have made myself. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;One of the used frameworks has a few classes with an #ifdef NEED_THIS_CLASS #endif around it with a #define NEED_THIS_CLASS in it's .pch file. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;The reason for this is that I use the framework for most of my apps, but if these classes are included, which are a part of the framework, it can be rejected in the app store if the classes are not used. So I outcomment the #define when I don't need it and use it if I do, this has worked without a problem. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;The problem is now that I want to use it in another framework where I need to use these classes, it doesn't seem to be able to find the classes. It's as if the #define NEED_THIS_CLASS is not there. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I can fix it by removing the #ifdef #endif around the classes, so it doesn't seem to be a problem with some referencing. It can find it if the #ifdef isn't there, and I can use all the other classes in the framework just fine. But it's alot more convenient to only have to change it in one place instead of 6 places if I need/don't need these classes.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Anyone have experience with #ifdef #endif in frameworks inside frameworks who has a solution to my problem? Any help would be much appreciated :)&lt;/p&gt;&#xA;" OwnerUserId="3265326" LastActivityDate="2015-01-13T11:28:35.537" Title="#ifdef doesn't seem to work with my framework" Tags="&lt;ios&gt;&lt;objective-c&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="28166565" PostTypeId="1" AcceptedAnswerId="28166605" CreationDate="2015-01-27T09:00:26.570" Score="17" ViewCount="4234" Body="&lt;p&gt;I am working on a project that has been built with both gcc and msvc so far. We recently started building with clang as well.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;There are some parts in the code, where platform-specific things are done:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef _WIN32&#xA;// ignore this in msvc&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Since gcc has previously been the only non-windows build, this was equivalent to saying &quot;do this only for gcc&quot;. But now it means &quot;do this only for gcc and clang&quot;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;However there are still situations, where I would like to handle something specifically for gcc, and not for clang. Is there a simple and robust way to detect gcc, i.e.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef ???&#xA;// do this *only* for gcc&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1805388" LastActivityDate="2015-11-18T08:10:41.040" Title="Detect gcc as opposed to msvc / clang with macro" Tags="&lt;c++&gt;&lt;gcc&gt;" AnswerCount="3" CommentCount="4" FavoriteCount="1" />
  <row Id="28203080" PostTypeId="1" AcceptedAnswerId="28203135" CreationDate="2015-01-28T21:50:32.843" Score="0" ViewCount="169" Body="&lt;p&gt;I think there is a possible conflict between a method and a windows macro.&#xA;I am using cygwin gcc and this is what my conflict looks like&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;File : MRepository.h&#xA;#pragma once&#xA;&#xA;#ifdef  GetMessage&#xA;#undef  GetMessage&#xA;#endif  //GetMessage&#xA;&#xA;class MRepository&#xA;{&#xA;public:&#xA;&#xA;    std::wstring GetMessage(const std::wstring &amp;amp;key) const;&#xA;    ...&#xA;    ....&#xA;&#xA;};&#xA;&#xA;File : MRepository.cpp&#xA;bool MRepository::SomeMethod(boost::shared_ptr&amp;lt;foo&amp;gt; &amp;amp;nd)&#xA;{&#xA;        std::wstring type = this-&amp;gt;GetMessage(L&quot;SomeData&quot;); //Error Here : Method not recognized&#xA;        ....&#xA;        ....        &#xA;    return available;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This is the error that I get from the method&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;error: 'class MRepository' has no member named 'GetMessageA'|&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Notice that I called &lt;code&gt;GetMessage&lt;/code&gt; but it thinks the method is called &lt;code&gt;GetMessageA&lt;/code&gt; any suggestions on why the compiler thinks I am trying to reference &lt;code&gt;GetMessageA&lt;/code&gt; when I clearly typed in &lt;code&gt;GetMessage&lt;/code&gt; ?&lt;/p&gt;&#xA;" OwnerUserId="1305891" LastActivityDate="2015-01-28T21:53:43.023" Title="Possible Conflict between a macro and a method" Tags="&lt;c++&gt;&lt;gcc&gt;&lt;macros&gt;" AnswerCount="1" CommentCount="4" ClosedDate="2015-01-28T21:58:48.607" />
  <row Id="28334715" PostTypeId="1" CreationDate="2015-02-05T01:29:16.110" Score="3" ViewCount="682" Body="&lt;p&gt;I am looking into 32-bit userspace support in ARM64 linux kernels, and it looks like enabling CONFIG_COMPAT would allow me to do that.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Can anyone chime in on whether enabling CONFIG_COMPAT would DISABLE the running of 64-bit apps? I ask this for the following reasons:&lt;/p&gt;&#xA;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;The documentation doesn't state that both 64/32 bit apps can be run with the same kernel&lt;/li&gt;&#xA;&lt;li&gt;&lt;p&gt;I took a look at fs/compat_binfmt_elf.c&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef   COMPAT_SET_PERSONALITY&#xA;#undef   SET_PERSONALITY&#xA;#define  SET_PERSONALITY      COMPAT_SET_PERSONALITY&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This seems to force the thread personality to&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;set_thread_flag(TIF_32BIT)    &#xA;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;p&gt;When load_elf_binary() in kernel/linux-3.14/fs/binfmt_elf.c is called, there is a call to SET_PERSONALITY(loc-&gt;elf_ex);&lt;/p&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;p&gt;So ineffect, when CONFIG_COMPAT is enabled, all userspace apps are force marked as 32-BIT?&lt;/p&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;p&gt;Thanks&lt;/p&gt;&#xA;" OwnerUserId="3920480" LastActivityDate="2015-02-09T19:21:07.000" Title="Mixing 64/32-bit userspace in arm64 linux ( using CONFIG_COMPAT )" Tags="&lt;c&gt;&lt;linux&gt;&lt;arm64&gt;" AnswerCount="1" CommentCount="1" FavoriteCount="1" />
  <row Id="28382619" PostTypeId="1" AcceptedAnswerId="28383086" CreationDate="2015-02-07T13:23:22.773" Score="1" ViewCount="84" Body="&lt;p&gt;Below is the snippet of Make file:&#xA;Makefile1:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;bar = true&#xA;foo = bar&#xA;ifdef $(foo)&#xA;frobozz = yes&#xA;endif&#xA;all = ; @echo The value of frobozz is $(frobozz)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Makefile2:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;bar =&#xA;foo = $(bar)&#xA;ifdef foo&#xA;frobozz = yes&#xA;else&#xA;frobozz = no&#xA;endif&#xA;&#xA;all = ; @echo The value of frobozz is $(frobozz)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;In both the cases the output is the same &lt;strong&gt;&quot;yes&quot;&lt;/strong&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So what I concluded is:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;In the first case the argument for ifdef is $(foo) that ultimately becomes bar means the statement actually looks like &lt;strong&gt;ifdef bar&lt;/strong&gt; so the value of bar is cheked.&lt;/li&gt;&#xA;&lt;li&gt;In the second case the argument for ifdef is foo directly so value of foo is checked so the statement ifdef checks the value of foo that is $(bar).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;First of all I want to know that am I interpreting correctly or I perceived wrong.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;If I am getting it correctly then the value of bar in second case is empty so it should give &lt;strong&gt;no&lt;/strong&gt; rather than giving &lt;strong&gt;yes&lt;/strong&gt;.&#xA;Please clarify ... Thanks .&lt;/p&gt;&#xA;" OwnerUserId="4238643" LastActivityDate="2015-02-09T20:43:06.137" Title="Makefile Conditionals directives" Tags="&lt;linux&gt;&lt;makefile&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="28879296" PostTypeId="1" CreationDate="2015-03-05T13:45:27.150" Score="0" ViewCount="58" Body="&lt;p&gt;The full code is below, it just exit when it goes through the if condition.&#xA;So I changed the condition, &lt;code&gt;argc != 1&lt;/code&gt; and it worked until the &lt;code&gt;pathconf&lt;/code&gt;.&#xA;In function &lt;code&gt;pr_pathconf&lt;/code&gt;, &lt;code&gt;path&lt;/code&gt; is null.&#xA;I don't know what is the problem. Please give me some help.&lt;/p&gt;&#xA;&#xA;&lt;pre class=&quot;lang-c prettyprint-override&quot;&gt;&lt;code&gt;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;errno.h&amp;gt; &#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;unistd.h&amp;gt;&#xA;&#xA;static void pr_sysconf(char *, int);&#xA;static void pr_pathconf(char *, char *, int);&#xA;&#xA;int main(int argc, char *argv[])&#xA;{&#xA;    printf(&quot; argc = %d\n&quot;, argc);&#xA;    if(argc != 2)&#xA;    {&#xA;        fprintf(stderr, &quot;usage : a.out &amp;lt;dirname&amp;gt;\n&quot;);&#xA;        exit(1);&#xA;    }&#xA;    pr_sysconf(&quot;ARG_MAX         =&quot;,_SC_ARG_MAX); &#xA;    pr_sysconf(&quot;CHILD_MAX       =&quot;,_SC_CHILD_MAX);&#xA;    pr_sysconf(&quot;clock ticks/second =&quot;, _SC_CLK_TCK);&#xA;    pr_sysconf(&quot;NGROUPS_MAX     =&quot;,_SC_NGROUPS_MAX);&#xA;    pr_sysconf(&quot;OPEN_MAX        =&quot;,_SC_OPEN_MAX);&#xA;#ifdef      _SC_STREAM_MAX&#xA;    pr_sysconf(&quot;STREAM_MAX      =&quot;,_SC_STREAM_MAX);&#xA;#endif&#xA;#ifdef      _SC_TZNAME_MAX&#xA;    pr_sysconf(&quot;TZNAME_MAX      =&quot;,_SC_TZNAME_MAX);&#xA;#endif&#xA;    pr_sysconf(&quot;_POSIX_JOB_CONTROL =&quot;,_SC_JOB_CONTROL);&#xA;    pr_sysconf(&quot;_POSIX_SAVED_IDS =&quot;, _SC_SAVED_IDS);&#xA;    pr_sysconf(&quot;_POSIX_VERSION  =&quot;,_SC_VERSION);&#xA;&#xA;    pr_pathconf(&quot;MAX_CANON      =&quot;,&quot;/dev/tty&quot;, _PC_MAX_CANON);&#xA;    pr_pathconf(&quot;MAX_INPUT      =&quot;,&quot;/dev/tty&quot;, _PC_MAX_INPUT);&#xA;    pr_pathconf(&quot;_POSIX_VDISABLE=&quot;,&quot;/dev/tty&quot;, _PC_VDISABLE);&#xA;    pr_pathconf(&quot;LINK_MAX       =&quot;, argv[1], _PC_LINK_MAX);&#xA;    pr_pathconf(&quot;NAME_MAX       =&quot;, argv[1], _PC_NAME_MAX);&#xA;    pr_pathconf(&quot;PATH_MAX       =&quot;, argv[1], _PC_PATH_MAX);&#xA;    pr_pathconf(&quot;PIPE_BUF       =&quot;, argv[1], _PC_PIPE_BUF);&#xA;    pr_pathconf(&quot;_POSIX_NO_TRUNC=&quot;, argv[1], _PC_NO_TRUNC);&#xA;    pr_pathconf(&quot;_POSIX_CHOWN_RESTRICTED =&quot;, argv[1], _PC_CHOWN_RESTRICTED);&#xA;&#xA;    exit(0);&#xA;}&#xA;&#xA;static void pr_sysconf(char *mesg, int name)&#xA;{&#xA;    long val;&#xA;    fputs(mesg, stdout);&#xA;    errno = 0;&#xA;    if((val = sysconf(name))&amp;lt;0){&#xA;        if(errno != 0)&#xA;        {&#xA;            fprintf(stderr, &quot;sysconf error\n&quot;);&#xA;            exit(1);&#xA;        }&#xA;        fputs(&quot; (not defined)\n&quot;, stdout);&#xA;    }else&#xA;        printf(&quot; %ld\n&quot;, val);&#xA;}&#xA;&#xA;static void pr_pathconf(char *mesg, char *path, int name)&#xA;{&#xA;    long val;&#xA;&#xA;    fputs(mesg, stdout);&#xA;    errno = 0;&#xA;    if((val = pathconf(path,name))&amp;lt;0)&#xA;    {&#xA;        if(errno != 0)&#xA;        {&#xA;            fprintf(stderr, &quot;pathconf error, path = %s\n&quot;, path);&#xA;            exit(1);&#xA;        }&#xA;        fputs(&quot; (no limit)\n&quot;, stdout);&#xA;    }&#xA;    else&#xA;        printf(&quot; %ld\n&quot;, val);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="4327231" LastEditorUserId="388520" LastEditDate="2015-03-07T02:41:59.283" LastActivityDate="2015-03-10T09:36:02.450" Title="C. pathconf got error. path is null" Tags="&lt;c&gt;&lt;argv&gt;&lt;argc&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="28999047" PostTypeId="1" CreationDate="2015-03-11T23:03:47.820" Score="0" ViewCount="80" Body="&lt;p&gt;My first useful project with pic which was to make a smart home automation system with 2 lasers that are put at the entrance of a room and detects whether you are getting in or out according to which laser you cut first from the LDR so if you are getting in you cut the first laser then the second and vise versa and accordingly it turns the light on or off and it also counts how much people entered and turn the lights off after the last gets out, the code is not working whatever i try with it and IDK why the lights get on whenever i cut only 1 laser alone, code is written with MPLAB and compiled with XC8, mcu: pic16f877a&lt;/p&gt;&#xA;&#xA;&lt;p&gt;main.cpp:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;define.h&quot;&#xA;&#xA;int main(){&#xA;    int counter = 0;&#xA;    TRISB = 255;&#xA;    OPTION_REG = 0b01111111;&#xA;    TRISC = 0;&#xA;    PORTC = 0;&#xA;&#xA;    while(1){&#xA;        if(laser1 == 1 &amp;amp;&amp;amp; laser2 == 0 &amp;amp;&amp;amp; counter == 0){&#xA;            for(int x = 0; x &amp;lt;= 3000; x++){&#xA;                if(laser2 == 1){&#xA;                    PORTCbits.RC0 = 1;&#xA;                    counter++;&#xA;                    x = 0;&#xA;                    break;&#xA;                }&#xA;                __delay_ms(1);&#xA;            }&#xA;&#xA;        }else if(laser1 == 1 &amp;amp;&amp;amp; laser2 == 0 &amp;amp;&amp;amp; counter &amp;gt;= 1){&#xA;            for(int y = 0; y &amp;lt;= 3000; y++){&#xA;                if(laser2 == 1){&#xA;                    counter++;&#xA;                    y = 0;&#xA;                    break;&#xA;                }&#xA;                __delay_ms(1);&#xA;            }&#xA;        }else if(laser1 == 0 &amp;amp;&amp;amp; laser2 == 1){&#xA;            for(int z = 0; z &amp;lt;= 3000; z++){&#xA;                if(laser1 == 1){&#xA;                    counter--;&#xA;                    z = 0;&#xA;                    if(counter == 0){&#xA;                        PORTCbits.RC0 = 0;&#xA;                    }else{&#xA;                        PORTCbits.RC0 = 1;&#xA;                    }&#xA;                    break;&#xA;                }&#xA;                __delay_ms(1);&#xA;            }&#xA;&#xA;        }&#xA;&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;define.h:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* &#xA; * File:   define.h&#xA; * Author: Fady&#xA; *&#xA; * Created on March 11, 2015, 10:51 PM&#xA; */&#xA;&#xA;#ifndef DEFINE_H&#xA;#define DEFINE_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;&#xA;// PIC16F877A Configuration Bit Settings&#xA;&#xA;// 'C' source line config statements&#xA;&#xA;#include &amp;lt;xc.h&amp;gt;&#xA;&#xA;#define laser1 PORTBbits.RB0&#xA;#define laser2 PORTBbits.RB1&#xA;#define LED PORTCbits.RC0&#xA;#define _XTAL_FREQ 4000000&#xA;// #pragma config statements should precede project file includes.&#xA;// Use project enums instead of #define for ON and OFF.&#xA;&#xA;// CONFIG&#xA;#pragma config FOSC = XT        // Oscillator Selection bits (XT oscillator)&#xA;#pragma config WDTE = OFF       // Watchdog Timer Enable bit (WDT disabled)&#xA;#pragma config PWRTE = OFF      // Power-up Timer Enable bit (PWRT disabled)&#xA;#pragma config BOREN = ON       // Brown-out Reset Enable bit (BOR enabled)&#xA;#pragma config LVP = ON         // Low-Voltage (Single-Supply) In-Circuit Serial Programming Enable bit (RB3/PGM pin has PGM function; low-voltage programming enabled)&#xA;#pragma config CPD = OFF        // Data EEPROM Memory Code Protection bit (Data EEPROM code protection off)&#xA;#pragma config WRT = OFF        // Flash Program Memory Write Enable bits (Write protection off; all program memory may be written to by EECON control)&#xA;#pragma config CP = OFF         // Flash Program Memory Code Protection bit (Code protection off)&#xA;&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif  /* DEFINE_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;the circuit is a very simple one tho,:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;where i only connected the led from PORTC pin 0 to ground and the 2 LDRs on pinb 1 &amp;amp; 2 in addition to power, of course, in vcc and MCLR and gnd and the 4MHz crystal&lt;/p&gt;&#xA;" OwnerUserId="4469807" LastEditorUserId="4469807" LastEditDate="2015-03-11T23:32:02.087" LastActivityDate="2015-03-14T08:31:09.920" Title="PIC program not working" Tags="&lt;automation&gt;&lt;microcontroller&gt;&lt;pic&gt;" AnswerCount="1" CommentCount="9" />
  <row Id="29062236" PostTypeId="1" CreationDate="2015-03-15T15:15:07.987" Score="-1" ViewCount="504" Body="&lt;p&gt;I have stm32f401re nucleo board. I am looking at hal library given by stm. I wanted to check the external interrupt on the board so i used BSP function. on pressing the user button(PC13), i want led to toggle. But its not working at all.I modified the GPIO example to use BSP functions. I have override the &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Please correct me.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/**&#xA;&#xA;&#xA;    ******************************************************************************&#xA;      * @file    GPIO/GPIO_IOToggle/Src/main.c &#xA;      * @author  MCD Application Team&#xA;      * @version V1.2.0&#xA;      * @date    26-December-2014&#xA;      * @brief   This example describes how to configure and use GPIOs through &#xA;      *          the STM32F4xx HAL API.&#xA;      ******************************************************************************&#xA;      * @attention&#xA;      *&#xA;      * &amp;lt;h2&amp;gt;&amp;lt;center&amp;gt;&amp;amp;copy; COPYRIGHT(c) 2014 STMicroelectronics&amp;lt;/center&amp;gt;&amp;lt;/h2&amp;gt;&#xA;      *&#xA;      * Redistribution and use in source and binary forms, with or without modification,&#xA;      * are permitted provided that the following conditions are met:&#xA;      *   1. Redistributions of source code must retain the above copyright notice,&#xA;      *      this list of conditions and the following disclaimer.&#xA;      *   2. Redistributions in binary form must reproduce the above copyright notice,&#xA;      *      this list of conditions and the following disclaimer in the documentation&#xA;      *      and/or other materials provided with the distribution.&#xA;      *   3. Neither the name of STMicroelectronics nor the names of its contributors&#xA;      *      may be used to endorse or promote products derived from this software&#xA;      *      without specific prior written permission.&#xA;      *&#xA;      * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;&#xA;      * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE&#xA;      * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE&#xA;      * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE&#xA;      * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL&#xA;      * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR&#xA;      * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER&#xA;      * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,&#xA;      * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE&#xA;      * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.&#xA;      *&#xA;      ******************************************************************************&#xA;      */&#xA;&#xA;    /* Includes ------------------------------------------------------------------*/&#xA;    #include &quot;main.h&quot;&#xA;&#xA;    /** @addtogroup STM32F4xx_HAL_Examples&#xA;      * @{&#xA;      */&#xA;&#xA;    /** @addtogroup GPIO_IOToggle&#xA;      * @{&#xA;      */ &#xA;&#xA;    /* Private typedef -----------------------------------------------------------*/&#xA;    /* Private define ------------------------------------------------------------*/&#xA;    /* Private macro -------------------------------------------------------------*/&#xA;    /* Private variables ---------------------------------------------------------*/&#xA;&#xA;    /* Private function prototypes -----------------------------------------------*/&#xA;    static void SystemClock_Config(void);&#xA;    static void Error_Handler(void);&#xA;&#xA;    /* Private functions ---------------------------------------------------------*/&#xA;&#xA;    /**&#xA;      * @brief  Main program&#xA;      * @param  None&#xA;      * @retval None&#xA;      */&#xA;    int main(void)&#xA;    {&#xA;     /* This sample code shows how to use STM32F4xx GPIO HAL API to toggle PA05 IOs &#xA;        connected to LED2 on STM32F4xx-Nucleo board  &#xA;        in an infinite loop.&#xA;        To proceed, 3 steps are required: */&#xA;&#xA;      /* STM32F4xx HAL library initialization:&#xA;           - Configure the Flash prefetch, instruction and Data caches&#xA;           - Configure the Systick to generate an interrupt each 1 msec&#xA;           - Set NVIC Group Priority to 4&#xA;           - Global MSP (MCU Support Package) initialization&#xA;         */&#xA;      HAL_Init();&#xA;&#xA;      /* Configure the system clock to 84 MHz */&#xA;      SystemClock_Config();&#xA;&#xA;      /* -1- Enable GPIOA Clock (to be able to program the configuration registers) */&#xA;    //  __HAL_RCC_GPIOA_CLK_ENABLE();&#xA;    //&#xA;    //  /* -2- Configure PA05 IO in output push-pull mode to&#xA;    //         drive external LED */&#xA;    //  GPIO_InitStruct.Pin = GPIO_PIN_5;&#xA;    //  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;&#xA;    //  GPIO_InitStruct.Pull = GPIO_PULLUP;&#xA;    //  GPIO_InitStruct.Speed = GPIO_SPEED_FAST;&#xA;    //  HAL_GPIO_Init(GPIOA, &amp;amp;GPIO_InitStruct);&#xA;&#xA;      BSP_LED_Init(LED2);&#xA;      BSP_PB_Init(BUTTON_KEY, BUTTON_MODE_EXTI);&#xA;      /* -3- Toggle PA05 IO in an infinite loop */  &#xA;      while (1)&#xA;      {&#xA;    //    HAL_GPIO_TogglePin(GPIOA, GPIO_PIN_5);&#xA;    //&#xA;    //    /* Insert delay 100 ms */&#xA;    //    HAL_Delay(100);&#xA;      }&#xA;    }&#xA;&#xA;    /**&#xA;      * @brief  System Clock Configuration&#xA;      *         The system Clock is configured as follow : &#xA;      *            System Clock source            = PLL (HSI)&#xA;      *            SYSCLK(Hz)                     = 84000000&#xA;      *            HCLK(Hz)                       = 84000000&#xA;      *            AHB Prescaler                  = 1&#xA;      *            APB1 Prescaler                 = 2&#xA;      *            APB2 Prescaler                 = 1&#xA;      *            HSI Frequency(Hz)              = 16000000&#xA;      *            PLL_M                          = 16&#xA;      *            PLL_N                          = 336&#xA;      *            PLL_P                          = 4&#xA;      *            PLL_Q                          = 7&#xA;      *            VDD(V)                         = 3.3&#xA;      *            Main regulator output voltage  = Scale2 mode&#xA;      *            Flash Latency(WS)              = 2&#xA;      * @param  None&#xA;      * @retval None&#xA;      */&#xA;    static void SystemClock_Config(void)&#xA;    {&#xA;      RCC_ClkInitTypeDef RCC_ClkInitStruct;&#xA;      RCC_OscInitTypeDef RCC_OscInitStruct;&#xA;&#xA;      /* Enable Power Control clock */&#xA;      __HAL_RCC_PWR_CLK_ENABLE();&#xA;&#xA;      /* The voltage scaling allows optimizing the power consumption when the device is &#xA;         clocked below the maximum system frequency, to update the voltage scaling value &#xA;         regarding system frequency refer to product datasheet.  */&#xA;      __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE2);&#xA;&#xA;      /* Enable HSI Oscillator and activate PLL with HSI as source */&#xA;      RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSI;&#xA;      RCC_OscInitStruct.HSIState = RCC_HSI_ON;&#xA;      RCC_OscInitStruct.HSICalibrationValue = 0x10;&#xA;      RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;&#xA;      RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSI;&#xA;      RCC_OscInitStruct.PLL.PLLM = 16;&#xA;      RCC_OscInitStruct.PLL.PLLN = 336;&#xA;      RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV4;&#xA;      RCC_OscInitStruct.PLL.PLLQ = 7;&#xA;      if(HAL_RCC_OscConfig(&amp;amp;RCC_OscInitStruct) != HAL_OK)&#xA;      {&#xA;        Error_Handler();&#xA;      }&#xA;&#xA;      /* Select PLL as system clock source and configure the HCLK, PCLK1 and PCLK2 &#xA;         clocks dividers */&#xA;      RCC_ClkInitStruct.ClockType = (RCC_CLOCKTYPE_SYSCLK | RCC_CLOCKTYPE_HCLK | RCC_CLOCKTYPE_PCLK1 | RCC_CLOCKTYPE_PCLK2);&#xA;      RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;&#xA;      RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;&#xA;      RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV2;  &#xA;      RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV1;  &#xA;      if(HAL_RCC_ClockConfig(&amp;amp;RCC_ClkInitStruct, FLASH_LATENCY_2) != HAL_OK)&#xA;      {&#xA;        Error_Handler();&#xA;      }&#xA;    }&#xA;&#xA;    /**&#xA;      * @brief  This function is executed in case of error occurrence.&#xA;      * @param  None&#xA;      * @retval None&#xA;      */&#xA;    static void Error_Handler(void)&#xA;    {&#xA;      while(1)&#xA;      {&#xA;      }&#xA;    }&#xA;&#xA;    #ifdef  USE_FULL_ASSERT&#xA;    /**&#xA;      * @brief  Reports the name of the source file and the source line number&#xA;      *         where the assert_param error has occurred.&#xA;      * @param  file: pointer to the source file name&#xA;      * @param  line: assert_param error line source number&#xA;      * @retval None&#xA;      */&#xA;    void assert_failed(uint8_t* file, uint32_t line)&#xA;    { &#xA;      /* User can add his own implementation to report the file name and line number,&#xA;         ex: printf(&quot;Wrong parameters value: file %s on line %d\r\n&quot;, file, line) */&#xA;&#xA;      /* Infinite loop */&#xA;      while (1)&#xA;      {&#xA;      }&#xA;    }&#xA;    #endif&#xA;&#xA;&#xA;    void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin)&#xA;    {&#xA;        if( GPIO_Pin == KEY_BUTTON_PIN)&#xA;            BSP_LED_Toggle(LED2);&#xA;    }&#xA;    /**&#xA;      * @}&#xA;      */&#xA;&#xA;    /**&#xA;      * @}&#xA;      */&#xA;&#xA;    /************************ (C) COPYRIGHT STMicroelectronics *****END OF FILE****/&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1057286" LastEditorUserId="1057286" LastEditDate="2015-03-15T15:22:05.283" LastActivityDate="2015-03-15T20:26:37.910" Title="STm32f401re Nucle Board user button not working" Tags="&lt;stm32&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="0" />
  <row Id="29394563" PostTypeId="1" CreationDate="2015-04-01T15:15:01.463" Score="1" ViewCount="492" Body="&lt;p&gt;I've got a project that I'm working on that requires the use of a Topaz Signature Capture pad. Our product currently uses the ActiveX control provided by Topaz for collecting signatures on a website, but we're trying to move to a desktop application powered by Python. Python will allow us to branch out into multiple OS's without too much extra work.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Topaz provides a 'C' library (&lt;a href=&quot;http://www.topazsystems.com/sigpluslibrary.html&quot; rel=&quot;nofollow&quot;&gt;http://www.topazsystems.com/sigpluslibrary.html&lt;/a&gt;) for interfacing with their devices. I believe I've determined that it is actually C++ (uses classes and other C++ constructs). I've attempted to create a wrapper for Python using SWIG and Cython, but I have not had a whole lot of luck.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My directory structure for SWIG is this:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;SigSwig&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Includes (contains all of the headers from Topaz Shared C Library)&lt;/li&gt;&#xA;&lt;li&gt;setup.py&lt;/li&gt;&#xA;&lt;li&gt;SigLib.i&lt;/li&gt;&#xA;&lt;li&gt;Signature.i&lt;/li&gt;&#xA;&lt;li&gt;etc...&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;h1&gt;Setup.py&lt;/h1&gt;&#xA;&#xA;&lt;pre class=&quot;lang-python prettyprint-override&quot;&gt;&lt;code&gt;# setup.py&#xA;import distutils&#xA;from distutils.core import setup, Extension&#xA;&#xA;module = Extension(&#xA;                        &quot;_SigLib&quot;, &#xA;                        [&quot;SigLib.i&quot;],&#xA;                        swig_opts=['-c++'],&#xA;                        language='c++',&#xA;                        library_dirs=['c:\Python27'],&#xA;                        libraries=[&quot;SigLib&quot;, &quot;hid&quot;, &quot;LibJpeg&quot;, &quot;libtiff&quot;, &quot;WINTAB32&quot;, &quot;WNTAB32X&quot;, &quot;zlib&quot;],&#xA;                        extra_options=[&quot;SigLib.lib&quot;, &quot;hid.lib&quot;, &quot;LibJpeg.lib&quot;, &quot;libtiff.lib&quot;, &quot;WINTAB32.LIB&quot;, &quot;WNTAB32X.LIB&quot;, &quot;zlib.lib&quot;]&#xA;                    )&#xA;&#xA;setup(&#xA;      name = &quot;Signature Capture&quot;,&#xA;      version = &quot;1.0&quot;,&#xA;      ext_modules = [module]&#xA;)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h1&gt;SigLib.i&lt;/h1&gt;&#xA;&#xA;&lt;pre class=&quot;lang-c prettyprint-override&quot;&gt;&lt;code&gt;%module SigLib&#xA;%{&#xA;#define SIGAPI &#xA;#include &quot;Include\SigLib.h&quot;&#xA;%}&#xA;&#xA;%include TabletParameters.i&#xA;%include TabletInterface.i&#xA;%include LCDInterface.i&#xA;%include Signature.i&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;h1&gt;Signature.i&lt;/h1&gt;&#xA;&#xA;&lt;pre class=&quot;lang-c prettyprint-override&quot;&gt;&lt;code&gt;%module Signature&#xA;%include &quot;Include\Signature.h&quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I'm having a hard time following the SWIG examples, but from what I can tell this should be okay. SigLib.i loads in the main header (SigLib.h), which includes the declarations for SIGAPI and all of the main include files. It doesn't include Signature.h (or any of the other headers in the other interface files) since it doesn't follow all headers. Then it loads in additional interface files. Signature.i, and all of the other interface files just include a reference to the header to parse.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I've tried a few different ways and this seems to have been the best so far. However, when I execute setup.py, I get these errors:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;SigLib_wrap.cpp(3417) : error C2065: 'temp' : undeclared identifier&#xA;SigLib_wrap.cpp(3418) : error C2065: 'temp' : undeclared identifier&#xA;SigLib_wrap.cpp(3418) : error C2059: syntax error : '*'&#xA;SigLib_wrap.cpp(3419) : error C2513: 'TabletParameters' : no variable declared before '='&#xA;SigLib_wrap.cpp(3419) : error C2065: 'temp' : undeclared identifier&#xA;SigLib_wrap.cpp(3420) : error C2065: 'temp' : undeclared identifier&#xA;SigLib_wrap.cpp(3420) : error C2541: 'delete' : cannot delete objects that are not pointers&#xA;SigLib_wrap.cpp(3432) : error C2275: 'TabletParameters' : illegal use of this type as an expression c:\users\kevin\downloads\sigpython\include\TabletParameters.h(18) : see declaration of 'TabletParameters'&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Looking at the generated code, most of the errors contain SIGAPI, like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;SIGAPI * temp;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;SIGAPI appears to be a &lt;code&gt;#define&lt;/code&gt; the occurs in the SigLib.h file and is used in class definitions like:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;class SIGAPI Signature&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;SigLib.h definition:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  SIGLIBDLL&#xA;#define SIGAPI  __declspec( dllexport ) &#xA;#else&#xA;#define SIGAPI&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I've tried hours of Googling trying to find a solution to this, but I haven't had any luck. I haven't been able to find anything in the SWIG documentation on it, but I'm honestly not really sure what to look for.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Edit:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Made the change Giorgos suggested in addition to loading in extra headers. It appears to generate the entire wrap file now with everything needed, but gets errors linking to libraries.&lt;/p&gt;&#xA;&#xA;&lt;h1&gt;SigLib.i&lt;/h1&gt;&#xA;&#xA;&lt;pre class=&quot;lang-c prettyprint-override&quot;&gt;&lt;code&gt;%module SigLib&#xA;%{&#xA;    #include &quot;Include\SigLib.h&quot;&#xA;%}&#xA;&#xA;&#xA;%include &amp;lt;windows.i&amp;gt;&#xA;%include &quot;Include\SigLib.h&quot;&#xA;%include &quot;Include\SigPoint.h&quot;&#xA;%include &quot;Include\SigStroke.h&quot;&#xA;%include &quot;Include\TabletParameters.h&quot;&#xA;%include &quot;Include\CircularBuffer.h&quot;&#xA;%include &quot;Include\SerialIoIF.h&quot;&#xA;%include &quot;Include\HidIoIF.h&quot;&#xA;%include &quot;Include\UsbIoIF.h&quot;&#xA;%include &quot;Include\SocketIoIF.h&quot;&#xA;%include &quot;Include\NewSocketIoIF.h&quot;&#xA;%include &quot;Include\SimIoIF.h&quot;&#xA;%include &quot;Include\ProcessSerialData.h&quot;&#xA;%include &quot;Include\CaptureSig.h&quot;&#xA;%include &quot;Include\TabletPoint.h&quot;&#xA;%include &quot;Include\PointBuffer.h&quot;&#xA;%include &quot;Include\TabletInterface.h&quot;&#xA;%include &quot;Include\TabletSampleList.h&quot;&#xA;%include &quot;Include\SigWindowType.h&quot;&#xA;%include &quot;Include\SigFile.h&quot;&#xA;%include &quot;Include\md5.h&quot;&#xA;%include &quot;Include\Utilities.h&quot;&#xA;%include &quot;Include\HotSpot.h&quot;&#xA;%include &quot;Include\HotSpotList.h&quot;&#xA;%include &quot;Include\BitmapCharacter.h&quot;&#xA;%include &quot;Include\CharacterMap.h&quot;&#xA;%include &quot;Include\TiffImage.h&quot;&#xA;%include &quot;Include\LCDGraphicBitmap.h&quot;&#xA;%include &quot;Include\LCDInterface.h&quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I did that and changed up how I loaded everything in. Now it appears to be compiling, but I'm getting many linking errors like these:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;SigLib_wrap.obj : error LNK2019: unresolved external symbol &quot;public: int __thiscall TabletInterface::PointsInPointBuffer(void)&quot; (?PointsInPointBuffer@TabletInterface@@QAEHXZ) referenced in function __wrap_TabletInterface_PointsInPointBuffer&#xA;&#xA;SigLib_wrap.obj : error LNK2019: unresolved external symbol &quot;public: void __thiscall TabletInterface::InitProcessInputData(void)&quot; (?InitProcessInputData@TabletInterface@@QAEXXZ) referenced in function __wrap_TabletInterface_InitProcessInputData&#xA;&#xA;SigLib_wrap.obj : error LNK2019: unresolved external symbol &quot;public: void __thiscall TabletInterface::CloseProcessInputData(void)&quot; (?CloseProcessInputData@TabletInterface@@QAEXXZ) referenced in function __wrap_TabletInterface_CloseProcessInputData&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I need to link against SigLib.lib and a few other lib files, but I'm not sure how to do that from the setup.py file I have and if that will even work for Python.&lt;/p&gt;&#xA;" OwnerUserId="4738670" LastEditorUserId="4738670" LastEditDate="2015-04-21T17:56:47.473" LastActivityDate="2015-04-21T17:56:47.473" Title="Wrapping C/C++ Library with SWIG" Tags="&lt;python&gt;&lt;c++&gt;&lt;swig&gt;&lt;cython&gt;&lt;topaz-signatures&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="29410324" PostTypeId="1" CreationDate="2015-04-02T10:10:39.093" Score="0" ViewCount="86" Body="&lt;p&gt;So I'm making a Windows Phone native C++ DirectX app in Visual Studio and for no particular reason I'm getting errors from sal.h&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have no idea why should that happen, nor why is it complaining about &lt;code&gt;extern &quot;C&quot;&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;It says &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;missing &quot;;&quot; before &quot;string&quot;&#xA;missing &quot;;&quot; before &quot;{&quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The full code for that part &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  __cplusplus // [&#xA;#ifndef __nothrow // [&#xA;# define __nothrow __declspec(nothrow)&#xA;#endif // ]&#xA;extern &quot;C&quot; { // errors are at this line&#xA;#else // ][&#xA;#ifndef __nothrow // [&#xA;# define __nothrow&#xA;#endif // ]&#xA;#endif  /* #ifdef __cplusplus */ // ]&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;So it's definitely being compiled with C++ compiler since &lt;code&gt;__cplusplus&lt;/code&gt; is defined&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any ideas why in the world should that happen?&lt;/p&gt;&#xA;" OwnerUserId="2770190" LastActivityDate="2015-04-02T10:10:39.093" Title="C++ fails to extern &quot;C&quot;" Tags="&lt;c++&gt;&lt;visual-studio&gt;&lt;windows-phone&gt;" AnswerCount="0" CommentCount="8" />
  <row Id="29465283" PostTypeId="1" AcceptedAnswerId="29465602" CreationDate="2015-04-06T04:18:42.533" Score="0" ViewCount="441" Body="&lt;p&gt;I'm trying to do a macro where if AAA and BBB does not exists. Something like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef !AAA &amp;amp;&amp;amp; !BBB&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;or this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef AAA || BBB&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;However, Xcode is throwing me errors, so I've tried&#xA;&lt;code&gt;#ifdef !(defined AAA) &amp;amp;&amp;amp; !(defined BBB)&lt;/code&gt;&#xA;or some other such combinations and it seems like Xcode doesn't seems to understand defined. I'm getting &quot;Macro names must be identifiers&quot; or &quot;Extra tokens at the end of #ifdef directive&quot; errors.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any idea how I could workaround this problem?&lt;/p&gt;&#xA;" OwnerUserId="321629" LastEditorUserId="321629" LastEditDate="2015-04-06T06:35:13.707" LastActivityDate="2015-04-06T06:35:13.707" Title="ObjC macro ifdef and defined" Tags="&lt;objective-c&gt;&lt;c&gt;&lt;xcode&gt;&lt;macros&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="29616060" PostTypeId="1" AcceptedAnswerId="29620738" CreationDate="2015-04-13T22:21:27.393" Score="0" ViewCount="36" Body="&lt;p&gt;I have to create a static-linking standalone .exe file from my .cpp and .h files. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;The only obstacle I need to overcome is being able to call the same function &lt;code&gt;m_pListAll()&lt;/code&gt;from two .cpp files, &lt;code&gt;main.cpp&lt;/code&gt; and &lt;code&gt;window.cpp&lt;/code&gt; (defining a class called &lt;code&gt;Window&lt;/code&gt;).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The only problem is (for unknown reasons) I cannot &lt;code&gt;#include&lt;/code&gt; the header file that defines m_peDO() twice across &lt;code&gt;main.cpp&lt;/code&gt; and &lt;code&gt;window.cpp&lt;/code&gt;, I can only do it once because the header file sets up something called &quot;dynamic linking&quot; with some bizarre thing called &lt;code&gt;HINSTANCE&lt;/code&gt;(wrong: actual reason is in answer section):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;            //linking.h&#xA;&#xA;            //  This is an extra header file for dynamic linking of the LabJackUD driver.&#xA;            //  support@labjack.com&#xA;&#xA;            #ifdef  __cplusplus&#xA;            extern &quot;C&quot;&#xA;            {&#xA;            #endif &#xA;&#xA;            //For dynamic linking, we first define structures that have the same format&#xA;            //as the desired function prototype.&#xA;            typedef LJ_ERROR (CALLBACK *tListAll) (long, long, long *, long *, long *, double *);&#xA;&#xA;&#xA;            //Define a variable to hold a handle to the loaded DLL.&#xA;            HINSTANCE hDLLInstance;&#xA;&#xA;            //Define variables for the UD functions.&#xA;            tListAll m_pListAll;&#xA;&#xA;            #ifdef  __cplusplus&#xA;            } // extern C&#xA;            #endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;There are more functions, but lets just pretend I want to use tListAll m_pListAll in main.cpp and window.cpp. My Qt project contains the following files:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;main.cpp //main code&#xA;window.h //header defining a class used in main&#xA;window.cpp //cpp thing defining that class's methods&#xA;peripheral.h //header file to control my peripheral device&#xA;peripheral.lib //library file to control my peripheral device (VC6 only not minGW?!)&#xA;linking.h //thing that solves(?) the minGW/VC6 library incompatibility (read on)&#xA;&#xA;Scenario 1) #include &amp;lt;linking.h&amp;gt; in **only** main.cpp&#xA;Outcome: m_pListAll() only in scope of main.cpp, out of scope for window.cpp&#xA;Scenario 2) #include &amp;lt;linking.h&amp;gt; in **both** main.cpp AND window.cpp&#xA;Outcome: Redefinition errors for redefining hDLLInstance and m_pListAll().&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Why am I using this wierd HINSTANCE thing? Something to do with my .lib file being incompatible with minGW. If I add the library to statically be part of compilation, i get:&#xA;    :-1: error: No rule to make target 'C:/Users/Joey/Documents/ValvePermissions/libLabJackU.a', needed by 'release\ValvePermissions.exe'.  Stop.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What should I do? I just want that function to be in the scope of window.cpp, but I don't want to use that header twice because of the errors.&lt;/p&gt;&#xA;" OwnerUserId="3277889" LastEditorUserId="3277889" LastEditDate="2015-04-14T21:21:08.647" LastActivityDate="2015-04-14T21:21:08.647" Title="Weird header can't be included in both main.cpp and window.cpp (a class)" Tags="&lt;mingw&gt;&lt;static-linking&gt;&lt;redefinition&gt;&lt;.lib&gt;&lt;hinstance&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="29909665" PostTypeId="1" CreationDate="2015-04-28T03:16:24.667" Score="9" ViewCount="392" Body="&lt;p&gt;Often I have to program microcontrollers in C, because C++ compilers are often not available, or can not make extremely small code because of various bugs.  But often, OOP &quot;syntactic sugar&quot;, is very convenient when it comes to making programs for hardware more clearly encapsulated for easy maintenance; so I wanted to find out if there was a way to do OOP syntax in C where as much as possible the OOP overhead (when not needed) could be made to optimize out in a way that is portable. eg: That will optimize with gcc targeted for different microcontrollers, or perhaps by using gcc's preprocessor and a generic ANSI-C compiler if gcc is not available for that microcontroller.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I found only threads, like this, &lt;a href=&quot;http://stackoverflow.com/questions/10266559/elegant-way-to-emulate-this-pointer-when-doing-oop-in-c&quot;&gt;Elegant way to emulate &amp;#39;this&amp;#39; pointer when doing OOP in C?&lt;/a&gt; which generally do OOP by embedding pointers into structs but that's not always what I want because it wastes memory when I'm not interested in virtual methods, or anything like that.  I can always follow the coding style in the link where those features are needed, but I want to develop techniques for when they are not needed; e.g. I just want to be able to program using OOP paradigms, with simple easy to understand code (Not necessarily C++, though I like C++), and still be able to achieve a minimal C program memory usage when some OOP paradigms are not in use.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So, I resorted to experimentation with gcc, and C99, because in general gcc 3.2 or above is available for most platforms; and realized that I could use the sizeof() and typeof() compiler functions from C99 to index classes automatically ( a 'trick' of sorts ) from an unused/uninitialized union member (So classes must be unions with sub-structs), in order to access a compile time constant lookup table created by macros, which could bind data and methods, and guarantee all type checking. etc. etc. etc.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;eg: GCC allows the optimizing out of const structures, and arrays, when their members are only accessed as constant expressions, so I thought I might be able to use that to build a macro based compile time binding system where the OOP overhead is handled in GCC and actually optimizes out of the final binary.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;With this system, I can now do variadic macro method calls, like:  M( a , init, &quot;with&quot;, &quot;any&quot;, &quot;parameters&quot;, 7 ) which looks up variable a's type, call method init, using variable number of parameters... &lt;/p&gt;&#xA;&#xA;&lt;p&gt;See code examples below, and try them out -- it's simpler than the explanation:  Use gcc -E to see the macro expansions, and note for ANSI only compilers, the typeof() operator will have to be replaced by a (void*)typecast; type checking only works with GCC.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The code is cut and paste-able into a text editor, with filename on first line, and it does compile and run on normal PC systems.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Although I did succeed in getting rid of individual pointers in every struct to &quot;point back to&quot; a class's list of methods, which saves memory in a limited memory microcontroller, I wasn't quite able to figure out how to get the compiler to optimize out &lt;em&gt;unused&lt;/em&gt; method pointers because I had to use (void*) pointers for the classes to hold them in an array, and those require a memory address (address of a struct) and a linker instance; and don't optimize out.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So: I was wondering if anyone knew of a way to improve my solution by making some kind of an &lt;em&gt;initialized&lt;/em&gt; method struct which would optimize out (have no linker address) after compilation, eg: when it's members are only accessed as constant expressions in the code.   In essence I'm needing to be able to look up an element in array where the initialized portion of each array element is a different classXXX_mt, rather than a list of addresses to classXXX_mt all typecast to (void*).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;There's two other improvements I'd like help with if anyone can think of a simple solution;  The cpp (c-pre-processor) doesn't allow defining of new macros from within a previous macro by token concatenation (As far as I know), so I have to make fixed length macro lists (A maximum of 10 in my example) to hold class definitions; which means I can only have a maximum of 10 classes in a program; but ideally, I would like a way to make my code more generic, so that the cpp could create variable length lists on the fly.  eg: The problem is related the inability of the c pre-processor to &quot;count&quot; automatically.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;And secondly, when I try to use anonymous structs for newer versions of GCC, so I might get rid of an extra 'm' required to access member data in ISO-C eg: foo.m.mydata, by deleting the 'm' name from the class union definition, and compile with gcc -std=c11  , it then simply gave me errors claiming the struct defined nothing... so, anonymous structs inside unions don't work even in GCC 4.8 although it supposed to;  how can I get anonymous structs to work?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Below is the example of how I tested and implemented an include file, voidbind.h, which builds a list of classes and statically links the methods to the variables of that class type.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Ultimately, the system allows me to program like this example; which I compiled with gcc 4.0 to 4.9 with no problems:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//classtest.c&#xA;#ifndef MACROCHECK  // Don't macro expand stdio.h, it's ugly...&#xA;#include &amp;lt;stdio.h&amp;gt;  // to see macros, do gcc -D MACROCHECK -E classtest.c&#xA;#endif&#xA;#include &quot;class1.h&quot; // include example class, library.&#xA;&#xA;#define _VOID_FINALIZE&#xA;#include &quot;voidbind.h&quot; // Make class list finalized, no more classes allowed&#xA;&#xA;void main( void ) {&#xA;    class1_ct a; // types ending in _ct are the macro created class types&#xA;    class2_ct b;&#xA;&#xA;    M( a , init ); // Call method of variable, a, and the function init.&#xA;    printf(&quot;a=%s %s\n&quot;,a.m.name, M( b, tryme, &quot;echo is this&quot; ) ); &#xA;    // I'd love to be rid of .m. in the previous line using anonymous struct&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Next is the Class definition / header file, for both class1 and class2, showing how the macro pre-processor is used to create classes of data bound to methods and the _ct type; normally this would probably be broken up into two header files, and two libraries; but I'm just abusing the header by putting all the code together for simplicity.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//class1.h&#xA;#ifndef _class1_h&#xA;#define _class1_h&#xA;&#xA;&#xA;// Define the data type structure for class1&#xA;typedef struct {&#xA;    char* name;&#xA;    int   one;&#xA;} class1_t;&#xA;&#xA;// Define the method type structure for class1 &#xA;union class1_ctt ; // class type tag, incomplete tag type for class1_ct&#xA;typedef struct { // method prototypes&#xA;    void (*init)( union class1_ctt* ); // passed a pointer to class1_ct&#xA;} class1_mt;&#xA;&#xA;// bind class1_mt and class1_t together into class1_ct&#xA;#define _VOID_NEW_CLASS class1&#xA;#include &quot;voidbind.h&quot;&#xA;&#xA;// Begin class2 definition&#xA;typedef struct { // define data type for class2&#xA;    int x;&#xA;} class2_t;&#xA;&#xA;union class2_ctt ; // class type tag, forward definition&#xA;typedef struct { // method prototypes for class2&#xA;    char* (*tryme)( union class2_ctt*, char* echo );&#xA;} class2_mt;&#xA;&#xA;// bind class2_t and class2_mt together into class2_ct&#xA;#define _VOID_NEW_CLASS class2&#xA;#include &quot;voidbind.h&quot;&#xA;&#xA;// --------------------------------------------- Start library code&#xA;// This would normally be a separate file, and linked in&#xA;// but as were doing a test, this is in the header instead...&#xA;&#xA;//#include &amp;lt;class1.h&amp;gt;&#xA;&#xA;void class1_init( class1_ct* self ) {&#xA;    self-&amp;gt;m.name = &quot;test&quot;;&#xA;    self-&amp;gt;m.one=5;  &#xA;}&#xA;&#xA;// Define class1's method type (_mt) instance of linker data (_ld):&#xA;// voidbind.h when it creates classes, expects an instance of the&#xA;// method type (_mt) named with _mt_ld appended to link the prototyped&#xA;// methods to C functions.  This is the actual &quot;binding&quot; information&#xA;// and is the data that I can't get to &quot;optimize out&quot;, eg: when there&#xA;// is more than one method, and some of them are not used by the program&#xA;&#xA;class1_mt class1_mt_ld = {&#xA;    .init=class1_init&#xA;};&#xA;&#xA;// ----------- CLASS2 libcode ----&#xA;&#xA;char* class2_tryme( class2_ct* self, char* echo ) {&#xA;    return echo;&#xA;}&#xA;&#xA;// class2's method type (_mt) instance of linker data (_ld).&#xA;class2_mt class2_mt_ld = { // linker information for method addresses&#xA;    .tryme=class2_tryme&#xA;};&#xA;&#xA;// --------------------------------------------- End of library code&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Finally, comes voidbind.h&#xA;This is the heart of the system, Getting the CPP to make a compile time constant list of void* pointers to method structs ... the void* list will always optimize out, as long as everything passed in are compile time constants. (But the structs in the list will not completely optimize out. :( even if constants. )&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For this to idea to work, I had to figure out a way to make cpp count how many times the voidbind header file was #included, in order to automatically make a list of class pointers, and since the macro preprocessor can not do addition, or define macros which change based on a previous definition of the same macro name; I had to use inline functions to &quot;save&quot; the pointer to the class method struct (_mt) from one pass to the next.  That's what forces me to basically use void* pointers, though it might be solvable in another way.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// voidbind.h&#xA;// A way to build compile time void pointer arrays&#xA;// These arrays are lists of constants that are only important at compile&#xA;// time and which &quot;go away&quot; once the compilation is finished (eg:static bind).&#xA;// Example code written by: Andrew F. Robinson of Scappoose&#xA;&#xA;&#xA;#ifdef _VOID_WAS_FINALIZED //#{&#xA;#error voidbind_h was included twice after a _VOID_FINALIZE was defined&#xA;#endif //#}&#xA;&#xA;// _VOID_FINALIZE, define only after all class headers have been included. &#xA;// It will simplify the macro expansion output, and minimize the memory impact&#xA;// of an optimization failure or disabling of the optimization in a bad compiler&#xA;// in hopes of making the program still work.&#xA;&#xA;#ifdef _VOID_FINALIZE //#{&#xA;#define _VOID_WAS_FINALIZED&#xA;#undef _VOID_BIND&#xA;static inline void* _VOID_BIND( int x ) {&#xA;    return _VOID_BIND_OBJ[ x ];&#xA;}&#xA;#else&#xA;&#xA;// Make sure this file has data predefined for binding before being&#xA;// included, or else error out so the user knows it's missing a define.&#xA;&#xA;#if ! defined( _VOID_NEW_OBJ ) &amp;amp;&amp;amp; ! defined( _VOID_NEW_CLASS ) //#{&#xA;#error missing a define of _VOID_NEW_OBJ or _VOID_NEW_CLASS&#xA;#endif //#}&#xA;&#xA;&#xA;// Initialize a macro (once) to count the number of times this file&#xA;// has been included; eg: since one object is to be added to the void&#xA;// list each time this file is #included. ( _VOID_OBJn ) &#xA;&#xA;#ifndef _VOID_OBJn //#{&#xA;#define _VOID_OBJn _ERROR_VOID_OBJn_NOT_INITIALIZED_&#xA;&#xA;// Initialize, once, macros to do name concatenations &#xA;#define __VOID_CAT( x, y ) x ## y&#xA;#define _VOID_CAT( x, y ) __VOID_CAT( x , y )&#xA;&#xA;// Initialize, once, the empty void* list of pointers for classes, objs.&#xA;#define _VOID_BIND_OBJ (void* []){\&#xA;    _VOID_OBJ0() , _VOID_OBJ1() , _VOID_OBJ2() , _VOID_OBJ3() , _VOID_OBJ4()\&#xA; ,  _VOID_OBJ5() , _VOID_OBJ6() , _VOID_OBJ7() , _VOID_OBJ8() , _VOID_OBJ9()\&#xA;}&#xA;// Define a function macro to return the list, so it can be easily&#xA;// replaced by a _FINALIZED  inline() function, later&#xA;#define _VOID_BIND(x) _VOID_BIND_OBJ[ x ]&#xA;&#xA;// All void pointers are initially null macros.  So the void list is 0.&#xA;#define _VOID_OBJ0()  0&#xA;#define _VOID_OBJ1()  0&#xA;#define _VOID_OBJ2()  0&#xA;#define _VOID_OBJ3()  0&#xA;#define _VOID_OBJ4()  0&#xA;#define _VOID_OBJ5()  0&#xA;#define _VOID_OBJ6()  0&#xA;#define _VOID_OBJ7()  0&#xA;#define _VOID_OBJ8()  0&#xA;#define _VOID_OBJ9()  0&#xA;#endif //#}&#xA;&#xA;// Figure out how many times this macro has been called, by&#xA;// checking for how many _VOID_OBJn() function macros have been&#xA;// replaced by inline functions&#xA;&#xA;#undef _VOID_OBJn&#xA;&#xA;#if defined( _VOID_OBJ0 ) // #{&#xA;#undef _VOID_OBJ0&#xA;#define _VOID_OBJn 0&#xA;#elif defined( _VOID_OBJ1 )&#xA;#undef _VOID_OBJ1&#xA;#define _VOID_OBJn 1&#xA;#elif defined( _VOID_OBJ2 )&#xA;#undef _VOID_OBJ2&#xA;#define _VOID_OBJn 2&#xA;#elif defined( _VOID_OBJ3 )&#xA;#undef _VOID_OBJ3&#xA;#define _VOID_OBJn 3&#xA;#elif defined( _VOID_OBJ4 )&#xA;#undef _VOID_OBJ4&#xA;#define _VOID_OBJn 4&#xA;#elif defined( _VOID_OBJ5 )&#xA;#undef _VOID_OBJ5&#xA;#define _VOID_OBJn 5&#xA;#elif defined( _VOID_OBJ6 )&#xA;#undef _VOID_OBJ6&#xA;#define _VOID_OBJn 6&#xA;#elif defined( _VOID_OBJ7 )&#xA;#undef _VOID_OBJ7&#xA;#define _VOID_OBJn 7&#xA;#elif defined( _VOID_OBJ8 )&#xA;#undef _VOID_OBJ8&#xA;#define _VOID_OBJn 8&#xA;#elif defined( _VOID_OBJ9 )&#xA;#undef _VOID_OBJ9&#xA;#define _VOID_OBJn 9 &#xA;#else&#xA;#error Attempted to define more than ten objects&#xA;#endif //#}&#xA;&#xA;// -------------------------------------------------------&#xA;// If the user defines _VOID_NEW_CLASS&#xA;// Create a union of the two class structs, xxx_t and xxx_mt&#xA;// and call it xxx_ct.  It must also be compatible with xxx_ctt, the tag&#xA;// which allows forward definitions in the class headers.&#xA;&#xA;#ifdef  _VOID_NEW_CLASS //#{&#xA;#ifndef M  //#{&#xA;#define M( var , method , ... )\&#xA;        (( (typeof(var._VOIDBIND_T))_VOID_BIND( sizeof(*(var._VOIDBIND)) ) )-&amp;gt;\&#xA;        method( &amp;amp; var , ## __VA_ARGS__ ))&#xA;#endif //#}&#xA;extern _VOID_CAT( _VOID_NEW_CLASS , _mt ) _VOID_CAT( _VOID_NEW_CLASS , _mt_ld );&#xA;typedef union _VOID_CAT( _VOID_NEW_CLASS, _ctt ) {&#xA;    char (*_VOIDBIND)[ _VOID_OBJn ];&#xA;    _VOID_CAT( _VOID_NEW_CLASS , _mt ) *_VOIDBIND_T;&#xA;    _VOID_CAT( _VOID_NEW_CLASS , _t ) m ;&#xA;} _VOID_CAT( _VOID_NEW_CLASS , _ct );&#xA;&#xA;static inline void* (_VOID_CAT( _VOID_OBJ , _VOID_OBJn )) ( void ) {&#xA;    return &amp;amp; _VOID_CAT( _VOID_NEW_CLASS, _mt_ld );&#xA;}&#xA;#undef _VOID_NEW_CLASS&#xA;#else // ---------- Otherwise, just bind whatever object was passed in&#xA;static inline _VOID_CAT( _VOID_OBJ , _VOID_OBJn ) (void) {&#xA;    return (void*) &amp;amp; _VOID_NEW_OBJ ;&#xA;}&#xA;#undef _VOID_NEW_OBJ&#xA;#endif //#}&#xA;&#xA;// End of Macros to define a list of pointers to class method structures&#xA;// and to bind data types to method types.&#xA;&#xA;#endif //#}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="2133679" LastEditorUserId="2682312" LastEditDate="2015-05-01T17:44:04.720" LastActivityDate="2015-05-01T17:44:04.720" Title="Improving a minimalistic OOP for microcontrollers using C, gcc, C99, and Macros with optimization" Tags="&lt;c&gt;&lt;oop&gt;&lt;pointers&gt;&lt;gcc&gt;" AnswerCount="4" CommentCount="23" FavoriteCount="5" />
  <row Id="29944454" PostTypeId="1" CreationDate="2015-04-29T12:57:22.777" Score="0" ViewCount="183" Body="&lt;p&gt;I have problem and hope, that you could help me.&#xA;I try to make CAN-communication between two dsPIC30F4011. It also works. Now I have to make the Identifier. I have to use the SID and the EID. They are divided into 4 parts. I want to make a bit-declaration and get an error.&#xA;I made a new header-file&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef IDENTIFIER_H&#xA;#define IDENTIFIER_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;&#xA;&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif  /* IDENTIFIER_H */&#xA;&#xA;&#xA;#include &amp;lt;p30F4011.h&amp;gt;&#xA;#include &quot;system.h&quot;&#xA;#include &amp;lt;p30fxxxx.h&amp;gt;&#xA;&#xA;&#xA;typedef struct tagCxTXxSIDBITS{&#xA;    unsigned          : 11;&#xA;    unsigned PRIO4_0  : 5;&#xA;}CxTXxPRIOBITS;&#xA;&#xA;extern volatile unsigned int C1TX0PRIO __attribute__((__sfr__));&#xA;extern volatile CxTXxPRIOBITS C1TX0PRIObits __attribute__((__sfr__));&#xA;extern volatile unsigned int C1TX1PRIO __attribute__((__sfr__));&#xA;extern volatile CxTXxPRIOBITS C1TX1PRIObits __attribute__((__sfr__));&#xA;extern volatile unsigned int C1TX2PRIO __attribute__((__sfr__));&#xA;extern volatile CxTXxPRIOBITS C1TX2PRIObits __attribute__((__sfr__));&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;In the Code I want to write&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;...&#xA;...&#xA;C1TX0PRIO = 0x0000;&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;If I want to build the project I get the error&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;pre&gt;&lt;code&gt;build/default/production/CAN_function.o(.text+0x66): In  function    `.LSM19':&#xA;: undefined reference to `_C1TX0PRIO'&#xA;make[2]: *** [dist/default/production/blink.X.production.hex] Error 255&#xA;make[1]: *** [.build-conf] Error 2&#xA;make: *** [.build-impl] Error 2&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;What did I do wrong?&#xA;I wrote it like in the p30F4011.h&lt;/p&gt;&#xA;" OwnerUserId="4846464" LastEditorUserId="2173917" LastEditDate="2015-04-29T13:21:20.407" LastActivityDate="2015-04-29T13:39:24.230" Title="bit-declaration - undefined reference to 'variable'" Tags="&lt;c&gt;&lt;declaration&gt;&lt;definition&gt;&lt;extern&gt;&lt;undefined-reference&gt;" AnswerCount="2" CommentCount="1" />
  <row Id="30182018" PostTypeId="1" AcceptedAnswerId="30182771" CreationDate="2015-05-12T04:50:39.730" Score="0" ViewCount="128" Body="&lt;p&gt;How can i change change the name of project executable in c++?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I know that i can do it in Project Properties under &quot;Configuration Properties&quot;, &#xA;but i want to do it in my code, for example using conditions &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef *something define*&#xA;        //Project name be A.exe&#xA;#else&#xA;        //Project name be B.exe&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="4814591" LastEditorUserId="635608" LastEditDate="2015-05-12T05:45:55.623" LastActivityDate="2015-05-12T05:51:01.173" Title="How change project name with conditions in c++" Tags="&lt;c++&gt;&lt;visual-studio-2010&gt;" AnswerCount="1" CommentCount="8" FavoriteCount="2" />
  <row Id="30312874" PostTypeId="1" CreationDate="2015-05-18T21:10:19.580" Score="2" ViewCount="479" Body="&lt;p&gt;I have a Wix project that uses compilation constants and &lt;code&gt;&amp;lt;?ifdef ?&amp;gt;&lt;/code&gt; for different build configurations. Is it possible to check if certain variables are defined using &lt;code&gt;&amp;lt;?ifdef ?&amp;gt;&lt;/code&gt; and some kind of &lt;code&gt;OR&lt;/code&gt;?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I've tried &lt;code&gt;&amp;lt;?ifdef A Or B ?&amp;gt;&lt;/code&gt; which doesn't seem to work, though I also do not seem to get any errors.&lt;/p&gt;&#xA;" OwnerUserId="4812586" LastEditorUserId="4812586" LastEditDate="2015-05-18T21:42:16.073" LastActivityDate="2015-05-18T23:45:15.827" Title="WiX preprocessor &lt;?ifdef ?&gt; with multiple variables and &quot;OR&quot;" Tags="&lt;wix&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="30418119" PostTypeId="1" CreationDate="2015-05-23T22:18:09.223" Score="3" ViewCount="44" Body="&lt;p&gt;Consider a project of hundred of C files that can be built in different configurations. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;A configuration can be distinguished with an additionnal &lt;code&gt;-D&lt;/code&gt; sent to the compiler &lt;em&gt;i.e.&lt;/em&gt; &lt;code&gt;-DHARDWARE_FOO&lt;/code&gt; or &lt;code&gt;-DHARDWARE_BAR&lt;/code&gt;. When the configuration change I usually need to clean all the objects files by doing this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;make clean all&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Otherwise &lt;code&gt;make&lt;/code&gt; won't rebuild the project because none of the dependencies have changed. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;The trivial solution to avoid cleaning the project manually would be to use a text file named &lt;code&gt;configuration&lt;/code&gt; that contains the name of the current configuration. In the &lt;code&gt;Makefile&lt;/code&gt; we will find:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;%o:%c $(CONFIGURATION) &#xA;   $(cc) -c $&amp;lt; -o $@ -D$(shell cat $(CONFIGURATION))&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Unfortunately this will still require to rebuild the whole project everytime the configuration change. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I feel this solution can be optimized if I am able to tell make to only rebuild the files that depend on the declaration &lt;code&gt;$(CONFIGURATION)&lt;/code&gt; &lt;em&gt;i.e.&lt;/em&gt; &lt;code&gt;HARDWARE_xxx&lt;/code&gt;. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;This could save a lot of time especially when the number of different hardwares is large. In my specific case I am talking about an embedded firmware that can run on different hardware platforms. An hardware platform is identified by a define sent to the compiler. So in the sources we will find plenty of &lt;code&gt;#ifdef ... #elif ... #endif&lt;/code&gt; directives&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My initial thoughts regarding this question was to use a script &lt;code&gt;getdependencies&lt;/code&gt; that will check all the C files (with their includes) recusively in order to identify which ones depend on the configuration. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;So in the &lt;code&gt;Makefile&lt;/code&gt; I will find:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;-import configurations.d&#xA;configurations.d: configuration&#xA;    getdependencies --configuration=$&amp;lt; $(SRCS)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I made some research on this to see if a similar solution already exist because I don't want to reinvent the wheel. Unfortunately I did not find anything like this. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any idea?&lt;/p&gt;&#xA;" OwnerUserId="2612235" LastActivityDate="2015-05-23T22:47:39.620" Title="How to save build time when the configuration change?" Tags="&lt;c&gt;&lt;makefile&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="1" />
  <row Id="30465466" PostTypeId="1" CreationDate="2015-05-26T17:49:06.873" Score="0" ViewCount="28" Body="&lt;p&gt;Hello i'm trying to use condition statements in my makefile to have it execute different make targets, but it skips over the condition and goes right to the else.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;He's a general example of what i'm trying to do &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ifdef ($(RUN_TEST))&#xA;all: install run uninstall &#xA;else&#xA;all: install uninstall&#xA;endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3400512" LastActivityDate="2015-05-27T04:01:07.107" Title="Using Condition statements with Makefile targets" Tags="&lt;makefile&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="30470528" PostTypeId="1" AcceptedAnswerId="30470571" CreationDate="2015-05-26T23:11:47.203" Score="1" ViewCount="264" Body="&lt;p&gt;I want to trace my code if &lt;code&gt;DEBUG&lt;/code&gt; is defined, as in the following &lt;code&gt;#ifdef&lt;/code&gt; code block:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef DEBUG&#xA;    OP_LOG(debug) &amp;lt;&amp;lt; &quot;SEQUENCE:  &quot; __FILE__ &amp;lt;&amp;lt; &quot;::&quot; &amp;lt;&amp;lt; __FUNCTION__;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Someone said I could use a &lt;code&gt;#define&lt;/code&gt; so that the above three lines would only be one line instead. This is the closest I could get to figuring it out, but it gives tracing output unconditionally, whether or not &lt;code&gt;DEBUG&lt;/code&gt; is defined:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define DEBUG_TRACE(note) OP_LOG(debug) &amp;lt;&amp;lt; &quot;SEQUENCE :  &quot; &amp;lt;&amp;lt; __FILE__ &amp;lt;&amp;lt;&quot;::&quot; &amp;lt;&amp;lt;__FUNCTION__ &amp;lt;&amp;lt; note&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I don't know how to make a conditional &lt;code&gt;#define&lt;/code&gt;. Is this possible, and if so, how to do it?&lt;/p&gt;&#xA;" OwnerUserId="1735836" LastEditorUserId="4860403" LastEditDate="2015-05-27T00:09:06.257" LastActivityDate="2015-05-27T00:09:06.257" Title="C++ on Linux - How do I #define a #ifdef / #endif debug conditional" Tags="&lt;c++&gt;&lt;debugging&gt;&lt;logging&gt;&lt;c-preprocessor&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="31072240" PostTypeId="1" AcceptedAnswerId="31072381" CreationDate="2015-06-26T11:38:08.593" Score="0" ViewCount="488" Body="&lt;p&gt;While I am running this md5 code, it is taking maximum 64 characters length of input at run time. Whenever I am giving more than 64 characters, it is showing &lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;&lt;code&gt;Inconsistency detected by ld.so: dl-fini.c: 205: _dl_fini: Assertion ns != 0 || i == nloaded failed!&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;I need to hash nearly 10kb of input (only string). Do I need to change anything in the header file? Can anyone tell me solution please?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;md5.h&lt;/strong&gt; &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef HEADER_MD5_H&#xA;#define HEADER_MD5_H&#xA;&#xA;#include &amp;lt;openssl/e_os2.h&amp;gt;&#xA;#include &amp;lt;stddef.h&amp;gt;&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;#ifdef OPENSSL_NO_MD5&#xA;#error MD5 is disabled.&#xA;#endif&#xA;&#xA;/*&#xA;  * !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&#xA;  * ! MD5_LONG has to be at least 32 bits wide. If it's wider, then !&#xA;  * ! MD5_LONG_LOG2 has to be defined along.                        !&#xA;  * !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&#xA;*/&#xA;&#xA;#if defined(__LP64__)&#xA;#define MD5_LONG unsigned long&#xA;#elif defined(OPENSSL_SYS_CRAY) || defined(__ILP64__)&#xA;#define MD5_LONG unsigned long&#xA;#define MD5_LONG_LOG2 3  &#xA;/*&#xA;  * _CRAY note. I could declare short, but I have no idea what impact&#xA;  * does it have on performance on none-T3E machines. I could declare&#xA;  * int, but at least on C90 sizeof(int) can be chosen at compile time.&#xA;  *  So I've chosen long...&#xA;  *                                      &amp;lt;appro@fy.chalmers.se&amp;gt;&#xA; */&#xA;#else&#xA;#define MD5_LONG unsigned long   &#xA;#endif&#xA;&#xA;#define MD5_CBLOCK      64&#xA;#define MD5_LBLOCK      (MD5_CBLOCK/2)&#xA;#define MD5_DIGEST_LENGTH 16&#xA;&#xA;typedef struct MD5state_st&#xA;    {&#xA;    MD5_LONG A,B,C,D;&#xA;    MD5_LONG Nl,Nh;&#xA;    MD5_LONG data[MD5_LBLOCK];&#xA;    unsigned int num;&#xA;    } MD5_CTX;&#xA;&#xA;#ifdef OPENSSL_FIPS&#xA;int private_MD5_Init(MD5_CTX *c);&#xA;#endif&#xA;int MD5_Init(MD5_CTX *c);&#xA;int MD5_Update(MD5_CTX *c, const void *data, size_t len);&#xA;int MD5_Final(unsigned char *md, MD5_CTX *c);&#xA;unsigned char *MD5(const unsigned char *d, size_t n, unsigned char *md);&#xA;void MD5_Transform(MD5_CTX *c, const unsigned char *b);&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;md5.c&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;  #include &amp;lt;stdio.h&amp;gt;&#xA;  #include &amp;lt;stdlib.h&amp;gt;&#xA;  #include &amp;lt;string.h&amp;gt;&#xA;  #include &quot;md5.h&quot;&#xA;&#xA; char *pt(char *, int );&#xA; int main(int argc, char **argv) &#xA; {&#xA;    char *in;&#xA;    char *out;&#xA;    printf(&quot;ENter the string\n&quot;);&#xA;    scanf(&quot;%[^\n]s&quot;,in);&#xA;    size_t len;    //unsigned long len;  size_t len; &#xA;    len = printf(&quot;len is %d\n&quot;,strlen(in));&#xA;    out = pt(in, len);&#xA;    printf(&quot;MD5 is\t: %s\n&quot;, out);&#xA;    free(out);&#xA;    //return 0; &#xA; }&#xA;&#xA;&#xA; char *pt(char *str, int length) &#xA; {&#xA;   int n;&#xA;   MD5_CTX c;&#xA;   unsigned char digest[16];&#xA;   char *output = (char*)malloc(33);&#xA;&#xA;   MD5_Init(&amp;amp;c);&#xA;&#xA;   MD5_Update(&amp;amp;c, str, length);&#xA;&#xA;   MD5_Final(digest, &amp;amp;c);&#xA;&#xA;   for (n = 0; n &amp;lt; 16; ++n)&#xA;   {&#xA;     sprintf(&amp;amp;output[n*2], &quot;%02x&quot;, (unsigned int)digest[n]);&#xA;   }&#xA;&#xA;   return output;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="5015113" LastEditorUserId="608639" LastEditDate="2015-06-26T15:58:47.567" LastActivityDate="2015-06-26T15:58:47.567" Title="Segmentation fault around MD5 code" Tags="&lt;c&gt;&lt;openssl&gt;&lt;runtime-error&gt;&lt;md5&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="31192189" PostTypeId="1" AcceptedAnswerId="31192374" CreationDate="2015-07-02T18:38:02.260" Score="0" ViewCount="220" Body="&lt;p&gt;Is it possible to disable chunks of code with c/c++ preprocessor depending on some definition, without instrumenting code with &lt;code&gt;#ifdef #endif&lt;/code&gt;?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; // if ENABLE_TEST_SONAR is not defined, test code will be eliminated by preprocessor&#xA; TEST_BEGIN(SONAR)&#xA;   uint8_t sonar_range = get_sonar_measurement(i);&#xA;   TEST_ASSERT(sonar_range &amp;lt; 300)&#xA;   TEST_ASSERT(sonar_range &amp;gt; 100)&#xA; TEST_END&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Functionally equivalent to something as follows:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef TEST_SONAR&#xA;    serial_print(&quot;test_case sonar:\r\n&quot;);&#xA;    uint8_t sonar_range = get_sonar_measurement(i);&#xA;    serial_print(&quot;  test sonar_range &amp;lt; 300:%d\r\n&quot;, sonar_range &amp;lt; 300);&#xA;    serial_print(&quot;  test sonar_range &amp;gt; 100:%d\r\n&quot;, sonar_range &amp;gt; 100);&#xA;#endif TEST_SONAR&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1008902" LastEditorUserId="1008902" LastEditDate="2015-07-02T18:51:58.873" LastActivityDate="2015-07-02T19:11:37.073" Title="Disable multiline statements with c/c++ macro" Tags="&lt;c++&gt;&lt;c&gt;&lt;c-preprocessor&gt;" AnswerCount="3" CommentCount="9" />
  <row Id="31580871" PostTypeId="1" AcceptedAnswerId="31733169" CreationDate="2015-07-23T07:31:53.113" Score="1" ViewCount="90" Body="&lt;p&gt;I've googled that Scala uses &quot;@elidable&quot; as a kind of macro in C++.&lt;br&gt;&#xA;Does ChiselHDL also support something like this for debugging?&lt;br&gt;&#xA;Or, any other alternatives?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;in scala contexts,&lt;/p&gt;&#xA;&#xA;&lt;pre class=&quot;lang-scala prettyprint-override&quot;&gt;&lt;code&gt;@elidable(WARNING) def debug(signal: Wire) = when(signal){ printf(&quot;Cache miss!&quot;) }&#xA;debug(miss)  // At every rising edge of clock, print whether there's cache miss or not.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Suppose Chisel has the preprocessor and #ifdef statement&#xA;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define DEBUG&#xA;#ifdef DEBUG&#xA;    when(is_cache_miss){ printf(&quot;Cache miss!&quot;) }&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3134471" LastEditorUserId="3134471" LastEditDate="2015-07-23T12:06:47.817" LastActivityDate="2015-07-30T20:13:30.457" Title="Does ChiselHDL supports something like #ifdef (macro)?" Tags="&lt;scala&gt;&lt;hdl&gt;&lt;chisel&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="31657499" PostTypeId="1" AcceptedAnswerId="31658120" CreationDate="2015-07-27T15:44:25.487" Score="7" ViewCount="947" Body="&lt;p&gt;I think this is part of the problem at &lt;a href=&quot;http://stackoverflow.com/q/31655462&quot;&gt;No type named 'unique_ptr' in namespace 'std' when compiling under LLVM/Clang&lt;/a&gt;. &lt;a href=&quot;http://marshall.calepin.co/c-and-xcode-46.html&quot; rel=&quot;nofollow&quot;&gt;According to Marshall Clow&lt;/a&gt;, I can detect &lt;code&gt;-stdlib=libc++&lt;/code&gt; via &lt;code&gt;_LIBCPP_VERSION&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;If you're writing cross-platform code, sometimes you need to know what&#xA;  standard library you are using. In theory, they should all offer&#xA;  equivalent functionality, but that's just theory. Sometimes you just&#xA;  need to know. The best way to check for libc++ is to look for the&#xA;  preprocessor symbol _LIBCPP_VERSION. If that's defined, then you're&#xA;  using libc++.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  _LIBCPP_VERSION&#xA;//  libc++ specific code here&#xA;#else&#xA;//  generic code here&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;Unfortunately, that breaks down with Apple's Clang (3.4-SVN) and the Clang (3.6) I built from sources after downloading from the LLVM project. I'm guessing the test is only valid under Xcode.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;How can I reliably detect &lt;code&gt;-stdlib=libc++&lt;/code&gt; in the preprocessor?&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;Here is the test case:&lt;/p&gt;&#xA;&#xA;&lt;pre class=&quot;lang-c++ prettyprint-override&quot;&gt;&lt;code&gt;$ cat test-clapple.cxx&#xA;&#xA;// Need to test {C++03,C++11} x {libc++, no libc++}&#xA;&#xA;// c++ -c test-clapple.cxx&#xA;//     - OK&#xA;// c++ -stdlib=libc++ -c test-clapple.cxx&#xA;//     - OK&#xA;// c++ -std=c++11 -c test-clapple.cxx&#xA;//     - FAILS, no type named 'unique_ptr' in namespace 'std'&#xA;// c++ -std=c++11 -stdlib=libc++ -c test-clapple.cxx&#xA;//     - OK&#xA;&#xA;#include &amp;lt;ciso646&amp;gt;&#xA;&#xA;#if (__cplusplus &amp;gt;= 201103L) || (_MSC_VER &amp;gt;= 1600)&#xA;# pragma message &quot;C++11&quot;&#xA;#elif (__cplusplus &amp;gt;= 199711L)&#xA;# pragma message &quot;C++03&quot;&#xA;#endif&#xA;&#xA;#if (_LIBCPP_VERSION)&#xA;# pragma message &quot;libc++&quot;&#xA;#else&#xA;# pragma message &quot;no libc++&quot;&#xA;#endif&#xA;&#xA;#if defined(__apple_build_version__)&#xA;# pragma message &quot;Apple build&quot;&#xA;#else&#xA;# pragma message &quot;non-Apple build&quot;&#xA;#endif&#xA;&#xA;#if (__cplusplus &amp;gt;= 201103L) || (_MSC_VER &amp;gt;= 1600) // C++11&#xA;# include &amp;lt;memory&amp;gt;&#xA;#else&#xA;# include &amp;lt;tr1/memory&amp;gt;&#xA;#endif&#xA;&#xA;// Manage auto_ptr warnings and deprecation in C++11&#xA;#if (__cplusplus &amp;gt;= 201103L) || (_MSC_VER &amp;gt;= 1600)&#xA;  template&amp;lt;typename T&amp;gt;&#xA;    using auto_ptr = std::unique_ptr&amp;lt;T&amp;gt;;&#xA;#else&#xA;  using std::auto_ptr;&#xA;#endif // C++11&#xA;&#xA;int main(int argc, char* argv[])&#xA;{&#xA;    return argc;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;This project does not use Autotools, Cmake, Boost, or other external libraries or frameworks.&lt;/p&gt;&#xA;" OwnerUserId="608639" LastEditorUserId="608639" LastEditDate="2015-07-27T21:40:01.633" LastActivityDate="2016-11-16T11:23:00.930" Title="How to detect -stdlib=libc++ in the preprocessor?" Tags="&lt;c++&gt;&lt;clang&gt;&lt;llvm&gt;&lt;c-preprocessor&gt;&lt;libc++&gt;" AnswerCount="1" CommentCount="4" />
  <row Id="31842275" PostTypeId="1" CreationDate="2015-08-05T20:32:37.107" Score="-1" ViewCount="174" Body="&lt;p&gt;I have type:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;typedef struct &#xA;{&#xA;   int x;&#xA;   int y;&#xA;   int z; &#xA;} sdf_test_t;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But when I try to compile the following:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;offset = offsetof(sdf_test_t, z);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Visual Studio responds with:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;c:\dataflash.c(542) : error C2143: syntax error : missing ')' before 'type'&#xA;c:\dataflash.c(542) : error C2059: syntax error : ')'&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;What is wrong here?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I am using:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Microsoft Visual Studio 2008 x86 &#xA;Microsoft (R) Visual Studio Version 9.0.21022.8.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The &lt;code&gt;offsetof&lt;/code&gt; macro is defined in &lt;code&gt;&amp;lt;stddef.h&amp;gt;&lt;/code&gt; as follows:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* Define offsetof macro */&#xA;#ifdef __cplusplus&#xA;&#xA;#ifdef  _WIN64&#xA;#define offsetof(s,m)   (size_t)( (ptrdiff_t)&amp;amp;reinterpret_cast&amp;lt;const volatile char&amp;amp;&amp;gt;((((s *)0)-&amp;gt;m)) )&#xA;#else&#xA;#define offsetof(s,m)   (size_t)&amp;amp;reinterpret_cast&amp;lt;const volatile char&amp;amp;&amp;gt;((((s *)0)-&amp;gt;m))&#xA;#endif&#xA;&#xA;#else&#xA;&#xA;#ifdef  _WIN64&#xA;#define offsetof(s,m)   (size_t)( (ptrdiff_t)&amp;amp;(((s *)0)-&amp;gt;m) )&#xA;#else&#xA;#define offsetof(s,m)   (size_t)&amp;amp;(((s *)0)-&amp;gt;m)&#xA;#endif&#xA;&#xA;#endif  /* __cplusplus */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;By elimination. I've established that the compiler uses:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define offsetof(s,m)   (size_t)&amp;amp;reinterpret_cast&amp;lt;const volatile char&amp;amp;&amp;gt;((((s *)0)-&amp;gt;m))&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="4459346" LastEditorUserId="4459346" LastEditDate="2015-08-05T20:41:32.903" LastActivityDate="2015-08-05T21:00:37.167" Title="Visual Studio Syntax Error on offsetof()" Tags="&lt;visual-studio&gt;&lt;visual-c++&gt;&lt;visual-studio-2008&gt;&lt;offsetof&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="31872889" PostTypeId="1" CreationDate="2015-08-07T08:20:20.053" Score="-1" ViewCount="69" Body="&lt;p&gt;When I was checking some import statement I found some import statement is in the pattern like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef A&#xA;&#xA;#ifdef B&#xA;//SOME SETTINGS 1 (some include,define,ifdef...)&#xA;#else&#xA;//SOME SETTINGS 2 (some include,define,ifdef...)&#xA;#endif&#xA;&#xA;#else&#xA;&#xA;#ifndef B&#xA;//SOME SETTINGS 1 (some include,define,ifdef...)&#xA;#else&#xA;//SOME SETTINGS 2 (some include,define,ifdef...)&#xA;#endif&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;which the macro of A is just inverse the macro of B,but &quot;//SOME SETTINGS 1&quot; and &quot;//SOME SETTINGS 2&quot; need to appear twice, so I try to rewrite that:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef A&#xA;#ifdef B&#xA;#else&#xA;#ifndef B&#xA;#endif&#xA;&#xA;//SOME SETTINGS 1 (some include,define,ifdef...)&#xA;&#xA;#else&#xA;&#xA;//SOME SETTINGS 2 (some include,define,ifdef...)&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but it failed to compile, is there any syntax to simulate this case that &quot;//SOME SETTINGS 1&quot; and &quot;//SOME SETTINGS 2&quot; only need to appear once?&lt;/p&gt;&#xA;" OwnerUserId="4822120" LastActivityDate="2016-04-19T15:41:26.597" Title="Is it possible to simulate the effect that place #ifdef inside another #ifdef #endif?" Tags="&lt;c++&gt;&lt;syntax&gt;&lt;macros&gt;" AnswerCount="5" CommentCount="1" />
  <row Id="31892863" PostTypeId="1" CreationDate="2015-08-08T11:56:32.110" Score="0" ViewCount="128" Body="&lt;p&gt;Is it possible to show current #ifdef blocks in Emacs (eg in mode-line)?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For example:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef A&#xA;... | #cursor position num. 1&#xA;#ifdef !B &amp;amp; C&#xA;...&#xA;#else /* !B &amp;amp; C */&#xA;foo(); | #cursor position num. 2&#xA;#endif /* !B &amp;amp; C */&#xA;#endif /* A */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It should show &quot;A&quot; in mode line, if i put cursor in position 1 &#xA;and show &quot;A &amp;amp; !(!B $ C)&quot; in position 2.&#xA;I am already using hide-if-def mode. But sometimes i need to work with all #ifdef blocks.&lt;/p&gt;&#xA;" OwnerUserId="3759732" LastActivityDate="2015-11-02T23:34:24.467" Title="Emacs. Show current #ifdef blocks" Tags="&lt;emacs&gt;&lt;macros&gt;&lt;elisp&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="0" />
  <row Id="31943286" PostTypeId="1" AcceptedAnswerId="31993346" CreationDate="2015-08-11T13:33:41.090" Score="0" ViewCount="92" Body="&lt;p&gt;I have an C-Mex S-function that implements a Tutsin - Eulor PECE algorithm.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The function is worky perfectly fine, if only one block is present in the model. If I put several instances of the block, to filter several signals, then the outputs starts to be null.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I think that the difference instances of the function share the same memory, and this mess with my states vectors. I am not using the discrete state functions provided by MatLab, instead I use my own declared arrays of doubles (real_T ) which are not extern.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any lead about this would be appreciated.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The code can be found here:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&quot;https://www.dropbox.com/s/d5nfdnio6qqrizq/te_pece.c?dl=0&quot; rel=&quot;nofollow&quot;&gt;https://www.dropbox.com/s/d5nfdnio6qqrizq/te_pece.c?dl=0&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Or under:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/*  File    : toto.c&#xA;*  Abstract:&#xA;*&#xA;*      Implements a Tutsin-Euler PECE algorithm.&#xA;*&#xA;*      This block implements a time transfer function discretisation&#xA;*      using Tutsin as a predictor and Euler as a corrector.&#xA;*&#xA;*      This block is capable of receiving multiple inputs at once (bus / vector)&#xA;*      and will treat them as separate signals to be processed by the same TF.&#xA;*&#xA;*      Use in real time, fixed step, environment.&#xA;*&#xA;*&#xA;*/&#xA;&#xA;#define S_FUNCTION_NAME toto&#xA;#define S_FUNCTION_LEVEL 2&#xA;&#xA;#include &quot;simstruc.h&quot;&#xA;&#xA;#include &quot;matrix.h&quot;&#xA;#include &quot;mex.h&quot;&#xA;&#xA;#define NUMERATOR_IDX 0&#xA;#define NUMERATOR_PARAM(S) ssGetSFcnParam(S,NUMERATOR_IDX)&#xA;&#xA;#define DENOMINATOR_IDX 1&#xA;#define DENOMINATOR_PARAM(S) ssGetSFcnParam(S,DENOMINATOR_IDX)&#xA;&#xA;#define SAMPLE_TIME_IDX 2&#xA;#define SAMPLE_TIME(S) ssGetSFcnParam(S,SAMPLE_TIME_IDX)&#xA;&#xA;#define NPARAMS 3&#xA;&#xA;/*====================*&#xA;* Private members    *&#xA;*====================*/&#xA;#define NSAMPLES 3&#xA;typedef enum {&#xA;    eN = 0,&#xA;    eNplusOne = 1,&#xA;    eNplusTwo = 2}&#xA;rankEnum;&#xA;&#xA;typedef enum {&#xA;    eNcd = 0,&#xA;    eStatesProcessed = 1,&#xA;    eOutputProcessed = 2}&#xA;rankProcessState;&#xA;rankProcessState mProcessState;&#xA;&#xA;int_T mTotalNumberOfDiscreteStates;&#xA;int_T mSignalNumberOfDiscreteStates;&#xA;int_T mNumberOfInputSignals;&#xA;&#xA;int_T mLoopIndex;&#xA;&#xA;int_T mInputWidth;&#xA;&#xA;real_T* mNumerator;&#xA;real_T* mDenominator;&#xA;&#xA;real_T** mPredictedStateVector;&#xA;real_T** mCorrectedStateVector;&#xA;real_T** mPredictedFunction;&#xA;real_T** mCorrectedFunction;&#xA;/*====================*&#xA;* Private methods *&#xA;*====================*/&#xA;void mInitializeRecursion();&#xA;&#xA;void mComputePredictedStates(real_T iSampleTime, rankEnum iComputedRank, rankEnum iPreviousRank);&#xA;void mComputeCorrectedStates(real_T iSampleTime, rankEnum iComputedRank, rankEnum iPreviousRank);&#xA;void mComputePredictedFunction(real_T iInput, rankEnum iComputedRank);&#xA;void mComputeCorrectedFunction(real_T iInput, rankEnum iComputedRank);&#xA;&#xA;void mUpdateStateVectors();&#xA;&#xA;/* Function: mEmitWarning ===============================================&#xA;* Abstract:&#xA;*    Display iMessage in matlab console&#xA;*    &#xA;*/&#xA;void mEmitWarning(const char* iMessage)&#xA;{&#xA;    mxArray *cell_array_ptr;&#xA;&#xA;    cell_array_ptr = mxCreateCellMatrix((mwSize)1,1);&#xA;    mxSetCell(cell_array_ptr,(mwIndex)0,mxCreateString(iMessage));&#xA;    mexCallMATLAB(0,NULL,1,&amp;amp;cell_array_ptr,&quot;disp&quot;);&#xA;}&#xA;&#xA;/*====================*&#xA;* S-function methods *&#xA;*====================*/&#xA;&#xA;/* Function: mdlInitializeSizes ===============================================&#xA;* Abstract:&#xA;*    The sizes information is used by Simulink to determine the S-function&#xA;*    block's characteristics (number of inputs, outputs, states, etc.).&#xA;*/&#xA;static void mdlInitializeSizes(SimStruct *S)&#xA;{&#xA;    ssSetNumSFcnParams(S, NPARAMS);  /* Number of expected parameters */&#xA;&#xA;    if (!ssSetNumInputPorts(S, 1)) return;&#xA;    ssSetInputPortWidth(S, 0, DYNAMICALLY_SIZED);   &#xA;    ssSetInputPortDirectFeedThrough(S,0,true);&#xA;&#xA;    if (!ssSetNumOutputPorts(S, 1)) return; &#xA;    ssSetOutputPortWidth(S, 0, DYNAMICALLY_SIZED);&#xA;&#xA;    ssSetNumDiscStates(S, 1);&#xA;}&#xA;&#xA;/* Function: mdlInitializeSampleTimes =========================================&#xA;* Abstract:&#xA;*    Specifiy that we inherit our sample time from the driving block.&#xA;*/&#xA;static void mdlInitializeSampleTimes(SimStruct *S)&#xA;{&#xA;    ssSetSampleTime(S, 0, *mxGetPr(SAMPLE_TIME(S)));&#xA;    ssSetOffsetTime(S, 0, 0.0);&#xA;}&#xA;&#xA;#define MDL_INITIALIZE_CONDITIONS&#xA;/* Function: mdlInitializeConditions ========================================&#xA;* Abstract:&#xA;*    Initialize the discrete states to zero and&#xA;*    allocate for states and function vectors&#xA;*/&#xA;static void mdlInitializeConditions(SimStruct *S)&#xA;{   &#xA;    int_T wDenominatorLength;&#xA;    int_T wNumeratorLength;&#xA;    real_T* wNumerator;&#xA;&#xA;    mInputWidth = ssGetInputPortWidth(S,0);&#xA;    ssSetOutputPortWidth(S, 0, mInputWidth);&#xA;&#xA;    //Avoid repetitive use of mxGetPr/mxGetNumberOfElements by fetching datas once.&#xA;    wNumeratorLength    = mxGetNumberOfElements(NUMERATOR_PARAM(S));&#xA;    wDenominatorLength  = mxGetNumberOfElements(DENOMINATOR_PARAM(S));&#xA;&#xA;    wNumerator   = mxGetPr(NUMERATOR_PARAM(S));&#xA;    mDenominator = mxGetPr(DENOMINATOR_PARAM(S));&#xA;&#xA;    mNumberOfInputSignals = ssGetInputPortWidth(S,0);&#xA;    mSignalNumberOfDiscreteStates = wDenominatorLength - 1;&#xA;    mTotalNumberOfDiscreteStates = mNumberOfInputSignals*mSignalNumberOfDiscreteStates;&#xA;&#xA;    ssSetNumContStates(S, 0);&#xA;    ssSetNumDiscStates(S, mTotalNumberOfDiscreteStates);        &#xA;&#xA;    //Ensure identical sizes for numerator and number of states, for matrix computations&#xA;    mNumerator = calloc(wDenominatorLength,sizeof(real_T));&#xA;    if(wNumeratorLength &amp;lt; mSignalNumberOfDiscreteStates)&#xA;    {   &#xA;        memcpy(mNumerator+(mSignalNumberOfDiscreteStates-wNumeratorLength),wNumerator,wNumeratorLength*sizeof(real_T));&#xA;    }&#xA;    else&#xA;    {&#xA;        memcpy(mNumerator,wNumerator,mSignalNumberOfDiscreteStates*sizeof(real_T));&#xA;    }&#xA;&#xA;    //Allocating for keeping in memory from n to n+2&#xA;    mPredictedStateVector = calloc(mTotalNumberOfDiscreteStates, sizeof(real_T));&#xA;    mCorrectedStateVector = calloc(mTotalNumberOfDiscreteStates, sizeof(real_T));&#xA;    mPredictedFunction = calloc(mTotalNumberOfDiscreteStates, sizeof(real_T));&#xA;    mCorrectedFunction = calloc(mTotalNumberOfDiscreteStates, sizeof(real_T));&#xA;    for (mLoopIndex = 0; mLoopIndex &amp;lt; mTotalNumberOfDiscreteStates; mLoopIndex++)&#xA;    {&#xA;        mPredictedStateVector[mLoopIndex] = calloc(NSAMPLES, sizeof(real_T));&#xA;        mCorrectedStateVector[mLoopIndex] = calloc(NSAMPLES, sizeof(real_T));&#xA;        mPredictedFunction[mLoopIndex] = calloc(NSAMPLES, sizeof(real_T));&#xA;        mCorrectedFunction[mLoopIndex] = calloc(NSAMPLES, sizeof(real_T));&#xA;    }&#xA;&#xA;    mInitializeRecursion(S);&#xA;}&#xA;&#xA;/* Function: mdlOutputs =======================================================&#xA;* Abstract:&#xA;*      y = Cx + Du &#xA;*&#xA;*      The discrete system is evaluated using a controllable state space&#xA;*      representation of the transfer function.  &#xA;*&#xA;*/&#xA;static void mdlOutputs(SimStruct *S, int_T tid)&#xA;{&#xA;    int_T wStateIndex;&#xA;    real_T *wOutput = ssGetOutputPortRealSignal(S,0);   &#xA;&#xA;    if (eStatesProcessed == mProcessState  &amp;amp;&amp;amp; ssIsSampleHit(S, 0, tid))&#xA;    {&#xA;        for (mLoopIndex = 0; mLoopIndex &amp;lt; mNumberOfInputSignals; mLoopIndex++)&#xA;        {&#xA;            if(NULL != wOutput)&#xA;            {&#xA;                *wOutput = 0;&#xA;                for (wStateIndex = 0; wStateIndex &amp;lt; mSignalNumberOfDiscreteStates; wStateIndex++)&#xA;                {&#xA;                    *wOutput  += mNumerator[wStateIndex]* mCorrectedStateVector[mLoopIndex*mSignalNumberOfDiscreteStates+wStateIndex][eNplusTwo];           &#xA;                }               &#xA;                *wOutput++;&#xA;            }&#xA;            else&#xA;            {&#xA;                break;&#xA;            }&#xA;&#xA;        }&#xA;        mUpdateStateVectors();&#xA;        mProcessState = eOutputProcessed;&#xA;    }&#xA;}&#xA;&#xA;#define MDL_UPDATE&#xA;/* Function: mdlUpdate ======================================================&#xA;* Abstract:&#xA;*      dx = Ax + Bu &#xA;*      The discrete system is evaluated using a controllable state space&#xA;*      representation of the transfer function.  &#xA;*&#xA;*/&#xA;&#xA;static void mdlUpdate(SimStruct *S, int_T tid)&#xA;{&#xA;    InputRealPtrsType wInput; &#xA;    real_T wSampleTime; &#xA;&#xA;    if ((eOutputProcessed == mProcessState || eNcd == mProcessState) &amp;amp;&amp;amp; ssIsSampleHit(S, 0, tid))&#xA;    {&#xA;        wInput = (InputRealPtrsType)ssGetInputPortSignalPtrs(S,0);&#xA;        wSampleTime = *mxGetPr(SAMPLE_TIME(S));&#xA;&#xA;        if(wInput != NULL)&#xA;        {&#xA;            mComputePredictedStates(wSampleTime,eNplusTwo,eNplusOne);&#xA;            mComputePredictedFunction(*wInput[0],eNplusTwo);&#xA;&#xA;            mComputeCorrectedStates(wSampleTime,eNplusTwo,eNplusOne);&#xA;            mComputeCorrectedFunction(*wInput[0],eNplusTwo);&#xA;&#xA;            mProcessState = eStatesProcessed;&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;/* Function: mdlTerminate =====================================================&#xA;* Abstract:&#xA;*    Free memory&#xA;*/&#xA;static void mdlTerminate(SimStruct *S)&#xA;{&#xA;    UNUSED_ARG(S); /* unused input argument */&#xA;&#xA;    free(mNumerator) ;&#xA;&#xA;    free(mPredictedStateVector) ;&#xA;    free(mCorrectedStateVector) ;&#xA;    free(mPredictedFunction) ;&#xA;    free(mCorrectedFunction) ;&#xA;}&#xA;&#xA;#ifdef  MATLAB_MEX_FILE    /* Is this file being compiled as a MEX-file? */&#xA;#include &quot;simulink.c&quot;      /* MEX-file interface mechanism */&#xA;#else&#xA;#include &quot;cg_sfun.h&quot;       /* Code generation registration function */&#xA;#endif&#xA;&#xA;/*====================*&#xA;* Private methods    *&#xA;*====================*/&#xA;&#xA;/* Function: mInitializeRecursion =======================================================&#xA;* Abstract:&#xA;*      &#xA;*&#xA;*/&#xA;void mInitializeRecursion()&#xA;{&#xA;    mProcessState = eNcd;&#xA;&#xA;    if (mCorrectedFunction !=NULL)&#xA;    {&#xA;        mCorrectedFunction[mTotalNumberOfDiscreteStates-1][eNplusOne] = 1;&#xA;    }&#xA;    else&#xA;    {&#xA;        mEmitWarning(&quot;Error in mdlInitializeConditions: Vectors are null&quot;);&#xA;    }&#xA;}&#xA;&#xA;/* Function: mComputePredictedStates =======================================================&#xA;* Abstract:&#xA;*      &#xA;*&#xA;*/&#xA;void mComputePredictedStates(real_T iSampleTime, rankEnum iComputedRank, rankEnum iPreviousRank)&#xA;{&#xA;    if (mPredictedStateVector != NULL &amp;amp;&amp;amp; mCorrectedStateVector !=NULL &amp;amp;&amp;amp; mCorrectedFunction !=NULL)&#xA;    {&#xA;        for (mLoopIndex = 0; mLoopIndex &amp;lt; mTotalNumberOfDiscreteStates; mLoopIndex++)&#xA;        {&#xA;            mPredictedStateVector[mLoopIndex][iComputedRank]  = mCorrectedStateVector[mLoopIndex][iPreviousRank] + 1/(double)2*iSampleTime*(3*mCorrectedFunction[mLoopIndex][iPreviousRank] - mCorrectedFunction[mLoopIndex][eN]);                  &#xA;        }&#xA;    }&#xA;    else&#xA;    {&#xA;        mEmitWarning(&quot;Error in mComputePredictedStates: Vectors are null&quot;);&#xA;    }&#xA;}&#xA;&#xA;/* Function: mComputeCorrectedStates =======================================================&#xA;* Abstract:&#xA;*      &#xA;*&#xA;*/&#xA;void mComputeCorrectedStates(real_T iSampleTime, rankEnum iComputedRank, rankEnum iPreviousRank)&#xA;{&#xA;    if (mCorrectedStateVector != NULL &amp;amp;&amp;amp; mCorrectedStateVector !=NULL &amp;amp;&amp;amp; mPredictedFunction !=NULL)&#xA;    {&#xA;        for (mLoopIndex = 0; mLoopIndex &amp;lt; mTotalNumberOfDiscreteStates; mLoopIndex++)&#xA;        {&#xA;            mCorrectedStateVector[mLoopIndex][iComputedRank]  = mCorrectedStateVector[mLoopIndex][iPreviousRank] + 1/(double)2*iSampleTime*(mPredictedFunction[mLoopIndex][iComputedRank] + mCorrectedFunction[mLoopIndex][iPreviousRank]);         &#xA;        }&#xA;    }&#xA;    else&#xA;    {&#xA;        mEmitWarning(&quot;Error in mComputeCorrectedStates: Vectors are null&quot;);&#xA;    }&#xA;}&#xA;&#xA;/* Function: mComputePredictedFunction =======================================================&#xA;* Abstract:&#xA;*      &#xA;*&#xA;*/&#xA;void mComputePredictedFunction(real_T iInput, rankEnum iComputedRank)&#xA;{&#xA;    int_T wStateIndex;&#xA;    if (mPredictedStateVector != NULL &amp;amp;&amp;amp; mPredictedFunction !=NULL)&#xA;    {&#xA;        for (mLoopIndex = 0; mLoopIndex &amp;lt; mTotalNumberOfDiscreteStates; mLoopIndex++)&#xA;        {&#xA;            if(0 == (mLoopIndex+1)%mSignalNumberOfDiscreteStates)&#xA;            {&#xA;                mPredictedFunction[mLoopIndex][iComputedRank] = iInput;&#xA;                for (wStateIndex = 0; wStateIndex &amp;lt; mSignalNumberOfDiscreteStates; wStateIndex++)&#xA;                {&#xA;                    mPredictedFunction[mLoopIndex][iComputedRank]  += -1*mDenominator[mSignalNumberOfDiscreteStates-wStateIndex]* mPredictedStateVector[wStateIndex][iComputedRank];            &#xA;                }&#xA;            }&#xA;            else&#xA;            {&#xA;                mPredictedFunction[mLoopIndex][iComputedRank]  = mPredictedStateVector[mLoopIndex+1][iComputedRank];    &#xA;            }       &#xA;        }&#xA;    }&#xA;    else&#xA;    {&#xA;        mEmitWarning(&quot;Error in mComputePredictedFunction: Vectors are null&quot;);&#xA;    }&#xA;}&#xA;&#xA;/* Function: mComputeCorrectedFunction =======================================================&#xA;* Abstract:&#xA;*      &#xA;*&#xA;*/&#xA;void mComputeCorrectedFunction(real_T iInput, rankEnum iComputedRank)&#xA;{&#xA;    int_T wStateIndex;&#xA;    if (mCorrectedStateVector != NULL &amp;amp;&amp;amp; mCorrectedFunction !=NULL)&#xA;    {&#xA;        for (mLoopIndex = 0; mLoopIndex &amp;lt; mTotalNumberOfDiscreteStates; mLoopIndex++)&#xA;        {&#xA;            if(0 == (mLoopIndex+1)%mSignalNumberOfDiscreteStates)&#xA;            {&#xA;                mCorrectedFunction[mLoopIndex][iComputedRank] = iInput;&#xA;                for (wStateIndex = 0; wStateIndex &amp;lt; mSignalNumberOfDiscreteStates; wStateIndex++)&#xA;                {&#xA;                    mCorrectedFunction[mLoopIndex][iComputedRank]  += -1*mDenominator[mSignalNumberOfDiscreteStates-wStateIndex]* mCorrectedStateVector[wStateIndex][iComputedRank];            &#xA;                }&#xA;            }&#xA;            else&#xA;            {&#xA;                mCorrectedFunction[mLoopIndex][iComputedRank]  = mCorrectedStateVector[mLoopIndex+1][iComputedRank];    &#xA;            }&#xA;        }&#xA;    }&#xA;    else&#xA;    {&#xA;        mEmitWarning(&quot;Error in mComputeCorrectedFunction: Vectors are null&quot;);&#xA;    }&#xA;}&#xA;&#xA;/* Function: mUpdateStateVectors =======================================================&#xA;* Abstract:&#xA;*      &#xA;*&#xA;*/&#xA;void mUpdateStateVectors()&#xA;{&#xA;    if (mPredictedStateVector != NULL &amp;amp;&amp;amp; mCorrectedStateVector !=NULL &amp;amp;&amp;amp; mPredictedFunction != NULL &amp;amp;&amp;amp; mCorrectedFunction !=NULL)&#xA;    {&#xA;        for (mLoopIndex = 0; mLoopIndex &amp;lt; mTotalNumberOfDiscreteStates; mLoopIndex++)&#xA;        {&#xA;            mPredictedStateVector[mLoopIndex][eN]  = mPredictedStateVector[mLoopIndex][eNplusOne];&#xA;            mCorrectedStateVector[mLoopIndex][eN]  = mCorrectedStateVector[mLoopIndex][eNplusOne];&#xA;            mPredictedFunction[mLoopIndex][eN]  = mPredictedFunction[mLoopIndex][eNplusOne];&#xA;            mCorrectedFunction[mLoopIndex][eN]  = mCorrectedFunction[mLoopIndex][eNplusOne];&#xA;&#xA;            mPredictedStateVector[mLoopIndex][eNplusOne]  = mPredictedStateVector[mLoopIndex][eNplusTwo];&#xA;            mCorrectedStateVector[mLoopIndex][eNplusOne]  = mCorrectedStateVector[mLoopIndex][eNplusTwo];&#xA;            mPredictedFunction[mLoopIndex][eNplusOne]  = mPredictedFunction[mLoopIndex][eNplusTwo];&#xA;            mCorrectedFunction[mLoopIndex][eNplusOne]  = mCorrectedFunction[mLoopIndex][eNplusTwo];&#xA;        }&#xA;    }&#xA;    else&#xA;    {&#xA;        mEmitWarning(&quot;Error in mUpdateStateVectors: Vectors are null&quot;);&#xA;    }&#xA;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3870905" LastEditorUserId="3870905" LastEditDate="2015-08-11T13:49:24.427" LastActivityDate="2015-08-13T16:08:00.233" Title="Multiples instances of a C-Mex function and shared memory" Tags="&lt;c++&gt;&lt;c&gt;&lt;matlab&gt;&lt;shared-memory&gt;&lt;simulink&gt;" AnswerCount="1" CommentCount="8" />
  <row Id="32072782" PostTypeId="1" CreationDate="2015-08-18T12:43:21.223" Score="3" ViewCount="75" Body="&lt;p&gt;I have following code that enumerates devices and write it description to console:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;windows.h&amp;gt;&#xA;#include &amp;lt;setupapi.h&amp;gt;&#xA;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;tchar.h&amp;gt;&#xA;&#xA;#ifdef  DEBUG&#xA;#undef  DBG&#xA;#define DBG 1&#xA;#endif&#xA;&#xA;#if DBG&#xA;#define OOPS() Oops(__FILE__, __LINE__)&#xA;#else&#xA;#define  OOPS()&#xA;#endif&#xA;&#xA;#define ALLOC(dwBytes) GlobalAlloc(GPTR,(dwBytes))&#xA;&#xA;#define REALLOC(hMem, dwBytes) GlobalReAlloc((hMem), (dwBytes), (GMEM_MOVEABLE|GMEM_ZEROINIT))&#xA;&#xA;#define FREE(hMem)  GlobalFree((hMem))&#xA;&#xA;#define CHECKFORLEAKS()&#xA;&#xA;&#xA;_Success_(return == TRUE)&#xA;BOOL&#xA;GetDeviceProperty(&#xA;_In_    HDEVINFO         DeviceInfoSet,&#xA;_In_    PSP_DEVINFO_DATA DeviceInfoData,&#xA;_In_    DWORD            Property,&#xA;_Outptr_  LPTSTR        *ppBuffer&#xA;)&#xA;{&#xA;    BOOL bResult;&#xA;    DWORD requiredLength = 0;&#xA;    DWORD lastError;&#xA;&#xA;    if(ppBuffer == NULL)&#xA;    {&#xA;        return FALSE;&#xA;    }&#xA;&#xA;    *ppBuffer = NULL;&#xA;&#xA;    bResult = SetupDiGetDeviceRegistryProperty(DeviceInfoSet,&#xA;                                               DeviceInfoData,&#xA;                                               Property,&#xA;                                               NULL,&#xA;                                               NULL,&#xA;                                               0,&#xA;                                               &amp;amp;requiredLength);&#xA;    lastError = GetLastError();&#xA;&#xA;    if((requiredLength == 0) || (bResult != FALSE &amp;amp;&amp;amp; lastError != ERROR_INSUFFICIENT_BUFFER))&#xA;    {&#xA;        return FALSE;&#xA;    }&#xA;&#xA;    *ppBuffer = ALLOC(requiredLength);&#xA;&#xA;    if(*ppBuffer == NULL)&#xA;    {&#xA;        return FALSE;&#xA;    }&#xA;&#xA;    bResult = SetupDiGetDeviceRegistryProperty(DeviceInfoSet,&#xA;                                               DeviceInfoData,&#xA;                                               Property,&#xA;                                               NULL,&#xA;                                               (PBYTE)*ppBuffer,&#xA;                                               requiredLength,&#xA;                                               &amp;amp;requiredLength);&#xA;    if(bResult == FALSE)&#xA;    {&#xA;        FREE(*ppBuffer);&#xA;        *ppBuffer = NULL;&#xA;        return FALSE;&#xA;    }&#xA;&#xA;    return TRUE;&#xA;}&#xA;&#xA;void&#xA;EnumerateAllDevices(&#xA;)&#xA;{&#xA;    HDEVINFO deviceInfo = NULL;&#xA;&#xA;    // Getting all present devices&#xA;    deviceInfo = SetupDiGetClassDevs(NULL,&#xA;                                     NULL,&#xA;                                     NULL,&#xA;                                     (DIGCF_ALLCLASSES | DIGCF_PRESENT));&#xA;&#xA;    if(deviceInfo != INVALID_HANDLE_VALUE)&#xA;    {&#xA;        ULONG                    index;&#xA;        DWORD error;&#xA;&#xA;        error = 0;&#xA;        index = 0;&#xA;&#xA;        while(error != ERROR_NO_MORE_ITEMS)&#xA;        {&#xA;&#xA;            BOOL success;&#xA;            SP_DEVINFO_DATA infoData;&#xA;            ZeroMemory(&amp;amp;infoData, sizeof(SP_DEVINFO_DATA));&#xA;            PSTR DeviceDescName = NULL;&#xA;            infoData.cbSize = sizeof(SP_DEVICE_INTERFACE_DATA);&#xA;&#xA;            success = SetupDiEnumDeviceInfo(deviceInfo,&#xA;                                            index,&#xA;                                            &amp;amp;infoData);&#xA;&#xA;            index++;&#xA;&#xA;            if(success == FALSE)&#xA;            {&#xA;                error = GetLastError();&#xA;&#xA;                if(error != ERROR_NO_MORE_ITEMS)&#xA;                {&#xA;                    //OOPS();&#xA;                }&#xA;            }&#xA;            else&#xA;            {&#xA;                BOOL   bResult;&#xA;&#xA;                bResult = GetDeviceProperty(deviceInfo,&#xA;                                            &amp;amp;infoData,&#xA;                                            SPDRP_DEVICEDESC,&#xA;                                            &amp;amp;DeviceDescName);&#xA;                if(bResult == FALSE)&#xA;                {&#xA;                    //OOPS();&#xA;                    break;&#xA;                }&#xA;&#xA;                printf(&quot;DeviceDescName   = %s\n&quot;, DeviceDescName);&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;int _tmain(int argc, _TCHAR* argv[])&#xA;{&#xA;    EnumerateAllDevices();&#xA;    return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;DeviceDescName is PSTR as you can see from the code. For some reason this works perfect for one project type  &lt;em&gt;Windows driver application&lt;/em&gt;. Here I see full device name DeviceDescName like &quot;High Definition Audio Controller&quot;. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;The same code is not working for other  &lt;em&gt;Console Application. Toolset v120&lt;/em&gt;. Here in DeviceDescName I see only first latter &quot;H&quot;(from &quot;High Definition Audio Controller&quot;). What can be the reason? (you can try this)&lt;/p&gt;&#xA;" OwnerUserId="1876627" LastEditorUserId="4774918" LastEditDate="2015-08-18T12:53:44.397" LastActivityDate="2015-08-18T12:54:24.657" Title="Why does PSTR type have different behavior on different visual studio projects types?" Tags="&lt;c&gt;&lt;string&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="32145352" PostTypeId="1" AcceptedAnswerId="32162566" CreationDate="2015-08-21T16:37:18.830" Score="1" ViewCount="89" Body="&lt;p&gt;Is there a good way to make a grammar nonterminal which is parsed differently, depending on results of some boost phoenix function?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;In my use-case, I have a grammar which among other things includes CPP-style #define directives, and #ifdef #else #endif directives. (It's not actually the C preprocessor though its just some crude imitation made by someone else.) When I parse it in qi, I pass my grammar (in its ctor) a reference to a &quot;preprocessor database&quot; object which is adapted to a fusion structure, and I have adapted phoenix functions which allow to add PP definitions / check for PP definitions. I have made it so that the #define directives have a semantic action which registers new definitions.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;When I try to implement the #ifdef #else directives I'm not sure what I should do. The only way that I can think of to do this is to add a boolean flag to all of the attributes types of all of my grammar nonterminals that marks whether it is in a discarded #ifdef branch, and after my AST is parsed then crawl through that again and toss the marked guys. But that's pretty inelegant, there has to be a better way, right?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;If possible I would like to be able to keep track of the original line numbers (before ifdefs are resolved).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I hope the question is clear, if it's not I can cook up a minimal example to show what I'm trying to do but my actual grammar is large.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Edit: Okay, I cooked up an SSCCE:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So here is a program that parses a very simple grammar of pairs, and has some minimal preprocessor language which includes define and ifdef. I understand how to use semantic actions so that matching things causes C++ callbacks to get fired, and that part seems to be working. However what I don't understand is how to use callbacks to feedback info into the grammar, i.e. &quot;if this phoenix function returns false then parse this differently&quot;. It would be enough I guess to know how to say &quot;if this phoenix function returns boolean false as part of this semantic action, then arbitrarily declare the nonterminal not to have matched and backtrack.&quot; Actually now that I'm writing all this I guess I know that the &quot;mini XML&quot; example must somehow do this since it uses a local variable to enforce that start and close tags must match? So I guess I could reverse engineer how it works there maybe. But apparently I didn't figure it out yet from reading docs / studying the examples.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Note that I think it's different from your first suggestion, just make a skip grammar. The thing is that I don't know how to make the skip grammar's behavior depend on a boost phoenix function's output either, it's just the same problem again. The only thing I know how to do with phoenix inside of qi right now is, fire void callbacks, and make things that get assigned to the attributed values.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define BOOST_SPIRIT_USE_PHOENIX_V3&#xA;&#xA;#include &amp;lt;boost/config/warning_disable.hpp&amp;gt;&#xA;#include &amp;lt;boost/spirit/include/qi.hpp&amp;gt;&#xA;#include &amp;lt;boost/spirit/include/phoenix_core.hpp&amp;gt;&#xA;#include &amp;lt;boost/spirit/include/phoenix_object.hpp&amp;gt;&#xA;#include &amp;lt;boost/spirit/include/phoenix_operator.hpp&amp;gt;&#xA;#include &amp;lt;boost/spirit/include/phoenix_fusion.hpp&amp;gt;&#xA;#include &amp;lt;boost/spirit/include/phoenix_stl.hpp&amp;gt;&#xA;#include &amp;lt;boost/fusion/adapted/struct/adapt_struct.hpp&amp;gt;&#xA;#include &amp;lt;boost/fusion/include/adapt_struct.hpp&amp;gt;&#xA;#include &amp;lt;boost/fusion/include/std_pair.hpp&amp;gt;&#xA;#include &amp;lt;boost/variant/recursive_variant.hpp&amp;gt;&#xA;&#xA;#include &amp;lt;cassert&amp;gt;&#xA;#include &amp;lt;cmath&amp;gt;&#xA;#include &amp;lt;memory&amp;gt;&#xA;#include &amp;lt;string&amp;gt;&#xA;#include &amp;lt;utility&amp;gt;&#xA;#include &amp;lt;vector&amp;gt;&#xA;&#xA;namespace fusion = boost::fusion;&#xA;namespace phoenix = boost::phoenix;&#xA;namespace qi = boost::spirit::qi;&#xA;namespace ascii = boost::spirit::ascii;&#xA;&#xA;typedef std::string pp_sym;&#xA;typedef std::set&amp;lt;pp_sym&amp;gt; pp_data;&#xA;&#xA;void add(pp_data &amp;amp; defines, const pp_sym &amp;amp; s) { defines.insert(s); }&#xA;void remove(pp_data &amp;amp; defines, const pp_sym &amp;amp; s) { defines.erase(s); }&#xA;bool search(pp_data &amp;amp; defines, const pp_sym &amp;amp; s) { return defines.count(s); }&#xA;&#xA;BOOST_PHOENIX_ADAPT_FUNCTION(void, pp_add_define_, add, 2);&#xA;BOOST_PHOENIX_ADAPT_FUNCTION(void, pp_remove_define_, remove, 2);&#xA;BOOST_PHOENIX_ADAPT_FUNCTION(bool, pp_search_define_, search, 2);&#xA;&#xA;typedef std::string Str;&#xA;typedef std::pair&amp;lt;Str, Str&amp;gt; Pair;&#xA;typedef std::vector&amp;lt;Pair&amp;gt; PairVec;&#xA;&#xA;/***&#xA; * Grammar definitions&#xA; */&#xA;&#xA;template &amp;lt;typename Iterator&amp;gt;&#xA;struct simple_grammar : qi::grammar&amp;lt;Iterator, PairVec()&amp;gt; {&#xA;    qi::rule&amp;lt;Iterator, PairVec()&amp;gt; main;&#xA;    qi::rule&amp;lt;Iterator, Pair()&amp;gt; pair;&#xA;    qi::rule&amp;lt;Iterator, Str()&amp;gt; first;&#xA;    qi::rule&amp;lt;Iterator, Str()&amp;gt; second;&#xA;&#xA;    qi::rule&amp;lt;Iterator, pp_sym()&amp;gt; pp_symbol;&#xA;    qi::rule&amp;lt;Iterator&amp;gt; pp_directive;&#xA;    qi::rule&amp;lt;Iterator, pp_sym()&amp;gt; define_directive;&#xA;    qi::rule&amp;lt;Iterator, pp_sym()&amp;gt; undef_directive;&#xA;    qi::rule&amp;lt;Iterator, pp_sym()&amp;gt; if_directive;&#xA;    qi::rule&amp;lt;Iterator&amp;gt; else_directive;&#xA;    qi::rule&amp;lt;Iterator&amp;gt; endif_directive;&#xA;&#xA;    qi::rule&amp;lt;Iterator&amp;gt; ws;&#xA;&#xA;    simple_grammar(pp_data &amp;amp; preprocessor_data)&#xA;            : simple_grammar::base_type(main)&#xA;    {&#xA;        using qi::lit;&#xA;        using qi::char_;&#xA;        using namespace qi::labels;&#xA;&#xA;        ws = char_(&quot; \t\r\n&quot;);&#xA;&#xA;        first = !lit('#') &amp;gt;&amp;gt; *(char_ - '=') &amp;gt;&amp;gt; lit('=');&#xA;        second = *(char_ - '\n') &amp;gt;&amp;gt; lit('\n');&#xA;        pair = first &amp;gt;&amp;gt; second;&#xA;&#xA;        pp_symbol = +char_(&quot;A-Za-z_&quot;);&#xA;&#xA;        pp_directive = &amp;amp;lit('#')&#xA;                &amp;gt;&amp;gt; ((define_directive [ pp_add_define_(ref(preprocessor_data), _1) ] )&#xA;                | (undef_directive [ pp_remove_define_(ref(preprocessor_data), _1) ] )&#xA;                | if_directive // [ ??? ]&#xA;                | else_directive&#xA;                | endif_directive)&#xA;                &amp;gt;&amp;gt; *(char_ - '\n') &amp;gt;&amp;gt; lit('\n');&#xA;&#xA;        main = (pp_directive &amp;gt;&amp;gt; -main) | (pair &amp;gt;&amp;gt; -main);&#xA;&#xA;        define_directive = lit(&quot;#define &quot;) &amp;gt;&amp;gt; pp_symbol &amp;gt;&amp;gt; &amp;amp;ws;&#xA;        undef_directive  = lit(&quot;#undef &quot;) &amp;gt;&amp;gt; pp_symbol &amp;gt;&amp;gt; &amp;amp;ws;&#xA;        if_directive     = lit(&quot;#ifdef &quot;) &amp;gt;&amp;gt; pp_symbol &amp;gt;&amp;gt; &amp;amp;ws;&#xA;        else_directive   = lit(&quot;#else&quot;);&#xA;        endif_directive  = lit(&quot;#endif&quot;);&#xA;    }&#xA;};&#xA;&#xA;const char * example_1 = &quot;&quot;&#xA;&quot;#define FOO\n&quot;&#xA;&quot;led_zeppelin=9\n&quot;&#xA;&quot;the_shins=9\n&quot;&#xA;&quot;dead_mau5=6\n&quot;&#xA;&quot;portishead=10\n&quot;&#xA;&quot;#ifdef FOO\n&quot;&#xA;&quot;foo_fighters=7\n&quot;&#xA;&quot;#else\n&quot;&#xA;&quot;the_who=6\n&quot;&#xA;&quot;#endif\n&quot;&#xA;&quot;kanye_west=4\n&quot;&#xA;&quot;#undef FOO\n&quot;&#xA;&quot;#define BAR\n&quot;;&#xA;&#xA;int main() {&#xA;    std::string temp{example_1};&#xA;&#xA;    typedef std::string::const_iterator str_it;&#xA;&#xA;    typedef simple_grammar&amp;lt;str_it&amp;gt; my_grammar;&#xA;    pp_data defines;&#xA;    my_grammar gram(defines); // Our grammar&#xA;    PairVec ast; // Our tree&#xA;&#xA;    str_it it = temp.begin();&#xA;    str_it end = temp.end();&#xA;&#xA;    bool b = qi::parse(it, end, gram, ast);&#xA;&#xA;    assert(b);&#xA;    assert(defines.count(&quot;FOO&quot;) == 0);&#xA;    assert(defines.count(&quot;BAR&quot;) == 1);&#xA;&#xA;    std::cout &amp;lt;&amp;lt; &quot;Parsed a list:\n\n&quot;;&#xA;&#xA;    for( const auto &amp;amp; p : ast) {&#xA;        std::cout &amp;lt;&amp;lt; p.first &amp;lt;&amp;lt; &quot;\n\t\t\t=\t&quot; &amp;lt;&amp;lt; p.second &amp;lt;&amp;lt; std::endl;&#xA;    }&#xA;    return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;For me the output of the above is (as expected):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ ./main &#xA;Parsed a list:&#xA;&#xA;led_zeppelin&#xA;            =   9&#xA;the_shins&#xA;            =   9&#xA;dead_mau5&#xA;            =   6&#xA;portishead&#xA;            =   10&#xA;foo_fighters&#xA;            =   7&#xA;the_who&#xA;            =   6&#xA;kanye_west&#xA;            =   4&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;However what I'd like to do is make the ifdef part do what you would naturally expect, and permit nested ifdef clauses.&lt;/p&gt;&#xA;" OwnerUserId="3598119" LastEditorUserId="3598119" LastEditDate="2015-08-22T02:58:00.300" LastActivityDate="2015-08-23T02:24:43.370" Title="How to implement #ifdef in a boost::spirit::qi grammar?" Tags="&lt;c++&gt;&lt;parsing&gt;&lt;c++11&gt;&lt;boost&gt;&lt;boost-spirit-qi&gt;" AnswerCount="3" CommentCount="1" />
  <row Id="32351687" PostTypeId="1" AcceptedAnswerId="32374641" CreationDate="2015-09-02T11:17:13.253" Score="2" ViewCount="406" Body="&lt;p&gt;To trace how much memory various parts of my code allocates, I found this objective-C code (&lt;a href=&quot;http://stackoverflow.com/questions/787160/programmatically-retrieve-memory-usage-on-iphone%20Here&quot;&gt;here&lt;/a&gt;), that I want to run in Delphi XE8: &lt;/p&gt;&#xA;&#xA;&lt;pre class=&quot;lang-c prettyprint-override&quot;&gt;&lt;code&gt;void report_memory(void)&#xA;{&#xA;    struct mach_task_basic_info info;&#xA;    mach_msg_type_number_t size = MACH_TASK_BASIC_INFO_COUNT;&#xA;    kern_return_t kerr = task_info(mach_task_self(),&#xA;                                   MACH_TASK_BASIC_INFO,&#xA;                                   (task_info_t)&amp;amp;info,&#xA;                                   &amp;amp;size);&#xA;    if( kerr == KERN_SUCCESS ) {&#xA;        NSLog(@&quot;Memory in use (in bytes): %u&quot;, info.resident_size);&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This code simply reads the current amount of memory used by the program and logs it. I will use it to detect how much memory usage grows when calling different parts of my code. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;It includes &lt;code&gt;Mach.h&lt;/code&gt;, and there is a &lt;code&gt;Macapi.Mach.pas&lt;/code&gt; unit in Delphi, but it does not implement any of the definitions used here.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;(The NSLog function log is implemented already: &lt;code&gt;iOSApi.Foundation.NSLog((StrToNSStr(aMessage) as ILocalObject).GetObjectID)&lt;/code&gt;)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;How should this code be converted to Delphi XE8?&#xA;(I might be able to convert the definitions my self, but where do I find the headers?)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;PS. I know this is a primitive way of tracing memory, but I have not found any better solution. The &lt;code&gt;Xcode Instruments&lt;/code&gt;, tells me that my app calls malloc 180.000 times, but it does not indicate what code or objects initiated it. This information might be lost because I use Delphi.&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;Update&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;Here is my translation and implementation of the function. It works with the iOS simulator and when targeting a 32bit iOS device, but it does NOT work on a 64 bit iOS device (return value is 4).&lt;/p&gt;&#xA;&#xA;&lt;pre class=&quot;lang-pascal prettyprint-override&quot;&gt;&lt;code&gt;unit uMachExt;&#xA;&#xA;interface&#xA;&#xA;uses Macapi.Mach, Posix.Base;&#xA;&#xA;type&#xA;  integer_t = Integer;&#xA;  natural_t = NativeInt;&#xA;  mach_vm_size_t = UInt64;&#xA;  //typedef int policy_t&#xA;  policy_t = Integer;&#xA;&#xA;  //type time_value_t = struct[2] of integer_t;&#xA;  time_value_t = array[0..1] of Integer; //0:seconds, 1:microseconds&#xA;&#xA;  //typedef natural_t mach_msg_type_number_t&#xA;  mach_msg_type_number_t = natural_t;&#xA;&#xA;  //type kern_return_t = int;&#xA;  kern_return_t = integer;&#xA;&#xA;  //typedef natural_t   task_flavor_t;&#xA;  task_flavor_t = natural_t;&#xA;&#xA;  // typedef    integer_t   *task_info_t;       /* varying array of int */&#xA;  task_info_t = array of integer_t;&#xA;&#xA;  {#define MACH_TASK_BASIC_INFO     20         /* always 64-bit basic info */&#xA;  struct mach_task_basic_info {&#xA;          mach_vm_size_t  virtual_size;       /* virtual memory size (bytes) */&#xA;          mach_vm_size_t  resident_size;      /* resident memory size (bytes) */&#xA;          mach_vm_size_t  resident_size_max;  /* maximum resident memory size (bytes) */&#xA;          time_value_t    user_time;          /* total user run time for&#xA;                                                 terminated threads */&#xA;          time_value_t    system_time;        /* total system run time for&#xA;                                                 terminated threads */&#xA;          policy_t        policy;             /* default policy for new threads */&#xA;          integer_t       suspend_count;      /* suspend count for task */&#xA;  }&#xA;  mach_task_basic_info = Record&#xA;        virtual_size: mach_vm_size_t  ;       //* virtual memory size (bytes) */&#xA;        resident_size: mach_vm_size_t  ;      //* resident memory size (bytes) */&#xA;        resident_size_max: mach_vm_size_t  ;  //* maximum resident memory size (bytes) */&#xA;        user_time: time_value_t    ;          //* total user run time for terminated threads */&#xA;        system_time: time_value_t    ;        //* total system run time forterminated threads */&#xA;        policy: policy_t        ;             //* default policy for new threads */&#xA;        suspend_count: integer_t;               //* suspend count for task */&#xA;  end;&#xA;&#xA;const&#xA;  cMACH_TASK_BASIC_INFO = 20;&#xA;  {typedef struct mach_task_basic_info       mach_task_basic_info_data_t;&#xA;  #define MACH_TASK_BASIC_INFO_COUNT   \&#xA;                (sizeof(mach_task_basic_info_data_t) / sizeof(natural_t))}&#xA;  cMACH_TASK_BASIC_INFO_COUNT = SizeOf(mach_task_basic_info) div sizeof(natural_t);&#xA;&#xA;  {&#xA;  #ifdef    mig_external&#xA;  mig_external&#xA;  #else&#xA;  extern&#xA;  #endif    /* mig_external */&#xA;  kern_return_t task_info&#xA;  (&#xA;    task_name_t target_task,&#xA;    task_flavor_t flavor,&#xA;    task_info_t task_info_out,&#xA;    mach_msg_type_number_t *task_info_outCnt&#xA;  );&#xA;  }&#xA;&#xA;  function task_info( target_task: task_name_t;&#xA;                      flavor: task_flavor_t;&#xA;                      var task_info_out: mach_task_basic_info;&#xA;                      var task_info_outCnt: mach_msg_type_number_t)  : kern_return_t;&#xA;    cdecl external libc name _PU + 'task_info';&#xA;&#xA;  function GetMemoryUsage: Integer;&#xA;&#xA;implementation&#xA;&#xA;{   struct mach_task_basic_info info;&#xA;    mach_msg_type_number_t size = MACH_TASK_BASIC_INFO_COUNT;&#xA;    kern_return_t kerr = task_info(mach_task_self(),&#xA;                                   MACH_TASK_BASIC_INFO,&#xA;                                   (task_info_t)&amp;amp;info,&#xA;                                   &amp;amp;size);&#xA;}&#xA;&#xA;function GetMemoryUsage: Integer;&#xA;var info: mach_task_basic_info;&#xA;    size: mach_msg_type_number_t;&#xA;    kerr: kern_return_t;&#xA;begin&#xA;  Result := 0;&#xA;  size := cMACH_TASK_BASIC_INFO_COUNT;&#xA;  kerr := task_info(mach_task_self, cMACH_TASK_BASIC_INFO, info, size);&#xA;  if kerr=0 then&#xA;    result := info.resident_size;&#xA;end;&#xA;&#xA;end.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It is enough for me that it works with 32 bit, but for completeness, if you find what should be changed to make it work with 64 bit, please comment (also if you find other errors in the implementation).&lt;/p&gt;&#xA;" OwnerUserId="3959599" LastEditorUserId="3959599" LastEditDate="2015-09-04T08:28:05.150" LastActivityDate="2015-09-04T08:28:05.150" Title="Converting Objective-C code to Delphi (XE8)" Tags="&lt;delphi&gt;&lt;firemonkey&gt;&lt;delphi-xe8&gt;" AnswerCount="1" CommentCount="6" />
  <row Id="32427967" PostTypeId="1" CreationDate="2015-09-06T20:27:12.507" Score="1" ViewCount="875" Body="&lt;p&gt;The IDE I use is 'Keil µVision5'.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I own a STM32F429ZIT-Discovery Board (it has a LCD display on board), to which I connected a &lt;a href=&quot;https://learn.adafruit.com/adafruit-bno055-absolute-orientation-sensor/overview&quot; rel=&quot;nofollow&quot;&gt;Bosch Sensortec BNO055 9-Axis IMU&lt;/a&gt;. I want them to communicate via I²C to each other, thus I already made the required connections as follows:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Vin (Sensor) -&gt; 5V (Discovery Board) &lt;/li&gt;&#xA;&lt;li&gt;GND (Sensor) -&gt; GND (Discovery&#xA;Board) &lt;/li&gt;&#xA;&lt;li&gt;SDA (Sensor) -&gt; PB7 (Discovery Board) &lt;/li&gt;&#xA;&lt;li&gt;SCL (Sensor) -&gt; PB6&#xA;(Discovery Board)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;I downloaded the BNO055_driver, which contains the file '&lt;a href=&quot;https://github.com/BoschSensortec/BNO055_driver/blob/master/bno055_support.c&quot; rel=&quot;nofollow&quot;&gt;bno055_support.c&lt;/a&gt;' (it includes code examples on how to get data from the sensor).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I find this very confusing. I don't know exactly which lines of code I need to include in my project.&#xA;I tried it, and I also included some lines that should be relevant for I²C. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I must say I am very inexperienced in programming and microcontrollers in general, clearly. And it's just like a bunch of pieces of code that I scrambled together, which probably don't make any sense. Please bear with me. Here you can see the code I tried.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The mess I've got so far:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;stm32f4xx.h&quot;                 &#xA;#include &quot;system_stm32f4xx.h&quot; &#xA;#include &quot;stm32f4xx_i2c.h&quot;&#xA;#include &quot;stm32f4xx_gpio.h&quot;&#xA;#include &amp;lt;stdint.h&amp;gt;&#xA;#include &quot;bno055.h&quot;&#xA;#include &quot;stm32f4xx_rcc.h&quot;&#xA;&#xA;#define SLAVE_ADDRESS 0x29                          // BNO055 Slave Address&#xA;&#xA;void init_I2C1(void){&#xA;&#xA;    GPIO_InitTypeDef GPIO_InitStruct;&#xA;    I2C_InitTypeDef I2C_InitStruct;&#xA;&#xA;    // enable APB1 peripheral clock for I2C1&#xA;    RCC_APB1PeriphClockCmd(RCC_APB1Periph_I2C1, ENABLE);&#xA;    // enable clock for SCL and SDA pins&#xA;    RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOB, ENABLE);&#xA;&#xA;    /* setup SCL and SDA pins&#xA;     * You can connect I2C1 to two different&#xA;     * pairs of pins:&#xA;     * 1. SCL on PB6 and SDA on PB7 &#xA;     * 2. SCL on PB8 and SDA on PB9&#xA;     */&#xA;    GPIO_InitStruct.GPIO_Pin = GPIO_Pin_6 | GPIO_Pin_7; // we are going to use PB6 and PB7&#xA;    GPIO_InitStruct.GPIO_Mode = GPIO_Mode_AF;           // set pins to alternate function&#xA;    GPIO_InitStruct.GPIO_Speed = GPIO_Speed_50MHz;      // set GPIO speed&#xA;    GPIO_InitStruct.GPIO_OType = GPIO_OType_OD;         // set output to open drain --&amp;gt; the line has to be only pulled low, not driven high&#xA;    GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_UP;           // enable pull up resistors&#xA;    GPIO_Init(GPIOB, &amp;amp;GPIO_InitStruct);                 // init GPIOB&#xA;&#xA;    // Connect I2C1 pins to AF  &#xA;    GPIO_PinAFConfig(GPIOB, GPIO_PinSource6, GPIO_AF_I2C1); // SCL&#xA;    GPIO_PinAFConfig(GPIOB, GPIO_PinSource7, GPIO_AF_I2C1); // SDA&#xA;&#xA;    // configure I2C1 &#xA;    I2C_InitStruct.I2C_ClockSpeed = 100000;         // 100kHz&#xA;    I2C_InitStruct.I2C_Mode = I2C_Mode_I2C;         // I2C mode&#xA;    I2C_InitStruct.I2C_DutyCycle = I2C_DutyCycle_2; // 50% duty cycle --&amp;gt; standard&#xA;    I2C_InitStruct.I2C_OwnAddress1 = 0x00;          // own address, not relevant in master mode&#xA;    I2C_InitStruct.I2C_Ack = I2C_Ack_Disable;       // disable acknowledge when reading (can be changed later on)&#xA;    I2C_InitStruct.I2C_AcknowledgedAddress = I2C_AcknowledgedAddress_7bit; // set address length to 7 bit addresses&#xA;    I2C_Init(I2C1, &amp;amp;I2C_InitStruct);                // init I2C1&#xA;&#xA;    // enable I2C1&#xA;    I2C_Cmd(I2C1, ENABLE);&#xA;}&#xA;&#xA;/* This function issues a start condition and &#xA; * transmits the slave address + R/W bit&#xA; * &#xA; * Parameters:&#xA; *      I2Cx --&amp;gt; the I2C peripheral e.g. I2C1&#xA; *      address --&amp;gt; the 7 bit slave address&#xA; *      direction --&amp;gt; the tranmission direction can be:&#xA; *                      I2C_Direction_Tranmitter for Master transmitter mode&#xA; *                      I2C_Direction_Receiver for Master receiver&#xA; */&#xA;void I2C_start(I2C_TypeDef* I2Cx, uint8_t address, uint8_t direction){&#xA;    // wait until I2C1 is not busy anymore&#xA;    while(I2C_GetFlagStatus(I2Cx, I2C_FLAG_BUSY));&#xA;&#xA;    // Send I2C1 START condition &#xA;    I2C_GenerateSTART(I2Cx, ENABLE);&#xA;&#xA;    // wait for I2C1 EV5 --&amp;gt; Slave has acknowledged start condition&#xA;    while(!I2C_CheckEvent(I2Cx, I2C_EVENT_MASTER_MODE_SELECT));&#xA;&#xA;    // Send slave Address for write &#xA;    I2C_Send7bitAddress(I2Cx, address, direction);&#xA;&#xA;    /* wait for I2C1 EV6, check if &#xA;     * either Slave has acknowledged Master transmitter or&#xA;     * Master receiver mode, depending on the transmission&#xA;     * direction&#xA;     */ &#xA;    if(direction == I2C_Direction_Transmitter){&#xA;        while(!I2C_CheckEvent(I2Cx, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED));&#xA;    }&#xA;    else if(direction == I2C_Direction_Receiver){&#xA;        while(!I2C_CheckEvent(I2Cx, I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED));&#xA;    }&#xA;}&#xA;&#xA;/* This function transmits one byte to the slave device&#xA; * Parameters:&#xA; *      I2Cx --&amp;gt; the I2C peripheral e.g. I2C1 &#xA; *      data --&amp;gt; the data byte to be transmitted&#xA; */&#xA;void I2C_write(I2C_TypeDef* I2Cx, uint8_t data)&#xA;{&#xA;    I2C_SendData(I2Cx, data);&#xA;    // wait for I2C1 EV8_2 --&amp;gt; byte has been transmitted&#xA;    while(!I2C_CheckEvent(I2Cx, I2C_EVENT_MASTER_BYTE_TRANSMITTED));&#xA;}&#xA;&#xA;/* This function reads one byte from the slave device &#xA; * and acknowledges the byte (requests another byte)&#xA; */&#xA;uint8_t I2C_read_ack(I2C_TypeDef* I2Cx){&#xA;    // enable acknowledge of recieved data&#xA;    I2C_AcknowledgeConfig(I2Cx, ENABLE);&#xA;    // wait until one byte has been received&#xA;    while( !I2C_CheckEvent(I2Cx, I2C_EVENT_MASTER_BYTE_RECEIVED) );&#xA;    // read data from I2C data register and return data byte&#xA;    uint8_t data = I2C_ReceiveData(I2Cx);&#xA;    return data;&#xA;}&#xA;&#xA;/* This function reads one byte from the slave device&#xA; * and doesn't acknowledge the recieved data &#xA; */&#xA;uint8_t I2C_read_nack(I2C_TypeDef* I2Cx){&#xA;    // disabe acknowledge of received data&#xA;    // nack also generates stop condition after last byte received&#xA;    // see reference manual for more info&#xA;    I2C_AcknowledgeConfig(I2Cx, DISABLE);&#xA;    I2C_GenerateSTOP(I2Cx, ENABLE);&#xA;    // wait until one byte has been received&#xA;    while( !I2C_CheckEvent(I2Cx, I2C_EVENT_MASTER_BYTE_RECEIVED) );&#xA;    // read data from I2C data register and return data byte&#xA;    uint8_t data = I2C_ReceiveData(I2Cx);&#xA;    return data;&#xA;}&#xA;&#xA;/* This funtion issues a stop condition and therefore&#xA; * releases the bus&#xA; */&#xA;void I2C_stop(I2C_TypeDef* I2Cx){&#xA;    // Send I2C1 STOP Condition &#xA;    I2C_GenerateSTOP(I2Cx, ENABLE);&#xA;}&#xA;&#xA;int main(void){&#xA;&#xA;    init_I2C1(); // initialize I2C peripheral&#xA;&#xA;    uint8_t received_data[2];&#xA;&#xA;    while(1){&#xA;&#xA;        I2C_start(I2C1, SLAVE_ADDRESS&amp;lt;&amp;lt;1, I2C_Direction_Transmitter); // start a transmission in Master transmitter mode&#xA;        I2C_write(I2C1, 0x20); // write one byte to the slave&#xA;        I2C_write(I2C1, 0x03); // write another byte to the slave&#xA;        I2C_stop(I2C1); // stop the transmission&#xA;&#xA;        I2C_start(I2C1, SLAVE_ADDRESS&amp;lt;&amp;lt;1, I2C_Direction_Receiver); // start a transmission in Master receiver mode&#xA;        received_data[0] = I2C_read_ack(I2C1); // read one byte and request another byte&#xA;        received_data[1] = I2C_read_nack(I2C1); // read one byte and don't request another byte, stop transmission&#xA;    }&#xA;}&#xA;&#xA;/*----------------------------------------------------------------------------*&#xA; *  The following functions are used for reading and writing of&#xA; *  sensor data using I2C communication&#xA;*----------------------------------------------------------------------------*/&#xA;#ifdef  BNO055_API&#xA;/*  \Brief: The function is used as I2C bus read&#xA; *  \Return : Status of the I2C read&#xA; *  \param dev_addr : The device address of the sensor&#xA; *  \param reg_addr : Address of the first register, will data is going to be read&#xA; *  \param reg_data : This data read from the sensor, which is hold in an array&#xA; *  \param cnt : The no of byte of data to be read&#xA; */&#xA;s8 BNO055_I2C_bus_read(u8 dev_addr, u8 reg_addr, u8 *reg_data, u8 cnt);&#xA;/*  \Brief: The function is used as SPI bus write&#xA; *  \Return : Status of the SPI write&#xA; *  \param dev_addr : The device address of the sensor&#xA; *  \param reg_addr : Address of the first register, will data is going to be written&#xA; *  \param reg_data : It is a value hold in the array,&#xA; *      will be used for write the value into the register&#xA; *  \param cnt : The no of byte of data to be write&#xA; */&#xA;s8 BNO055_I2C_bus_write(u8 dev_addr, u8 reg_addr, u8 *reg_data, u8 cnt);&#xA;/*&#xA; * \Brief: I2C init routine&#xA;*/&#xA;s8 I2C_routine(void);&#xA;#endif&#xA;/********************End of I2C function declarations***********************/&#xA;s32 bno055_data_readout_template(void)&#xA;{&#xA;/*---------------------------------------------------------------------------*&#xA; *********************** START INITIALIZATION ************************&#xA; *--------------------------------------------------------------------------*/&#xA; #ifdef BNO055_API&#xA;/*  Based on the user need configure I2C interface.&#xA; *  It is example code to explain how to use the bno055 API*/&#xA;    I2C_routine();&#xA; #endif&#xA;/*--------------------------------------------------------------------------*&#xA; *  This function used to assign the value/reference of&#xA; *  the following parameters&#xA; *  I2C address&#xA; *  Bus Write&#xA; *  Bus read&#xA; *  Chip id&#xA; *  Page id&#xA; *  Accel revision id&#xA; *  Mag revision id&#xA; *  Gyro revision id&#xA; *  Boot loader revision id&#xA; *  Software revision id&#xA; *-------------------------------------------------------------------------*/&#xA;    comres = bno055_init(&amp;amp;bno055);&#xA;&#xA;/*  For initializing the BNO sensor it is required to the operation mode&#xA;    of the sensor as NORMAL&#xA;    Normal mode can set from the register&#xA;    Page - page0&#xA;    register - 0x3E&#xA;    bit positions - 0 and 1*/&#xA;    power_mode = POWER_MODE_NORMAL; /* set the power mode as NORMAL*/&#xA;    comres += bno055_set_power_mode(power_mode);&#xA;/*--------------------------------------------------------------------------*&#xA;************************* END INITIALIZATION *************************&#xA;&#xA;/************************* START READ RAW SENSOR DATA****************/&#xA;&#xA;/*  Using BNO055 sensor we can read the following sensor data and&#xA;    virtual sensor data&#xA;    Sensor data:&#xA;        Accel&#xA;        Mag&#xA;        Gyro&#xA;    Virtual sensor data&#xA;        Euler&#xA;        Quaternion&#xA;        Linear acceleration&#xA;        Gravity sensor */&#xA;/*  For reading sensor raw data it is required to set the&#xA;    operation modes of the sensor&#xA;    operation mode can set from the register&#xA;    page - page0&#xA;    register - 0x3D&#xA;    bit - 0 to 3&#xA;    for sensor data read following operation mode have to set&#xA;     * SENSOR MODE&#xA;        *0x01 - OPERATION_MODE_ACCONLY&#xA;        *0x02 - OPERATION_MODE_MAGONLY&#xA;        *0x03 - OPERATION_MODE_GYRONLY&#xA;        *0x04 - OPERATION_MODE_ACCMAG&#xA;        *0x05 - OPERATION_MODE_ACCGYRO&#xA;        *0x06 - OPERATION_MODE_MAGGYRO&#xA;        *0x07 - OPERATION_MODE_AMG&#xA;        based on the user need configure the operation mode*/&#xA;    comres += bno055_set_operation_mode(OPERATION_MODE_ACCONLY);&#xA;&#xA;/******************START READ CONVERTED SENSOR DATA****************/&#xA;&#xA;/*  API used to read Linear acceleration data output as m/s2&#xA;    float functions also available in the BNO055 API */&#xA;    comres += bno055_convert_double_linear_accel_x_msq(&amp;amp;d_linear_accel_datax);&#xA;    comres += bno055_convert_double_linear_accel_y_msq(&amp;amp;d_linear_accel_datay);&#xA;    comres += bno055_convert_double_linear_accel_z_msq(&amp;amp;d_linear_accel_dataz);&#xA;    comres += bno055_convert_double_linear_accel_xyz_msq(&amp;amp;d_linear_accel_xyz);&#xA;&#xA;/*-----------------------------------------------------------------------*&#xA;************************* START DE-INITIALIZATION ***********************&#xA;*-------------------------------------------------------------------------*/&#xA;/*  For de - initializing the BNO sensor it is required to the operation mode&#xA;    of the sensor as SUSPEND&#xA;    Suspend mode can set from the register&#xA;    Page - page0&#xA;    register - 0x3E&#xA;    bit positions - 0 and 1*/&#xA;    power_mode = POWER_MODE_SUSPEND; /* set the power mode as SUSPEND*/&#xA;    comres += bno055_set_power_mode(power_mode);&#xA;&#xA;/*---------------------------------------------------------------------*&#xA;************************* END DE-INITIALIZATION **********************&#xA;*---------------------------------------------------------------------*/&#xA;return comres;&#xA;}&#xA;&#xA;#ifdef  BNO055_API&#xA;/*--------------------------------------------------------------------------*&#xA;*   The following function is used to map the I2C bus read, write, delay and&#xA;*   device address with global structure bno055_t&#xA;*-------------------------------------------------------------------------*/&#xA;/*-------------------------------------------------------------------------*&#xA; *  By using bno055 the following structure parameter can be accessed&#xA; *  Bus write function pointer: BNO055_WR_FUNC_PTR&#xA; *  Bus read function pointer: BNO055_RD_FUNC_PTR&#xA; *  Delay function pointer: delay_msec&#xA; *  I2C address: dev_addr&#xA; *--------------------------------------------------------------------------*/&#xA; s8 I2C_routine(void) {&#xA;&#xA;    bno055.bus_write = BNO055_I2C_bus_write;&#xA;    bno055.bus_read = BNO055_I2C_bus_read;&#xA;    bno055.delay_msec = BNO055_delay_msek;&#xA;    bno055.dev_addr = BNO055_I2C_ADDR2;&#xA;&#xA;    return BNO055_ZERO_U8X;&#xA;}&#xA;&#xA;/************** I2C buffer length******/&#xA;&#xA;#define I2C_BUFFER_LEN 8&#xA;#define I2C0 5&#xA;/*-------------------------------------------------------------------*&#xA;*&#xA;*   This is a sample code for read and write the data by using I2C&#xA;*   Use either I2C  based on your need&#xA;*   The device address defined in the bno055.h file&#xA;*&#xA;*-----------------------------------------------------------------------*/&#xA;&#xA;/*  \Brief: The function is used as I2C bus write&#xA; *  \Return : Status of the I2C write&#xA; *  \param dev_addr : The device address of the sensor&#xA; *  \param reg_addr : Address of the first register, will data is going to be written&#xA; *  \param reg_data : It is a value hold in the array,&#xA; *      will be used for write the value into the register&#xA; *  \param cnt : The no of byte of data to be write&#xA; */&#xA;s8 BNO055_I2C_bus_write(u8 dev_addr, u8 reg_addr, u8 *reg_data, u8 cnt)&#xA;{&#xA;    s32 iError = BNO055_ZERO_U8X;&#xA;    u8 array[I2C_BUFFER_LEN];&#xA;    u8 stringpos = BNO055_ZERO_U8X;&#xA;    array[BNO055_ZERO_U8X;] = reg_addr;&#xA;    for (stringpos = BNO055_ZERO_U8X; stringpos &amp;lt; cnt; stringpos++) {&#xA;        array[stringpos + BNO055_ONE_U8X] = *(reg_data + stringpos);&#xA;    }&#xA;    /*&#xA;    * Please take the below function as your reference for&#xA;    * write the data using I2C communication&#xA;    * &quot;IERROR = I2C_WRITE_STRING(DEV_ADDR, ARRAY, CNT+1)&quot;&#xA;    * add your I2C write function here&#xA;    * iError is an return value of I2C read function&#xA;    * Please select your valid return value&#xA;    * In the driver SUCCESS defined as 0&#xA;    * and FAILURE defined as -1&#xA;    * Note :&#xA;    * This is a full duplex operation,&#xA;    * The first read data is discarded, for that extra write operation&#xA;    * have to be initiated. For that cnt+1 operation done in the I2C write string function&#xA;    * For more information please refer data sheet SPI communication:&#xA;    */&#xA;    return (s8)iError;&#xA;}&#xA;&#xA; /* \Brief: The function is used as I2C bus read&#xA; *  \Return : Status of the I2C read&#xA; *  \param dev_addr : The device address of the sensor&#xA; *  \param reg_addr : Address of the first register, will data is going to be read&#xA; *  \param reg_data : This data read from the sensor, which is hold in an array&#xA; *  \param cnt : The no of byte of data to be read&#xA; */&#xA;s8 BNO055_I2C_bus_read(u8 dev_addr, u8 reg_addr, u8 *reg_data, u8 cnt)&#xA;{&#xA;    s32 iError = BNO055_ZERO_U8X;&#xA;    u8 array[I2C_BUFFER_LEN] = {BNO055_ZERO_U8X;};&#xA;    u8 stringpos = BNO055_ZERO_U8X;&#xA;    array[BNO055_ZERO_U8X;] = reg_addr;&#xA;    /* Please take the below function as your reference&#xA;     * for read the data using I2C communication&#xA;     * add your I2C rad function here.&#xA;     * &quot;IERROR = I2C_WRITE_READ_STRING(DEV_ADDR, ARRAY, ARRAY, 1, CNT)&quot;&#xA;     * iError is an return value of SPI write function&#xA;     * Please select your valid return value&#xA;     * In the driver SUCCESS defined as 0&#xA;     * and FAILURE defined as -1&#xA;     */&#xA;    for (stringpos = BNO055_ZERO_U8X; stringpos &amp;lt; cnt; stringpos++) {&#xA;        *(reg_data + stringpos) = array[stringpos];&#xA;    }&#xA;    return (s8)iError;&#xA;}&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Of course I get error messages when I try to compile:&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;main.c(108): error:  #268: declaration may not appear after executable statement in block     uint8_t data = I2C_ReceiveData(I2Cx);&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(124): error:  #268: declaration may not appear after executable&#xA;  statement in block    uint8_t data = I2C_ReceiveData(I2Cx);&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(140): error:  #268: declaration may not appear after executable&#xA;  statement in block    uint8_t received_data(2);&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(140): warning:  #550-D: variable &quot;received_data&quot; was set but&#xA;  never used    uint8_t received_data(2);&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(207): error:  #20: identifier &quot;comres&quot; is undefined    comres =&#xA;  bno055_init(&amp;amp;bno055);&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(207): error:  #20: identifier &quot;bno055&quot; is undefined    comres =&#xA;  bno055_init(&amp;amp;bno055);&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(215): error:  #20: identifier &quot;power_mode&quot; is undefined&lt;br&gt;&#xA;    power_mode = POWER_MODE_NORMAL; /* set the power mode as NORMAL*/&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(220): warning:  #9-D: nested comment is not allowed&lt;br&gt;&#xA;  /************************* START READ RAW SENSOR DATA****************/&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(255): error:  #20: identifier &quot;d_linear_accel_datax&quot; is&#xA;  undefined     comres +=&#xA;  bno055_convert_double_linear_accel_x_msq(&amp;amp;d_linear_accel_datax);&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(256): error:  #20: identifier &quot;d_linear_accel_datay&quot; is&#xA;  undefined     comres +=&#xA;  bno055_convert_double_linear_accel_y_msq(&amp;amp;d_linear_accel_datay);&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(257): error:  #20: identifier &quot;d_linear_accel_dataz&quot; is&#xA;  undefined     comres +=&#xA;  bno055_convert_double_linear_accel_z_msq(&amp;amp;d_linear_accel_dataz);&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(258): error:  #20: identifier &quot;d_linear_accel_xyz&quot; is undefined&#xA;    comres +=&#xA;  bno055_convert_double_linear_accel_xyz_msq(&amp;amp;d_linear_accel_xyz);&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;main.c(375): warning:  #1-D: last line of file ends without a newline &lt;/p&gt;&#xA;  &#xA;  &lt;h1&gt;endif&lt;/h1&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;The 'BNO055 sensor' has buit in sensor fusion algorithms (blends accelerometer, magnetometer and gyroscope data into stable three-axis orientation output). So it can output the data that I need. I would like to receive 'X, Y and Z Linear acceleration data as m/s2' and print it out on the Computer screen. I don't know if it is even possible to print out the data on my PC screen, since I connected the Discovery Board via USB to my computer. If it is not possible, then maybe it's possible to print it out on the Discovery Board's built in LCD Display.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any help to clarify my concern would be greatly welcomed.&lt;/p&gt;&#xA;" OwnerUserId="5289633" LastEditorUserId="5289633" LastEditDate="2015-09-06T22:06:33.007" LastActivityDate="2015-10-16T14:55:46.050" Title="STM32F4-Discovery Board: Print out data from connected sensor on the PC screen" Tags="&lt;c&gt;&lt;accelerometer&gt;&lt;gyroscope&gt;&lt;i2c&gt;&lt;stm32f4discovery&gt;" AnswerCount="2" CommentCount="2" FavoriteCount="1" />
  <row Id="32647391" PostTypeId="1" AcceptedAnswerId="32802118" CreationDate="2015-09-18T08:32:33.273" Score="1" ViewCount="568" Body="&lt;p&gt;In our project we want to use the GPU of a Freescale iMX6Q ARM processor to render an image and then write over a gstreamer pipeline to a VNC server.&#xA;The sequence is as follows:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Initialize OpenGL &lt;/li&gt;&#xA;&lt;li&gt;For each frame of the video stream: &#xA;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Render Image with OpenGL ES to a texture using a Framebuffer and a&#xA;Renderbuffer &lt;/li&gt;&#xA;&lt;li&gt;Read Image pixels using &lt;code&gt;glReadPixels()&lt;/code&gt; &lt;/li&gt;&#xA;&lt;li&gt;Copy the Image data to the video frame &lt;/li&gt;&#xA;&lt;li&gt;Push frame to the video stream&lt;/li&gt;&#xA;&lt;/ol&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;We use Yocto 1.8 as the build-system, and the source code below of the init sequence works on our nitrogen6X-lite prototype board (with &lt;code&gt;USE_PBUFFER&lt;/code&gt; defined), but not on our headless production board. On the production board we can't initalize a &quot;display&quot;: Either with &lt;code&gt;USE_PBUFFER&lt;/code&gt; defined or not defined, we get a &lt;code&gt;0x3003 EGL_BAD_ALLOC&lt;/code&gt; Error. We have the &lt;code&gt;vfb&lt;/code&gt; kernel module loaded with &lt;code&gt;vfb_enable=1&lt;/code&gt; and the &lt;code&gt;video=vfb&lt;/code&gt; kernel options. The dev file &lt;code&gt;/dev/fb0&lt;/code&gt; is created successfully. In yocto, we tried the &lt;code&gt;fsl-image-multimedia-full&lt;/code&gt;, &lt;code&gt;image-core&lt;/code&gt; and &lt;code&gt;image-core-directfb&lt;/code&gt; images both in default mode, and wtih &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;DISTRO_FEATURES_remove = &quot; x11 wayland&quot;&#xA;DISTRO_FEATURES_append = &quot; directfb&quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;in our &lt;code&gt;conf/local.conf&lt;/code&gt; file.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;How should can we use the GPU of the iMX processor in an embedded Linux settings to render offscreen, without having a display? What are the appropriate Kernel settings? What are the appropriate user-space functions to use?&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Current user-space implementation of the OpenGL init sequence:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;EGLDisplay display;&#xA;EGLSurface surface;&#xA;#ifdef  USE_PBUFFER&#xA;  display = eglGetDisplay(EGL_DEFAULT_DISPLAY);&#xA;#else&#xA; int fbnum = 0; // fbnum is an integer for /dev/fb0 fbnum = 0&#xA; EGLNativeDisplayType native_display = fbGetDisplayByIndex(fbnum);&#xA; EGLNativeWindowType native_window = fbCreateWindow(native_display, 0, 0, 0, 0);&#xA; display = eglGetDisplay(native_display);&#xA;#endif  &#xA;if (display == EGL_NO_DISPLAY) {&#xA; g_print(&quot;Unable to open connection to Window system: 0x%x\n&quot;,eglGetError());&#xA; return 0; // &amp;lt;-- Point of failure, both with and without USE_PBUFFER set&#xA;}&#xA;// ...&#xA;if (!eglInitialize(display, &amp;amp;majorVersion, &amp;amp;minorVersion)) {&#xA; g_print(&quot;Unable to initialize Display: 0x%x\n&quot;,eglGetError());&#xA; return 0;&#xA;}&#xA;// ...&#xA;#ifdef USE_PBUFFER&#xA;  surface = eglCreatePbufferSurface(display, config, surfaceAttribList); &#xA;#else&#xA;  surface = eglCreateWindowSurface(display, config, native_display, surfaceAttribList);&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Extract of the current kernel config, based on 3.14.28&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;# CONFIG_VGASTATE is not set&#xA;# CONFIG_VIDEO_OUTPUT_CONTROL is not set&#xA;CONFIG_HDMI=y&#xA;CONFIG_FB=y&#xA;# CONFIG_FIRMWARE_EDID is not set&#xA;# CONFIG_FB_DDC is not set&#xA;# CONFIG_FB_BOOT_VESA_SUPPORT is not set&#xA;CONFIG_FB_CFB_FILLRECT=y&#xA;CONFIG_FB_CFB_COPYAREA=y&#xA;CONFIG_FB_CFB_IMAGEBLIT=y&#xA;# CONFIG_FB_CFB_REV_PIXELS_IN_BYTE is not set&#xA;CONFIG_FB_SYS_FILLRECT=m&#xA;CONFIG_FB_SYS_COPYAREA=m&#xA;CONFIG_FB_SYS_IMAGEBLIT=m&#xA;# CONFIG_FB_FOREIGN_ENDIAN is not set&#xA;CONFIG_FB_SYS_FOPS=m&#xA;# CONFIG_FB_SVGALIB is not set&#xA;# CONFIG_FB_MACMODES is not set&#xA;# CONFIG_FB_BACKLIGHT is not set&#xA;CONFIG_FB_MODE_HELPERS=y&#xA;# CONFIG_FB_TILEBLITTING is not set&#xA;#&#xA;# Frame buffer hardware drivers&#xA;#&#xA;# CONFIG_FB_IMX is not set&#xA;# CONFIG_FB_UVESA is not set&#xA;# CONFIG_FB_OPENCORES is not set&#xA;# CONFIG_FB_S1D13XXX is not set&#xA;# CONFIG_FB_TMIO is not set&#xA;# CONFIG_FB_SMSCUFX is not set&#xA;# CONFIG_FB_UDL is not set&#xA;# CONFIG_FB_GOLDFISH is not set&#xA;CONFIG_FB_VIRTUAL=m&#xA;# CONFIG_FB_METRONOME is not set&#xA;CONFIG_FB_MX3=y&#xA;# CONFIG_FB_BROADSHEET is not set&#xA;# CONFIG_FB_AUO_K190X is not set&#xA;# CONFIG_FB_MXS is not set&#xA;# CONFIG_FB_SIMPLE is not set&#xA;# CONFIG_EXYNOS_VIDEO is not set&#xA;# CONFIG_BACKLIGHT_LCD_SUPPORT is not set&#xA;CONFIG_FB_MXC=y&#xA;# CONFIG_FB_MXC_SYNC_PANEL is not set&#xA;CONFIG_FB_MXC_EDID=y&#xA;# CONFIG_FB_MXC_EINK_PANEL is not set&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Update 2015-09-24:&lt;/strong&gt; &#xA;Well, as a first step to resolve the issues, we added the correct MXC framebuffer drivers to the kernel and the device tree, but we still keep getting EGL_BAD_ALLOC Errors (both when x11 and wayland are added to the image or not). We use the following kernel command line:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;[..] video=mxcfb0:dev=hdmi,1920x1080M@60,if=RGB24 gpumem=64M fbmem=32M,32M [..]&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Also, the device files &lt;code&gt;/dev/fb0&lt;/code&gt; and &lt;code&gt;/dev/fb1&lt;/code&gt; are created correctly and the output on &lt;code&gt;/sys/class/graphics/fb0&lt;/code&gt; resp. &lt;code&gt;fb1&lt;/code&gt; is looking reasonable (i.e. same as on my desktop pc and my nitrogen reference board)&lt;/p&gt;&#xA;" OwnerUserId="4477279" LastEditorUserId="4477279" LastEditDate="2015-09-24T07:32:19.667" LastActivityDate="2015-09-26T21:18:06.260" Title="OpenGL ES use in a headless embedded linux platform" Tags="&lt;c&gt;&lt;linux&gt;&lt;opengl-es&gt;&lt;yocto&gt;" AnswerCount="2" CommentCount="0" />
  <row Id="32936849" PostTypeId="1" AcceptedAnswerId="32937574" CreationDate="2015-10-04T18:28:26.073" Score="1" ViewCount="330" Body="&lt;p&gt;Using g++ version 4.8.4 I get an error:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;error: invalid conversion from ‘const SSL_METHOD* (&lt;em&gt;)() {aka const ssl_method_st&lt;/em&gt; (&lt;em&gt;)()}’ to ‘MethodFuncPtr {aka ssl_method_st&lt;/em&gt; (*)()}’ [-fpermissive]&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I can compile with -fpermissive, but what is a fix?  I've seen solutions for this type of error, but none for when the return type is const (even though it's explicitly a const return value).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;A snippet from ssl.h (C header):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;  typedef struct ssl_method_st {&#xA;    int version;&#xA;    int (*ssl_new) (int *s);&#xA;    void (*ssl_clear) (int *s);&#xA;  } SSL_METHOD;&#xA;&#xA;  const SSL_METHOD *TLSv1_method(void);&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;C++ header:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;ssl.h&amp;gt;&#xA;&#xA;extern &quot;C&quot; {&#xA;  typedef SSL_METHOD*(*MethodFuncPtr)(void);&#xA;}&#xA;&#xA;class Method&#xA;{&#xA; public:&#xA;  Method(SSL_METHOD *method);&#xA;&#xA;  static const MethodFuncPtr TLSv1;&#xA;&#xA; private:&#xA;  SSL_METHOD *m_method;&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;C++ source:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Method::Method(SSL_METHOD* method)&#xA;  : m_method(method)&#xA;{ }&#xA;&#xA;const MethodFuncPtr Method::TLSv1 = TLSv1_method;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="5407316" LastEditorUserId="1413395" LastEditDate="2015-10-04T18:32:44.313" LastActivityDate="2015-10-04T19:36:09.570" Title="error: invalid conversion on const return type" Tags="&lt;c++&gt;&lt;c&gt;&lt;c++11&gt;&lt;g++&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="33376567" PostTypeId="1" CreationDate="2015-10-27T19:09:50.630" Score="0" ViewCount="457" Body="&lt;p&gt;I am trying to export a function pointer for a function to be called.  What I am after is when a function in a dll/exe needs to call a function exported by another library it gets the function pointer and calls that.  The reason for this is I want to provide a hooking mechanism and I figured function pointers would be the quickest and easiest way because I can change what they point to easily are runtime.&#xA;So I found this &lt;a href=&quot;http://stackoverflow.com/questions/7764074/exporting-a-function-pointer-from-dll&quot;&gt;Exporting a function pointer from dll&lt;/a&gt; and I cant get it to work.  Whenever I call it to get the function pointer I get an error that it cant find the entry point.  So the error isnt that the function pointer is working but the function to get the function pointer isnt working.  I believe it is a function signature issue.  Here is an example:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Colors.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef __COLORS&#xA;#define __COLORS&#xA;&#xA;#ifdef  MYDLL_EXPORTS &#xA;/*Enabled as &quot;export&quot; while compiling the dll project*/&#xA;#define DLLEXPORT __declspec(dllexport)  &#xA;#else&#xA;/*Enabled as &quot;import&quot; in the Client side for using already created dll file*/&#xA;#define DLLEXPORT __declspec(dllimport)  &#xA;#endif&#xA;&#xA;#include &amp;lt;string&amp;gt;&#xA;#include &amp;lt;vector&amp;gt;&#xA;class Colors&#xA;{&#xA;private:&#xA;     std::string myColor;&#xA;     static DLLEXPORT std::vector&amp;lt;std::string&amp;gt; allColors;&#xA;public:&#xA;     Colors(){};&#xA;     Colors(std::string MyColor);&#xA;     virtual DLLEXPORT std::string getMyColor();&#xA;     virtual DLLEXPORT void addToColors(std::string color);&#xA;     std::vector&amp;lt;std::string&amp;gt; getAllColors();&#xA;};&#xA;typedef Colors* (*create)(std::string);&#xA;&#xA;DLLEXPORT create createColors();&#xA;&#xA;Colors* createColors2(std::string color);&#xA;&#xA;&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;colors.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define MYDLL_EXPORTS&#xA;#include &quot;Color.h&quot;&#xA;&#xA;&#xA;&#xA;&#xA;std::vector&amp;lt;std::string&amp;gt; Colors::allColors;&#xA;&#xA;Colors::Colors(std::string MyColor)&#xA;{&#xA;     this-&amp;gt;myColor = MyColor;&#xA;     this-&amp;gt;allColors.push_back(this-&amp;gt;myColor);&#xA;}&#xA;&#xA;std::vector&amp;lt;std::string&amp;gt; Colors::getAllColors()&#xA;{&#xA;     return this-&amp;gt;allColors;&#xA;}&#xA;&#xA;std::string Colors::getMyColor()&#xA;{&#xA;    return this-&amp;gt;myColor;&#xA;}&#xA;&#xA;Colors* createColors2(std::string color)&#xA;{&#xA;    return new Colors(color);&#xA;&#xA;}&#xA;&#xA;DLLEXPORT void Colors::addToColors(std::string color)&#xA;{&#xA;     this-&amp;gt;allColors.push_back(color);&#xA;}&#xA;&#xA;DLLEXPORT create createColors()&#xA;{&#xA;     return &amp;amp;createColors2;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;main.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define MYDLL_EXPORTS&#xA;&#xA;#include &amp;lt;iostream&amp;gt;&#xA;#include &amp;lt;Windows.h&amp;gt;&#xA;#include &quot;Color.h&quot;&#xA;&#xA;&#xA;&#xA;int main()&#xA;{&#xA;&#xA;&#xA;    Colors red(&quot;red&quot;);&#xA;    Colors blue(&quot;blue&quot;);&#xA;&#xA;    Colors* dlltest;&#xA;&#xA;    //Define the function prototype&#xA;    typedef Colors* (*createNewColor)();&#xA;&#xA;    BOOL freeResult, runTimeLinkSuccess = FALSE;&#xA;    HINSTANCE dllHandle = NULL;&#xA;    createNewColor dllCreateNewColor = NULL;&#xA;&#xA;    //Load the dll and keep the handle to it&#xA;    dllHandle = LoadLibrary(L&quot;libs/testerdll.dll&quot;);&#xA;&#xA;    // If the handle is valid, try to get the function address. &#xA;    if (NULL != dllHandle)&#xA;    {&#xA;&#xA;        //Get pointer to our function using GetProcAddress:&#xA;        dllCreateNewColor = (createNewColor)GetProcAddress(dllHandle,&quot;createNewColor&quot;);&#xA;&#xA;        // If the function address is valid, call the function. &#xA;        if (runTimeLinkSuccess = (NULL != dllCreateNewColor))&#xA;        {&#xA;&#xA;            dlltest = dllCreateNewColor();&#xA;            std::cout &amp;lt;&amp;lt; &quot;Color of dll class: &quot; &amp;lt;&amp;lt; dlltest-&amp;gt;getMyColor() &amp;lt;&amp;lt; std::endl;&#xA;        }&#xA;        else&#xA;        {&#xA;            std::cout &amp;lt;&amp;lt; &quot;Failed to locate function&quot; &amp;lt;&amp;lt; std::endl;&#xA;        }&#xA;&#xA;            //Free the library:&#xA;            //freeResult = FreeLibrary(dllHandle);&#xA;    }&#xA;    else&#xA;    {&#xA;         std::cout &amp;lt;&amp;lt; &quot;Failed to load library&quot; &amp;lt;&amp;lt; std::endl;&#xA;    }&#xA;&#xA;    std::vector&amp;lt;std::string&amp;gt; colorslist = red.getAllColors();&#xA;    for (std::string color : colorslist)&#xA;    {&#xA;        std::cout &amp;lt;&amp;lt; color &amp;lt;&amp;lt; std::endl;&#xA;    }&#xA;    return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Dll project&#xA;dllmain.cpp&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// testerdll.cpp : Defines the exported functions for the DLL application.&#xA;&#xA;&#xA;#include &quot;stdafx.h&quot;&#xA;&#xA;&#xA;#include &quot;Color.h&quot;&#xA;&#xA;&#xA;&#xA;__declspec(dllexport) Colors* createNewColor()&#xA;{&#xA;    create temp1 = createColors();  //seems to fail here&#xA;&#xA;    return nullptr;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Yes I know I have memory leaks etc.  this was just a quick example code to replicate the problem.&lt;/p&gt;&#xA;" OwnerUserId="5354812" LastActivityDate="2015-10-27T19:46:35.183" Title="dll export function pointer (best way to provide exported function hooking)" Tags="&lt;c++&gt;&lt;pointers&gt;&lt;dll&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="33630829" PostTypeId="1" AcceptedAnswerId="33631120" CreationDate="2015-11-10T13:12:32.583" Score="1" ViewCount="13" Body="&lt;p&gt;I would like to add to a build list the packages I want to build if it is not installed yet.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The goal is to install some Python packages without pip and from local sources. I don't have access to pip...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So I wrote I Makefile that looks like: &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;all: natsort foo bar foobar ...&#xA;&#xA;natsort: natsort-4.0.4.tar.gz&#xA;    tar xvzf $&amp;lt;&#xA;    cd $(patsubst %.tar.gz,%, $&amp;lt;) &amp;amp;&amp;amp; python setup.py install&#xA;    rm -rf $(patsubst %.tar.gz,%, $&amp;lt;)&#xA;    python -c 'import natsort'&#xA;    echo -e &quot;Installation of $&amp;lt; [done]\n&quot; &amp;gt;&amp;gt; install.log &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The problem with this implementation is that all the packages will be rebuild and reinstalled each time I run the Make command. I would like to check if the module is already installed. My idea is to do something like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ifdef $(shell python -c 'import natsort')&#xA;all: natsort&#xA;endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;How can I rewrite this to make it works?&lt;/p&gt;&#xA;" OwnerUserId="2612235" LastActivityDate="2015-11-10T13:27:32.317" Title="Build on shell condition with Make" Tags="&lt;linux&gt;&lt;makefile&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="33668613" PostTypeId="1" CreationDate="2015-11-12T09:54:13.960" Score="0" ViewCount="67" Body="&lt;p&gt;So i'm working on linux and my question is how make a program accept arguments in execution like this one: &lt;/p&gt;&#xA;&#xA;&lt;p&gt;./program am i&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Also both functions work the same way at the moment, because i'm struggling  with getting only this line:&#xA;(expected result of show_info_who_am_i)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Kamil    pts/0    2015-11-12 10:14 (:0)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;instead of both of them:&#xA;(result of show_info_who)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Kamil    tty2     2015-11-12 10:13 (:0)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Kamil    pts/0    2015-11-12 10:14 (:0)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include    &amp;lt;stdio.h&amp;gt;&#xA;#include    &amp;lt;utmp.h&amp;gt;&#xA;#include    &amp;lt;fcntl.h&amp;gt;&#xA;#include    &amp;lt;unistd.h&amp;gt;&#xA;#include    &amp;lt;stdlib.h&amp;gt;&#xA;#include    &amp;lt;time.h&amp;gt;&#xA;#include    &amp;lt;sys/types.h&amp;gt;&#xA;&#xA;#define SHOWHOST    /* include remote machine on output */&#xA;&#xA;show_info_who( struct utmp *utbufp )&#xA;{&#xA;    if(utbufp-&amp;gt;ut_type &amp;gt; 4){&#xA;        time_t czas = utbufp-&amp;gt;ut_time;&#xA;        char buf[80];&#xA;        struct tm* timeinfo = localtime(&amp;amp;czas);&#xA;&#xA;        printf(&quot;%-8.8s&quot;, utbufp-&amp;gt;ut_name);  /* the logname  */&#xA;        printf(&quot; &quot;);                /* a space  */&#xA;        printf(&quot;%-8.8s&quot;, utbufp-&amp;gt;ut_line);  /* the tty  */&#xA;        printf(&quot; &quot;);                /* a space  */&#xA;        strftime(buf, 80, &quot;%F %R&quot; , timeinfo);&#xA;        printf(&quot;%s&quot;, buf);&#xA;        printf(&quot; &quot;);                /* a space  */&#xA;&#xA;&#xA;    #ifdef  SHOWHOST&#xA;        printf(&quot;(%s)&quot;, utbufp-&amp;gt;ut_host);    /* the host */&#xA;    #endif&#xA;        printf(&quot;\n&quot;);               /* newline  */&#xA;    }&#xA;}&#xA;&#xA;show_info_who_am_i( struct utmp *utbufp )&#xA;{&#xA;    if(utbufp-&amp;gt;ut_type &amp;gt; 4){&#xA;        time_t czas = utbufp-&amp;gt;ut_time;&#xA;        char buf[80];&#xA;        struct tm* timeinfo = localtime(&amp;amp;czas);&#xA;&#xA;        printf(&quot;%-8.8s&quot;, utbufp-&amp;gt;ut_name);  /* the logname  */&#xA;        printf(&quot; &quot;);                /* a space  */&#xA;        printf(&quot;%-8.8s&quot;, utbufp-&amp;gt;ut_line);  /* the tty  */&#xA;        printf(&quot; &quot;);                /* a space  */&#xA;        strftime(buf, 80, &quot;%F %R&quot; , timeinfo);&#xA;        printf(&quot;%s&quot;, buf);&#xA;        printf(&quot; &quot;);                /* a space  */&#xA;&#xA;&#xA;    #ifdef  SHOWHOST&#xA;        printf(&quot;(%s)&quot;, utbufp-&amp;gt;ut_host);    /* the host */&#xA;    #endif&#xA;        printf(&quot;\n&quot;);               /* newline  */&#xA;    }&#xA;&#xA;}&#xA;&#xA;int main(int argc, char *argv[])&#xA;{&#xA;    struct utmp current_record; /* read info into here       */&#xA;    int     utmpfd;     /* read from this descriptor */&#xA;    int     reclen = sizeof(current_record);&#xA;&#xA;    if ( (utmpfd = open(UTMP_FILE, O_RDONLY)) == -1 ){&#xA;        perror( UTMP_FILE );    /* UTMP_FILE is in utmp.h    */&#xA;        exit(1);&#xA;    }&#xA;&#xA;    //char am[22] = &quot;am&quot;;    /* test */&#xA;    //char i[22] = &quot;i&quot;;    /* test */&#xA;&#xA;    //printf(&quot;%s,%s\n\n&quot;, am,i);    /* test */&#xA;    //printf(&quot;%s&quot;, argv[1]);&#xA;&#xA;    if(argv[1]== &quot;am&quot;){&#xA;        if(argv[2]== &quot;i&quot;){&#xA;            while ( read(utmpfd, &amp;amp;current_record, reclen) == reclen )&#xA;                show_info_who_am_i(&amp;amp;current_record);&#xA;        }&#xA;    }&#xA;    else{&#xA;        while ( read(utmpfd, &amp;amp;current_record, reclen) == reclen )&#xA;            show_info_who(&amp;amp;current_record);         &#xA;    }&#xA;    //printf(&quot;%s,%s&quot;, argv[1], argv[2]);      /* test */&#xA;    close(utmpfd);&#xA;    return 0;           /* went ok */&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="5553999" LastActivityDate="2015-11-12T09:54:13.960" Title="Pass string as argument into C program in terminal" Tags="&lt;c&gt;&lt;linux&gt;" AnswerCount="0" CommentCount="2" />
  <row Id="33673405" PostTypeId="1" AcceptedAnswerId="33674058" CreationDate="2015-11-12T14:10:26.643" Score="0" ViewCount="87" Body="&lt;p&gt;So i have to make a program that execution results are similar to those after using command who and who am i in linux. the problem is that both functions inside if(strcmp... and in else... are working when separated. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;The main issue is that i have to have them both in one file, and it just not work. When put together only that do something ./program am i, and ./program tells Segmentation fault (core dumped).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Second issue is that i have no clue how to make part ./program am i work properly it should return me only me: User pts/0 date time... not all of users like in else... part.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include    &amp;lt;stdio.h&amp;gt;&#xA;#include    &amp;lt;utmp.h&amp;gt;&#xA;#include    &amp;lt;fcntl.h&amp;gt;&#xA;#include    &amp;lt;unistd.h&amp;gt;&#xA;#include    &amp;lt;stdlib.h&amp;gt;&#xA;#include    &amp;lt;time.h&amp;gt;&#xA;#include    &amp;lt;string.h&amp;gt;&#xA;#include    &amp;lt;sys/types.h&amp;gt;&#xA;&#xA;#define SHOWHOST&#xA;&#xA;void show_info_who( struct utmp *utbufp )&#xA;{&#xA;    if(utbufp-&amp;gt;ut_type &amp;gt; 4){&#xA;        time_t czas = utbufp-&amp;gt;ut_time;&#xA;        char buf[80];&#xA;        struct tm* timeinfo = localtime(&amp;amp;czas);&#xA;&#xA;        printf(&quot;%-8.8s&quot;, utbufp-&amp;gt;ut_name);  &#xA;        printf(&quot; &quot;);                &#xA;        printf(&quot;%-8.8s&quot;, utbufp-&amp;gt;ut_line);  &#xA;        printf(&quot; &quot;);                &#xA;        strftime(buf, 80, &quot;%F %R&quot; , timeinfo);&#xA;        printf(&quot;%s&quot;, buf);&#xA;        printf(&quot; &quot;);                &#xA;&#xA;&#xA;    #ifdef  SHOWHOST&#xA;        printf(&quot;(%s)&quot;, utbufp-&amp;gt;ut_host);    &#xA;    #endif&#xA;        printf(&quot;\n&quot;);               &#xA;    }&#xA;}&#xA;&#xA;&#xA;int main(int argc, char *argv[])&#xA;{&#xA;    struct utmp current_record;&#xA;    int     utmpfd;     &#xA;    int     reclen = sizeof(current_record);&#xA;&#xA;    if ( (utmpfd = open(UTMP_FILE, O_RDONLY)) == -1 ){&#xA;        perror( UTMP_FILE );&#xA;        exit(1);&#xA;    }&#xA;&#xA;    if(strcmp ( argv[1], &quot;am&quot;) == 0){&#xA;        if(strcmp ( argv[2], &quot;i&quot;) == 0){&#xA;            while ( read(utmpfd, &amp;amp;current_record, reclen) == reclen )&#xA;                show_info_who(&amp;amp;current_record);&#xA;                printf(&quot;test\n&quot;);&#xA;        }&#xA;&#xA;    close(utmpfd);&#xA;    return 0;&#xA;    }&#xA;&#xA;        while ( read(utmpfd, &amp;amp;current_record, reclen) == reclen )&#xA;            show_info_who(&amp;amp;current_record);&#xA;        close(utmpfd);&#xA;&#xA;        return 0;&#xA;&#xA;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="5553999" LastActivityDate="2015-11-12T14:42:54.033" Title="Segmentation fault (core dumped) C linux" Tags="&lt;c&gt;&lt;linux&gt;" AnswerCount="1" CommentCount="5" />
  <row Id="33722172" PostTypeId="1" AcceptedAnswerId="33740878" CreationDate="2015-11-15T16:45:45.427" Score="-1" ViewCount="264" Body="&lt;p&gt;I create form and attached two &lt;strong&gt;TStylebook&lt;/strong&gt; on it.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The first one have Windows Style (&lt;em&gt;MetropolisUIBlack.vsf&lt;/em&gt;) the second one have Android style (&lt;em&gt;AndroidLight.fsf&lt;/em&gt;)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;On Form create i wrote the following code&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;procedure TMainForm.FormCreate(Sender: TObject);&#xA;begin&#xA;  {$IFDEF  MSWINDOWS}&#xA;    Self.StyleBook := WinStyle;&#xA;  {$ENDIF}&#xA;  {$IFDEF  ANDROID}&#xA;    Self.StyleBook := DroidStyle;&#xA;  {$ENDIF}&#xA;end;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The problem is if the Android style was selected at design time and i run the application on Windows i get the following message&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;The style you have chosen is not available for your currently selected&#xA;  target platform. You can select a custom style or remove the stylebook&#xA;  to allow FireMonkey to automatically load the native style at run time&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;How i can set the Stylebook depending on the platform regardless what i have select on the form design ?&lt;/p&gt;&#xA;" OwnerUserId="3500668" LastActivityDate="2015-11-16T17:10:56.957" Title="Delphi Multi Styles for Multiplatforms" Tags="&lt;android&gt;&lt;delphi&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="33953855" PostTypeId="1" AcceptedAnswerId="33959840" CreationDate="2015-11-27T09:11:35.527" Score="0" ViewCount="330" Body="&lt;p&gt;I have downloaded openssl compiled library for armeabi and x86 android platforms from &lt;a href=&quot;https://github.com/emileb/OpenSSL-for-Android-Prebuilt&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt; and tried to load it in the .pro file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;INCLUDEPATH += C:\Temp\openssl\OpenSSL-for-Android-Prebuilt\openssl-1.0.2\include\&#xA;LIBS += -LC:\Temp\openssl\OpenSSL-for-Android-Prebuilt\openssl-1.0.2\armeabi-v7a\lib \&#xA;-llibssl&#xA;-llibcrypto&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I have also tried with &lt;code&gt;-llibssl.so -llibcrypto.so&lt;/code&gt; and &lt;code&gt;-llibssl.a -llibcrypto.a&lt;/code&gt; but this error occures:&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;collect2.exe:-1: error: error: ld returned 1 exit status&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;The code is simple usage of SHA1 and it is running on MSVC 12.0 with .lib libraries successfully:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;mainwindow.cpp&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;mainwindow.h&quot;&#xA;#include &quot;ui_mainwindow.h&quot;&#xA;#include &quot;QMessageBox&quot;&#xA;#include &amp;lt;openssl/sha.h&amp;gt;&#xA;&#xA;MainWindow::MainWindow(QWidget *parent) :&#xA;    QMainWindow(parent),&#xA;    ui(new Ui::MainWindow)&#xA;{&#xA;    ui-&amp;gt;setupUi(this);&#xA;    const unsigned char ibuf[] = &quot;compute sha1&quot;;&#xA;    const char ibuf1[] = &quot;compute sha1&quot;;&#xA;    unsigned char obuf[20];&#xA;&#xA;    SHA1(ibuf, strlen(ibuf1), obuf);&#xA;&#xA;    int i;&#xA;    for (i = 0; i &amp;lt; 20; i++) {&#xA;        printf(&quot;%02x &quot;, obuf[i]);&#xA;    }&#xA;    printf(&quot;\n&quot;);&#xA;}&#xA;&#xA;MainWindow::~MainWindow()&#xA;{&#xA;    delete ui;&#xA;}&#xA;&#xA;void MainWindow::on_pushButton_clicked()&#xA;{&#xA;    QMessageBox::about(this,tr(&quot;Test&quot;),tr(&quot;Hellow man!!!&quot;));&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Of course I have read forums so here is the full log:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;C:\Users\niki\Downloads\android-ndk-r10e/toolchains/arm-linux-androideabi-4.9/prebuilt/windows/bin/arm-linux-androideabi-g++ --sysroot=C:\Users\niki\Downloads\android-ndk-r10e/platforms/android-9/arch-arm/ -Wl,-soname,libtestAndroid.so -Wl,--no-undefined -Wl,-z,noexecstack -shared -o libtestAndroid.so main.obj mainwindow.obj moc_mainwindow.obj   -LC:\Users\niki\Downloads\android-ndk-r10e/sources/cxx-stl/gnu-libstdc++/4.9/libs/armeabi -LC:\Users\niki\Downloads\android-ndk-r10e/platforms/android-9/arch-arm//usr/lib -LC:/Qt/5.5/android_armv5/lib -lQt5Widgets -Lc:\utils\android\ndk/sources/cxx-stl/gnu-libstdc++/4.8/libs/armeabi -Lc:\utils\android\ndk/platforms/android-9/arch-arm//usr/lib -lQt5Gui -lQt5Core -lGLESv2 -lgnustl_shared -llog -lz -lm -ldl -lc -lgcc&#xA;mainwindow.obj:mainwindow.cpp:function MainWindow::MainWindow(QWidget*): error: undefined reference to 'SHA1'&#xA;collect2.exe: error: ld returned 1 exit status&#xA;makefile:83: recipe for target 'libtestAndroid.so' failed&#xA;mingw32-make: *** [libtestAndroid.so] Error 1&#xA;10:47:05: The process &quot;C:\Qt\Tools\mingw492_32\bin\mingw32-make.exe&quot; exited with code 2.&#xA;Error while building/deploying project testAndroid (kit: Android for armeabi (GCC 4.9, Qt 5.5.1))&#xA;When executing step &quot;Make&quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It seems that SHA1 is the problem. In sha.h it is defined&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;so this is not the issue. There is some Android.mk file. What to do? Should I load it somehow in .pro file? I just wanted to try usage of openssl in android before compile it to be shure it is possible to work(because compilling will take time and must be done on linux). &lt;/p&gt;&#xA;" OwnerUserId="5467838" LastEditorUserId="5467838" LastEditDate="2015-11-27T09:36:03.760" LastActivityDate="2015-11-27T14:47:19.533" Title="QT 5.5.1 .so library with android" Tags="&lt;android&gt;&lt;c++&gt;&lt;qt&gt;&lt;openssl&gt;&lt;shared-libraries&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="34031152" PostTypeId="1" AcceptedAnswerId="34036063" CreationDate="2015-12-01T22:09:22.920" Score="1" ViewCount="110" Body="&lt;p&gt;I am trying to re-create some C++ sample API usage code in C#.&lt;br&gt;&#xA;It's looking like I might need to create a C++/CLI wrapper to make the API functions accessible to the managed world, but I'd like to avoid that if possible. The API library itself only has a single exported function: &lt;code&gt;data_api_func_tab&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This is what the C++ API usage looks like:&lt;/p&gt;&#xA;&#xA;&#xA;&#xA;&lt;pre class=&quot;lang-cpp prettyprint-override&quot;&gt;&lt;code&gt;//&#xA;// .h file &#xA;// &#xA;typedef struct _DATA_API_FUNC_TAB {&#xA;    short   (*api_init)();&#xA;    // ... lots of other methods ...&#xA;&#xA;} DATA_API_FUNC_TAB&#xA;&#xA;extern  &quot;C&quot;  typedef short  (* MAPIINIT)(short);&#xA;// ... lots of other methods ...&#xA;&#xA;#undef  EXTERN&#xA;#ifdef  _MAIN&#xA;#define EXTERN&#xA;#else&#xA;#define EXTERN  extern&#xA;#endif&#xA;&#xA;EXTERN  MAPIINIT ncm_api_init;&#xA;// ... lots of other methods ...&#xA;&#xA;public:&#xA;    UCHAR SomeVariable;&#xA;    void SomeMethod( arguments );&#xA;&#xA;//&#xA;// .cpp file&#xA;//  &#xA;/// Constructor&#xA;CWidgetDataApi::CWidgetDataApi()&#xA;{&#xA;    SomeVariable = 0;&#xA;&#xA;    m_hInstHdl = ::LoadLibrary(_T(&quot;.\\NATIVEAPI.dll&quot;));&#xA;    if( NULL != m_hInstHdl )&#xA;    {&#xA;        DATA_API_FUNC_TAB* p_data_api_func_tab =&#xA;            (DATA_API_FUNC_TAB*) ::GetProcAddress(m_hInstHdl, &quot;data_api_func_tab&quot;);&#xA;        SomeVariable = 1;&#xA;&#xA;        if( p_data_api_func_tab == NULL )&#xA;        {&#xA;            ::FreeLibrary(m_hInstHdl);&#xA;            m_hInstHdl = NULL;&#xA;            SomeVariable = 0;&#xA;        }&#xA;        else&#xA;        {&#xA;            api_init = (MAPINIT) p_data_api_func_tab-&amp;gt;api_init;&#xA;            // ... lots of other methods ...&#xA;&#xA;            short Ret = api_init(index);&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;/// Method&#xA;void CWidgetDataApi::SomeMethod( arguments )&#xA;{&#xA;   // ... Makes use of the various other methods ...&#xA;}&#xA;&#xA;//&#xA;// Usage in another class&#xA;//&#xA;DataAPI = new CWidgetDataApi;&#xA;&#xA;if( DataAPI-&amp;gt;SomeVariable == 1 )&#xA;{ &#xA;    DataAPI-&amp;gt;SomeMethod( arguments );  &#xA;    ...&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Since I can't use reflection on the native library (not to mention it would be slow), PInvoke seems to be the only way in.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have recreated the appropriate structures in C# and tried the following PInvoke signatures, &lt;/p&gt;&#xA;&#xA;&lt;pre class=&quot;lang-cpp prettyprint-override&quot;&gt;&lt;code&gt;[DllImport(&quot;NATIVEAPI.dll&quot;, CharSet = CharSet.Auto, SetLastError = true)]&#xA;internal static extern struct data_api_func_tab { };&#xA;&#xA;[DllImport(&quot;NATIVEAPI.dll&quot;, CharSet = CharSet.Auto, SetLastError = true)]&#xA;internal static extern short api_init([In, Out] ref _DATA_API_FUNC_TAB data_api_func_tab);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but they produce the exception&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;Unable to find an entry point named '... whatever I try...' in NATIVEAPI.dll &lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;I've searched around for a way to do this but only seem to find unmanaged to C++/CLI solutions. Is what I am attempting to do even possible (given that the individual methods contained in the structure are not exported)?&lt;/p&gt;&#xA;" OwnerUserId="2596334" LastEditorUserId="2596334" LastEditDate="2015-12-02T21:06:31.387" LastActivityDate="2015-12-02T21:06:31.387" Title="PInvoke method contained in a native structure" Tags="&lt;c#&gt;&lt;api&gt;&lt;struct&gt;&lt;pinvoke&gt;" AnswerCount="1" CommentCount="8" />
  <row Id="34086390" PostTypeId="1" AcceptedAnswerId="34087095" CreationDate="2015-12-04T10:39:30.850" Score="2" ViewCount="158" Body="&lt;p&gt;As per my understanding array of strings can be initialized as shown below or using two dimensional array. Please tell is there any other possibility.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;char *states[] = { &quot;California&quot;, &quot;Oregon&quot;, &quot;Washington&quot;, &quot;Texas&quot; };&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I have observed in U-boot source that environment variables are stored in one dimensional array as shown &lt;a href=&quot;http://git.denx.de/?p=u-boot.git;a=blob;f=common/env_common.c;h=be64d1307b96441ba184e080263541d7860f7dd2;hb=3d35d87d5482de23cd5dc4d7721b1086107cae50#l60&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;uchar default_environment[] = {&#xA;#ifdef  CONFIG_BOOTARGS&#xA;    &quot;bootargs=&quot;     CONFIG_BOOTARGS     &quot;\0&quot;&#xA;#endif&#xA;#ifdef  CONFIG_BOOTCOMMAND&#xA;    &quot;bootcmd=&quot;      CONFIG_BOOTCOMMAND   &quot;\0&quot;&#xA;#endif &#xA;...&#xA;    &quot;\0&quot;&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Can you help me understand this?&lt;/p&gt;&#xA;" OwnerUserId="3693586" LastEditorUserId="2718186" LastEditDate="2015-12-04T10:57:31.197" LastActivityDate="2015-12-16T17:02:40.233" Title="unsure about initializing one dimensional char array with array of strings" Tags="&lt;c&gt;&lt;arrays&gt;&lt;c-strings&gt;&lt;u-boot&gt;" AnswerCount="6" CommentCount="3" FavoriteCount="1" />
  <row Id="34146392" PostTypeId="1" AcceptedAnswerId="34150046" CreationDate="2015-12-08T01:21:16.850" Score="2" ViewCount="81" Body="&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#include &amp;lt;stdbool.h&amp;gt;&#xA;#include &quot;Book.h&quot;&#xA;&#xA;&#xA;int main(int argc, char** argv) {&#xA;&#xA;    Book * dummy = newBook(&quot;dummy&quot;, &quot;dummy&quot;, 00000);&#xA;&#xA;    printf(&quot;%s %s %ld&quot;, dummy-&amp;gt;title, dummy-&amp;gt;author, dummy-&amp;gt;ISBN);&#xA;&#xA;    dummy-&amp;gt;next = NULL;&#xA;&#xA;&#xA;    Book* newishBook = newBook(&quot;Foo&quot;, &quot;Chris&quot;, 1234);&#xA;    insertToList(newishBook, dummy);&#xA;&#xA;    Book* another = newBook(&quot;Bar&quot;, &quot;Jim&quot;, 23344);&#xA;    insertToList(another, dummy);&#xA;&#xA;    Book* yet = newBook(&quot;Derp&quot;, &quot;Bob&quot;, 999);&#xA;    insertToList(yet, dummy);&#xA;&#xA;    displayList(dummy);&#xA;&#xA;    searchISBN(999);&#xA;&#xA;    return (EXIT_SUCCESS);&#xA;}&#xA;&#xA;Book* newBook(char* newTitle, char* newAuthor, long newISBN) {&#xA;    Book* new_book = malloc(sizeof(Book));&#xA;&#xA;    strcpy(new_book-&amp;gt;title, newTitle);&#xA;    strcpy(new_book-&amp;gt;author, newAuthor);&#xA;    new_book-&amp;gt;ISBN = newISBN;&#xA;    return new_book;&#xA;}&#xA;&#xA;&#xA;&#xA;void insertToList(Book* bookToInsert, Book* dummy){&#xA;    Book* currentNode = dummy;&#xA;    Book* temp = malloc(sizeof(Book));&#xA;&#xA;    if (currentNode-&amp;gt;next == NULL){&#xA;        currentNode-&amp;gt;next = bookToInsert;&#xA;        printf(&quot;Head&quot;);&#xA;    } else {&#xA;        currentNode= currentNode-&amp;gt;next;        &#xA;        while(currentNode-&amp;gt;ISBN &amp;gt; bookToInsert-&amp;gt;ISBN){&#xA;&#xA;            if (bookToInsert -&amp;gt;ISBN &amp;lt; currentNode-&amp;gt;ISBN){&#xA;                // if isbn of current book more than current node, move to next current node&#xA;                //otherwise add here&#xA;                printf(&quot;Added&quot;);&#xA;                temp-&amp;gt;next = currentNode-&amp;gt;next;&#xA;                bookToInsert-&amp;gt;next = currentNode-&amp;gt;next;&#xA;                currentNode-&amp;gt;next = temp-&amp;gt;next;&#xA;            }&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;void displayList(Book* dummy){&#xA;    //start at dummy node-&#xA;    Book* currentNode = dummy;&#xA;    bool run = true;&#xA;&#xA;    //print until next = null&#xA;    while(run==true){&#xA;        if (currentNode-&amp;gt;next != NULL){&#xA;            printf(&quot;%s %s %ld \n&quot;, currentNode-&amp;gt;title, currentNode-&amp;gt;author, currentNode-&amp;gt;ISBN); &#xA;            currentNode = currentNode -&amp;gt;next;&#xA;        } else {&#xA;            run = false;&#xA;        }&#xA;    }    &#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This program is intended to create book structs which are the nodes of a linked list. A book is defined as follows in the header file Book.h:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef BOOK_H&#xA;#define BOOK_H&#xA;&#xA;#ifdef  __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;&#xA;typedef struct book_t {&#xA;    char title[50];&#xA;    char author[30];&#xA;    long ISBN;&#xA;    struct Book *next;&#xA;} Book;&#xA;&#xA;Book* newBook(char* newTitle, char* newAuthor, long newISBN);&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;&#xA;#endif  /* BOOK_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I feel like my insertToList function is close to working, but I've got code-blindness from looking at it too wrong and I'm sure there's something really basic wrong with it. Currently there is no output- just an empty terminal, I believe the loop is not exiting properly. Uncommenting the printf statments &quot;added&quot; and &quot;head&quot; causes the program to loop indefinitely, outputting &quot;added&quot; to the terminal.&lt;/p&gt;&#xA;" OwnerUserId="2754717" LastEditorUserId="3547036" LastEditDate="2015-12-08T05:31:25.860" LastActivityDate="2015-12-08T07:13:45.263" Title="Linked Lists in C- adding a struct in sorted position" Tags="&lt;c&gt;&lt;linked-list&gt;&lt;singly-linked-list&gt;" AnswerCount="2" CommentCount="7" />
  <row Id="34195944" PostTypeId="1" CreationDate="2015-12-10T07:23:36.150" Score="0" ViewCount="239" Body="&lt;p&gt;Our current project includes FreeRTOS, and I added --use_frame_pointer to Keil uVision's ARMGCC compiler option. But after loading firmware into STM32F104 chip, then runs it, it crashed. Without --use_frame_pointer, everything is OK.&#xA;The hard fault handler shows that faultStackAddress is 0x40FFFFDC, which points to a reserved area. Does anyone has any idea of this error? Thanks a lot.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#if defined(__CC_ARM)&#xA;__asm void HardFault_Handler(void)&#xA;{&#xA;   TST lr, #4&#xA;   ITE EQ&#xA;   MRSEQ r0, MSP&#xA;   MRSNE r0, PSP&#xA;   B __cpp(Hard_Fault_Handler)&#xA;}&#xA;#else&#xA;void HardFault_Handler(void)&#xA;{&#xA;   __asm(&quot;TST lr, #4&quot;);&#xA;   __asm(&quot;ITE EQ&quot;);&#xA;   __asm(&quot;MRSEQ r0, MSP&quot;);&#xA;   __asm(&quot;MRSNE r0, PSP&quot;);&#xA;   __asm(&quot;B Hard_Fault_Handler&quot;);&#xA;}&#xA;#endif&#xA;&#xA;void Hard_Fault_Handler(uint32_t *faultStackAddress)&#xA;{&#xA;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I stepped into each line of code, and the crash happened in below function in FreeRTOS's port.c after I called  vTaskDelete(NULL);&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;void vPortYieldFromISR( void )&#xA;{&#xA;    /* Set a PendSV to request a context switch. */&#xA;    portNVIC_INT_CTRL_REG = portNVIC_PENDSVSET_BIT;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But seems like this is not the root cause, because when I deleted vTaskDelete(NULL), crash still happened.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;[update on Jan 8] sample code&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;FreeRTOSConfig.h&quot;&#xA;#include &quot;FreeRTOS.h&quot;&#xA;#include &quot;task.h&quot;&#xA;#include &amp;lt;stm32f10x.h&amp;gt;&#xA;&#xA;void crashTask(void *param)&#xA;{&#xA;&#xA;    unsigned int i = 0;&#xA;    /* halt the hardware. */&#xA;    while(1)&#xA;    {&#xA;         i += 1;&#xA;    }&#xA;    vTaskDelete(NULL);&#xA;}&#xA;void testCrashTask()&#xA;{&#xA;    xTaskCreate(crashTask, (const signed char *)&quot;crashTask&quot;,  configMINIMAL_STACK_SIZE,  NULL,  1,  NULL);    &#xA;}&#xA;&#xA;void Hard_Fault_Handler(unsigned int *faultStackAddress);&#xA;&#xA;/* The fault handler implementation calls a function called Hard_Fault_Handler(). */&#xA;#if defined(__CC_ARM)&#xA;__asm void HardFault_Handler(void)&#xA;{&#xA;   TST lr, #4&#xA;   ITE EQ&#xA;   MRSEQ r0, MSP&#xA;   MRSNE r0, PSP&#xA;   B __cpp(Hard_Fault_Handler)&#xA;}&#xA;#else&#xA;void HardFault_Handler(void)&#xA;{&#xA;   __asm(&quot;TST lr, #4&quot;);&#xA;   __asm(&quot;ITE EQ&quot;);&#xA;   __asm(&quot;MRSEQ r0, MSP&quot;);&#xA;   __asm(&quot;MRSNE r0, PSP&quot;);&#xA;   __asm(&quot;B Hard_Fault_Handler&quot;);&#xA;}&#xA;#endif&#xA;&#xA;void Hard_Fault_Handler(unsigned int *faultStackAddress)&#xA;{&#xA;    int i = 0;&#xA;    while(1)&#xA;    {&#xA;        i += 1;&#xA;    }&#xA;}&#xA;&#xA;void nvicInit(void)&#xA;{&#xA;&#xA;    NVIC_PriorityGroupConfig(NVIC_PriorityGroup_4);&#xA;    #ifdef  VECT_TAB_RAM                            &#xA;    NVIC_SetVectorTable(NVIC_VectTab_RAM, 0x0);     &#xA;    #else&#xA;    NVIC_SetVectorTable(NVIC_VectTab_FLASH, 0x0);  &#xA;    #endif&#xA;}&#xA;&#xA;int main()&#xA;{&#xA;    nvicInit();&#xA;&#xA;    testCrashTask();&#xA;    vTaskStartScheduler();&#xA;&#xA;}&#xA;&#xA;/* For now, the stack depth of IDLE has 88 left. if want add func to here, &#xA;   you should increase it. */&#xA;void vApplicationIdleHook(void)&#xA;{   /* ATTENTION: all funcs called within here, must not be blocked */&#xA;    //workerProbe();&#xA;}&#xA;&#xA;void debugSendTraceInfo(unsigned int taskNbr)&#xA;{&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;When crash happened, in HardFault_Handler, Keil MDK IDE reports below fault information. I looked the STKERR error, which mainly means that stack pointer is corrupted. But I really have no idea why it is corrupted. Without --use_frame_pointer, everything works OK.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&quot;https://i.stack.imgur.com/G3qSf.png&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/G3qSf.png&quot; alt=&quot;enter image description here&quot;&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;[update on Jan 13]&lt;/strong&gt;&lt;br&gt;&#xA;I did further investigation. Seems like the crash is caused by FreeRTOS's default TimerTask. If I comment out the xTimerCreateTimerTask() in vTaskStartScheduler() function(tasks.c), the crash does not happen. &lt;br&gt;&#xA;Another odd thing is that if I debug it and step into the TimerTask's portYIELD_WITHIN_API() function call, then resume the application. It does not crash. So my guess is that this might due to certain time sequence. But I could not find the root cause of it.&lt;br&gt;&#xA;Any thoughts? Thanks.&lt;/p&gt;&#xA;" OwnerUserId="827484" LastEditorUserId="827484" LastEditDate="2016-01-13T10:52:37.743" LastActivityDate="2016-01-13T10:52:37.743" Title="ARM Cortex-M3 crashed with --use_frame_pointer caused by FreeRTOS's TimerTask" Tags="&lt;arm&gt;&lt;embedded&gt;&lt;stm32&gt;&lt;cortex-m3&gt;&lt;freertos&gt;" AnswerCount="0" CommentCount="8" />
  <row Id="34337679" PostTypeId="1" AcceptedAnswerId="34337820" CreationDate="2015-12-17T15:00:04.123" Score="0" ViewCount="52" Body="&lt;p&gt;I'm having hard time working around one warning issued by VS2013.&#xA;What I have is a piece of code used for passing text to int var:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define WRITE(txt)  { foo-&amp;gt;bar.func = func_xyz; foo-&amp;gt;bar.xyz.var = (((uint64_t) (uintptr_t) (txt)) &amp;amp; 0xFFFFFFFFu); } //where var is uint32_t&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Which causes the compiler to return &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;warning C4244: '=' : conversion from 'uintptr_t' to 'uint32_t', possible loss of data.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Now unfortunately I can't possibly change var type to anything else than uint32_t and unfortunately I fall victim to preprocessor directive &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  _WIN64&#xA;    typedef unsigned __int64    uintptr_t;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Is there any way to get around this warning and do it the right way? I'm 100% sure that this is fully working (simply because it is), but any kind of warning is unacceptable. &lt;/p&gt;&#xA;" OwnerUserId="4574639" LastEditorUserId="1795279" LastEditDate="2015-12-17T15:00:44.933" LastActivityDate="2015-12-17T15:37:02.823" Title="Int pointer type to int" Tags="&lt;c&gt;&lt;visual-studio&gt;&lt;types&gt;&lt;casting&gt;&lt;warnings&gt;" AnswerCount="2" CommentCount="4" />
  <row Id="34688765" PostTypeId="1" CreationDate="2016-01-09T01:37:04.607" Score="0" ViewCount="35" Body="&lt;p&gt;How can I return a string that hasn't curly braces on it?&#xA;Example, in bellow code I want pattern.group(3) matches only code with no curly braces.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;pattern = re.search('(.*)#ifdef (.*?)if(.*?)#endif(.*?){(.*?)}(.*)',codigo,re.DOTALL)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;So &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef expression_1&#xA;  if (condition_1)&#xA;#endif&#xA;{&#xA;  //lines of code&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;is suposed to match, and&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef SIZE == 1                &#xA;         if(x == 2){&#xA;&#xA;&#xA;            //lines of code 2&#xA;&#xA;&#xA;        }&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;not.&lt;/p&gt;&#xA;" OwnerUserId="3093561" LastActivityDate="2016-01-09T05:04:23.250" Title="Python regex pattern without curly braces" Tags="&lt;python&gt;&lt;regex&gt;" AnswerCount="2" CommentCount="1" />
  <row Id="34814419" PostTypeId="1" AcceptedAnswerId="34815201" CreationDate="2016-01-15T15:26:55.687" Score="0" ViewCount="35" Body="&lt;p&gt;I am now reading the sourse code of Leptonica, which is a good image processing library. In this library it provides a function to set pixels value when the pixel's depth is 8 (corresponding to grey-scale image):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/*!&#xA; *  l_setDataByte()&#xA; *&#xA; *      Input:  line  (ptr to beginning of data line)&#xA; *              n     (pixel index)&#xA; *              val   (val to be inserted: 0 - 0xff)&#xA; *      Return: void&#xA; */&#xA;void&#xA;l_setDataByte(void    *line,&#xA;              l_int32  n,&#xA;              l_int32  val)&#xA;{&#xA;#ifdef  L_BIG_ENDIAN&#xA;    *((l_uint8 *)line + n) = val;&#xA;#else  /* L_LITTLE_ENDIAN */&#xA;    *(l_uint8 *)((l_uintptr_t)((l_uint8 *)line + n) ^ 3) = val;&#xA;#endif  /* L_BIG_ENDIAN */&#xA;}&#xA;&#xA;typedef   unsigned int   uintptr_t;&#xA;typedef unsigned char           l_uint8;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;For the case of big endian it is the code is very easy to understand, but for the little endian case it is very hard to understand. Could some explain why pixel value is set in this way when the computer is little endian? Thanks. &lt;/p&gt;&#xA;" OwnerUserId="1264018" LastActivityDate="2016-01-18T15:11:35.873" Title="image pixel reading in big_endian and little_endian" Tags="&lt;c++&gt;&lt;image&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="34906527" PostTypeId="1" CreationDate="2016-01-20T17:23:37.557" Score="0" ViewCount="58" Body="&lt;p&gt;I'm having an issue with a makefile that I'm writing for a data processing pipeline. It's saying that there is no rule to make a target, but I don't understand why because I have such a rule. Here is the makefile:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;  1 ifdef $(BROAD)&#xA;  2     target=$(MARK)_peaks.broadPeak&#xA;  3 else&#xA;  4     target=$(MARK)_peaks.narrowPeak&#xA;  5 endif&#xA;  6 &#xA;  7 all: $(target)&#xA;  8 &#xA;  9 $(MARK)_peaks.broadPeak : $(MARK).filtered.bam $(INPUT).filtered.bam&#xA; 10     macs2 callpeak -g $(GSIZE) -q 0.05 -c $(INPUT).filtered.bam -t $(MARK).filtered.bam -f BAM -n $(MA    RK) -B --broad&#xA; 11 &#xA; 12 $(MARK)_peaks.narrowPeak : $(MARK).filtered.bam $(INPUT).filtered.bam&#xA; 13     macs2 callpeak -g $(GSIZE) -q 0.01 -c $(INPUT).filtered.bam -t $(MARK).filtered.bam -f BAM -n $(MA    RK) -B &#xA; 14 &#xA; 15 %.filtered.bam : %.duplicate-marked.bam&#xA; 16     samtools view -b -q 15 $&amp;lt; &amp;gt; $@&#xA; 17 &#xA; 18 %.duplicate-marked.bam : %.sorted.bam&#xA; 19     picard-tools MarkDuplicates INPUT=$&amp;lt; OUTPUT=$@ METRICS_FILE=output.dup_metrics REMOVE_DUPLICATES=f    alse ASSUME_SORTED=true VALIDATION_STRINGENCY=SILENT&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And the output with debugging on is:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$ make --debug=verbose --dry-run -f chipseq-pe.makefile MARK=H3K27me3 INPUT=input ASSEMBLY=/home/ckern/galGal4.dna_sm.fa GSIZE=1.057e9 BROAD=Y&#xA;GNU Make 3.81&#xA;Copyright (C) 2006  Free Software Foundation, Inc.&#xA;This is free software; see the source for copying conditions.&#xA;There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A&#xA;PARTICULAR PURPOSE.&#xA;&#xA;This program built for x86_64-pc-linux-gnu&#xA;Reading makefiles...&#xA;Reading makefile `chipseq-pe.makefile'...&#xA;Updating goal targets....&#xA;Considering target file `all'.&#xA; File `all' does not exist.&#xA;  Considering target file `H3K27me3_peaks.narrowPeak'.&#xA;   File `H3K27me3_peaks.narrowPeak' does not exist.&#xA;    Considering target file `H3K27me3.filtered.bam'.&#xA;     File `H3K27me3.filtered.bam' does not exist.&#xA;     Finished prerequisites of target file `H3K27me3.filtered.bam'.&#xA;    Must remake target `H3K27me3.filtered.bam'.&#xA;make: *** No rule to make target `H3K27me3.filtered.bam', needed by `H3K27me3_peaks.narrowPeak'.  Stop.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I have a pattern rule to make any *.filtered.bam file, so I don't understand why it's saying there is no rule to make that target.&lt;/p&gt;&#xA;" OwnerUserId="251276" LastActivityDate="2016-01-20T17:23:37.557" Title="&quot;No rule to make target&quot; but I think I have a pattern rule for it" Tags="&lt;makefile&gt;" AnswerCount="0" CommentCount="2" />
  <row Id="35193638" PostTypeId="1" CreationDate="2016-02-04T06:04:15.487" Score="0" ViewCount="81" Body="&lt;p&gt;I am working on web application Angularjs with gulp.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Using gulp I am created one environment variable like below&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;var env = process.env.NODE_ENV  || 'test';&#xA;&#xA;gulp.task('preprocess', function() {&#xA;    log('Preprocess..');&#xA;    log(env)&#xA;    // Minify and copy all JavaScript (except vendor scripts)&#xA;    return gulp.src(source.scripts)&#xA;        .pipe(preprocess({context:{target:env}}))&#xA;});&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And this is my gulp output&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;[11:23:02] Starting 'preprocess'...&#xA;[11:23:02] Preprocess..&#xA;[11:23:02] test&#xA;[11:23:02] Finished 'preprocess' after 370 ms&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But I can't access this environment variable inside my angular code. I don't know need to include any plugins are not? &lt;/p&gt;&#xA;&#xA;&lt;p&gt;This is my js code for access environment variable&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//@ifdef  env='test'&#xA;    alert('Environment variable test');&#xA;//@endif&#xA;&#xA;//@ifdef  env='local'&#xA;alert('Environment variable local');&#xA;//@endif    &#xA;&#xA;//@ifdef  env='dev'&#xA;alert('Environment variable dev');&#xA;//@endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;How can I access the environment variable created by gulp.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Please help me.&lt;/p&gt;&#xA;" OwnerUserId="1914757" LastEditorUserId="4370109" LastEditDate="2016-07-07T19:57:14.390" LastActivityDate="2016-07-07T19:57:14.390" Title="How to access preprocess in angularjs" Tags="&lt;javascript&gt;&lt;angularjs&gt;&lt;gulp-preprocess&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="35432678" PostTypeId="1" CreationDate="2016-02-16T12:30:16.387" Score="0" ViewCount="75" Body="&lt;p&gt;Is there any way to find out compiler flags in C++ while compiling?&#xA;For example, some dream code:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef -fPIC&#xA;...&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;OS: Debian&#xA;Compiler: gcc&lt;/p&gt;&#xA;" OwnerUserId="1088224" LastActivityDate="2016-02-16T12:30:16.387" Title="C++ check gcc compiler flags while compiling" Tags="&lt;linux&gt;&lt;gcc&gt;&lt;compiler-flags&gt;" AnswerCount="0" CommentCount="3" />
  <row Id="35481587" PostTypeId="1" CreationDate="2016-02-18T12:31:49.553" Score="1" ViewCount="135" Body="&lt;p&gt;I'm trying to communicate with a Yokogawa GS200 DC source connected to windows PC over GPIB using c++ and Qt.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I found a library from Yokogawa (&lt;a href=&quot;https://y-link.yokogawa.com/YL008.po?V_ope_type=Show&amp;amp;Download_id=DL00002096&amp;amp;Language_id=EN&quot; rel=&quot;nofollow&quot;&gt;https://y-link.yokogawa.com/YL008.po?V_ope_type=Show&amp;amp;Download_id=DL00002096&amp;amp;Language_id=EN&lt;/a&gt;) that should do the task; however, when I tried running a simple code it compiled without errors, but the there was no output or any sign that the functions were executed. I would just get &quot;press &amp;lt;ENTER&gt; to exit this window&quot;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I'm not sure what is wrong exactly, anyone has any ideas?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The code and header file are the following:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;main:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;tmctl.h&quot;&#xA;&#xA;&#xA; int main()&#xA;        {&#xA;&#xA;     char adr[100];&#xA;     int  ret;&#xA;     int  id;&#xA;     char buf[1000];&#xA;     int  length;&#xA;&#xA;&#xA;ret = TmcInitialize( TM_CTL_GPIB, &quot;11&quot;, &amp;amp;id );&#xA;&#xA;if( ret != 0 ) {&#xA;    return  TmcGetLastError( id );&#xA;}&#xA;&#xA;ret = TmcSetTerm( id, 3, 1 );&#xA;if( ret != 0 ) {&#xA;    return  TmcGetLastError( id );&#xA;}&#xA;&#xA;&#xA;ret = TmcSetTimeout( id, 300 );&#xA;if( ret != 0 ) {&#xA;    return  TmcGetLastError( id );&#xA;}&#xA;&#xA;&#xA;ret = TmcSetRen( id, 1 );&#xA;if( ret != 0 ) {&#xA;    return  TmcGetLastError( id );&#xA;}&#xA;&#xA;&#xA;/* sending *RST */&#xA;ret = TmcSend( id, &quot;*RST&quot; );&#xA;if( ret != 0 ) {&#xA;    return  TmcGetLastError( id );&#xA;}&#xA;&#xA;/* *sending IDN? &amp;amp; receiving query */&#xA;ret = TmcSend( id, &quot;*IDN?&quot; );&#xA;if( ret != 0 ) {&#xA;    return  TmcGetLastError( id );&#xA;}&#xA;&#xA;&#xA;&#xA;ret = TmcReceive( id, buf, 1000, &amp;amp;length );&#xA;if( ret != 0 ) {&#xA;    return  TmcGetLastError( id );&#xA;}&#xA;&#xA;&#xA;        }&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;header:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    /*STARTM------------------------------------------------------------------&#xA;+       Module Name     : tmctl.h                                        +&#xA;+       Abstract        : Yokogawa T&amp;amp;M Remote Control functions.         +&#xA;+       Revision History:                                                +&#xA;+       Rev.    Date.          Notes.                                    +&#xA;+       --------------------------------------------------------------   +&#xA;+       2.0     20070309    USBTMC2 VXI11 supported. thread safe support +&#xA;+       2.1     20080508    RS232C expand                                +&#xA;+       2.2     20080704    Add TmcGetInitializeError.                   +&#xA;+       2.3     20121121    coped 64 bits                                +&#xA;-ENDM-------------------------------------------------------------------*/&#xA;&#xA;#ifndef _TMCTL_H&#xA;#define _TMCTL_H    1&#xA;&#xA;#include &amp;lt;windows.h&amp;gt;&#xA;&#xA;/* Control setting */&#xA;#define TM_NO_CONTROL   0&#xA;#define TM_CTL_GPIB 1&#xA;#define TM_CTL_RS232    2&#xA;#define TM_CTL_USB  3&#xA;#define TM_CTL_ETHER    4&#xA;#define TM_CTL_USBTMC   5&#xA;#define TM_CTL_ETHERUDP 6&#xA;#define TM_CTL_USBTMC2  7               // 2007/01/19 add&#xA;#define TM_CTL_VXI11    8               // 2007/01/19 add&#xA;#define TM_CTL_USB2 9&#xA;&#xA;/* GPIB */&#xA;&#xA;/* RS232 */&#xA;#define TM_RS_1200      '0'&#xA;#define TM_RS_2400      '1'&#xA;#define TM_RS_4800      '2'&#xA;#define TM_RS_9600      '3'&#xA;#define TM_RS_19200     '4'&#xA;#define TM_RS_38400     '5'&#xA;#define TM_RS_57600     '6'&#xA;#define TM_RS_115200            '7'         // Ver2.1&#xA;&#xA;#define TM_RS_8N1       '0'&#xA;#define TM_RS_7E        '1'&#xA;#define TM_RS_7O        '2'&#xA;#define TM_RS_8O        '3'         // Ver2.1 8bit,odd,onestopbit&#xA;#define TM_RS_7N5       '4'         // Ver2.1 7bit,noparity,one5stopbit&#xA;#define TM_RS_8N2       '5'&#xA;&#xA;#define TM_RS_NO        '0'&#xA;#define TM_RS_XON       '1'&#xA;#define TM_RS_HARD      '2'&#xA;&#xA;/* USB */&#xA;#define TM_USB_CHECK_OK             0&#xA;#define TM_USB_CHECK_NOTOPEN                    1&#xA;#define TM_USB_CHECK_NODEVICE                   2&#xA;&#xA;#define TM_USB_READPIPE             0&#xA;#define TM_USB_WRITEPIPE            1&#xA;#define TM_USB_STATUSPIPE           2&#xA;&#xA;/* Error Number */&#xA;#define TMCTL_NO_ERROR              0x00000000      /* No error */&#xA;#define TMCTL_TIMEOUT               0x00000001      /* Timeout */&#xA;#define TMCTL_NO_DEVICE             0x00000002      /* Device Not Found */&#xA;#define TMCTL_FAIL_OPEN             0x00000004      /* Open Port Error */&#xA;#define TMCTL_NOT_OPEN              0x00000008      /* Device Not Open */&#xA;#define TMCTL_DEVICE_ALREADY_OPEN               0x00000010      /* Device Already Open */&#xA;#define TMCTL_NOT_CONTROL           0x00000020      /* Controller Not Found */&#xA;#define TMCTL_ILLEGAL_PARAMETER                 0x00000040      /* Parameter is illegal */&#xA;#define TMCTL_SEND_ERROR            0x00000100      /* Send Error */&#xA;#define TMCTL_RECV_ERROR            0x00000200      /* Receive Error */&#xA;#define TMCTL_NOT_BLOCK             0x00000400      /* Data is not Block Data */&#xA;#define TMCTL_SYSTEM_ERROR          0x00001000      /* System Error */&#xA;#define TMCTL_ILLEGAL_ID            0x00002000      /* Device ID is Illegal */&#xA;#define TMCTL_NOT_SUPPORTED         0x00004000      /* this feature not supportred */&#xA;#define TMCTL_INSUFFICIENT_BUFFER               0x00008000      /* unsufficient buffer size */&#xA;&#xA;/* L2 Error Number */&#xA;#define TMCTL2_NO_ERROR             (00000)         /* No error */&#xA;#define TMCTL2_TIMEOUT              (10001)         /* Timeout */&#xA;#define TMCTL2_NO_DEVICE            (10002)         /* Device Not Found */&#xA;#define TMCTL2_FAIL_OPEN            (10003)         /* Open Port Error */&#xA;#define TMCTL2_NOT_OPEN             (10004)         /* Device Not Open */&#xA;#define TMCTL2_DEVICE_ALREADY_OPEN              (10005)         /* Device Already Open */&#xA;#define TMCTL2_NOT_CONTROL          (10006)         /* Controller Not Found */&#xA;#define TMCTL2_ILLEGAL_PARAMETER                (10007)         /* Parameter is illegal */&#xA;#define TMCTL2_SEND_ERROR           (10008)         /* Send Error */&#xA;#define TMCTL2_RECV_ERROR           (10009)         /* Receive Error */&#xA;#define TMCTL2_NOT_BLOCK            (10010)         /* Data is not Block Data */&#xA;#define TMCTL2_SYSTEM_ERROR         (10011)         /* System Error */&#xA;#define TMCTL2_ILLEGAL_ID           (10012)         /* Device ID is Illegal */&#xA;#define TMCTL2_NOT_SUPPORTED                    (10013)         /* this feature not supportred */&#xA;#define TMCTL2_INSUFFICIENT_BUFFER              (10014)         /* unsufficient buffer size */&#xA;&#xA;#define ADRMAXLEN           (64)&#xA;&#xA;typedef struct _Devicelist&#xA;{&#xA;    char    adr[ADRMAXLEN] ;&#xA;} DEVICELIST ;&#xA;&#xA;typedef struct _DevicelistEx&#xA;{&#xA;    char        adr[ADRMAXLEN] ;&#xA;unsigned short  vendorID ;&#xA;unsigned short  productID ;&#xA;    char        dummy[188] ;&#xA;} DEVICELISTEX ;&#xA;&#xA;&#xA;&#xA;typedef void(__stdcall *Hndlr)(int, UCHAR, ULONG, ULONG) ;&#xA;&#xA;/* Functions */&#xA;#ifndef _TMCTL_DEFINES&#xA;#ifdef  __cplusplus&#xA;extern  &quot;C&quot; {&#xA;#endif&#xA;extern  int     __stdcall TmcInitialize( int wire, char* adr, int* id ) ;&#xA;extern  int     __stdcall TmcSetIFC( int id, int tm ) ;&#xA;extern  int     __stdcall TmcDeviceClear( int id ) ;&#xA;extern  int     __stdcall TmcDeviceTrigger( int id ) ;&#xA;extern  int     __stdcall TmcSend( int id, char* msg ) ;&#xA;extern  int     __stdcall TmcSendByLength( int id, char* msg, int len ) ;&#xA;extern  int     __stdcall TmcSendSetup( int id ) ;&#xA;extern  int     __stdcall TmcSendOnly( int id, char* msg, int len, int end ) ;&#xA;extern  int     __stdcall TmcReceive( int id, char* buff, int blen, int* rlen ) ;&#xA;extern  int     __stdcall TmcReceiveSetup( int id ) ;&#xA;extern  int     __stdcall TmcReceiveOnly( int id, char* buff, int blen, int* rlen ) ;&#xA;extern  int     __stdcall TmcReceiveBlockHeader( int id, int* len ) ;&#xA;extern  int     __stdcall TmcReceiveBlockData( int id, char* buff, int blen, int* rlen, int* end ) ;&#xA;extern  int     __stdcall TmcCheckEnd( int id ) ;&#xA;extern  int     __stdcall TmcSetCmd( int id, char* cmd ) ;&#xA;extern  int     __stdcall TmcSetRen( int id, int flag ) ;&#xA;extern  int     __stdcall TmcGetLastError( int id ) ;&#xA;extern  int     __stdcall TmcGetDetailLastError( int id ) ;&#xA;extern  int     __stdcall TmcCheckError( int id, int sts, char* msg, char* err ) ;&#xA;extern  int     __stdcall TmcSetTerm( int id, int eos, int eot ) ;&#xA;extern  int     __stdcall TmcSetEos( int id, unsigned char eos ) ;&#xA;extern  int     __stdcall TmcSetTimeout( int id, int tmo ) ;&#xA;extern  int     __stdcall TmcSetDma( int id, int flg ) ;&#xA;extern  int     __stdcall TmcGetStatusByte( int id, unsigned char* sts ) ;&#xA;extern  int     __stdcall TmcFinish( int id ) ;&#xA;extern  int     __stdcall TmcSearchDevices(int wire, DEVICELIST* list, int max, int* num,char* option) ;&#xA;extern  int     __stdcall TmcSearchDevicesEx(int wire, DEVICELISTEX* list, int max, int* num,char* option) ;&#xA;extern  int     __stdcall TmcWaitSRQ(int id, char* stsbyte, int tout) ;&#xA;extern  int     __stdcall TmcAbortWaitSRQ(int id) ;&#xA;extern  int     __stdcall TmcSetCallback(int id,Hndlr func, ULONG p1, ULONG p2) ;&#xA;extern  int     __stdcall TmcResetCallback(int id) ;&#xA;extern  int     __stdcall TmcSendTestData(int id, char* msg, int len ) ;&#xA;extern  int     __stdcall TmcReceiveTestData( int id, char* buff, int blen, int* rlen ) ;&#xA;extern  int     __stdcall TmcInitiateAbortBulkIn(int id, UCHAR tagNo) ;&#xA;extern  int     __stdcall TmcInitiateAbortBulkOut(int id, UCHAR tagNo) ;&#xA;extern  int     __stdcall TmcCheckAbortBulkInStatus(int id) ;&#xA;extern  int     __stdcall TmcCheckAbortBulkOutStatus(int id) ;&#xA;extern  int     __stdcall TmcEncodeSerialNumber(char* encode,size_t len,char* src) ;&#xA;extern  int     __stdcall TmcDecodeSerialNumber(char* decode,size_t len,char* src) ;&#xA;extern  int     __stdcall TmcGotoLocal( int id ) ;&#xA;extern  int     __stdcall TmcLocalLockout(int id) ;&#xA;extern  int     __stdcall TmcAbortPipe(int id,long pipeNo) ;&#xA;extern  int     __stdcall TmcResetPipe(int id,long pipeNo) ;&#xA;extern  int     __stdcall TmcWriteHeader(int id, int blen) ;&#xA;extern  int     __stdcall TmcReceiveWithoutWriteHeader(int id, char* buff, int blen, int* rlen, int* end ) ;&#xA;extern  int     __stdcall TmcGetTagNo(int id, UCHAR* tag) ;&#xA;extern  int     __stdcall TmcSendByLength2( int id, char* msg, int msgSize, int len, CHAR eof) ;&#xA;extern  int     __stdcall TmcDeviceChangeNotify(HWND hWnd, BOOL bStart) ;&#xA;extern  int     __stdcall TmcCheckUSB(int id) ;&#xA;extern  int     __stdcall TmcGetPipeNo(int id,int type,int* pipeNo) ;&#xA;extern  int     __stdcall TmcCheckGUID(void *lParam) ;&#xA;extern  ULONG   __stdcall TmcGetInitializeError() ;&#xA;&#xA;// L2&#xA;extern  int __stdcall xTmcSearchDevices(int wire, DEVICELIST* adrlist, int max, int *num,char* option) ;&#xA;extern  int __stdcall xTmcSearchDevicesEx(int wire, DEVICELISTEX* adrlist, int max, int *num,char* option) ;&#xA;extern  int __stdcall xTmcInitialize( int wire, char* adr, int* id ) ;&#xA;extern  int __stdcall xTmcInitializeEx( int wire, char* adr, int* id, int timeout ) ;&#xA;extern  int __stdcall xTmcFinish( int id ) ;&#xA;extern  int __stdcall xTmcSend( int id, char* msg ) ;&#xA;extern  int __stdcall xTmcSendByLength( int id, char* msg, int len ) ;&#xA;extern  int __stdcall xTmcSendSetup( int id ) ;&#xA;extern  int __stdcall xTmcSendOnly( int id, char* msg, int len, int end ) ;&#xA;extern  int __stdcall xTmcReceive( int id, char* buff, int blen, int* rlen ) ;&#xA;extern  int __stdcall xTmcReceiveSetup( int id ) ;&#xA;extern  int __stdcall xTmcReceiveOnly( int id, char* buff, int blen, int* rlen ) ;&#xA;extern  int __stdcall xTmcReceiveBlockHeader( int id, int* length ) ;&#xA;extern  int __stdcall xTmcReceiveBlockData( int id, char* buff, int blen, int* rlen, int* end ) ;&#xA;extern  int __stdcall xTmcCheckEnd( int id ) ;&#xA;extern  int __stdcall xTmcDeviceClear( int id ) ;&#xA;extern  int __stdcall xTmcSetRen( int id, int flag ) ;&#xA;extern  int __stdcall xTmcGetLastError( int id ) ;&#xA;extern  int __stdcall xTmcSetTerm( int id, int eos, int eot ) ;&#xA;extern  int __stdcall xTmcSetTimeout( int id, int tmo ) ;&#xA;extern  int __stdcall xTmcCreateSRQHandler( int id, UINT msgId, HWND hWnd) ;&#xA;extern  int __stdcall xTmcDleateSRQHandler( int id ) ;&#xA;extern  int __stdcall xTmcSetCallback(int id,Hndlr func, ULONG p1, ULONG p2) ;&#xA;extern  int __stdcall xTmcResetCallback(int id) ;&#xA;extern  int __stdcall xTmcSet( int id, char *msg) ;&#xA;extern  int __stdcall xTmcSetBinary( int id, char* msg, char *buf, int size ) ;&#xA;extern  int __stdcall xTmcGet( int id, char *msg, char* buf, int blen, int* rlen ) ;&#xA;extern  int __stdcall xTmcGetBinary( int id, char *msg, char* buf, int blen, int* rlen ) ;&#xA;extern  int __stdcall xTmcGetErrorQueue(int id) ;&#xA;extern  int __stdcall xTmcSetNE( int id, char *msg) ;&#xA;extern  int __stdcall xTmcSetBinaryNE( int id, char* msg, char *buf, int size ) ;&#xA;extern  int __stdcall xTmcGetNE( int id, char *msg, char* buf, int blen, int* rlen ) ;&#xA;extern  int __stdcall xTmcGetBinaryNE( int id, char *msg, char* buf, int blen, int* rlen ) ;&#xA;extern  int __stdcall xTmcSetNES( int id, char *msg) ;&#xA;extern  int __stdcall xTmcSetBinaryNES( int id, char* msg, char *buf, int size ) ;&#xA;extern  int __stdcall xTmcLock( int id ) ;&#xA;extern  int __stdcall xTmcUnlock( int id ) ;&#xA;&#xA;#ifdef  __cplusplus&#xA;}&#xA;#endif&#xA;#endif&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;a discription of the functions and variables in addition to the .dll file can be found in the library folder &lt;a href=&quot;https://y-link.yokogawa.com/YL008.po?V_ope_type=Show&amp;amp;Download_id=DL00002096&amp;amp;Language_id=EN&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt;. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;of course I used &lt;code&gt;LIBS += &quot;...\tmctl.dll&quot;&lt;/code&gt; to link the library to my project too.&lt;/p&gt;&#xA;" OwnerUserId="5945704" LastEditorUserId="1016716" LastEditDate="2016-02-26T08:40:02.140" LastActivityDate="2016-02-26T08:40:02.140" Title="programing power source over GPIB with Qt" Tags="&lt;c++&gt;&lt;qt&gt;&lt;gpib&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="35609911" PostTypeId="1" CreationDate="2016-02-24T18:15:54.487" Score="-1" ViewCount="197" Body="&lt;p&gt;I am trying to write a simple openCV app for iOS, but I am having trouble with using openCV functions in XCode. They will throw a EXC_BAD_ACCESS(code = 1), or not work entirely. I am using the processImage sample from the tutorial and that doesn't even work. I am using XCode 7.3 beta and believe I have installed openCV 2.4.11 correctly.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;ViewController.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#import &amp;lt;UIKit/UIKit.h&amp;gt;&#xA;#import &amp;lt;opencv2/highgui/cap_ios.h&amp;gt;&#xA;&#xA;&#xA;using namespace cv;&#xA;&#xA;@interface ViewController : UIViewController &amp;lt;CvVideoCameraDelegate&amp;gt;&#xA;{&#xA;    //IBOutlet UIImageView *imageView;&#xA;    CvVideoCamera *camera;&#xA;}&#xA;&#xA;@property (nonatomic, retain) CvVideoCamera* camera;&#xA;&#xA;@end&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;ViewController.mm&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#import &quot;ViewController.h&quot;&#xA;#import &amp;lt;opencv2/highgui/cap_ios.h&amp;gt;&#xA;&#xA;&#xA;@interface ViewController ()&#xA;@property (weak, nonatomic) IBOutlet UIImageView *imageView&#xA;@end&#xA;&#xA;@implementation ViewController&#xA;&#xA;@synthesize camera;&#xA;&#xA;- (void)viewDidLoad {&#xA;    [super viewDidLoad];&#xA;&#xA;    self.camera = [[CvVideoCamera alloc] initWithParentView: self.imageView];&#xA;    self.camera.defaultAVCaptureDevicePosition = AVCaptureDevicePositionBack;&#xA;&#xA;    self.camera.defaultAVCaptureSessionPreset = AVCaptureSessionPresetHigh;&#xA;    self.camera.defaultAVCaptureVideoOrientation = AVCaptureVideoOrientationPortrait;&#xA;    self.camera.defaultFPS = 60;&#xA;    self.camera.grayscaleMode = NO;&#xA;    self.camera.delegate = self;&#xA;    self.camera.useAVCaptureVideoPreviewLayer = YES;&#xA;&#xA;    self.imageView.frame = self.view.bounds;&#xA;&#xA;    [self.camera start];&#xA;}&#xA;&#xA;&#xA;#pragma mark - Protocol CvVideoCameraDelegate&#xA;#ifdef  __cplusplus&#xA;&#xA;&#xA;- (void)processImage:(cv::Mat&amp;amp;)image;&#xA;{&#xA;    // Do some OpenCV stuff with the image&#xA;    Mat image_copy;&#xA;    cvtColor(image, image_copy, CV_BGRA2BGR);&#xA;&#xA;    // invert image&#xA;    bitwise_not(image_copy, image_copy); // ERROR IS THROWN HERE, BUT IT &#xA;                                         // WILL ALSO THROW ON THE CVTCOLOR&#xA;                                         // IF I REMOVE THIS LINE&#xA;    cvtColor(image_copy, image, CV_BGR2BGRA);&#xA;}&#xA;&#xA;#endif&#xA;&#xA;&#xA;-(void)didReceiveMemoryWarning {&#xA;    [super didReceiveMemoryWarning];&#xA;}&#xA;&#xA;@end&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="5251043" LastEditorUserId="1486275" LastEditDate="2016-02-24T19:23:47.450" LastActivityDate="2016-02-24T21:36:08.970" Title="Open CV Tutorial on IOS not working, EXC_BAD_ACCESS" Tags="&lt;ios&gt;&lt;objective-c&gt;&lt;xcode&gt;&lt;opencv&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="1" />
  <row Id="35677969" PostTypeId="1" AcceptedAnswerId="35678165" CreationDate="2016-02-28T02:21:38.973" Score="1" ViewCount="49" Body="&lt;p&gt;I have many data tables which enable tight functions.  If I want more than one of the data table items to be conditionally compiled, however, it makes the table itself a mess.  Here is an example:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//#define USE_UNITS&#xA;//#define USE_RAW&#xA;&#xA;typedef struct&#xA;{&#xA;  uint8_t alarm_num;&#xA;  uint8_t dec;&#xA;  boolean sign;&#xA;  PGM_P label;&#xA;  PGM_P label_suffix;&#xA;#ifdef  USE_UNITS&#xA;  PGM_P units;&#xA;#endif&#xA;#ifdef  USE_RAW&#xA;  boolean raw;&#xA;#endif&#xA;  boolean newline;&#xA;} TEST_TABLE_TYPE;&#xA;&#xA;const TEST_TABLE_TYPE PROGMEM test_table[NUM_ALARMS] =&#xA;{&#xA;  {ALARM_VIN_UV_LVL, MEAS_VIN_VCAP_VOUT_DEC, false, label_vin_string, label_uv_string,&#xA;#ifdef  USE_UNITS&#xA;  units_volts_string,&#xA;#endif&#xA;#ifdef  USE_RAW&#xA;  false,&#xA;#endif&#xA;    false},&#xA;  {ALARM_VIN_OV_LVL, MEAS_VIN_VCAP_VOUT_DEC, false, label_vin_string, label_ov_string,&#xA;#ifdef  USE_UNITS&#xA;      units_volts_string,&#xA;#endif&#xA;#ifdef  USE_RAW&#xA;      false,&#xA;#endif&#xA;      false},&#xA;  {ALARM_IIN_OC_LVL, MEAS_IIN_ICHG_DEC, true, label_iin_string, label_oc_string,&#xA;#ifdef  USE_UNITS&#xA;    units_amps_string,&#xA;#endif&#xA;#ifdef  USE_RAW&#xA;    false,&#xA;#endif&#xA;    true},&#xA;  {ALARM_VOUT_UV_LVL, MEAS_VIN_VCAP_VOUT_DEC, false, label_vout_string, label_uv_string,&#xA;#ifdef  USE_UNITS&#xA;      units_volts_string,&#xA;#endif&#xA;#ifdef  USE_RAW&#xA;      false,&#xA;#endif&#xA;      false}&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;That is only 3 items too!  I might be better off just including 4 copies of the table selected by each possible combination of USE_UNITS and USE_RAW.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there a best way to have the data tables conditionally compile?&lt;/p&gt;&#xA;" OwnerUserId="3754356" LastEditorUserId="4370109" LastEditDate="2016-02-28T10:14:20.600" LastActivityDate="2016-02-28T11:45:53.880" Title="Best way to conditionally include data table columns in C" Tags="&lt;c&gt;&lt;c-preprocessor&gt;" AnswerCount="2" CommentCount="2" />
  <row Id="35713037" PostTypeId="1" CreationDate="2016-03-01T01:24:45.507" Score="0" ViewCount="66" Body="&lt;p&gt;&lt;code&gt;enter code here&lt;/code&gt;  I was trying to export a class from a C++ dll. I defined DLL_TEST_EXPORTS as a macro and set the public and private functions and variables. My question is whether all the public variables and functions will be exported or I have to do something else to export them?  &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;dll_test.h&#xA;&#xA;#ifdef  DLL_TEST_EXPORTS &#xA;/*Enabled as &quot;export&quot; while compiling the dll project*/&#xA;#define DLLEXPORT __declspec(dllexport)  &#xA;#else&#xA;/*Enabled as &quot;import&quot; in the Client side for using already created dll file*/&#xA;#define DLLEXPORT __declspec(dllimport)  &#xA;#endif&#xA;&#xA;class DLLEXPORT getWettedNodeForces{ &#xA;&#xA;private:&#xA;long int i, j, z, temp, k;&#xA;double Pmax, W, c, theta, R, c0, rho, P0, R2, tx, ty, tz, Angle, Vel, Vel1,   Vel2, Vel3, PT, PT1, Area, FT, T1, T2, T3, T4, T5, T6, tPmax, tV, test, yLow, yHigh, h;&#xA;double V1[3], V2[3], V3[3], V4[3], N[4], R3[3];&#xA;&#xA;&#xA;public:  &#xA;void getforce();    &#xA;int nodalForce.id; &#xA;double nodalForce.x, nodalForce.y, nodalForce.z, wettedNodeForces;&#xA;&#xA;};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="5862538" LastEditorUserId="5862538" LastEditDate="2016-03-01T01:43:13.577" LastActivityDate="2016-03-01T01:43:13.577" Title="Export function from C++ DLL" Tags="&lt;c++&gt;&lt;dll&gt;&lt;dllexport&gt;" AnswerCount="0" CommentCount="3" />
  <row Id="35872256" PostTypeId="1" CreationDate="2016-03-08T16:07:48.483" Score="0" ViewCount="97" Body="&lt;p&gt;I want to use flags to compile my C project:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;in configure.ac I Define the default model&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;AC_ARG_ENABLE(model, [AS_HELP_STRING([--enable-model],&#xA;    [specify which Model will be used; (default --enable-model=98]))],,&#xA;    [AC_DEFINE(MODEL_98)])&#xA;&#xA;AS_IF([test &quot;x$enable_model&quot; = &quot;x98&quot;], [AC_DEFINE(MODEL_98)])&#xA;AS_IF([test &quot;x$enable_model&quot; = &quot;x181&quot;], [AC_DEFINE(MODEL_181)])&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and then in Makefile.am i use these variable as following : &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;proj_SOURCES =          \&#xA;    ../bac.c        \&#xA;    ../conf.c               \&#xA;    ../cw.c             \&#xA;&#xA;ifdef $(MODEL_98)&#xA;proj_SOURCES +=                                 \&#xA;    ../dm/98/interfaces.c               \&#xA;    ../dm/98/device.c                   \&#xA;    ../dm/98/ging.c         \&#xA;    ../dm/98/wa.c                   &#xA;&#xA;endif&#xA;ifdef $(MODEL_181)&#xA;proj_SOURCES +=                                 \&#xA;    ../dm/181/fi.c&#xA;endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but the project doesn't compile !!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;what wrong in my Makefile.am &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks&lt;/p&gt;&#xA;" OwnerUserId="1410376" LastEditorUserId="1410376" LastEditDate="2016-03-08T16:33:04.430" LastActivityDate="2016-03-08T19:06:24.603" Title="ifdef in Makefile.am" Tags="&lt;c++&gt;&lt;c&gt;&lt;makefile&gt;&lt;autotools&gt;" AnswerCount="1" CommentCount="1" FavoriteCount="0" />
  <row Id="35875835" PostTypeId="1" CreationDate="2016-03-08T19:04:27.217" Score="0" ViewCount="36" Body="&lt;p&gt;Is there a helper method, or similar, in Javascript for &lt;code&gt;isDefined&lt;/code&gt;?  I just found this in a utility file I inherited:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;'use strict';&#xA;&#xA;var me = {&#xA;    ifDefined           : ifDefined,&#xA;    ifDef               : ifDefined,&#xA;    isDefined           : isDefined,&#xA;    isDef               : isDefined,&#xA;};&#xA;&#xA;function isDefined (value) {&#xA;    return (typeof value != 'undefined');&#xA;}&#xA;function ifDefined (value, defaultValue) {&#xA;    return isDefined(value) ? defaultValue : value;&#xA;}&#xA;&#xA;module.exports = me;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It appears the author is using it to have a shorthand method for the &lt;code&gt;typeof&lt;/code&gt; check:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;environment.u = isDef(envInfo.u, environment.u);&#xA;environment.x = isDef(envInfo.x, environment.x);&#xA;environment.s = isDef(envInfo.s, environment.s);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="4241633" LastEditorUserId="4241633" LastEditDate="2016-03-08T19:18:38.793" LastActivityDate="2016-03-08T19:35:48.963" Title="Javascript ifDefined helper method?" Tags="&lt;javascript&gt;" AnswerCount="3" CommentCount="3" FavoriteCount="0" />
  <row Id="35990734" PostTypeId="1" AcceptedAnswerId="36004746" CreationDate="2016-03-14T14:49:29.990" Score="1" ViewCount="23" Body="&lt;p&gt;Is there any way to check for user defined configurations (that is NOT the standard DEBUG or RELEASEones) within C++ code itself, such as a defined variable that matches the configuration name? VS 2010...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I direly need this for an old project where no kind of unit testing is available at all, and where I want to add a few lines (functions, includes, ...) whenever a specific &quot;Debug_Test&quot; configuration is chosen to at least offer very basic unit testing opportunities.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I already read this&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/30913006/ifdef-configuration-in-visual-studio&quot;&gt;#ifdef $(CONFIGURATION) in Visual Studio&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;but I also need to add a few functions for the specific configuration, not just include files for the chosen build.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks for help!&lt;/p&gt;&#xA;" OwnerUserId="868972" LastEditorUserId="868972" LastEditDate="2016-03-14T14:59:40.380" LastActivityDate="2016-03-15T07:13:48.903" Title="Check for specific configuration in C++ peojects for Visual Studio 2010" Tags="&lt;c++&gt;&lt;visual-studio-2010&gt;&lt;configuration&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="36137376" PostTypeId="1" CreationDate="2016-03-21T17:04:13.003" Score="1" ViewCount="304" Body="&lt;p&gt;I found that using&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef ...&#xA;#elseif defined(...)&#xA;#else&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;always uses either the #ifdef or the #else, never the #elseif, but substituting #elif causes it to work as expected based on what's defijned.  What convoluted purpose, if any, is served by the existence of #elseif, and if none, why doesn't the preprocessor complain?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Maybe this is why for years (decades, really), I've been using ugly #else/#endif blocks, since at least they're reliable!&lt;/p&gt;&#xA;" OwnerUserId="1879439" LastActivityDate="2016-03-21T17:10:30.233" Title="#elseif vs #elif (C/C++ preprocessor)" Tags="&lt;c++&gt;&lt;conditional-compilation&gt;" AnswerCount="1" CommentCount="1" FavoriteCount="1" />
  <row Id="36437438" PostTypeId="1" CreationDate="2016-04-05T21:31:16.240" Score="0" ViewCount="69" Body="&lt;p&gt;I have tested a few makes and having issues of environment variables in the shell is not inside the Make file. I wonder what is wrong in my setup.  I tested on my mac os, redhat, and Ubuntu.  They all have the same behavior.  I wonder anyone can help with this.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;GNU Make 4.1&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Here is my simplest make file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ifdef $(HOME)&#xA; $(info $$HOME is $(HOME))&#xA;else&#xA; $(info $$HOME is undefined)&#xA;endif&#xA;&#xA;all :&#xA;    echo do nothing&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;When typing make at the terminal I get&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$HOME is undefined&#xA;echo do nothing&#xA;do nothing&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;echo $HOME&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/Users/myusername&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Here is the definition from make's manual book &lt;a href=&quot;https://www.gnu.org/software/make/manual/html_node/Environment.html&quot; rel=&quot;nofollow&quot;&gt;https://www.gnu.org/software/make/manual/html_node/Environment.html&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Variables in make can come from the environment in which make is run. Every environment variable that make sees when it starts up is transformed into a make variable with the same name and value. But an explicit assignment in the makefile, or with a command argument, overrides the environment.&lt;/p&gt;&#xA;" OwnerUserId="2407363" LastEditorUserId="2407363" LastEditDate="2016-04-05T22:09:13.937" LastActivityDate="2016-04-05T22:09:13.937" Title="Why make cannot pick up environment variables" Tags="&lt;c++&gt;&lt;linux&gt;&lt;shell&gt;&lt;makefile&gt;" AnswerCount="1" CommentCount="4" />
  <row Id="36685875" PostTypeId="1" CreationDate="2016-04-18T05:12:26.023" Score="0" ViewCount="19" Body="&lt;p&gt;I download code pthread_barrier.h and pthread_barrier.c from internet, and trying to compile and run it on Ubuntu. It can perfectly compile and run through terminal. But when i trying to build and run on eclipse, it keep report the error &quot;conflicting types for ‘pthread_barrierattr_t’&quot;. Can anyone help me to solve this problem?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; /*&#xA;* pthread_barrier.h&#xA;*&#xA;*  Created on: Nov 10, 2015&#xA;*      Author: kunxia&#xA;*/&#xA;&#xA;#ifndef PTHREAD_BARRIER_H&#xA;#define PTHREAD_BARRIER_H&#xA;&#xA;#include &amp;lt;pthread.h&amp;gt;&#xA;&#xA;#ifdef __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA; #if !defined(PTHREAD_BARRIER_SERIAL_THREAD)&#xA;# define PTHREAD_BARRIER_SERIAL_THREAD  (1)&#xA;#endif&#xA;&#xA;#if !defined(PTHREAD_PROCESS_PRIVATE)&#xA;# define PTHREAD_PROCESS_PRIVATE    (42)&#xA;#endif&#xA;#if !defined(PTHREAD_PROCESS_SHARED)&#xA;# define PTHREAD_PROCESS_SHARED     (43)&#xA;#endif&#xA;&#xA;typedef struct {&#xA;} pthread_barrierattr_t;&#xA;&#xA; typedef struct {&#xA;pthread_mutex_t mutex;&#xA;pthread_cond_t cond;&#xA;unsigned int limit;&#xA;unsigned int count;&#xA;unsigned int phase;&#xA;} pthread_barrier_t;&#xA;&#xA;int pthread_barrierattr_init(pthread_barrierattr_t *attr);&#xA; int pthread_barrierattr_destroy(pthread_barrierattr_t *attr);&#xA;&#xA;int pthread_barrierattr_getpshared(const pthread_barrierattr_t *restrict attr,&#xA;               int *restrict pshared);&#xA;int pthread_barrierattr_setpshared(pthread_barrierattr_t *attr,&#xA;               int pshared);&#xA;&#xA;int pthread_barrier_init(pthread_barrier_t *restrict barrier,&#xA;         const pthread_barrierattr_t *restrict attr,&#xA;         unsigned int count);&#xA; int pthread_barrier_destroy(pthread_barrier_t *barrier);&#xA;&#xA; int pthread_barrier_wait(pthread_barrier_t *barrier);&#xA;&#xA; #ifdef  __cplusplus&#xA;}&#xA; #endif&#xA;&#xA;#endif /* PTHREAD_BARRIER_H */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;pthread.c below&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; #define __unused __attribute__((unused))&#xA;&#xA; int&#xA; pthread_barrierattr_init(pthread_barrierattr_t *attr __unused)&#xA;{&#xA;  return 0;&#xA;}&#xA;&#xA;int&#xA;pthread_barrierattr_destroy(pthread_barrierattr_t *attr __unused)&#xA;{&#xA;return 0;&#xA;}&#xA;&#xA;int&#xA;pthread_barrierattr_getpshared(const pthread_barrierattr_t *restrict attr __unused,&#xA;               int *restrict pshared)&#xA;{&#xA; *pshared = PTHREAD_PROCESS_PRIVATE;&#xA;  return 0;&#xA; }&#xA;&#xA; int&#xA; pthread_barrierattr_setpshared(pthread_barrierattr_t *attr __unused,&#xA;               int pshared) &#xA; {&#xA; if (pshared != PTHREAD_PROCESS_PRIVATE) {&#xA;    errno = EINVAL;&#xA;    return -1;&#xA; }&#xA; return 0;&#xA; }&#xA;&#xA; int&#xA; pthread_barrier_init(pthread_barrier_t *restrict barrier,&#xA;         const pthread_barrierattr_t *restrict attr __unused,&#xA;         unsigned count)&#xA;{&#xA;if (count == 0) {&#xA;    errno = EINVAL;&#xA;    return -1;&#xA;}&#xA;&#xA;if (pthread_mutex_init(&amp;amp;barrier-&amp;gt;mutex, 0) &amp;lt; 0) {&#xA;    return -1;&#xA;}&#xA;if (pthread_cond_init(&amp;amp;barrier-&amp;gt;cond, 0) &amp;lt; 0) {&#xA;    int errno_save = errno;&#xA;    pthread_mutex_destroy(&amp;amp;barrier-&amp;gt;mutex);&#xA;    errno = errno_save;&#xA;    return -1;&#xA;}&#xA;&#xA;barrier-&amp;gt;limit = count;&#xA;barrier-&amp;gt;count = 0;&#xA;barrier-&amp;gt;phase = 0;&#xA;&#xA;  return 0;&#xA; }&#xA;&#xA; int&#xA; pthread_barrier_destroy(pthread_barrier_t *barrier)&#xA; {&#xA;  pthread_mutex_destroy(&amp;amp;barrier-&amp;gt;mutex);&#xA;  pthread_cond_destroy(&amp;amp;barrier-&amp;gt;cond);&#xA;  return 0;&#xA; }&#xA;&#xA; int&#xA; pthread_barrier_wait(pthread_barrier_t *barrier)&#xA; {&#xA; pthread_mutex_lock(&amp;amp;barrier-&amp;gt;mutex);&#xA; barrier-&amp;gt;count++;&#xA; if (barrier-&amp;gt;count &amp;gt;= barrier-&amp;gt;limit) {&#xA;    barrier-&amp;gt;phase++;&#xA;    barrier-&amp;gt;count = 0;&#xA;    pthread_cond_broadcast(&amp;amp;barrier-&amp;gt;cond);&#xA;    pthread_mutex_unlock(&amp;amp;barrier-&amp;gt;mutex);&#xA;    return PTHREAD_BARRIER_SERIAL_THREAD;&#xA; } else {&#xA;    unsigned phase = barrier-&amp;gt;phase;&#xA;    do&#xA;        pthread_cond_wait(&amp;amp;barrier-&amp;gt;cond, &amp;amp;barrier-&amp;gt;mutex);&#xA;    while (phase == barrier-&amp;gt;phase);&#xA;    pthread_mutex_unlock(&amp;amp;barrier-&amp;gt;mutex);&#xA;    return 0;&#xA; }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="6217993" LastActivityDate="2016-04-18T05:12:26.023" Title="conflicting types for ‘pthread_barrier_t’" Tags="&lt;c#&gt;&lt;pthread-barriers&gt;" AnswerCount="0" CommentCount="1" />
  <row Id="36752850" PostTypeId="1" AcceptedAnswerId="36752959" CreationDate="2016-04-20T19:00:54.577" Score="1" ViewCount="159" Body="&lt;p&gt;Trying to parse a malformed XML content with xml.etree.ElementTree.parse() raises different exception in Python 2.6.6 and Python 2.7.5&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Python 2.6: xml.parsers.expat.ExpatError&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Python 2.7: xml.etree.ElementTree.ParseError&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I'm writing code which must run in Python 2.6 and 2.7. afaik there is no way to define code which runs only in a Python version in Python (analogous to what we could do with #ifdef  in C/C++). The only way I see to handle both exceptions is to catch a common parent exception of both (eg Exception). However, that is not ideal because other exceptions will be handled in the same catch block. Is there any other way?&lt;/p&gt;&#xA;" OwnerUserId="1550682" LastActivityDate="2016-04-20T19:28:20.740" Title="How to handle different exceptions raised in different Python version" Tags="&lt;python&gt;&lt;xml&gt;&lt;exception-handling&gt;" AnswerCount="2" CommentCount="5" />
  <row Id="36933519" PostTypeId="1" AcceptedAnswerId="36933613" CreationDate="2016-04-29T08:37:53.543" Score="1" ViewCount="33" Body="&lt;p&gt;I was doing image processing using opencv.. but then this error comes out when i debug the main program. I dont what need to be modify from this header file since im not quite familiar when it comes to error in the header file.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/*&#xA; *      POSIX Standard: 6.5 File Control Operations     &amp;lt;fcntl.h&amp;gt;&#xA; */&#xA;&#xA;#ifndef _FCNTL_H&#xA;#define _FCNTL_H        1&#xA;&#xA;#include &amp;lt;features.h&amp;gt;&#xA;&#xA;/* This must be early so &amp;lt;bits/fcntl.h&amp;gt; can define types winningly.  */&#xA;__BEGIN_DECLS&#xA;&#xA;/* Get the definitions of O_*, F_*, FD_*: all the&#xA;   numbers and flag bits for `open', `fcntl', et al.  */&#xA;#include &amp;lt;bits/fcntl.h&amp;gt;&#xA;&#xA;/* For XPG all symbols from &amp;lt;sys/stat.h&amp;gt; should also be available.  */&#xA;#ifdef __USE_XOPEN&#xA;# include &amp;lt;sys/stat.h&amp;gt;&#xA;#endif&#xA;&#xA;#ifdef  __USE_MISC&#xA;# ifndef R_OK                   /* Verbatim from &amp;lt;unistd.h&amp;gt;.  Ugh.  */&#xA;/* Values for the second argument to access.&#xA;   These may be OR'd together.  */&#xA;#  define R_OK  4               /* Test for read permission.  */&#xA;#  define W_OK  2               /* Test for write permission.  */&#xA;#  define X_OK  1               /* Test for execute permission.  */&#xA;#  define F_OK  0               /* Test for existence.  */&#xA;# endif&#xA;#endif /* Use misc.  */&#xA;&#xA;/* XPG wants the following symbols.  */&#xA;#ifdef __USE_XOPEN              /* &amp;lt;stdio.h&amp;gt; has the same definitions.  */&#xA;# define SEEK_SET       0       /* Seek from beginning of file.  */&#xA;# define SEEK_CUR       1       /* Seek from current position.  */&#xA;# define SEEK_END       2       /* Seek from end of file.  */&#xA;#endif  /* XPG */&#xA;&#xA;/* Do the file control operation described by CMD on FD.&#xA;   The remaining arguments are interpreted depending on CMD.&#xA;&#xA;   This function is a cancellation point and therefore not marked with&#xA;   __THROW.  */&#xA;extern int fcntl (int __fd, int __cmd, ...);&#xA;&#xA;/* Open FILE and return a new file descriptor for it, or -1 on error.&#xA;   OFLAG determines the type of access used.  If O_CREAT is on OFLAG,&#xA;   the third argument is taken as a `mode_t', the mode of the created file.&#xA;&#xA;   This function is a cancellation point and therefore not marked with&#xA;   __THROW.  */&#xA;#ifndef __USE_FILE_OFFSET64&#xA;extern int open (__const char *__file, int __oflag, ...) __nonnull ((1));&#xA;#else&#xA;# ifdef __REDIRECT&#xA;extern int __REDIRECT (open, (__const char *__file, int __oflag, ...), open64)&#xA;     __nonnull ((1));&#xA;# else&#xA;#  define open open64&#xA;# endif&#xA;#endif&#xA;#ifdef __USE_LARGEFILE64&#xA;extern int open64 (__const char *__file, int __oflag, ...) __nonnull ((1));&#xA;#endif&#xA;&#xA;#ifdef __USE_ATFILE&#xA;/* Similar to `open' but a relative path name is interpreted relative to&#xA;   the directory for which FD is a descriptor.&#xA;&#xA;   NOTE: some other `openat' implementation support additional functionality&#xA;   through this interface, especially using the O_XATTR flag.  This is not&#xA;   yet supported here.&#xA;&#xA;   This function is a cancellation point and therefore not marked with&#xA;   __THROW.  */&#xA;# ifndef __USE_FILE_OFFSET64&#xA;extern int openat (int __fd, __const char *__file, int __oflag, ...)&#xA;     __nonnull ((2));&#xA;# else&#xA;#  ifdef __REDIRECT&#xA;extern int __REDIRECT (openat, (int __fd, __const char *__file, int __oflag,&#xA;                                ...), openat64) __nonnull ((2));&#xA;#  else&#xA;#   define openat openat64&#xA;#  endif&#xA;# endif&#xA;&#xA;extern int openat64 (int __fd, __const char *__file, int __oflag, ...)&#xA;     __nonnull ((2));&#xA;#endif&#xA;&#xA;/* Create and open FILE, with mode MODE.  This takes an `int' MODE&#xA;   argument because that is what `mode_t' will be widened to.&#xA;&#xA;   This function is a cancellation point and therefore not marked with&#xA;   __THROW.  */&#xA;#ifndef __USE_FILE_OFFSET64&#xA;extern int creat (__const char *__file, __mode_t __mode) __nonnull ((1));&#xA;#else&#xA;# ifdef __REDIRECT&#xA;extern int __REDIRECT (creat, (__const char *__file, __mode_t __mode),&#xA;                       creat64) __nonnull ((1));&#xA;# else&#xA;#  define creat creat64&#xA;# endif&#xA;#endif&#xA;#ifdef __USE_LARGEFILE64&#xA;extern int creat64 (__const char *__file, __mode_t __mode) __nonnull ((1));&#xA;#endif&#xA;&#xA;#if !defined F_LOCK &amp;amp;&amp;amp; (defined __USE_MISC || (defined __USE_XOPEN_EXTENDED \&#xA;                                               &amp;amp;&amp;amp; !defined __USE_POSIX))&#xA;/* NOTE: These declarations also appear in &amp;lt;unistd.h&amp;gt;; be sure to keep both&#xA;   files consistent.  Some systems have them there and some here, and some&#xA;   software depends on the macros being defined without including both.  */&#xA;&#xA;/* `lockf' is a simpler interface to the locking facilities of `fcntl'.&#xA;   LEN is always relative to the current file position.&#xA;   The CMD argument is one of the following.  */&#xA;&#xA;# define F_ULOCK 0      /* Unlock a previously locked region.  */&#xA;# define F_LOCK  1      /* Lock a region for exclusive use.  */&#xA;# define F_TLOCK 2      /* Test and lock a region for exclusive use.  */&#xA;# define F_TEST  3      /* Test a region for other processes locks.  */&#xA;&#xA;# ifndef __USE_FILE_OFFSET64&#xA;extern int lockf (int __fd, int __cmd, __off_t __len);&#xA;# else&#xA;#  ifdef __REDIRECT&#xA;extern int __REDIRECT (lockf, (int __fd, int __cmd, __off64_t __len), lockf64);&#xA;#  else&#xA;#   define lockf lockf64&#xA;#  endif&#xA;# endif&#xA;# ifdef __USE_LARGEFILE64&#xA;extern int lockf64 (int __fd, int __cmd, __off64_t __len);&#xA;# endif&#xA;#endif&#xA;&#xA;#ifdef __USE_XOPEN2K&#xA;/* Advice the system about the expected behaviour of the application with&#xA;   respect to the file associated with FD.  */&#xA;# ifndef __USE_FILE_OFFSET64&#xA;extern int posix_fadvise (int __fd, __off_t __offset, __off_t __len,&#xA;                          int __advise) __THROW;&#xA;# else&#xA; # ifdef __REDIRECT_NTH&#xA;extern int __REDIRECT_NTH (posix_fadvise, (int __fd, __off64_t __offset,&#xA;                                           __off64_t __len, int __advise),&#xA;                           posix_fadvise64);&#xA;#  else&#xA;#   define posix_fadvise posix_fadvise64&#xA;#  endif&#xA;# endif&#xA;# ifdef __USE_LARGEFILE64&#xA;extern int posix_fadvise64 (int __fd, __off64_t __offset, __off64_t __len,&#xA;                            int __advise) __THROW;&#xA;# endif&#xA;&#xA;&#xA;/* Reserve storage for the data of the file associated with FD.&#xA;&#xA;   This function is a possible cancellation points and therefore not&#xA;   marked with __THROW.  */&#xA;# ifndef __USE_FILE_OFFSET64&#xA;extern int posix_fallocate (int __fd, __off_t __offset, __off_t __len);&#xA;# else&#xA; # ifdef __REDIRECT&#xA;extern int __REDIRECT (posix_fallocate, (int __fd, __off64_t __offset,&#xA;                                         __off64_t __len),&#xA;                       posix_fallocate64);&#xA;#  else&#xA;#   define posix_fallocate posix_fallocate64&#xA;#  endif&#xA;# endif&#xA;# ifdef __USE_LARGEFILE64&#xA;extern int posix_fallocate64 (int __fd, __off64_t __offset, __off64_t __len);&#xA;# endif&#xA;#endif&#xA;&#xA;&#xA;/* Define some inlines helping to catch common problems.  */&#xA;#if __USE_FORTIFY_LEVEL &amp;gt; 0 &amp;amp;&amp;amp; defined __extern_always_inline \&#xA;    &amp;amp;&amp;amp; defined __va_arg_pack_len&#xA;# include &amp;lt;bits/fcntl2.h&amp;gt;&#xA;#endif&#xA;&#xA;__END_DECLS&#xA;&#xA;#endif /* fcntl.h  */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It shows this kind of error.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/usr/include/fcntl.h||In function ‘int main(int, char**)’:|&#xA;/usr/include/fcntl.h|73|error: too few arguments to function ‘int&#xA;open(const char*, int, ...)’|&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="5137944" LastActivityDate="2016-04-29T08:41:56.770" Title="What should I modify for this error in the header &quot;fcntl.h&quot;?" Tags="&lt;c++&gt;&lt;opencv&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="36950049" PostTypeId="1" AcceptedAnswerId="36950334" CreationDate="2016-04-30T02:31:10.883" Score="-1" ViewCount="83" Body="&lt;p&gt;Is there any way to convert C++(STL) code to QT (QTL)?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have a code written using STL (string, vector, iostream, fstream) and &#xA;I want to add it to my Qt Project (QString, QVector, ... when used).&#xA;My ideal way is to make it QTL-STL-compatible by adding some defines&#xA;in &lt;code&gt;.h&lt;/code&gt; file like following&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;// STL to QTL&#xA;#ifdef STL_CPP&#xA;    #include &amp;lt;string&amp;gt;&#xA;    #include&amp;lt;vector&amp;gt;&#xA;#else // QTL&#xA;    #include &amp;lt;QString&amp;gt;&#xA;    #define string QString&#xA;    #include &amp;lt;QVector&amp;gt;&#xA;    #define vector QVector&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Is there any existing work can convert some most commonly used STL code without &#xA;changing the source code ?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Note that I don't want to convert std datatype to qt datatype&lt;/strong&gt;, what I want is to &#xA;make a code can used in both Qt project(ifndef &lt;code&gt;STL_CPP&lt;/code&gt;) and C++ project (ifdef &lt;code&gt;STL_CPP&lt;/code&gt;). &lt;/p&gt;&#xA;" OwnerUserId="5181908" LastEditorUserId="5181908" LastEditDate="2016-04-30T03:00:39.803" LastActivityDate="2016-04-30T03:21:54.620" Title="How to make a c++ code can be used in both Qt project (QTL style) and C++ project (STL style)" Tags="&lt;qt&gt;&lt;stl&gt;&lt;qvector&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="36953612" PostTypeId="1" AcceptedAnswerId="37024180" CreationDate="2016-04-30T10:17:01.093" Score="-2" ViewCount="241" Body="&lt;p&gt;I encapsulate my function pointers in a structure/class. I can use these functions in a CPU implementation easily. However, if I want to use function pointers in CUDA, I have to register these functions by CUDA directives. Unfortuanely, here things become tricky. What I want is to create and device function pointers from a class containing function pointers. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;But let's start with the structure:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef TRANSFERFUNCTIONS_H_&#xA;#define TRANSFERFUNCTIONS_H_&#xA;&#xA;#ifndef SWIG&#xA;#include &amp;lt;cmath&amp;gt;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;string.h&amp;gt;&#xA;#endif&#xA;&#xA;#define PI    3.14159265358979323846f &#xA;&#xA;&#xA;&#xA;typedef float (*pDistanceFu) (float, float);&#xA;typedef float (*pDecayFu) (float, float, float);&#xA;&#xA;&#xA;//////////////////////////////////////////////////////////////////////////////////////////////&#xA;#ifdef __CUDACC__&#xA;        __host__ __device__&#xA;#endif&#xA;inline static float&#xA;fcn_gaussian_nhood (float dist, float sigmaT) {&#xA;        return exp(-pow(dist, 2.f)/(2.f*pow(sigmaT, 2.f)));&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;//////////////////////////////////////////////////////////////////////////////////////////////&#xA;    #ifdef &lt;strong&gt;CUDACC&lt;/strong&gt;&#xA;            &lt;strong&gt;host&lt;/strong&gt; &lt;strong&gt;device&lt;/strong&gt;&#xA;    #endif&#xA;    inline static float&#xA;    fcn_rad_decay (float sigma0, float T, float lambda) {&#xA;            return std::floor(sigma0*exp(-T/lambda) + 0.5f);&#xA;    }&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    //////////////////////////////////////////////////////////////////////////////////////////////&#xA;#ifdef __CUDACC__&#xA;        __host__ __device__&#xA;#endif&#xA;inline static float&#xA;fcn_lrate_decay (float sigma0, float T, float lambda) {&#xA;        return sigma0*exp(-T/lambda);&#xA;}&#xA;&#xA;class DistFunction;&#xA;typedef float (*pDistanceFu) (float, float);&#xA;typedef float (*pDecayFu) (float, float, float);&#xA;typedef float (DistFunction::*pmDistanceFu) (float, float);&#xA;typedef float (DistFunction::*pmDecayFu) (float, float, float);&#xA;&#xA;&#xA;class DistFunction {&#xA;private:&#xA;        pDistanceFu hDist;&#xA;        pDecayFu hRadDecay; &#xA;        pDecayFu hLRateDecay;&#xA;&#xA;public:&#xA;        DistFunction(char *, pDistanceFu, pDecayFu, pDecayFu);&#xA;        void Assign();&#xA;&#xA;        char *name;&#xA;        pDistanceFu distance;&#xA;        pDecayFu rad_decay;&#xA;        pDecayFu lrate_decay;&#xA;};&#xA;&#xA;void test();&#xA;&#xA;#endif /* TRANSFERFUNCTIONS_H_ */&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Implementation:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//#include &amp;lt;iostream&amp;gt;&#xA;#include &quot;Functions.h&quot;&#xA;#include &amp;lt;iostream&amp;gt;&#xA;#include &amp;lt;thrust/extrema.h&amp;gt;&#xA;#include &amp;lt;thrust/distance.h&amp;gt;&#xA;#include &amp;lt;thrust/device_vector.h&amp;gt;&#xA;&#xA;&#xA;DistFunction::DistFunction(char *cstr, pDistanceFu dist, pDecayFu rad, pDecayFu lrate) : name(cstr), distance(dist), rad_decay(rad), lrate_decay(lrate) {&#xA;}&#xA;&#xA;void DistFunction::Assign() {&#xA;        pDistanceFu hDist;&#xA;        pDecayFu hRadDecay; &#xA;        pDecayFu hLRateDecay;&#xA;&#xA;        cudaMemcpyFromSymbol(&amp;amp;hDist, distance, sizeof(pDistanceFu) );&#xA;        cudaMemcpyFromSymbol(&amp;amp;hRadDecay, rad_decay, sizeof(pDecayFu) );&#xA;        cudaMemcpyFromSymbol(&amp;amp;hLRateDecay, lrate_decay, sizeof(pDecayFu) );&#xA;&#xA;        distance = hDist;&#xA;        rad_decay = hRadDecay;&#xA;        lrate_decay = hLRateDecay;&#xA;}&#xA;&#xA;DistFunction fcn_gaussian = DistFunction(&#xA;        (char*)&quot;gaussian&quot;,&#xA;        fcn_gaussian_nhood,&#xA;        fcn_rad_decay,&#xA;        fcn_lrate_decay&#xA;);&#xA;&#xA;&#xA;&#xA;struct sm20lrate_decay_functor {&#xA;        float fCycle;&#xA;        float fCycles;&#xA;        DistFunction m_pfunc;&#xA;&#xA;        sm20lrate_decay_functor(const DistFunction &amp;amp;pfunc, float cycle, float cycles) : m_pfunc(pfunc), fCycle(cycle), fCycles(cycles) {}&#xA;&#xA;        __host__ __device__&#xA;        float operator()(float lrate) {&#xA;                return (m_pfunc.lrate_decay)(lrate, fCycle, fCycles);&#xA;        }&#xA;};&#xA;&#xA;void test() {&#xA;        unsigned int iWidth     = 4096;&#xA;        thrust::device_vector&amp;lt;float&amp;gt; dvLearningRate(iWidth, 0.f);&#xA;        thrust::device_vector&amp;lt;float&amp;gt; dvLRate(iWidth, 0.f);&#xA;&#xA;        thrust::transform( dvLRate.begin(),&#xA;                dvLRate.end(),&#xA;                dvLearningRate.begin(),&#xA;                sm20lrate_decay_functor(fcn_gaussian, 1, 100) );&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Edit: Made a minimal example.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;It seems that CUDA device function pointers seem useless, because I cannot use them dynamically. For what they have been implemented remains enigmatic for me. Can it be that CUDA is not really supporting function pointers but just uses function references in a similar way?&lt;/p&gt;&#xA;" OwnerUserId="1909456" LastEditorUserId="1909456" LastEditDate="2016-05-01T18:13:21.873" LastActivityDate="2016-05-04T09:49:35.977" Title="Assignement of device function pointers in CUDA (from host function pointers)" Tags="&lt;c++&gt;&lt;cuda&gt;" AnswerCount="2" CommentCount="9" />
  <row Id="37408043" PostTypeId="1" CreationDate="2016-05-24T08:21:23.593" Score="0" ViewCount="34" Body="&lt;p&gt;I have a regular dll with shared mfc dll. it was built on vc++ 6.0. I want to use it in vc++ 2008 windows form application.it has a header file, a lib and a dll.&#xA;I am adding some lines of the said header files&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;   #ifdef   DLLBUILD&#xA;   #define  DLLFUNC   extern &quot;C&quot; __declspec(dllexport) WINAPI&#xA;   #else&#xA;   #define  DLLFUNC   extern &quot;C&quot; __declspec(dllimport) WINAPI&#xA;   #endif &#xA;&#xA;   DLLFUNC int SC06StepInit(void)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;When I add this header it shows multiple errors of same type&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;error C2144: syntax error : 'int' should be preceded by ';'&lt;br&gt;&#xA;  error&#xA;  C4430: missing type specifier - int assumed. Note: C++ does not&#xA;  support default-int&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;error start from line &lt;code&gt;DLLFUNC int SC06StepInit(void)&lt;/code&gt; to all lines started with the same name &lt;code&gt;DLLFUNC&lt;/code&gt;. I have no idea of starting any function with a name than return type and than again a name.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The source code of this dll also had all the functions in the same manner.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I want to know. What is this way of defining a function is called and to use such libraries.&lt;/p&gt;&#xA;" OwnerUserId="1244539" LastEditorUserId="264325" LastEditDate="2016-05-25T12:16:51.960" LastActivityDate="2016-05-25T12:22:59.197" Title="Using a regular dll with shared mfc dll" Tags="&lt;visual-c++&gt;&lt;dll&gt;&lt;mfc&gt;&lt;shared-libraries&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="37444142" PostTypeId="1" CreationDate="2016-05-25T17:38:04.333" Score="0" ViewCount="59" Body="&lt;p&gt;I am trying to run the following code (a simple backup program), but from some reason, the field tv_sec could not be resolved.&#xA;I tried everything that crossed my mind - but no help.&#xA;I want to emphasize that I have read the other relevant questions in this site and also tried to add the line:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;sys/time.h&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;but - again - it didn't work.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Can you help me? &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thank you all!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I decided to attach the whole program, at any cas - in order to allow you to see the whole picture, if needed. &#xA;The code (the problematic line is under the note //&amp;lt;&gt;//): &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    #include &amp;lt;stdio.h&amp;gt;&#xA;    #include &amp;lt;stdlib.h&amp;gt;&#xA;    #include &amp;lt;string.h&amp;gt;&#xA;    #include &amp;lt;sys/types.h&amp;gt;&#xA;    #include &amp;lt;sys/stat.h&amp;gt;&#xA;    #include &amp;lt;unistd.h&amp;gt;&#xA;    #include &amp;lt;fcntl.h&amp;gt;&#xA;    #include &amp;lt;utime.h&amp;gt;&#xA;    #include &amp;lt;dirent.h&amp;gt;&#xA;    #include &amp;lt;libgen.h&amp;gt;&#xA;&#xA;    #define MIN(X,Y) ((X) &amp;lt; (Y) ? (X) : (Y))&#xA;&#xA;    // The header of each backed-up file&#xA;    typedef struct {&#xA;        char name[100];&#xA;        char mode[8];&#xA;        char uid[8];&#xA;        char gid[8];&#xA;        char size[12];&#xA;        char mtime[12];&#xA;        char typeflag;&#xA;    } bkp_header;&#xA;&#xA;    // Function declarations&#xA;    int backup(char *src, char *dest);&#xA;    int restore(char *src);&#xA;    int backup_abstract(char *src, int out_file);&#xA;    int backup_file(char *name, struct stat buf, int out_file);&#xA;    int backup_dir(char *name, struct stat buf, int out_file);&#xA;    int backup_symlink(char *name, struct stat buf, int out_file);&#xA;    int restore_file(bkp_header *file_header, int bkp_file);&#xA;    int restore_dir(bkp_header *file_header, int bkp_file);&#xA;    int restore_symlink(bkp_header *file_header, int bkp_file);&#xA;    int restore_metadata(bkp_header *file_header);&#xA;    bkp_header* get_file_header(char *name, struct stat buf, char type);&#xA;    int write_header_to_file(char *name, struct stat buf, int out_file, char type);&#xA;&#xA;    char* backup_dir_name;&#xA;&#xA;    // Main&#xA;    int main(int argc, char *argv[]) {&#xA;        int result = 1;&#xA;&#xA;        if (argc &amp;lt; 3) {&#xA;            fprintf(stderr, &quot;Invalid parameters\n&quot;);&#xA;        }&#xA;        else {&#xA;            // Backup&#xA;            if (strncmp(argv[1], &quot;-c&quot;, 2) == 0) {&#xA;                if (argc &amp;lt; 4) {&#xA;                    fprintf(stderr, &quot;Please insert the path you want to backup\n&quot;);&#xA;                }&#xA;                else {&#xA;                    result = backup(argv[3], argv[2]);&#xA;                }&#xA;            }&#xA;            // Restore&#xA;            else if (strncmp(argv[1], &quot;-x&quot;, 2) == 0) {&#xA;                result = restore(argv[2]);&#xA;            }&#xA;            else {&#xA;                fprintf(stderr, &quot;Invalid operation\n&quot;);&#xA;            }&#xA;        }&#xA;        exit(result);&#xA;    }&#xA;&#xA;    // Takes a 'src' path and runs a backup to the 'dest' path&#xA;    int backup(char *src, char *dest) {&#xA;        // Create the backup file&#xA;        int out_file = open(dest, O_TRUNC | O_CREAT | O_WRONLY);&#xA;        if (out_file &amp;lt; 0) {&#xA;            fprintf(stdout, &quot;Failed opening file for writing.&quot;);&#xA;            return -1;&#xA;        }&#xA;&#xA;        // Get the root backup directory&#xA;        char *src_dup = strdup(src);&#xA;        backup_dir_name = dirname(src_dup);&#xA;&#xA;        // Run the backup based on the type&#xA;        int result = backup_abstract(src, out_file);&#xA;        close(out_file);&#xA;        return result;&#xA;    }&#xA;&#xA;    // Backup something - a file, a folder or a symbolic link&#xA;    int backup_abstract(char *src, int out_file) {&#xA;        // Get the 'src' lstat&#xA;        struct stat buf;&#xA;        if (lstat(src, &amp;amp;buf) &amp;lt; 0) {&#xA;            fprintf(stderr, &quot;lstat error&quot;);&#xA;            return -1;&#xA;        }&#xA;&#xA;        if (S_ISDIR(buf.st_mode)) {&#xA;            return backup_dir(src, buf, out_file);&#xA;        }&#xA;        else if (S_ISREG(buf.st_mode)) {&#xA;            return backup_file(src, buf, out_file);&#xA;        }&#xA;        #ifdef  S_ISLNK&#xA;        else if (S_ISLNK(buf.st_mode)) {&#xA;            return backup_symlink(src, buf, out_file);&#xA;        }&#xA;        #endif&#xA;        else {&#xA;            fprintf(stderr, &quot;Can only backup a regular file, a directory, or a symlink\n&quot;);&#xA;        }&#xA;        return -1;&#xA;    }&#xA;&#xA;    // Backup a single file&#xA;    int backup_file(char *name, struct stat buf, int out_file) {&#xA;        if (write_header_to_file(name, buf, out_file, 'r') &amp;lt; 0) {&#xA;            return -1;&#xA;        }&#xA;&#xA;        // Copy the file right after the header in 8K chunks&#xA;        int in_file = open(name, O_RDONLY);&#xA;        if (in_file &amp;lt; 0) {&#xA;            fprintf(stdout, &quot;Failed opening file for reading.&quot;);&#xA;            return -1;&#xA;        }&#xA;        char read_buf[8192];&#xA;        while (1) {&#xA;            ssize_t result = read(in_file, read_buf, sizeof(read_buf));&#xA;            if (result &amp;lt; 0) {&#xA;                fprintf(stdout, &quot;Failed reading from file.&quot;);&#xA;                return -1;&#xA;            }&#xA;            if (result == 0) {&#xA;                break; /* EOF */&#xA;            }&#xA;            if (write(out_file, read_buf, (int)result) != (int)result) {&#xA;                fprintf(stdout, &quot;Failed writing to file.&quot;);&#xA;                return -1;&#xA;            }&#xA;        }&#xA;        close(in_file);&#xA;        return 0;&#xA;    }&#xA;&#xA;    // Backup a directory&#xA;    int backup_dir(char *name, struct stat buf, int out_file) {&#xA;        if (write_header_to_file(name, buf, out_file, 'd') &amp;lt; 0) {&#xA;            return -1;&#xA;        }&#xA;&#xA;        // Backup the contents of this directory&#xA;        DIR *dir;&#xA;        struct dirent *ent;&#xA;        if ((dir = opendir(name)) == NULL) {&#xA;            fprintf(stdout, &quot;Failed opening directory for reading.&quot;);&#xA;            return -1;&#xA;        }&#xA;        while ((ent = readdir(dir)) != NULL) {&#xA;            if (strcmp(ent-&amp;gt;d_name, &quot;.&quot;) &amp;amp;&amp;amp; strcmp(ent-&amp;gt;d_name, &quot;..&quot;)) {&#xA;                char full_path[100];&#xA;                strcpy(full_path, name);&#xA;                strcat(full_path, &quot;/&quot;);&#xA;                strcat(full_path, ent-&amp;gt;d_name);&#xA;&#xA;                if (backup_abstract(full_path, out_file) != 0) {&#xA;                    return -1;&#xA;                }&#xA;            }&#xA;        }&#xA;        closedir(dir);&#xA;        return 0;&#xA;    }&#xA;&#xA;    // Backup a symbolic link&#xA;    int backup_symlink(char *name, struct stat buf, int out_file) {&#xA;        if (write_header_to_file(name, buf, out_file, 'l') &amp;lt; 0) {&#xA;            return -1;&#xA;        }&#xA;&#xA;        char *link_target = malloc(buf.st_size + 1);&#xA;        if (link_target == NULL) {&#xA;            fprintf(stdout, &quot;Failed allocating memory.&quot;);&#xA;            return -1;&#xA;        }&#xA;        ssize_t link = readlink(name, link_target, buf.st_size + 1);&#xA;        if (link &amp;lt; 0) {&#xA;            fprintf(stderr, &quot;lstat error&quot;);&#xA;            return -1;&#xA;        }&#xA;        link_target[buf.st_size] = '\0';&#xA;        if (write(out_file, link_target, buf.st_size) != buf.st_size) {&#xA;            fprintf(stdout, &quot;Failed writing to file.&quot;);&#xA;            return -1;&#xA;        }&#xA;        free(link_target);&#xA;        return 0;&#xA;    }&#xA;&#xA;    // Get the backup header for a file&#xA;    bkp_header* get_file_header(char *name, struct stat buf, char type) {&#xA;        bkp_header *file_header = (bkp_header*)malloc(sizeof(bkp_header));&#xA;&#xA;        int abs_path_start = strncmp(name, backup_dir_name, strlen(backup_dir_name));&#xA;        if (abs_path_start != 0) {&#xA;            fprintf(stdout, &quot;Warning: Failed converting backup path to relative.&quot;);&#xA;        }&#xA;        else {&#xA;            name = &amp;amp;name[strlen(backup_dir_name)+1];&#xA;        }&#xA;&#xA;        sprintf(file_header-&amp;gt;name, name);&#xA;        sprintf(file_header-&amp;gt;mode, &quot;%d&quot;, buf.st_mode);&#xA;        sprintf(file_header-&amp;gt;uid, &quot;%d&quot;, buf.st_uid);&#xA;        sprintf(file_header-&amp;gt;gid, &quot;%d&quot;, buf.st_gid);&#xA;        sprintf(file_header-&amp;gt;size, &quot;%d&quot;, (int)buf.st_size);&#xA;//&amp;lt;&amp;lt;PROBLEM!!!&amp;gt;&amp;gt;//&#xA;        sprintf(file_header-&amp;gt;mtime, &quot;%d&quot;, (int)buf.st_mtim.tv_sec); &#xA;        file_header-&amp;gt;typeflag = type;&#xA;&#xA;        return file_header;&#xA;    }&#xA;&#xA;    // Create and write the header to the output file&#xA;    int write_header_to_file(char *name, struct stat buf, int out_file, char type) {&#xA;        bkp_header *file_header = get_file_header(name, buf, type);&#xA;        if (write(out_file, file_header, sizeof(bkp_header)) != sizeof(bkp_header)) {&#xA;            fprintf(stdout, &quot;Failed writing to file.&quot;);&#xA;            return -1;&#xA;        }&#xA;        return 0;&#xA;    }&#xA;&#xA;    // Takes a 'src' backup file path and extracts it to the current working dir&#xA;    int restore(char *src) {&#xA;        // Read the backup file&#xA;        int bkp_file = open(src, O_RDONLY);&#xA;        if (bkp_file &amp;lt; 0) {&#xA;            fprintf(stdout, &quot;Failed opening backup file for reading.&quot;);&#xA;            return -1;&#xA;        }&#xA;        while (1) {&#xA;            // Read the header&#xA;            char header_buf[sizeof(bkp_header)];&#xA;            ssize_t h_result = read(bkp_file, header_buf, sizeof(header_buf));&#xA;            if (h_result &amp;lt; 0) {&#xA;                fprintf(stdout, &quot;Failed reading from backup file.&quot;);&#xA;                return -1;&#xA;            }&#xA;            if (h_result == 0) {&#xA;                break; /* EOF */&#xA;            }&#xA;            bkp_header *file_header = header_buf;&#xA;&#xA;            // Restore the file/dir/symbolic-link&#xA;            if (file_header-&amp;gt;typeflag == 'r') {&#xA;                if (restore_file(file_header, bkp_file) &amp;lt; 0) {&#xA;                    return -1;&#xA;                }&#xA;            }&#xA;            else if (file_header-&amp;gt;typeflag == 'd') {&#xA;                if (restore_dir(file_header, bkp_file) &amp;lt; 0) {&#xA;                    return -1;&#xA;                }&#xA;            }&#xA;            else if (file_header-&amp;gt;typeflag == 'l') {&#xA;                if (restore_symlink(file_header, bkp_file) &amp;lt; 0) {&#xA;                    return -1;&#xA;                }&#xA;            }&#xA;            else {&#xA;                fprintf(stdout, &quot;Failed restoring, unknown file type found.&quot;);&#xA;                return -1;&#xA;            }&#xA;        }&#xA;        close(bkp_file);&#xA;        return 0;&#xA;    }&#xA;&#xA;    // Restore a single file based on the header and the raw bkp_file&#xA;    int restore_file(bkp_header *file_header, int bkp_file) {&#xA;        // Make sure the output file does not exist&#xA;        int out_file;&#xA;        out_file = open(file_header-&amp;gt;name, O_RDONLY);&#xA;        if (out_file != -1) {&#xA;            close(out_file);&#xA;            fprintf(stdout, &quot;Failed restoring, file %s already exists.&quot;, file_header-&amp;gt;name);&#xA;            return -1;&#xA;        }&#xA;&#xA;        // Create and open it for writing&#xA;        out_file = open(file_header-&amp;gt;name, O_WRONLY | O_CREAT);&#xA;        if (out_file &amp;lt; 0) {&#xA;            fprintf(stdout, &quot;Failed opening backed-up file path for writing.&quot;);&#xA;            return -1;&#xA;        }&#xA;&#xA;        // Restore the file's meta data&#xA;        if (restore_metadata(file_header) != 0) {&#xA;            fprintf(stdout, &quot;Failed restoring backed-up file meta data.&quot;);&#xA;            return -1;&#xA;        }&#xA;&#xA;        // Read the content of the file in 8K chunks, and write them to disk&#xA;        int file_size = atoi(file_header-&amp;gt;size);&#xA;        while (file_size) {&#xA;            // Read a chunk from the backup file&#xA;            char file_buf[8192];&#xA;            ssize_t f_result = read(bkp_file, file_buf, MIN(sizeof(file_buf), file_size));&#xA;            if (f_result &amp;lt; 0) {&#xA;                fprintf(stdout, &quot;Failed reading from backup file.&quot;);&#xA;                return -1;&#xA;            }&#xA;            if (f_result == 0) {&#xA;                break; /* EOF */&#xA;            }&#xA;&#xA;            // Write this chunk to the disc&#xA;            if (write(out_file, file_buf, (int)f_result) != (int)f_result) {&#xA;                fprintf(stdout, &quot;Failed writing file to disc.&quot;);&#xA;                return -1;&#xA;            }&#xA;            file_size -= f_result;&#xA;        }&#xA;        close(out_file);&#xA;        return 0;&#xA;    }&#xA;&#xA;    // Restore a directory based on the header and the raw bkp_file&#xA;    int restore_dir(bkp_header *file_header, int bkp_file) {&#xA;        // Create this folder on the disc&#xA;        if (mkdir(file_header-&amp;gt;name, atoi(file_header-&amp;gt;mode)) != 0) {&#xA;            fprintf(stdout, &quot;Failed creating directory.&quot;);&#xA;            return -1;&#xA;        }&#xA;&#xA;        // Restore the directory's meta data&#xA;        if (restore_metadata(file_header) != 0) {&#xA;            fprintf(stdout, &quot;Failed restoring backed-up directory's meta data.&quot;);&#xA;            return -1;&#xA;        }&#xA;        return 0;&#xA;    }&#xA;&#xA;    // Restore a symbolic link (not the target file) based on the header and the raw bkp_file&#xA;    int restore_symlink(bkp_header *file_header, int bkp_file) {&#xA;        // Make sure the output file does not exist&#xA;        int out_file;&#xA;        out_file = open(file_header-&amp;gt;name, O_RDONLY);&#xA;        if (out_file != -1) {&#xA;            close(out_file);&#xA;            fprintf(stdout, &quot;Failed restoring, symlink %s already exists.&quot;, file_header-&amp;gt;name);&#xA;            return -1;&#xA;        }&#xA;&#xA;        int path_size = atoi(file_header-&amp;gt;size);&#xA;        char *file_buf = malloc(sizeof(char)*path_size);&#xA;        if (file_buf == NULL) {&#xA;            fprintf(stdout, &quot;Failed allocating memory.&quot;);&#xA;            return -1;&#xA;        }&#xA;&#xA;        // Read the content of the file, get the link target&#xA;        ssize_t f_result = read(bkp_file, file_buf, path_size);&#xA;        if (f_result &amp;lt; 0) {&#xA;            fprintf(stdout, &quot;Failed reading from backup file.&quot;);&#xA;            return -1;&#xA;        }&#xA;&#xA;        // Create this symbolic link on the disc&#xA;        if (symlink(file_buf, file_header-&amp;gt;name) != 0) {&#xA;            fprintf(stdout, &quot;Failed creating symlink.&quot;);&#xA;            return -1;&#xA;        }&#xA;&#xA;        // Restore the link's meta data&#xA;        if (restore_metadata(file_header) != 0) {&#xA;            fprintf(stdout, &quot;Failed restoring backed-up link meta data.&quot;);&#xA;            return -1;&#xA;        }&#xA;        return 0;&#xA;    }&#xA;&#xA;&#xA;    // Set the original UID, GID, permissions and modification time&#xA;    int restore_metadata(bkp_header *file_header) {&#xA;        if (lchown(file_header-&amp;gt;name, atoi(file_header-&amp;gt;uid), atoi(file_header-&amp;gt;gid)) != 0) {&#xA;            fprintf(stdout, &quot;chown error&quot;);&#xA;            return -1;&#xA;        }&#xA;        if (file_header-&amp;gt;typeflag != 'l') {&#xA;            // No lchmod in my glibc, not restoring mode for symlinks&#xA;            if (chmod(file_header-&amp;gt;name, atoi(file_header-&amp;gt;mode)) != 0) {&#xA;                fprintf(stdout, &quot;chmod error&quot;);&#xA;                return -1;&#xA;            }&#xA;            struct utimbuf ubuf;&#xA;            ubuf.modtime = atoi(file_header-&amp;gt;mtime);&#xA;            if (utime(file_header-&amp;gt;name, &amp;amp;ubuf) != 0) {&#xA;                fprintf(stdout, &quot;utime error&quot;);&#xA;                return -1;&#xA;            }&#xA;        }&#xA;        return 0;&#xA;    }&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="3403740" LastActivityDate="2016-05-25T17:52:20.400" Title="The field tv_sec could not be resolved" Tags="&lt;c&gt;&lt;stat&gt;&lt;time.h&gt;" AnswerCount="1" CommentCount="4" />
  <row Id="37742770" PostTypeId="1" AcceptedAnswerId="37743513" CreationDate="2016-06-10T07:48:45.120" Score="2" ViewCount="739" Body="&lt;p&gt;I want to try one of the sample codes shipped with SDK, namely &quot;tutorial-2-mixedprocessing&quot;. I followed these steps:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;1) Import Project -&gt; selected tutorial directory&lt;/p&gt;&#xA;&#xA;&lt;p&gt;2) I named it “tutorial-2-mixedprocessing1”, left 3 options ticked (“Replace jars&amp;amp;lib sources when possible” and “Create Gradle-style module names”) &lt;/p&gt;&#xA;&#xA;&lt;p&gt;3) &lt;em&gt;Warning: “NDK integration deprecated in the current plugin”&lt;/em&gt; I clicked &lt;em&gt;“Set &quot;android.useDeprecatedNdk=true&quot; in gradle.properties to continue using the current NDK integration”&lt;/em&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;4) Import module -&gt;  Selected java module which is in “C:\SDKs\OpenCV-android-sdk\sdk\java” in my case -&gt; Left 3 checkbox ticked&lt;/p&gt;&#xA;&#xA;&lt;p&gt;5) &lt;em&gt;Error:Cause: failed to find target with hash string 'android-14' in: C:\Users\c010\AppData\Local\Android\Sdk Install missing platform(s) and sync project.&lt;/em&gt; I changed compileSdkversion, buildToolsVersion and targetSdkVersion and synced. Error dissapeared. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;6-7) Open module settings -&gt; Dependencies Added Opencv module as module dependency. Added NDK location (“C:\SDKs\android-ndk-r12-beta2” in my case)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;8) Build -&gt; make project leads &lt;em&gt;Error:(2, 33) opencv2/core/core.hpp: No such file or directory&lt;/em&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;In Eclipse I would add some include paths, but I don’t know how to do it in Android Studio. I thought editing Android.mk could help:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My Android.mk was&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;LOCAL_PATH := $(call my-dir)&#xA;&#xA;include $(CLEAR_VARS)&#xA;&#xA;ifdef OPENCV_ANDROID_SDK&#xA;  ifneq (&quot;&quot;,&quot;$(wildcard $(OPENCV_ANDROID_SDK)/OpenCV.mk)&quot;)&#xA;    include ${OPENCV_ANDROID_SDK}/OpenCV.mk&#xA;  else&#xA;    include ${OPENCV_ANDROID_SDK}/sdk/native/jni/OpenCV.mk&#xA;  endif&#xA;else&#xA;  include ../../sdk/native/jni/OpenCV.mk&#xA;endif&#xA;&#xA;LOCAL_MODULE    := mixed_sample&#xA;LOCAL_SRC_FILES := jni_part.cpp&#xA;LOCAL_LDLIBS +=  -llog -ldl&#xA;&#xA;include $(BUILD_SHARED_LIBRARY)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I changed it to plain absolute path&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;LOCAL_PATH := $(call my-dir)&#xA;include $(CLEAR_VARS)&#xA;include C:\SDKs\OpenCV-android-sdk\sdk\native\jni\OpenCV.mk&#xA;&#xA;LOCAL_MODULE    := mixed_sample&#xA;LOCAL_SRC_FILES := jni_part.cpp&#xA;LOCAL_LDLIBS +=  -llog -ldl&#xA;&#xA;include $(BUILD_SHARED_LIBRARY)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Didn’t help.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I added 'OPENCV_ANDROID_SDK := C:\SDKs\OpenCV-android-sdk\' before “ifdef ...” line, same result. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I added 'LOCAL_C_INCLUDES += C:\SDKs\OpenCV-android-sdk\sdk\native\jni\include' , same result.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I edited gradle file which looked like &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;apply plugin: 'com.android.application'&#xA;&#xA;android {&#xA;    compileSdkVersion 23&#xA;    buildToolsVersion &quot;23.0.3&quot;&#xA;&#xA;    defaultConfig {&#xA;        applicationId &quot;org.opencv.samples.tutorial2&quot;&#xA;        minSdkVersion 8&#xA;        targetSdkVersion 8&#xA;&#xA;        ndk {&#xA;            moduleName &quot;mixed_sample&quot;&#xA;        }&#xA;    }&#xA;&#xA;    buildTypes {&#xA;        release {&#xA;            minifyEnabled false&#xA;            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.txt'&#xA;        }&#xA;    }&#xA;}&#xA;&#xA;dependencies {&#xA;    compile project(':openCVLibrary310')&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I changed ndk bracket as follows: &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ndk {&#xA;    moduleName &quot;mixed_sample&quot;&#xA;    cFlags  += &quot;-I${file(&quot;C:/SDKs/OpenCV-android-sdk/sdk/native/jni/include&quot;)}&quot;.toString()&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;em&gt;Error:error: null-IC:\SDKs\OpenCV-android-sdk\sdk\native\jni\include: Invalid argument&lt;/em&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;It didn't accept cppFlags &lt;em&gt;Error:(14, 0) Could not find property 'cppFlags' on com.android.build.gradle.internal.dsl.NdkOptions_Decorated@797a42f2.&lt;/em&gt;&lt;/p&gt;&#xA;" OwnerUserId="6445358" LastActivityDate="2016-06-10T08:30:21.127" Title="AndroidStudio can't find OpenCV headers" Tags="&lt;android&gt;&lt;opencv&gt;&lt;android-studio&gt;&lt;android-ndk&gt;&lt;opencv4android&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="38055533" PostTypeId="1" CreationDate="2016-06-27T13:41:31.040" Score="1" ViewCount="52" Body="&lt;p&gt;The nvcc compiler is still quite bad with heavily templated code such as found in the boost or Eigen libraries.&#xA;I cannot (with nvcc) compile a main.cu file which does&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;Eigen/Dense&amp;gt;&#xA;#include &amp;lt;boost/locale.hpp&amp;gt;&#xA;int main() {}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;the same code in a .cpp file compiles fine (it is passed on untouched I guess).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This problem has existed for years:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/8138673/why-does-nvcc-fails-to-compile-a-cuda-file-with-boostspirit&quot;&gt;Why does nvcc fails to compile a CUDA file with boost::spirit?&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is there some way, e.g. via a preprocessor macro, to hide code from the nvcc compiler's parsing but still pass it on to the host compiler?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I know that &lt;code&gt;__CUDACC__&lt;/code&gt; indicates the presence of the nvcc compiler and that &lt;code&gt;__CUDA_ARCH__&lt;/code&gt; indicates that we are currently compiling code for the gpu, such that I can do for example:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef __CUDACC__&#xA;#error Must be compiled using nvcc&#xA;#endif&#xA;&#xA;__host__ __device__ void f(int* x) {&#xA;    *x = &#xA;    #ifdef  __CUDA_ARCH__  &#xA;    42&#xA;    #else&#xA;    0&#xA;    #endif&#xA;    ;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Now I would like to do something like the following in my .cu file:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;void foo();&#xA;&#xA;#ifdef __USING_HOST_COMPILER__&#xA;#include &amp;lt;Eigen/Dense&amp;gt;&#xA;#include &amp;lt;boost/locale.hpp&amp;gt;&#xA;&#xA;void foo() {&#xA;    // use boost and Eigen&#xA;}&#xA;#endif&#xA;&#xA;// use foo() in a __host__ function with launches some kernels (&amp;lt;- so this file needs to be nvcc'ed)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;But I have yet to find a macro that does this. &lt;code&gt;_MSC_VER&lt;/code&gt; doesn't do the job: nvcc defines it already. And setting &quot;Additional host compiler options&quot; to &quot;/D__USING_HOST_COMPILER__&quot; doesn't do the job either, because apparently nvcc uses the host compiler to do preprocessing before it parses the file by itself.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I know that I can move host-only code to a separate .cpp file and &lt;code&gt;extern&lt;/code&gt;-reference the host functions I need from .cu files, but I would like native support.&lt;/p&gt;&#xA;" OwnerUserId="524504" LastActivityDate="2016-06-27T13:41:31.040" Title="Can you hide code from the nvcc compiler but pass it on to the host compiler?" Tags="&lt;visual-c++&gt;&lt;visual-studio-2013&gt;&lt;cuda&gt;&lt;nvcc&gt;" AnswerCount="0" CommentCount="1" />
  <row Id="38093929" PostTypeId="1" CreationDate="2016-06-29T08:13:56.297" Score="1" ViewCount="60" Body="&lt;p&gt;On our setup, I need to check if some environment variable is exist, and the check if it's set to 1 or 0. &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?ifdef $(env.Enable_LBA) ?&amp;gt;&#xA;    &amp;lt;?if $(env.Enable_LBA) = 1?&amp;gt;&#xA;           Do things&#xA;    &amp;lt;?endif ?&amp;gt;&#xA;&amp;lt;?endif ?&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;for some reason, this doesn't work. if I leave only the  statements, the build fail if the env. variable isn't define. when it's like the above, it doesn't work even after setting Enable_LBA=1&lt;/p&gt;&#xA;" OwnerUserId="5520074" LastActivityDate="2016-06-29T08:13:56.297" Title="Wix - check if environment variable is exist and then it's value" Tags="&lt;wix&gt;" AnswerCount="0" CommentCount="1" />
  <row Id="38179848" PostTypeId="1" CreationDate="2016-07-04T08:17:19.953" Score="1" ViewCount="82" Body="&lt;p&gt;Is it possible to do a compile-time-assertion that a function get called at least one &lt;strong&gt;occurrence&lt;/strong&gt;?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;It is &lt;strong&gt;not&lt;/strong&gt; related to how many times the function is executed.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;//C.h&#xA;class C{  //Callee&#xA;    void f();&#xA;};&#xA;&#xA;//C.cpp&#xA;void C::f(){ //note: non static&#xA;    assert_called_at_least_once();  //&amp;lt;--- I expected something like this $$&#xA;    ............. some complex thing ......&#xA;}&#xA;&#xA;//D.cpp&#xA;D::f2(){  //Caller&#xA;    C c;&#xA;    if(false){ &#xA;    //^ This line is to emphasize that I don't care whether c.f() will be executed&#xA;        c.f(); //&amp;lt;--- if I comment out this line, an error should occur.&#xA;        //( Assume that it is only one occurrence of C::f(). )&#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It is for debugging purpose.&lt;/p&gt;&#xA;&#xA;&lt;h2&gt;&lt;strong&gt;Edit&lt;/strong&gt;&lt;/h2&gt;&#xA;&#xA;&lt;p&gt;As requested, I will provide more information why I want this feature.   &lt;/p&gt;&#xA;&#xA;&lt;p&gt;My game has many sub-systems.  C is one of them. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;I want to make sure that my game calls a certain function in a certain sub-system (e.g. Bullet System updates bullet's position) at least once.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is the reason.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Sometimes, when I want to narrow the scope that a bug can occur, I disable the function by commenting out this line in my big System (D) :-&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;bulletSystem-&amp;gt;update();&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;After the bug is found, I sometimes forgot to re-enable it back. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;In some cases, it is easier if I can insert an assert line inside the function rather than set breakpoint.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Edit2:&lt;/strong&gt;&lt;br&gt;&#xA;I prefer a solution explaining about C++ feature rather than a solution to solve my specific example about game.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;If such solution simply does not exist (suggested by M.M and n.m.), please post as an answer, so I can sadly accept it.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Edit3:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define #ifdef ... (suggested by rezdm)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;or other # seem to be useful.  &lt;/p&gt;&#xA;&#xA;&lt;p&gt;However, I demand a solution that&lt;br&gt;&#xA;- the $$-line is replaced by &amp;lt;= 1 line of simple code, because more complexity = more bugs&lt;br&gt;&#xA;- does not require any modification in caller (D)&lt;/p&gt;&#xA;" OwnerUserId="3577745" LastEditorUserId="3577745" LastEditDate="2016-07-04T14:14:01.723" LastActivityDate="2016-07-04T14:14:01.723" Title="Assert that a function is called in code at least 1 occurrence" Tags="&lt;c++&gt;&lt;assert&gt;" AnswerCount="0" CommentCount="11" />
  <row Id="38353369" PostTypeId="1" CreationDate="2016-07-13T13:38:28.360" Score="0" ViewCount="104" Body="&lt;p&gt;cross building socket code for win32/64 on linux using the mingw toolchain&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Where is &lt;code&gt;#define INVALID_SOCKET&lt;/code&gt; in &lt;code&gt;winsock2.h&lt;/code&gt;?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;It should be in there&lt;/p&gt;&#xA;&#xA;&lt;p&gt;but it isn't&lt;/p&gt;&#xA;&#xA;&lt;p&gt;whats going on? Am I going mad?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;UPDATE&lt;/p&gt;&#xA;&#xA;&lt;p&gt;focussing in on the 64 bit for a moment,&lt;/p&gt;&#xA;&#xA;&lt;p&gt;in dir:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/usr/x86_64-w64-mingw32/include/&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;we have a link to &lt;code&gt;winsock2.h&lt;/code&gt; -&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;lrwxrwxrwx 1 root root    40 Jun  3  2015 winsock2.h -&amp;gt; ../../share/mingw-w64/include/winsock2.h&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;looking at &lt;code&gt;../../share/mingw-w64/include/winsock2.h&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;there is no appearance of the string &lt;code&gt;INVALID_SOCKET&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;start of the file looks like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/**&#xA; * This file has no copyright assigned and is placed in the Public Domain.&#xA; * This file is part of the mingw-w64 runtime package.&#xA; * No warranty is given; refer to the file DISCLAIMER.PD within this package.&#xA; */&#xA;&#xA;#ifndef _WINSOCK2API_&#xA;#define _WINSOCK2API_&#xA;&#xA;#include &amp;lt;_mingw_unicode.h&amp;gt;&#xA;&#xA;#ifndef _WINSOCKAPI_&#xA;#define _WINSOCKAPI_&#xA;#else&#xA;#warning Please include winsock2.h before windows.h&#xA;#endif&#xA;&#xA;#ifndef INCL_WINSOCK_API_TYPEDEFS&#xA;#define INCL_WINSOCK_API_TYPEDEFS 0&#xA;#endif&#xA;&#xA;#ifndef _INC_WINDOWS&#xA;#include &amp;lt;windows.h&amp;gt;&#xA;#endif&#xA;&#xA;#ifndef MAKEWORD&#xA;#define MAKEWORD(low,high) ((WORD)(((BYTE)(low)) | ((WORD)((BYTE)(high))) &amp;lt;&amp;lt; 8))&#xA;#endif&#xA;&#xA;#ifndef WINSOCK_VERSION&#xA;#define WINSOCK_VERSION MAKEWORD(2,2)&#xA;#endif&#xA;&#xA;#ifndef WINSOCK_API_LINKAGE&#xA;#ifdef  DECLSPEC_IMPORT&#xA;#define WINSOCK_API_LINKAGE DECLSPEC_IMPORT&#xA;#else&#xA;#define WINSOCK_API_LINKAGE&#xA;#endif&#xA;#endif /* WINSOCK_API_LINKAGE */&#xA;#define WSAAPI          WINAPI&#xA;&#xA;/* undefine macros from winsock.h */&#xA;#include &amp;lt;psdk_inc/_ws1_undef.h&amp;gt;&#xA;&#xA;#ifdef __LP64__&#xA;#pragma push_macro(&quot;u_long&quot;)&#xA;#undef u_long&#xA;#define u_long __ms_u_long&#xA;#endif&#xA;&#xA;#include &amp;lt;_timeval.h&amp;gt;&#xA;#include &amp;lt;_bsd_types.h&amp;gt;&#xA;#include &amp;lt;inaddr.h&amp;gt;&#xA;#include &amp;lt;psdk_inc/_socket_types.h&amp;gt;&#xA;#include &amp;lt;psdk_inc/_fd_types.h&amp;gt;&#xA;#include &amp;lt;psdk_inc/_ip_types.h&amp;gt;&#xA;#include &amp;lt;psdk_inc/_wsadata.h&amp;gt;&#xA;#include &amp;lt;ws2def.h&amp;gt; /* FIXME: include order */&#xA;&#xA;#ifdef __cplusplus&#xA;extern &quot;C&quot; {&#xA;#endif&#xA;&#xA;#define IOCPARM_MASK 0x7f&#xA;#define IOC_VOID 0x20000000&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;around line 296 looks like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define PF_DLI AF_DLI&#xA;#define PF_LAT AF_LAT&#xA;#define PF_HYLINK AF_HYLINK&#xA;#define PF_APPLETALK AF_APPLETALK&#xA;#define PF_VOICEVIEW AF_VOICEVIEW&#xA;#define PF_FIREFOX AF_FIREFOX&#xA;#define PF_UNKNOWN1 AF_UNKNOWN1&#xA;#define PF_BAN AF_BAN&#xA;#define PF_ATM AF_ATM&#xA;#define PF_INET6 AF_INET6&#xA;#define PF_BTH AF_BTH&#xA;&#xA;#define PF_MAX AF_MAX&#xA;&#xA;#define SOL_SOCKET 0xffff&#xA;&#xA;#define SOMAXCONN 0x7fffffff&#xA;&#xA;#define MSG_OOB 0x1&#xA;#define MSG_PEEK 0x2&#xA;#define MSG_DONTROUTE 0x4&#xA;#define MSG_WAITALL 0x8&#xA;&#xA;#define MSG_PARTIAL 0x8000&#xA;&#xA;#define MSG_INTERRUPT 0x10&#xA;&#xA;#define MSG_MAXIOVLEN 16&#xA;&#xA;#define MAXGETHOSTSTRUCT 1024&#xA;&#xA;#define FD_READ_BIT 0&#xA;#define FD_READ (1 &amp;lt;&amp;lt; FD_READ_BIT)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I've grepped the &lt;code&gt;../../share/mingw-w64/include/&lt;/code&gt; dir for &lt;code&gt;INVALID_SOCKET&lt;/code&gt; to no avail..&lt;/p&gt;&#xA;&#xA;&lt;p&gt;UPDATE2:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So if INVALID_SOCKET is there, then maybe I've misinterpreted the compiler error? I thought it was effectively telling me that INVALID_SOCKET was not defined - see following relevant snippet of compiler call and resulting error:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;x86_64-w64-mingw32-gcc -g -Wall -static -DERR_MSG_LIM=2 -I../../TEST/core/src -I../../TEST/core_harness/src -I../../TEST/pulse_IO/src -I../../daemon/src -I../src -I/usr/local/include -I/usr/local/x86_64-w64-mingw32/include  test_daemon.c -c -o ../build/win64/test_daemon.o&#xA;&#xA;In file included from ../../TEST/core_harness/src/test_harness.h:31:0,&#xA;                 from ../../daemon/src/daemon.h:18,&#xA;                 from test_daemon.c:20:&#xA;&#xA;../../TEST/core_harness/src/test_socket.h:64:27: error: expected ‘:’, ‘,’, ‘;’, ‘}’ or ‘__attribute__’ before ‘=’ token&#xA;     SOCKET connect_socket = INVALID_SOCKET;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;UPDATE 3:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I'm now wondering whether my use of default values in a struct definition is the problem, i.e. its OK for gcc on linux, but no good for mingw?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My struct looks like this:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;typedef struct {&#xA;    char *hostname;&#xA;    int portno;&#xA;#ifndef _WIN32&#xA;    unsigned int sockfd;&#xA;    unsigned int newsockfd;&#xA;    struct sockaddr_in serv_addr;&#xA;    struct sockaddr_in cli_addr;    &#xA;    struct hostent *server;&#xA;#endif&#xA;#ifdef _WIN32&#xA;    int iResult;&#xA;    WSADATA wsaData;&#xA;    SOCKET connect_socket = INVALID_SOCKET;&#xA;    struct addrinfo *result = NULL;&#xA;    struct addrinfo *ptr = NULL;&#xA;    struct addrinfo hints;    &#xA;#endif&#xA;} socket_cfg_t;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and the error is occuring atline:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;SOCKET connect_socket = INVALID_SOCKET;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1041868" LastEditorUserId="1041868" LastEditDate="2016-07-14T10:55:38.797" LastActivityDate="2016-07-14T10:55:38.797" Title="No INVALID_SOCKET #define in mingw-w64 32 bit or 64 bit winsock2.h files" Tags="&lt;c&gt;&lt;mingw&gt;&lt;winsock2&gt;" AnswerCount="0" CommentCount="15" />
  <row Id="38405070" PostTypeId="1" AcceptedAnswerId="38412784" CreationDate="2016-07-15T21:09:40.490" Score="0" ViewCount="48" Body="&lt;p&gt;In this recipe, I want git to fetch the current sha1 hash only if git is present and I'm in a git repository.  My problem is that $(GIT) is always null.  I don't understand why this is so yet setting $(HASH) and echoing it works.  What's going on here?  How can I get the Make to execute a chunk of code only if git is installed?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;hash:&#xA;ifneq (&quot;$(wildcard .git)&quot;, &quot;&quot;)&#xA;    $(eval GIT=`which git`)&#xA;  ifdef $(GIT)&#xA;    $(eval HASH=`git rev-parse HEAD`)&#xA;    @echo $(HASH)&#xA;    @echo &quot;#define GIT_SHA1 \&quot;$(HASH)\&quot;&quot; &amp;gt; git_sha1.h&#xA;  endif&#xA;else&#xA;    @echo &quot;Not in a git repository&quot;&#xA;endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I want to avoid having to use a shell script to do this.&lt;/p&gt;&#xA;" OwnerUserId="1705267" LastEditorUserId="874188" LastEditDate="2016-07-16T16:23:45.890" LastActivityDate="2016-07-16T16:23:45.890" Title="Setting a variable in a Makefile recipe and then testing it" Tags="&lt;makefile&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="0" />
  <row Id="38427647" PostTypeId="1" AcceptedAnswerId="38427674" CreationDate="2016-07-18T02:00:54.653" Score="-1" ViewCount="34" Body="&lt;p&gt;I want to know how to call a function in a header file. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;For example.. &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;example.h&#xA;&#xA;#ifndef NPT_IMM32_H&#xA;#define NPT_IMM32_H&#xA;&#xA;#ifndef NPT_API&#xA;    #ifdef  _THIS_IS_IMPLE_&#xA;        #define NPT_API     __declspec(dllexport)&#xA;    #else&#xA;        #define NPT_API     __declspec(dllimport)&#xA;    #endif &#xA;#endif &#xA;&#xA;NPT_API char * __stdcall npt_GetVer();&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I want to call npt_GerVer() function in calling.c JNI file &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;calling.c&#xA;#include &amp;lt;jni.h&amp;gt;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;stdbool.h&amp;gt;&#xA;#include &amp;lt;windows.h&amp;gt;&#xA;&#xA;#include &quot;example.h&quot;&#xA;&#xA;JNIEXPORT void JNICALL Java_FingerPrintJNI_GetVer(JNIEnv *env, jobject thisObj){&#xA;    // Here How to call the npt_GerVer() function ? &#xA;    return;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;As you can see, I want to call &quot;npt_GerVer() function&quot; in Java_FingerPrintJNI_GetVer function. &#xA;How can I do that?&lt;/p&gt;&#xA;" OwnerUserId="878520" LastEditorUserId="4774918" LastEditDate="2016-07-18T02:11:28.360" LastActivityDate="2016-07-18T02:11:28.360" Title="Calling a function in a header file" Tags="&lt;c&gt;&lt;gcc&gt;&lt;jni&gt;&lt;header-files&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="38783156" PostTypeId="1" AcceptedAnswerId="38785826" CreationDate="2016-08-05T07:05:43.973" Score="0" ViewCount="40" Body="&lt;p&gt;makefile    &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;RUN_EXE = xyz.exe&#xA;SOME_DIR_PATH = ../folder1/&#xA;&#xA;ifdef $(MAKECMDGOALS)&#xA;   ifeq ($(MAKECMDGOALS), &quot;target_1&quot;)&#xA;      ABC = status.log&#xA;      ARGS_TO_EXE = &quot;argc1&quot;&#xA;   endif&#xA;   ifeq ($(MAKECMDGOALS), &quot;target_1&quot;)&#xA;      ABC = file2.txt&#xA;      ARGS_TO_EXE = &quot;argc2&quot;&#xA;   endif&#xA;else&#xA;   ABC = status.log file2.txt&#xA;   ARGS_TO_EXE = &quot;&quot;&#xA;endif&#xA;&#xA; # phony define&#xA;.PHONY = default target_1 target_2 &#xA;&#xA;# if target not mention run default&#xA;default: $(ABC)&#xA;&#xA;&#xA;target_1 target_2:$(ABC)&#xA;&#xA;$(ABC):&#xA;      $(CD) $(SOME_DIR_PATH) &amp;amp;&amp;amp; ( $(RUN_EXE) $(ARGS_TO_EXE) || (exit 1;)) 2&amp;gt;&amp;amp;1 | tee -a ../status.log; \&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;i have two makefile using the first makefile i am invoking this makefile.&#xA;if some error come it should succesfully return to first makefile.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;for testing purpose i created a error in executable i am trying to open a file in read mode which doesn't exist. so my executable will through error and it will come out &lt;/p&gt;&#xA;&#xA;&lt;p&gt;when i give&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;make target_1&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;error: error opening file (using c printf function and same will be in file)&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;make target_2 &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;error: error opening file (using c printf function and same will be in file)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;BUT problem occur here&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;make&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;error: error opening file (using c printf function and same will be in file).&#xA;error: error opening file (using c printf function and same will be in file).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;it should exit after first print with successfully logging in status.log file but it is not happening. AS $(ABC) contain two target status.log and file2.txt so in first run it try to build status.log and in second it try to build file2.txt.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;But i want if error is there in first run it should return to first makefile and log the error in status.log also and shouldn't run for file2.txt and come out using exit 1&lt;/p&gt;&#xA;" OwnerUserId="6652681" LastEditorUserId="6652681" LastEditDate="2016-08-05T10:25:52.340" LastActivityDate="2016-08-05T10:25:52.340" Title="how to exit and log the data in file at same time in makefile when error occurs" Tags="&lt;c&gt;&lt;bash&gt;&lt;unix&gt;&lt;makefile&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="39239624" PostTypeId="1" CreationDate="2016-08-31T02:01:48.163" Score="1" ViewCount="84" Body="&lt;p&gt;I am compiling a C++ code together with Fortran subroutine. The C++ cpp code is like:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;Calculate.h&quot;&#xA;extern &quot;C&quot; double SolveEq_(double *Gvalue, double *GvalueU, double *GvalueV, double *Gnodex, double *Gnodey, double *GtimeInc, double *Glfs);&#xA;&#xA;template &amp;lt;class T1, class T2&amp;gt;&#xA;void Calculate(vector&amp;lt;Element&amp;lt;T1, T2&amp;gt; &amp;gt; &amp;amp;elm, GParameter &amp;amp;GeqPm, GmeshInfo &amp;amp;Gmesh)&#xA;{&#xA;    // Solving Equation using Fortran code&#xA;    SolveEq_(&amp;amp;Gmesh.Gvalue[0], &amp;amp;Gmesh.GvalueU[0], &amp;amp;Gmesh.GvalueV[0], &amp;amp;Gmesh.Gnodex[0], &amp;amp;Gmesh.Gnodey[0], &amp;amp;GeqPm.GtimeInc, &amp;amp;GeqPm.Glfs);&#xA;    return;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And the Fortran code is like:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;!==========================================================================&#xA;Module Inputpar&#xA;Implicit None&#xA;Integer,parameter :: Numx = 200, Numy = 200&#xA;End Module&#xA;!======================================== PROGRAM =============================================&#xA;Subroutine SolveEq(Gvalue, GvalueU, GvalueV, Gnodex, Gnodey, Deltat, Lfs);&#xA;Use Inputpar&#xA;Implicit None&#xA;&#xA;Real*8 Deltat, Lfs, Dt, Su&#xA;Real*8 Gvalue(1, (Numx+1)*(Numy+1)), GvalueU(1, (Numx+1)*(Numy+1)), GvalueV(1, (Numx+1)*(Numy+1))&#xA;Real*8 Gnodex(0:Numx), Gnodey(0:Numy)&#xA;&#xA;Real*8 DX, DY&#xA;Real*8 X(-3:Numx+3), Y(-3:Numy+3)&#xA;Real*8 VelX(-3:Numx+3,-3:Numy+3), VelY(-3:Numx+3,-3:Numy+3)&#xA;Real*8 G(-3:Numx+3,-3:Numy+3)&#xA;&#xA;Common /CommonData/ X, Y, DX, DY, VelX, VelY, G, Dt, Su&#xA;&#xA;!============================= Data Transfer ============================&#xA;Dt                  = Deltat&#xA;Su                  = Lfs&#xA;X          (0:Numx) = Gnodex(0:Numx)&#xA;Y          (0:Numy) = Gnodey(0:Numy)&#xA;VelX(0:Numx,0:Numy) = transpose(reshape(GvalueU,(/Numy+1,Numx+1/)))&#xA;VelY(0:Numx,0:Numy) = transpose(reshape(GvalueV,(/Numy+1,Numx+1/)))&#xA;G   (0:Numx,0:Numy) = transpose(reshape(Gvalue ,(/Numy+1,Numx+1/)))&#xA;&#xA;!==========Some other lines neglected here=================&#xA;&#xA;End&#xA;!======================================== END PROGRAM =========================================&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Firstly compile the Fortran code using command: &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;      gfortran SolveEq.f90 -c -o SolveEq.o&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And then compile the C++/Fortran codes together using makefile:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;# Compiler&#xA;CC = g++&#xA;&#xA;# Debug option&#xA;DEBUG = false&#xA;&#xA;# Source directory of codes&#xA;SRC1 = /home&#xA;SRC2 = $(SRC1)/Resources&#xA;SRC3 = $(SRC1)/Resources/Classes&#xA;&#xA;OPT=-fopenmp -O2&#xA;&#xA;ifdef $(DEBUG)&#xA;  PROG=test.out&#xA;else&#xA;  PROG=i.out&#xA;endif&#xA;&#xA;# Linker&#xA;#LNK=-I$(MPI)/include -L$(MPI)/lib -lmpich -lopa -lmpl -lpthread&#xA;&#xA;OBJS = libtseutil.a Calculate.o SolveEq.o&#xA;&#xA;OBJS_F=$(OBJS)&#xA;SUF_OPTS1=$(OBJS_F)&#xA;SUF_OPTS2=-I$(SRC2)/&#xA;SUF_OPTS3=-I$(SRC3)/&#xA;SUF_OPTS4=&#xA;&#xA;# Details of compiling&#xA;$(PROG): $(OBJS_F)&#xA;    $(CC) $(OPT) -o $@ $(SUF_OPTS1)&#xA;%.o: $(SRC1)/%.cpp&#xA;    $(CC) $(OPT) -c $&amp;lt; $(SUF_OPTS2)&#xA;%.o: $(SRC2)/%.cpp&#xA;    $(CC) $(OPT) -c $&amp;lt; $(SUF_OPTS3)&#xA;%.o: $(SRC3)/%.cpp&#xA;    $(CC) $(OPT) -c $&amp;lt; $(SUF_OPTS4)&#xA;&#xA;# Clean&#xA;.PHONY: clean&#xA;clean:&#xA;    @rm -rf *.o *.oo *.log&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;However, the error shows that:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;g++ -fopenmp -O2 -o libtseutil.a Calculate.o SolveEq.o&#xA;Calculate.o: In function `void Calculate&amp;lt;CE_Tri, SolElm2d&amp;gt;(std::vector&amp;lt;Element&amp;lt;CE_Tri, SolElm2d&amp;gt;, std::allocator&amp;lt;Element&amp;lt;CE_Tri, SolElm2d&amp;gt; &amp;gt; &amp;gt;&amp;amp;, GParameter&amp;amp;, GmeshInfo&amp;amp;)':&#xA;Calculate.cpp:(.text._Z10CalculateGI6CE_Tri8SolElm2dEvRSt6vectorI7ElementIT_T0_ESaIS6_EER10GParameterR9GmeshInfo[_Z10CalculateGI6CE_Tri8SolElm2dEvRSt6vectorI7ElementIT_T0_ESaIS6_EER10GParameterR9GmeshInfo]+0x3c): undefined reference to `SolveEq_'&#xA;SolveEq.o: In function `solveeq_':&#xA;SolveEq.f90:(.text+0x2b8e): undefined reference to `_gfortran_reshape_r8'&#xA;SolveEq.f90:(.text+0x2d2a): undefined reference to `_gfortran_reshape_r8'&#xA;SolveEq.f90:(.text+0x2ec6): undefined reference to `_gfortran_reshape_r8'&#xA;SolveEq.f90:(.text+0x31fa): undefined reference to `_gfortran_reshape_r8'&#xA;collect2: error: ld returned 1 exit status&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;How does this happen?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I used a simple case to test the mixed compiling. The C++ code was:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdlib.h&amp;gt;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;iostream&amp;gt;&#xA;#include &amp;lt;vector&amp;gt;&#xA;using namespace std;&#xA;&#xA;extern &quot;C&quot; double fortran_sum_(double *sum, double *su2m, double *vec, double* vec2, int *size);&#xA;&#xA;int main(int argc, char ** argv)&#xA;{&#xA;    int size;&#xA;    double sum, sum2;&#xA;    double aa,bb,cc,dd;&#xA;    vector&amp;lt;double&amp;gt; vec;&#xA;    vector&amp;lt;double&amp;gt; vec2;&#xA;&#xA;    size=2;&#xA;    aa=1.0;&#xA;    bb=2.0;&#xA;    sum=0.0;&#xA;    sum2=0.0;&#xA;&#xA;    vec.push_back(aa);&#xA;    vec.push_back(bb);&#xA;    vec2.push_back(aa*2.0);&#xA;    vec2.push_back(bb*2.0);&#xA;&#xA;    fortran_sum_(&amp;amp;sum, &amp;amp;sum2, &amp;amp;vec[0], &amp;amp;vec2[0], &amp;amp;size);&#xA;&#xA;    cout &amp;lt;&amp;lt; &quot;Calling a Fortran function&quot; &amp;lt;&amp;lt; endl;&#xA;    cout &amp;lt;&amp;lt; &quot;============================&quot; &amp;lt;&amp;lt; endl;&#xA;    cout &amp;lt;&amp;lt; &quot;size = &quot; &amp;lt;&amp;lt; size &amp;lt;&amp;lt; endl;&#xA;    cout &amp;lt;&amp;lt; &quot;sum = &quot; &amp;lt;&amp;lt; sum &amp;lt;&amp;lt; endl;&#xA;    cout &amp;lt;&amp;lt; &quot;sum2 = &quot; &amp;lt;&amp;lt; sum2 &amp;lt;&amp;lt; endl &amp;lt;&amp;lt; endl;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;And the Fortran code was:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Subroutine fortran_sum(gsum, gsum2, gvec, gvec2, gsize2)&#xA;  integer gsize,gsize2&#xA;  real*8 gvec(0:gsize2-1), gvec2(0:1)&#xA;  real*8 gsum, gsum2&#xA;  gsum = gvec(0)+gvec(1);&#xA;  gsum2 = gvec2(0)+gvec2(1);&#xA;  gsize = gsize*2;&#xA;end &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Then used commands to compile :&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;gfortran fortran_sum.f90 -c -o fortran_sum.o&#xA;g++ fortran_sum.o call_fortran.cpp -o a.out&#xA;./a.out&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It worked well:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Calling a Fortran function&#xA;============================&#xA;size = 2&#xA;sum = 3&#xA;sum2 = 6&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="6512561" LastEditorUserId="721644" LastEditDate="2016-09-03T14:34:24.750" LastActivityDate="2016-09-03T14:34:24.750" Title="C++/Fortran mixed programming: undefined reference to `_gfortran_reshape_r8'" Tags="&lt;c++&gt;&lt;fortran&gt;&lt;mixed-code&gt;" AnswerCount="3" CommentCount="6" FavoriteCount="1" />
  <row Id="39317175" PostTypeId="1" CreationDate="2016-09-04T13:00:52.900" Score="0" ViewCount="37" Body="&lt;p&gt;i am building a clang libtool, &#xA;how can i get the preprocessor information that will tell me if a given Decl is inside a scope of #if #ifdef #ifndef ?&lt;/p&gt;&#xA;" OwnerUserId="6793201" LastActivityDate="2016-09-19T07:39:16.007" Title="How to check if a Decl is inside a scope of #if directive?" Tags="&lt;clang&gt;&lt;llvm-clang&gt;&lt;libtool&gt;&lt;libtooling&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="39380742" PostTypeId="1" AcceptedAnswerId="39381087" CreationDate="2016-09-08T00:12:22.290" Score="0" ViewCount="32" Body="&lt;p&gt;I'm using Questasim 10.4c to simulate a Systemverilog design that uses the `ifdef  compiler directive at a bunch of places. Example:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;`ifdef FOR_SIMULATION_ONLY&#xA;&amp;lt;code&amp;gt;&#xA;`endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;After compiling, I haven't found any way to get Questasim to be able to tell me explicitly whether FOR_SIMULATION_ONLY has been defined, though. I've dug through the user guide and command reference manual and the closest thing I've found is putting a -E option in all my vlog compile statements and then examining the files created to see if FOR_SIMULATION_ONLY is defined. Can Questasim tell me, though, whether it's been defined without having to use the vlog -E method?&lt;/p&gt;&#xA;" OwnerUserId="5843925" LastActivityDate="2016-09-08T01:03:34.503" Title="How do I know which Systemverilog macros are defined when using Modelsim or Questasim?" Tags="&lt;system-verilog&gt;&lt;modelsim&gt;&lt;questasim&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="39826865" PostTypeId="1" AcceptedAnswerId="39886133" CreationDate="2016-10-03T07:56:02.243" Score="8" ViewCount="102" Body="&lt;p&gt;This is my project structure:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;MainFolder&#xA;  - Jamroot.jam&#xA;  - AnotherFolder&#xA;      - libFolder&#xA;          - Jamfile.jam&#xA;          - cpp files&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I have an #ifdef in one of the cpp files. &#xA;Example:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef SOMEVALUE&#xA;  Code&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I need to compile the cpp files with #define in Jamfile. Since, I am having two types of executables (one with #define and one without) I need to do this in Jamfile itself and not cpp code.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have tried the following, which does not work (unable to find definitions inside #ifdef #endif block): &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;lib libname : [ glob *.cpp ] : &amp;lt;link&amp;gt;static : &amp;lt;define&amp;gt;SOMEVALUE ;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="1427663" LastEditorUserId="1427663" LastEditDate="2016-10-03T09:23:26.693" LastActivityDate="2016-10-07T02:36:38.103" Title="#define in Boost Jamfiles" Tags="&lt;c++&gt;&lt;boost&gt;&lt;bjam&gt;" AnswerCount="2" CommentCount="0" FavoriteCount="1" />
  <row Id="39829098" PostTypeId="1" AcceptedAnswerId="39830585" CreationDate="2016-10-03T10:06:42.040" Score="0" ViewCount="62" Body="&lt;p&gt;I'm working on a visual debugger for an embedded application running on stm32.&#xA;So the debugger will run on a PC an reuse the same code as the main application except for the low level functions triggering hardware reaction and will instead send signals for the GUI (QT).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I'm looking for a pattern or something clean that could allow me to do that without big #ifdef in the code.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;So to give an example:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I have the gpio.h and gpio.c files playing with the stm32 low level stuffs (they are semi-generated by stmCube so I cannot change them completely).&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;(C code)&#xA;void GPIO_set_realy_state(int relay, bool state)&#xA;{&#xA;    HAL_GPIO_WritePin(port,relay,state?GPIO_PIN_SETGPIO_PIN_RESET);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I have a c++ wrapper above them (GpioWrapper) that is called whenever the application needed to change the state of an IO&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;GpioWrapper::setRealyState(int relay, bool state)&#xA;{&#xA;    GPIO_set_realy_state(relay,state);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;In the PC application, I would like another implementation of that wrapper or something alike that would get called instead of the above one to send a signal instead of calling the low level functions making the GUI to change an icon.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;GpioWrapper::setRealyState(int relay, bool state)&#xA;{&#xA;    emit RelayTriggered(relay,state);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The problem that I face is that to send signals, my class need to inherit from QObject and it cannot be the case in GpioWrapper.h given that that part has no clue of the Qt World when used in the embedded application and I would like to avoid #ifdef #else in my wrapper if possible.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;What could be the cleaner way to solve that?&lt;/p&gt;&#xA;" OwnerUserId="5772884" LastEditorUserId="5772884" LastEditDate="2016-10-03T10:45:01.690" LastActivityDate="2016-10-03T12:21:37.777" Title="create multiple implementations of a class, one to send Qt signals and one to work with hardware directly" Tags="&lt;c++&gt;&lt;qt&gt;&lt;design-patterns&gt;&lt;embedded&gt;&lt;wrapper&gt;" AnswerCount="2" CommentCount="2" />
  <row Id="40178080" PostTypeId="1" CreationDate="2016-10-21T13:34:59.897" Score="1" ViewCount="61" Body="&lt;p&gt;&lt;b&gt;port_pin.h&lt;/b&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef __PORT_PIN_H__&#xA;#define __PORT_PIN_H__&#xA;&#xA;typedef enum&#xA;{&#xA;    IO_PORT_A    = ((uint16_t)0),   /* IO Port A Selected  */&#xA;    IO_PORT_B    = ((uint16_t)1),   /* IO Port B Selected  */&#xA;    IO_PORT_NONE = ((uint16_t)0xFF)  /* No IO Port Selected */&#xA;}PortName_t;&#xA;&#xA;/* IO Driver GPIO Pin Numbers */&#xA;typedef enum&#xA;{&#xA;    IO_PIN_0    = ((uint16_t)0),      /* Pin 0 selected    */&#xA;    IO_PIN_1    = ((uint16_t)1),      /* Pin 1 selected    */&#xA;    IO_PIN_2    = ((uint16_t)2),      /* Pin 2 selected    */&#xA;    IO_PIN_3    = ((uint16_t)3),      /* Pin 3 selected    */&#xA;}PinNumber_t;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;b&gt;hal_io.h&lt;/b&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef __HAL_IO_H__&#xA;#define __HAL_IO_H__&#xA;&#xA;#ifdef  DEF_HAL_IO&#xA;#define EXTERN_HAL_IO&#xA;#else   &#xA;#define EXTERN_HAL_IO extern&#xA;#endif&#xA;&#xA;EXTERN_HAL_IO void HalIo_fct(PortName_t, PinNumber_t);&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;b&gt;drv_io.h&lt;/b&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef __DRV_IO_H__&#xA;#define __DRV_IO_H__&#xA;&#xA;#ifdef  DEF_DRV_IO&#xA;#define EXTERN_DRV_IO&#xA;#else   &#xA;#define EXTERN_DRV_IO extern&#xA;#endif&#xA;&#xA;EXTERN_DRV_IO Status_t DDrvIOPinSet_fct(const BoardCfgPortPin_t *pointer);&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;b&gt;board_cfg.h&lt;/b&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef __BOARD_CFG_H__&#xA;#define __BOARD_CFG_H__&#xA;&#xA;#ifdef  DEF_BOARD_CFG&#xA;#define EXTERN_BOARD_CFG&#xA;#else   &#xA;#define EXTERN_BOARD_CFG extern&#xA;#endif&#xA;&#xA;/* IO driver Gpio Port and Pin Configuration */&#xA;typedef struct&#xA;{&#xA;    PortName_t  Name_en;    /* Specifies the IO Port module             */&#xA;                            /* This parameter can be a value of @ref    */&#xA;                            /* GpioPort_t                               */&#xA;&#xA;    PinNumber_t PinNo_en;   /* Specifies the IO Pin number              */&#xA;                            /* This parameter can be a value of @ref    */&#xA;                            /* PinNumber_t                              */&#xA;}BoardCfgPortPin_t;&#xA;&#xA;EXTERN_BOARD_CFG const BoardCfgPortPin_t BoardCfgPortPin_sta[4];&#xA;&#xA;EXTERN_BOARD_CFG void BoardCfg_fct();&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;b&gt;main.c&lt;/b&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &quot;common.h&quot;&#xA;#include &quot;port_pin.h&quot;&#xA;#include &quot;board_cfg.h&quot;&#xA;#include &quot;drv_io.h&quot;&#xA;&#xA;int main()&#xA;{&#xA;    BoardCfg_fct();&#xA;&#xA;    printf(&quot;\n\n&quot;);&#xA;&#xA;    return 0;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;b&gt;hal_io.c&lt;/b&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define DEF_HAL_IO&#xA;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &quot;common.h&quot;&#xA;#include &quot;port_pin.h&quot;&#xA;#include &quot;hal_io.h&quot;&#xA;&#xA;void HalIo_fct(PortName_t PortName_en, PinNumber_t PinNo_en)&#xA;{&#xA;    printf(&quot;\nIN HAL\n&quot;);&#xA;    printf(&quot;PORTNAME : %d, PIN NUMBER : %d&quot;, PortName_en, PinNo_en);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;b&gt;drv_io.c&lt;/b&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define DEF_DRV_IO&#xA;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &quot;common.h&quot;&#xA;#include &quot;port_pin.h&quot;&#xA;#include &quot;hal_io.h&quot;&#xA;#include &quot;board_cfg.h&quot;&#xA;#include &quot;drv_io.h&quot;&#xA;&#xA;Status_t DDrvIOPinSet_fct(const BoardCfgPortPin_t *pointer)&#xA;{&#xA;    printf(&quot;\nin DRV IO \n&quot;);&#xA;    HalIo_fct(pointer-&amp;gt;Name_en, pointer-&amp;gt;PinNo_en);&#xA;    return (PASS);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;b&gt;board_cfg.c&lt;/b&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define DEF_BOARD_CFG&#xA;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &quot;common.h&quot;&#xA;#include &quot;port_pin.h&quot;&#xA;#include &quot;drv_io.h&quot;&#xA;#include &quot;board_cfg.h&quot;&#xA;&#xA;const BoardCfgPortPin_t BoardCfgPortPin_sta[4] =&#xA;{&#xA;    { IO_PORT_B, IO_PIN_0 }, /* SENSE_INV_TEMP        */&#xA;    { IO_PORT_B, IO_PIN_1 }, /* SENSE_INV_AC          */&#xA;    { IO_PORT_B, IO_PIN_2 }, /* BUZZER                */&#xA;    { IO_PORT_B, IO_PIN_3 }, /* STAUS_230V_AC         */&#xA;};&#xA;&#xA;void BoardCfg_fct()&#xA;{&#xA;    DDrvIOPinSet_fct(&amp;amp;BoardCfgPortPin_sta[0]);&#xA;    DDrvIOPinSet_fct(&amp;amp;BoardCfgPortPin_sta[1]);&#xA;    DDrvIOPinSet_fct(&amp;amp;BoardCfgPortPin_sta[2]);&#xA;    DDrvIOPinSet_fct(&amp;amp;BoardCfgPortPin_sta[3]);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Regarding the above files, when I try to compile the code I am getting the following errors:&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;drv_io.h(10): error C2143: syntax error : missing ')' before '*'&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;drv_io.h(10): error C2143: syntax error : missing '{' before '*'&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;drv_io.h(10): error C2059: syntax error : ')'&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;If I comment the code in board_cfg.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* IO driver Gpio Port and Pin Configuration */&#xA;typedef struct&#xA;{&#xA;    PortName_t  Name_en;    /* Specifies the IO Port module             */&#xA;                            /* This parameter can be a value of @ref    */&#xA;                            /* GpioPort_t                               */&#xA;&#xA;    PinNumber_t PinNo_en;   /* Specifies the IO Pin number              */&#xA;                            /* This parameter can be a value of @ref    */&#xA;                           /* PinNumber_t                              */&#xA;}BoardCfgPortPin_t;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and add it to port_pin.h, I could compile the code successfully.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;But I need to have the struct in board_cfg.h only&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Why am I getting this error?&lt;/p&gt;&#xA;" OwnerUserId="1093152" LastEditorUserId="1687119" LastEditDate="2016-10-21T18:13:25.357" LastActivityDate="2016-10-21T18:13:25.357" Title="error in struct decleration in header files" Tags="&lt;c&gt;" AnswerCount="2" CommentCount="2" />
  <row Id="40504228" PostTypeId="1" CreationDate="2016-11-09T10:01:34.710" Score="0" ViewCount="18" Body="&lt;p&gt;I am new here to programming. I have an issue regarding saving the outputs of a loop to .csv file. &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;iostream&amp;gt;&#xA;#include &amp;lt;string&amp;gt;&#xA;&#xA;#include &amp;lt;cstdlib&amp;gt;&#xA;#include &amp;lt;fstream&amp;gt;&#xA;#include &amp;lt;ios&amp;gt;&#xA;#include &amp;lt;iomanip&amp;gt;&#xA;#include &amp;lt;sstream&amp;gt;&#xA;&#xA;&#xA;#include &quot;opencv2/highgui/highgui.hpp&quot;&#xA;#include &quot;opencv2/imgproc/imgproc.hpp&quot;&#xA;#include &quot;opencv2/videoio/videoio.hpp&quot;&#xA;&#xA;#include &quot;opencv2/core/cvdef.h&quot;&#xA;#include &amp;lt;cstddef&amp;gt;&#xA;#include &amp;lt;cstring&amp;gt;&#xA;#include &amp;lt;cctype&amp;gt;&#xA;&#xA;#include &amp;lt;algorithm&amp;gt;&#xA;#include &amp;lt;utility&amp;gt;&#xA;#include &amp;lt;cstdlib&amp;gt;&#xA;#include &amp;lt;cmath&amp;gt;&#xA;#include &quot;opencv2/core/ptr.inl.hpp&quot;&#xA;&#xA;#include &quot;dirent.h&quot;&#xA;#include &quot;windows.h&quot;&#xA;&#xA;#include &amp;lt;stdio.h&amp;gt;&#xA;#include &amp;lt;iostream&amp;gt;&#xA;#include &quot;opencv2/core.hpp&quot;&#xA;#include &quot;opencv2/features2d.hpp&quot;&#xA;&#xA;#include &quot;opencv2/flann/miniflann.hpp&quot;&#xA;#include &quot;opencv2/highgui.hpp&quot;&#xA;&#xA;#include &amp;lt;opencv2/calib3d/calib3d.hpp&amp;gt;&#xA;&#xA;#include &quot;opencv2/core/core.hpp&quot;&#xA;#include &quot;opencv2/features2d/features2d.hpp&quot;&#xA;&#xA;&#xA;&#xA;using namespace cv;&#xA;using namespace std;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;#define SHOW_RESULTS &#xA;typedef long SLONG;&#xA;typedef LARGE_INTEGER TIMER;&#xA;static SLONG&#xA;flag_timer_setup = 0;&#xA;static LARGE_INTEGER&#xA;lpTimerFrequency;&#xA;&#xA;//-------------------------------------------------------&#xA;void SYS_reset_timer ( TIMER *tick )&#xA;//-------------------------------------------------------&#xA;{&#xA;if( flag_timer_setup == 0)&#xA;{&#xA;QueryPerformanceFrequency(&amp;amp;lpTimerFrequency);&#xA;flag_timer_setup = 1;&#xA;}&#xA;&#xA;QueryPerformanceCounter( tick );&#xA;&#xA;}&#xA;&#xA;//-------------------------------------------------------&#xA;SLONG SYS_get_timer_us           ( TIMER *tick)&#xA;//-------------------------------------------------------&#xA;{&#xA;TIMER&#xA;lpPerformanceCountEnd;&#xA;QueryPerformanceCounter( &amp;amp;lpPerformanceCountEnd );&#xA;&#xA;return ((SLONG)(0xFFFFFFFF &amp;amp; ((lpPerformanceCountEnd.QuadPart - tick-&amp;gt;QuadPart) * 1000000L / lpTimerFrequency.QuadPart)) );&#xA;}&#xA;&#xA;int testBlur(Mat sourceImage, Mat &amp;amp; destinationImage, float &amp;amp; time)&#xA;{&#xA;&#xA;TIMER tic;&#xA;&#xA;/// test parameters&#xA;int filterSize = 11;&#xA;int N = 1000;&#xA;int time1;&#xA;if( sourceImage.empty()) // Check for invalid input&#xA;{&#xA;cout &amp;lt;&amp;lt;  &quot;Invelid input image&quot; &amp;lt;&amp;lt; std::endl ;&#xA;return -1;&#xA;}&#xA;&#xA;&#xA;for (filterSize =1; filterSize &amp;lt;11; filterSize+=1)&#xA;{&#xA;    SYS_reset_timer(&amp;amp;tic);  &#xA;&#xA;for(int i =0; i&amp;lt;N; i++)&#xA;{&#xA;    // filter the image&#xA;    blur(sourceImage, destinationImage, cvSize(filterSize, filterSize));&#xA;&#xA;}&#xA;&#xA;SLONG elapsed_time = SYS_get_timer_us(&amp;amp;tic);&#xA;float elapsed_time_seconds = elapsed_time/1000.0f;&#xA;float el = (elapsed_time_seconds)/N;&#xA;&#xA;cout&amp;lt;&amp;lt; &quot;blur&quot;&amp;lt;&amp;lt; el&amp;lt;&amp;lt;endl;&#xA;time = el;&#xA;}&#xA;&#xA;&#xA;return 0;&#xA;&#xA;}&#xA;&#xA;int main(int argc, const char* argv[])&#xA;&#xA;{&#xA;Mat sourceImage, destImage, temp, desttImage, detect;&#xA;Mat grad,src,distanceTransform;&#xA;int scale = 1;&#xA;int delta = 0;&#xA;float time;&#xA;int ddepth = -1;    &#xA;&#xA;&#xA;////////&#xA;ofstream myfile;&#xA;myfile.open (&quot;Elapsed Time For Image Filtering.csv&quot;);&#xA;&#xA;//load image&#xA;sourceImage = imread(&quot;../images/man.tiff&quot;,IMREAD_GRAYSCALE); // load and convert to grayscale&#xA;if( sourceImage.empty() )                      // Check for invalid input                                           &#xA;{&#xA;cout &amp;lt;&amp;lt;  &quot;Could not open or find the image&quot; &amp;lt;&amp;lt; std::endl ;&#xA;return -1;&#xA;}&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;// call test function for blur&#xA;testBlur(sourceImage, destImage,time);&#xA;myfile &amp;lt;&amp;lt; &quot;Blur;&quot;&amp;lt;&amp;lt;time&amp;lt;&amp;lt;time&amp;lt;&amp;lt;endl;&#xA;imwrite(&quot;blur.bmp&quot;, destImage);&#xA;&#xA;//show results&#xA;#ifdef  SHOW_RESULTS&#xA;namedWindow( &quot;Display window&quot;, WINDOW_AUTOSIZE ); // Create a window for display.&#xA;imshow( &quot;Display window&quot;, destImage );                // Show our image inside it.&#xA;//waitKey(0); // Wait for a keystroke in the window&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I converted the images and used some filter function and added timer to test the tick and toc and I added the for loop by  hanging the value of the filtersize and I'm unable to save the ten outputs of the testblur to .csv file. Please let me know how should print the output of the for loop of test blur to the .csv file.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thanks in advance&lt;/p&gt;&#xA;" OwnerUserId="7110539" LastEditorUserId="1174942" LastEditDate="2016-11-09T12:29:08.767" LastActivityDate="2016-11-09T12:29:08.767" Title="Issue regarding saving the outputs of a loop to .csv file" Tags="&lt;c++&gt;&lt;csv&gt;" AnswerCount="0" CommentCount="3" />
  <row Id="40622976" PostTypeId="1" CreationDate="2016-11-16T02:14:05.277" Score="6" ViewCount="64" Body="&lt;p&gt;Consider the following code:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;template&amp;lt;typename&amp;gt;&#xA;struct One {};&#xA;&#xA;template&amp;lt;typename, typename&amp;gt;&#xA;struct Two {};&#xA;&#xA;template&amp;lt;template&amp;lt;typename...&amp;gt; class TTP, typename...&amp;gt;&#xA;struct SS;&#xA;&#xA;#ifdef    TEST_TTP&#xA;    template&amp;lt;template&amp;lt;typename&amp;gt; class OneParam,&#xA;             typename... Ts&amp;gt;&#xA;    struct SS&amp;lt;OneParam, Ts...&amp;gt; {};&#xA;&#xA;    template&amp;lt;template&amp;lt;typename, typename&amp;gt; class TwoParam,&#xA;             typename... Ts&amp;gt;&#xA;    struct SS&amp;lt;TwoParam, Ts...&amp;gt; {};&#xA;#else  // TEST_TTP&#xA;    template&amp;lt;template&amp;lt;typename&amp;gt; class OneParam,&#xA;             typename TParam&amp;gt;&#xA;    struct SS&amp;lt;OneParam, TParam&amp;gt; {};&#xA;&#xA;    template&amp;lt;template&amp;lt;typename, typename&amp;gt; class TwoParam,&#xA;             typename TParam1,&#xA;             typename TParam2&amp;gt;&#xA;    struct SS&amp;lt;TwoParam, TParam1, TParam2&amp;gt; {};&#xA;#endif // TEST_TTP&#xA;&#xA;int main() {&#xA;    SS&amp;lt;One, int&amp;gt;       ssoi;&#xA;    SS&amp;lt;Two, int, int&amp;gt; sstii;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;This code will compile properly on Clang, GCC, and MSVC, if &lt;code&gt;TEST_TTP&lt;/code&gt; isn't defined.  However, if it &lt;em&gt;is&lt;/em&gt; defined...&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The code compiles properly on GCC, indicating that it recognises that &lt;code&gt;OneParam&lt;/code&gt; and &lt;code&gt;TwoParam&lt;/code&gt; are distinct from &lt;code&gt;TTP&lt;/code&gt; in the primary template.&lt;/li&gt;&#xA;&lt;li&gt;Clang fails to recognise that &lt;code&gt;OneParam&lt;/code&gt; specialises &lt;code&gt;TTP&lt;/code&gt;, causing it to emit two errors (the first being that the partial specialisation doesn't specialise any template parameters, and the second being that &lt;code&gt;OneParam&lt;/code&gt; conflicts with the previously-declared template template parameter).  It then emits similar errors for &lt;code&gt;TwoParam&lt;/code&gt; (the first is identical, while the second says that the template template parameter has too many parameters), and an error for each instantiation of &lt;code&gt;SS&lt;/code&gt; (because it considers the template to be undefined), for a total of 6 errors.&lt;/li&gt;&#xA;&lt;li&gt;MSVC emits similar errors to Clang, but more concisely: It emits C3855 (&lt;code&gt;OneParam&lt;/code&gt; is incompatible with the primary template), and a C2079 (variable uses undefined type) for each instantiation of &lt;code&gt;SS&lt;/code&gt;, for a total of 3 errors.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;Demonstrated live &lt;a href=&quot;http://coliru.stacked-crooked.com/a/f145f13504935246&quot; rel=&quot;nofollow noreferrer&quot;&gt;on Coliru&lt;/a&gt;.&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;p&gt;From my testing:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;GCC allows a template with a template template parameter which takes a variadic parameter pack to be partially specialised based solely on the number of parameters that template template parameter takes. Clang and MSVC do not.&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;template&amp;lt;template&amp;lt;typename...&amp;gt;        class T&amp;gt; struct S;&#xA;template&amp;lt;template&amp;lt;typename&amp;gt;           class T&amp;gt; struct S&amp;lt;T&amp;gt; {}; // Only works with GCC.&#xA;template&amp;lt;template&amp;lt;typename, typename&amp;gt; class T&amp;gt; struct S&amp;lt;T&amp;gt; {}; // Only works with GCC.&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Clang and MSVC are fine with this if other parameters are also specialised, however.&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;template&amp;lt;template&amp;lt;typename...&amp;gt; class T, typename... Ts&amp;gt; struct S;&#xA;&#xA;template&amp;lt;template&amp;lt;typename&amp;gt; class T,&#xA;         typename TParam&amp;gt;&#xA;struct S&amp;lt;T, TParam&amp;gt; {};&#xA;&#xA;template&amp;lt;template&amp;lt;typename, typename&amp;gt; class T,&#xA;         typename TParam1,&#xA;         typename TParam2&amp;gt;&#xA;struct S&amp;lt;T, TParam1, TParam2&amp;gt; {};&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;It would thus appear that either the former isn't legal C++, or it isn't properly supported by Clang and MSVC.  So, the question is this:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Considering this, what is the proper, legal syntax for partially specialising a template, which contains a template template parameter, based on the number of parameters that template template parameter takes? If there is no legal syntax for this, is supporting it a GCC extension and/or bug?&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;sup&gt;If a full record of the tests I performed, along with the original example which prompted this question, are desired, please see the edit history.&lt;/sup&gt;&lt;/p&gt;&#xA;" OwnerUserId="5386374" LastEditorUserId="5386374" LastEditDate="2016-12-09T02:18:50.080" LastActivityDate="2016-12-09T02:18:50.080" Title="What is the syntax for partially specialising a template based on the number of parameters a template template parameter takes?" Tags="&lt;c++&gt;&lt;visual-c++&gt;&lt;g++&gt;&lt;clang++&gt;&lt;template-templates&gt;" AnswerCount="0" CommentCount="0" />
  <row Id="40836919" PostTypeId="1" CreationDate="2016-11-28T03:52:40.867" Score="0" ViewCount="47" Body="&lt;p&gt;I want my emacs to change code color to gray if the macro undefined, and also, in the case of #ifdef #else, a proper indent is needed too.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#define MY_MACRO&#xA;#ifdef MY_MACRO&#xA;int foo = 0;//proper indent, normal color&#xA;#else&#xA;int bar = 0;//proper indent, and gray color&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="6243726" LastEditorUserId="729907" LastEditDate="2016-11-28T05:34:45.350" LastActivityDate="2016-11-28T15:55:00.113" Title="emacs, #ifdef macro color change, and indent" Tags="&lt;emacs&gt;&lt;syntax-highlighting&gt;&lt;font-lock&gt;" AnswerCount="1" CommentCount="0" FavoriteCount="1" />
  <row Id="40881069" PostTypeId="1" AcceptedAnswerId="40881129" CreationDate="2016-11-30T05:38:26.627" Score="-1" ViewCount="21" Body="&lt;p&gt;How would I implement sleep and usleep in a header file. This is what I've tried so far and it isn't working. I am not quite proficient in c++ yet. I know that it is possible to do something similar in HTML by commenting out and each browser uses the code specific to it.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This is the sample I'm practicing with:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;help.cpp&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;iostream&amp;gt;&#xA;#include &quot;pause.h&quot;&#xA;&#xA;using namespace std;&#xA;&#xA;&#xA;int main() {&#xA;&#xA;pause p;    &#xA;&#xA;cout &amp;lt;&amp;lt; &quot;Hello&quot;;&#xA;&#xA;p.pause(5000)&#xA;&#xA;cout &amp;lt;&amp;lt; &quot; World&quot;;&#xA;&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Someone in another thread suggested using #ifdef #else #endif to get it to work between windows and linux/unix&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;pause.h&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef _WIN32&#xA;    #include &amp;lt;windows.h&amp;gt;&#xA;&#xA;&#xA;class pause&#xA;{&#xA;    public:&#xA;        void pause(unsigned milliseconds)&#xA;        {&#xA;            Sleep(milliseconds);&#xA;        }&#xA;};&#xA;&#xA;#else&#xA;        #include &amp;lt;unistd.h&amp;gt;&#xA;&#xA;class pause&#xA;{&#xA;    public:&#xA;        void pause(unsigned milliseconds)&#xA;        {&#xA;            usleep(milliseconds * 1000); // takes microseconds&#xA;        }&#xA;};&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Somehow though, I must have written the class incorrectly because running my .cpp file it is not recognizing the class or object I tried creating.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Error&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;Running /home/ubuntu/workspace/help.cpp&#xA;In file included from /home/ubuntu/workspace/help.cpp:2:0:&#xA;/home/ubuntu/workspace/pause.h:20:41: error: return type specification for constructor invalid&#xA;         void pause(unsigned milliseconds)&#xA;                                         ^&#xA;/home/ubuntu/workspace/help.cpp: In function ‘int main()’:&#xA;/home/ubuntu/workspace/help.cpp:9:7: error: expected ‘;’ before ‘p’&#xA; pause p;    &#xA;       ^&#xA;/home/ubuntu/workspace/help.cpp:13:1: error: ‘p’ was not declared in this scope&#xA; p.pause(5000)&#xA; ^&#xA;/home/ubuntu/workspace/help.cpp:15:1: error: expected ‘;’ before ‘cout’&#xA; cout &amp;lt;&amp;lt; &quot; World&quot;;&#xA; ^&#xA;&#xA;&#xA;Process exited with code: 1&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="7228990" LastActivityDate="2016-11-30T06:04:11.087" Title="Using sleep and usleep interchangeably by creating a class that decides which one to use" Tags="&lt;c++&gt;&lt;function&gt;&lt;class&gt;&lt;header&gt;&lt;sleep&gt;" AnswerCount="2" CommentCount="2" />
  <row Id="40895677" PostTypeId="1" CreationDate="2016-11-30T18:31:49.313" Score="1" ViewCount="19" Body="&lt;p&gt;In the quest for optimal matrix-matrix multiplication using eigen3 (and hopefully profiting from SIMD support) I wrote the following test:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &amp;lt;iostream&amp;gt;&#xA;#include &amp;lt;Eigen/Dense&amp;gt;&#xA;#include &amp;lt;ctime&amp;gt;&#xA;&#xA;using namespace Eigen;&#xA;using namespace std;&#xA;&#xA;const int test_size= 13;&#xA;const int test_size_16b= test_size+1;&#xA;&#xA;typedef Matrix&amp;lt;double, Dynamic, Dynamic, ColMajor, test_size_16b,     test_size_16b&amp;gt; TestMatrix_dyn16b_t;&#xA;typedef Matrix&amp;lt;double, Dynamic, Dynamic&amp;gt; TestMatrix_dynalloc_t;&#xA;typedef Matrix&amp;lt;double, test_size, test_size&amp;gt; TestMatrix_t;&#xA;typedef Matrix&amp;lt;double, test_size_16b, test_size_16b&amp;gt; TestMatrix_fix16b_t;&#xA;&#xA;template&amp;lt;typename TestMatrix_t&amp;gt; EIGEN_DONT_INLINE void test(const char * msg, int m_size= test_size, int n= 10000) {&#xA;    double s= 0.0;&#xA;    clock_t elapsed= 0;&#xA;    TestMatrix_t m3;&#xA;    for(int i= 0; i&amp;lt;n; i++) {&#xA;        TestMatrix_t m1 = TestMatrix_t::Random(m_size, m_size);&#xA;        TestMatrix_t m2= TestMatrix_t::Random(m_size, m_size);&#xA;&#xA;        clock_t begin = clock();&#xA;        m3.noalias()= m1*m2;&#xA;        clock_t end = clock();&#xA;        elapsed+= end - begin;&#xA;&#xA;        // make sure m3 is not optimized away&#xA;        s+= m3(1, 1);&#xA;    }&#xA;&#xA;    double elapsed_secs = double(elapsed) / CLOCKS_PER_SEC;&#xA;    cout &amp;lt;&amp;lt; &quot;Elapsed time &quot; &amp;lt;&amp;lt; msg &amp;lt;&amp;lt; &quot;: &quot; &amp;lt;&amp;lt; elapsed_secs &amp;lt;&amp;lt; &quot; size &quot; &amp;lt;&amp;lt; m3.cols() &amp;lt;&amp;lt; &quot;, &quot; &amp;lt;&amp;lt; m3.rows() &amp;lt;&amp;lt; endl;&#xA;}&#xA;&#xA;int main() {&#xA;#ifdef  EIGEN_VECTORIZE&#xA;    cout &amp;lt;&amp;lt; &quot;EIGEN_VECTORIZE on &quot; &amp;lt;&amp;lt; endl;&#xA;#endif&#xA;&#xA;    test&amp;lt;TestMatrix_t&amp;gt;         (&quot;normal   &quot;);&#xA;    test&amp;lt;TestMatrix_dyn16b_t&amp;gt;  (&quot;dyn 16b  &quot;);&#xA;    test&amp;lt;TestMatrix_dynalloc_t&amp;gt;(&quot;dyn alloc&quot;);&#xA;    test&amp;lt;TestMatrix_fix16b_t&amp;gt;  (&quot;fix 16b  &quot;, test_size_16b);&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;compiled with &lt;code&gt;g++ -msse3 -O2 -DEIGEN_DONT_PARALLELIZE test.cpp&lt;/code&gt; and ran it on an Athlon II X2 255. The result rather surprised me:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;EIGEN_VECTORIZE on &#xA;Elapsed time normal   : 0.019193 size 13, 13&#xA;Elapsed time dyn 16b  : 0.025226 size 13, 13&#xA;Elapsed time dyn alloc: 0.018648 size 13, 13&#xA;Elapsed time fix 16b  : 0.018221 size 14, 14&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Similar results are attained with other odd numbers for &lt;code&gt;test_size&lt;/code&gt;. What confuses me is this:&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;From reading &lt;a href=&quot;http://eigen.tuxfamily.org/index.php?title=FAQ#Vectorization&quot; rel=&quot;nofollow noreferrer&quot;&gt;Eigen Vectorization FAQ&lt;/a&gt; I would have thought that a 13x13 matrix has no multiple of 16 bytes size and thus will not profit from SIMD optimization. I expected the computation time to be much worse but it isn't.&lt;/li&gt;&#xA;&lt;li&gt;From reading about &lt;a href=&quot;http://eigen.tuxfamily.org/dox/group__TutorialMatrixClass.html&quot; rel=&quot;nofollow noreferrer&quot;&gt;Optional template parameters&lt;/a&gt; I would have thought that dynamic matrices with fixed upper bound known at compile time would behave much like dynamically allocated matrices an thus would have a similar computation speed. But they don't. That's actually what surprises me the most and what triggered my initial quest: I wanted to know if it is better to use a dynamic matrix with fixed upper bound that is a multiple of 16 bytes than a fixed size matrix whos size is not a multiple of 16 bytes.&lt;/li&gt;&#xA;&lt;li&gt;Finally interesting but not so much surprising: a matrix whos fixed size is a multiple of 16 is no slower that that of a matrix whos col and row length is one less. SIMD just does the extra col and row for free.&lt;/li&gt;&#xA;&lt;li&gt;Not my original question but also interesting: when the test is compiled without SSE2 support and thus without vectorization the relative computation times are roughly proportional. The dynamically sized fixed memory matrix is again slowest.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;To put my question short: why is &lt;code&gt;Matrix&amp;lt;double, Dynamic, Dynamic, ColMajor, test_size_16b, test_size_16b&amp;gt;&lt;/code&gt; so much slower? Can you confirm my observations and maybe even explain them?&lt;/p&gt;&#xA;" OwnerUserId="7232220" LastActivityDate="2016-11-30T21:26:38.010" Title="Performance issue with matrix-matrix multiplication involving MaxRowsAtCompileTime / MaxColsAtCompileTime" Tags="&lt;gcc&gt;&lt;matrix&gt;&lt;eigen&gt;&lt;eigen3&gt;" AnswerCount="1" CommentCount="0" />
  <row Id="40978316" PostTypeId="1" AcceptedAnswerId="40978559" CreationDate="2016-12-05T16:01:42.430" Score="1" ViewCount="87" Body="&lt;p&gt;Given the following code in a project I'm working on:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;/* Pre-definitions in a pre-definitions file to be included in the project */&#xA;#ifdef  WIN32&#xA;#define __FUNCNAME__ __FUNCTION__&#xA;#else&#xA;#define __FUNCNAME__ __func__  &#xA;#endif&#xA;&#xA;/* My definitions */&#xA;#define MAC() \&#xA;     MAC1()&#xA;&#xA;#define MAC1() \&#xA;     myPrintFunction(__FUNCNAME__)&#xA;&#xA;/* My print function */&#xA;void myPrintFunction(const char * functionName)&#xA;{&#xA;     printf(&quot;\n func name: %s \n&quot;,functionName);&#xA;}&#xA;&#xA;/* Macro usage example function */&#xA;void myFunction()&#xA;{&#xA;     if (some_condition)&#xA;     {&#xA;         MAC();&#xA;     }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;The function name is presented as an empty string.&#xA;Any idea why, and how can I fix it?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Code compiled and tested on Linux machine, using GCC compiler.&lt;/p&gt;&#xA;" OwnerUserId="2162550" LastEditorUserId="2162550" LastEditDate="2016-12-05T16:08:12.720" LastActivityDate="2016-12-05T18:09:15.150" Title="GCC __func__ gets evaluated to an empty string" Tags="&lt;c&gt;&lt;gcc&gt;&lt;c-preprocessor&gt;&lt;string-literals&gt;" AnswerCount="2" CommentCount="9" />
  <row Id="41235819" PostTypeId="1" CreationDate="2016-12-20T06:00:07.560" Score="0" ViewCount="32" Body="&lt;p&gt;I have a visibity support in my code, taken from &lt;a href=&quot;https://gcc.gnu.org/wiki/Visibility&quot; rel=&quot;nofollow noreferrer&quot;&gt;https://gcc.gnu.org/wiki/Visibility&lt;/a&gt; &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is the file pexp.h&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#pragma once&#xA;&#xA;#if defined _WIN32 || defined __CYGWIN__&#xA;  #ifdef BUILDING_DLL&#xA;    #ifdef __GNUC__&#xA;      #define P_EXPORT __attribute__ ((dllexport))&#xA;    #else&#xA;      #define P_EXPORT __declspec(dllexport) // Note: actually gcc seems to also supports this syntax.&#xA;    #endif&#xA;  #else&#xA;    #ifdef __GNUC__&#xA;      #define P_EXPORT __attribute__ ((dllimport))&#xA;    #else&#xA;      #define P_EXPORT __declspec(dllexport) // Note: actually gcc seems to also supports this syntax.&#xA;    #endif&#xA;  #endif&#xA;  #define P_HIDDEN&#xA;#else&#xA;  #if __GNUC__ &amp;gt;= 4&#xA;    #define P_EXPORT __attribute__ ((visibility (&quot;default&quot;)))&#xA;    #define P_HIDDEN  __attribute__ ((visibility (&quot;hidden&quot;)))&#xA;  #else&#xA;    #define P_EXPORT&#xA;    #define P_HIDDEN&#xA;  #endif&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;one of the header file (lets say gs.h) has function declartions as&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef _GS_&#xA;#define _GS_&#xA;&#xA;    #ifdef  __cplusplus&#xA;    extern &quot;C&quot; {&#xA;    #endif&#xA;&#xA;    #define OK        1&#xA;    ...&#xA;    int     gs_resume(int pid);&#xA;    ...&#xA;&#xA;    #ifdef  __cplusplus&#xA;    }&#xA;    #endif&#xA;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;and in gs.c, some of the functions are defined as&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;P_EXPORT int gs_resume(int pid)&#xA;{&#xA;    ...&#xA;    HANDLE hThread = (HANDLE) pid;&#xA;    ....&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Code is a mix of .c and .cpp files. Methods which has visibility as P_EXPORT is getting used in .cpp files also.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;While compiling I am getting below error&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;error C2375: 'gs_resume': redefinition; different linkage&#xA;.....            note: see declaration of 'gs_resume'&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Tried the suggestions mentioned in below link&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/3677157/error-c2375-redefinition-different-linkage&quot;&gt;error C2375: redefinition; different linkage&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/11726958/cant-include-winsock2-h-in-msvc-2010&quot;&gt;Can&amp;#39;t include Winsock2.h in MSVC 2010&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;But no luck :)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;If I add P_EXPORT in method declaration, then I am getting more errors like&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;...&#xA;error C2054: expected '(' to follow 'P_EXPORT'&#xA;error C2085: 'gs_resume': not in formal parameter list&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Please suggest&lt;/p&gt;&#xA;" OwnerUserId="3381858" LastActivityDate="2016-12-20T06:00:07.560" Title="visibility support + error C2375: redefinition; different linkage" Tags="&lt;c++&gt;&lt;c&gt;" AnswerCount="0" CommentCount="1" />
  <row Id="41783677" PostTypeId="1" CreationDate="2017-01-21T19:40:49.450" Score="0" ViewCount="13" Body="&lt;p&gt;I'm trying to build Qt 4.7.4 with msvc2010 and DB2 support. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is my command line:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;C:\qt-src-4.7.4&amp;gt;configure -opensource -static -release -platform win32-msvc2010&#xA;-qt-sql-db2 -qt-sql-odbc -I &quot;C:\sqllib\include&quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Headers file here - part of IBM package, but &lt;code&gt;nmake&lt;/code&gt; tells me that there are bunch of errors in code:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;        c:\sqllib\include\sqlcli.h(669): see defenition of &quot;SQLColAttributeW&quot;&#xA;c:\sqllib\include\sqlcli.h(685) : error C2733: second С-linkage of overloaded&#xA; functuin &quot;SQLConnectW&quot; not allowed&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;However, header files are organized two function versions - unicode and non-unicode.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Here is how it's look like:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;sqlcli1.h:&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include    &quot;sqlcli.h&quot;&#xA;...&#xA;#ifdef ODBC64&#xA;SQLRETURN SQL_API SQLColAttributeW(&#xA;    SQLHSTMT        hstmt,&#xA;    SQLUSMALLINT    iCol,&#xA;    SQLUSMALLINT    iField,&#xA;    SQLPOINTER      pCharAttr,&#xA;    SQLSMALLINT     cbCharAttrMax,&#xA;    SQLSMALLINT     *pcbCharAttr,&#xA;    SQLLEN          *pNumAttr);&#xA;#else&#xA;    SQLRETURN SQL_API SQLColAttributeW(&#xA;    SQLHSTMT        hstmt,&#xA;    SQLUSMALLINT    iCol,&#xA;    SQLUSMALLINT    iField,&#xA;    SQLPOINTER      pCharAttr,&#xA;    SQLSMALLINT     cbCharAttrMax,&#xA;    SQLSMALLINT  *pcbCharAttr,&#xA;    SQLPOINTER      pNumAttr);&#xA;#endif&#xA;...&#xA;SQLRETURN SQL_API SQLConnectW(&#xA;    SQLHDBC            hdbc,&#xA;    SQLWCHAR        *szDSN,&#xA;    SQLSMALLINT        cbDSN,&#xA;    SQLWCHAR        *szUID,&#xA;    SQLSMALLINT        cbUID,&#xA;    SQLWCHAR        *szAuthStr,&#xA;    SQLSMALLINT        cbAuthStr);&#xA; ...&#xA;&#xA;#ifdef  UNICODE&#xA;#define SQLColAttribute     SQLColAttributeW&#xA;...&#xA;#define SQLColAttributes    SQLconnectW&#xA;...&#xA;#endif UNICODE&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;sqlcli.h:&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef ODBC64&#xA;SQLRETURN SQL_API_FN  SQLColAttribute  (SQLHSTMT          hstmt,&#xA;                                        SQLUSMALLINT      icol,&#xA;                                        SQLUSMALLINT      fDescType,&#xA;                                        SQLPOINTER        rgbDesc,&#xA;                                        SQLSMALLINT       cbDescMax,&#xA;                                        SQLSMALLINT FAR   *pcbDesc,&#xA;                                        SQLLEN            *pfDesc);&#xA;#else&#xA;SQLRETURN SQL_API_FN  SQLColAttribute  (SQLHSTMT          hstmt,&#xA;                                        SQLUSMALLINT      icol,&#xA;                                        SQLUSMALLINT      fDescType,&#xA;                                        SQLPOINTER        rgbDesc,&#xA;                                        SQLSMALLINT       cbDescMax,&#xA;                                        SQLSMALLINT FAR   *pcbDesc,&#xA;                                        SQLPOINTER        pfDesc);&#xA;#endif&#xA;&#xA;&#xA;&#xA;SQLRETURN SQL_API_FN  SQLConnect       (SQLHDBC           hdbc,&#xA;                                        SQLCHAR     FAR   *szDSN,&#xA;                                        SQLSMALLINT       cbDSN,&#xA;                                        SQLCHAR     FAR   *szUID,&#xA;                                        SQLSMALLINT       cbUID,&#xA;                                        SQLCHAR     FAR   *szAuthStr,&#xA;                                        SQLSMALLINT       cbAuthStr);&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;So, as far, as I understood that thing is pretty basically tries to keep comaptibility with unicode and ANSI. But the functions &lt;code&gt;SQLConnect&lt;/code&gt; and &lt;code&gt;SQLConnectW&lt;/code&gt; should not lead to double linkage, do they?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;My question is how should I change the source to eliminate double linkage and not to break compatibility for both unicode and ansi?&lt;/p&gt;&#xA;" OwnerUserId="2801364" LastActivityDate="2017-01-21T19:40:49.450" Title="Second C-linkage C2773 in unicode and non-unicode function defenition" Tags="&lt;c++&gt;&lt;qt&gt;&lt;visual-studio-2010&gt;&lt;header-files&gt;&lt;linkage&gt;" AnswerCount="0" CommentCount="0" />
  <row Id="42063553" PostTypeId="1" AcceptedAnswerId="42063923" CreationDate="2017-02-06T08:44:22.867" Score="0" ViewCount="62" Body="&lt;p&gt;The following expression:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;^(#ifdef FEATURE)+?\s*$((\r\n.*?)*^(#endif)+\s*[\/\/]*\s*(end of)*\s*FEATURE)+?$&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Overrides the matching buffer when running my compiled .Jar file.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The matching string can be similar to:&lt;/p&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;  &lt;p&gt;this is a junk line&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;&lt;strong&gt;#ifdef FEATURE&lt;/strong&gt;&lt;br&gt;&#xA;  &lt;strong&gt;#endif // end of FEATURE&lt;/strong&gt;&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;this is a junk line&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;&lt;strong&gt;#ifdef FEATURE&lt;/strong&gt;&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;&lt;strong&gt;this is a junk line that should be matched: HOLasduiqwhei &amp;amp; // FEATURE fjfefj&lt;/strong&gt;&#xA;        &lt;strong&gt;#endif // h&lt;/strong&gt;&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;&lt;strong&gt;#endif FEATURE&lt;/strong&gt;&lt;/p&gt;&#xA;  &#xA;  &lt;p&gt;this is a junk line&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&#xA;&lt;p&gt;So, the bold strings should match. The error is as follows:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;   at java.util.regex.Pattern$GroupHead.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Loop.match(Unknown Source)&#xA;   at java.util.regex.Pattern$GroupTail.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Curly.match1(Unknown Source)&#xA;   at java.util.regex.Pattern$Curly.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Slice.match(Unknown Source)&#xA;   at java.util.regex.Pattern$GroupHead.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Loop.match(Unknown Source)&#xA;   at java.util.regex.Pattern$GroupTail.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Curly.match1(Unknown Source)&#xA;   at java.util.regex.Pattern$Curly.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Slice.match(Unknown Source)&#xA;   at java.util.regex.Pattern$GroupHead.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Loop.match(Unknown Source)&#xA;   at java.util.regex.Pattern$GroupTail.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Curly.match1(Unknown Source)&#xA;   at java.util.regex.Pattern$Curly.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Slice.match(Unknown Source)&#xA;   at java.util.regex.Pattern$GroupHead.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Loop.match(Unknown Source)&#xA;   at java.util.regex.Pattern$GroupTail.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Curly.match1(Unknown Source)&#xA;   at java.util.regex.Pattern$Curly.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Slice.match(Unknown Source)&#xA;   at java.util.regex.Pattern$GroupHead.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Loop.match(Unknown Source)&#xA;   at java.util.regex.Pattern$GroupTail.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Curly.match1(Unknown Source)&#xA;   at java.util.regex.Pattern$Curly.match(Unknown Source)&#xA;   at java.util.regex.Pattern$Slice.match(Unknown Source)&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Any backtracking avoiding strategy/improvement of the expression is welcome. I have tried the atomic groups &lt;code&gt;(?&amp;gt;)&lt;/code&gt; but doesn't simplify, for some reason.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;The code is the following: &lt;/p&gt;&#xA;&#xA;&lt;p&gt;public String strip(String text) {&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;    ArrayList&amp;lt;String&amp;gt; patterns=new ArrayList&amp;lt;String&amp;gt;();&#xA;    patterns=readFile(&quot;Disabled_Features.txt&quot;);&#xA;    for(int i = 0; i &amp;lt; patterns.size(); ++i)&#xA;    {&#xA;&#xA;      Pattern todoPattern = Pattern.compile(&quot;^#ifdef &quot;+patterns.get(i)+&quot;((?:\\r?\\n(?!#endif (?:// end of )?&quot;+patterns.get(i)+&quot;$).*)*)\\r?\\n#endif (?:// end of )?&quot;+patterns.get(i)+&quot;$&quot;,Pattern.MULTILINE); &#xA;&#xA;      Matcher m = todoPattern.matcher(text);&#xA;      text = m.replaceAll(&quot;&quot;);&#xA;    }&#xA;    return text;        &#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="7115106" LastEditorUserId="7115106" LastEditDate="2017-02-06T09:52:19.190" LastActivityDate="2017-02-06T11:29:54.780" Title="Regular Expression backtracks until overflow in Java" Tags="&lt;java&gt;&lt;regex&gt;&lt;pattern-matching&gt;&lt;backtracking&gt;" AnswerCount="2" CommentCount="6" />
  <row Id="42139302" PostTypeId="1" AcceptedAnswerId="42139587" CreationDate="2017-02-09T14:28:57.980" Score="-1" ViewCount="49" Body="&lt;p&gt;I have to filter out from a huge amount of cpp files all the macros defined, excluding the guards, for example:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#if &amp;lt;NAME&amp;gt;&#xA;#ifdef &amp;lt;NAME&amp;gt;&#xA;#ifndef &amp;lt;NAME&amp;gt;&#xA;#if defined(&amp;lt;NAME&amp;gt;)&#xA;#if defined &amp;lt;NAME&amp;gt;&#xA;!defined(&amp;lt;NAME&amp;gt;)&#xA;!defined &amp;lt;NAME&amp;gt;&#xA;#else if &amp;lt;NAME&amp;gt;&#xA;#elif &amp;lt;NAME&amp;gt;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I have to retrieve all the NAMEs, but they are not all in the form &lt;em&gt;XXX&lt;/em&gt;, due to different programmers working on the project, there are a lot of definitions, so I am facing problems in define a regex that can extrapolate only &lt;code&gt;&amp;lt;NAME&amp;gt;&lt;/code&gt; from each of the situations just described. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Any advice is appreciated!&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;EDIT&lt;/strong&gt;&#xA;As someone pointed out, my NAME (with surrondings &amp;lt; ) is only a placeholder, where in reality it can be &lt;em&gt;XXXX&lt;/em&gt;, XXXX, _XX_Y_, _XXX , _XXX_Y, XXYY where X and Y could be uppercase letters or digits, with no regularity in the name! they are directives to the preprocessor and I have to filter them out&lt;/p&gt;&#xA;" OwnerUserId="2648463" LastEditorUserId="2648463" LastEditDate="2017-02-09T14:39:30.197" LastActivityDate="2017-02-09T14:47:51.777" Title="Using regex to filter for preprocessor directives?" Tags="&lt;c++&gt;&lt;regex&gt;&lt;c-preprocessor&gt;&lt;preprocessor-directive&gt;&lt;ifdefine&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="42201335" PostTypeId="1" CreationDate="2017-02-13T10:04:12.757" Score="1" ViewCount="71" Body="&lt;p&gt;I need a regular expression that matches the paragraph: &lt;strong&gt;'&amp;amp;Start a'&lt;/strong&gt;(first in sample text) until &lt;strong&gt;'&amp;amp;end a'&lt;/strong&gt; (last end from sample text). The problem is that sometimes '&amp;amp;end a' is not explicitly specified, and is sometimes written as '&amp;amp;end'. The problem is even bigger when you have '&amp;amp;Start b' and '&amp;amp;end b' (which is sometimes '&amp;amp;end' as well, hence the confusion).&lt;/p&gt;&#xA;&#xA;&lt;p&gt;A sample block of target for this regex is (sorry for putting it as code block):&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;junk text&#xA;&#xA;&amp;amp;Start a &amp;lt;&#xA;&#xA;fulfilling text&#xA;&#xA;fulfilling text&#xA;&#xA;&amp;amp;Start b&#xA;&#xA;&amp;amp;Start c&#xA;&#xA;&amp;amp;end c&#xA;&#xA;fulfilling text&#xA;&#xA;&amp;amp;end&#xA;&#xA;&amp;amp;end &amp;lt;&#xA;&#xA;junk text&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;So the regex should match all paragraph starting and ending with the lines which contain the &amp;lt; symbol, though it's not included in the original text. (i.e. with the &amp;amp;Start X we want, and skipping the '&amp;amp;Start Y' '&amp;amp;end' (or '&amp;amp;end Y') groups until the '&amp;amp;end' (or '&amp;amp;end X') we want.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;This is not a simple implementation. The expression I am working with is the following:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;&amp;amp;start a([^&amp;amp;]*)(&amp;amp;end a|&amp;amp;end) &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Which maches well isolated '&amp;amp;start a' '&amp;amp;end' paragraphs, but when other '&amp;amp;start Y' lines come in between, the script gets confused.&#xA;I might use some If statment that jumps the undesired blocks... Here is a more complicated approach of the case:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;junk text&#xA;&#xA;&amp;amp;Start a &amp;lt;&#xA;&#xA;fulfilling text&#xA;&#xA;fulfilling text&#xA;&#xA;&amp;amp;Start b&#xA;&#xA;&amp;amp;Start c&#xA;&#xA;&amp;amp;end&#xA;&#xA;fulfilling text&#xA;&#xA;&amp;amp;end&#xA;&#xA;&amp;amp;end &amp;lt;&#xA;&#xA;junk text&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Without specifying any '&amp;amp;end'.&#xA;Note1: '&amp;amp;start X' is always defined, but '&amp;amp;end X' can be as well '&amp;amp;end', but always corresponds to the closest start upfront.&#xA;Note2: I can't change much the structure of my regex because of stack overflow errors, but rather adapt it to this specific case.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Sorry for the weird explaination but I hope somebody can find any viable advise.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Thank you&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Edit:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#@ -split &quot;`n&quot; | ForEach-Object { $_.trim() } |&#xA;&#xA;$files = Get-ChildItem &quot;$PSScriptRoot&quot; # root path&#xA;&#xA;for($i=0; $i -lt $files.Count; $i++){&#xA;&#xA;    #iterate through files from the current folder.&#xA;    $data = Get-Content -Path $files[$i].FullName&#xA;&#xA;    # parse DisabledFeatures.txt file as array of strings (1 string per line of the file)&#xA;    $feature = Get-Content DisabledFeatures.txt&#xA;&#xA;    #iterate for each string entry in $feature array (read from txt file)&#xA;    for($counter=0; counter -lt $feature.Count; counter++){&#xA;&#xA;        #retrieve array value to use it in the main algorythm&#xA;        $groupID = &quot;$feature&quot;&#xA;&#xA;        $data | ForEach-Object -Begin { $ignore = $false; $levels = 0 } -Process {&#xA;            #Start ignoring text after we've found the trigger&#xA;            if($_ -match &quot;^`#ifdef $groupID&quot;) { $ignore = $true }   &#xA;            #Track nested groups&#xA;            elseif($ignore) {&#xA;                if ($_ -match '^`#ifdef') { $levels++ }&#xA;                elseif ($_ -match '`#endif') {&#xA;                    if($levels -ge 1) { $levels-- }&#xA;                    #If no nesting, we've hit the end of our targeted group. Stop ignoring&#xA;                    else { $ignore = $false }&#xA;                }&#xA;            }&#xA;            #Write line&#xA;            else { $_ }&#xA;        }  &#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="7115106" LastEditorUserId="7115106" LastEditDate="2017-02-16T09:32:34.170" LastActivityDate="2017-02-16T09:32:34.170" Title="Paragraph conditional nested regular expression (recursion)" Tags="&lt;java&gt;&lt;regex&gt;&lt;powershell&gt;&lt;if-statement&gt;&lt;paragraph&gt;" AnswerCount="1" CommentCount="25" />
  <row Id="42268950" PostTypeId="1" AcceptedAnswerId="42271744" CreationDate="2017-02-16T08:49:39.787" Score="0" ViewCount="30" Body="&lt;p&gt;I am working on following script which tries to read a text file, and then run an algorithm with the collected data. The algorithm must be applied to each file in the current folder, so there are 2 main loops.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Loop 1 is for files in folder.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Loop 2 is for the text line entries used in the algorithm.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Loop 3 is for the algorithm itself.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#$path = (Get-Item -Path &quot;.\&quot; -Verbose).FullName&#xA;$path = split-path -parent $MyInvocation.MyCommand.Definition&#xA;$files = Get-ChildItem &quot;$path\test&quot; -r # root path $PSScriptRoot&#xA;&#xA;#echo $path&#xA;#echo $files&#xA;#echo $files.Count&#xA;ForEach ($file in $files){&#xA;&#xA;    echo &quot;the value of i is&quot; $i&#xA;    #echo $file.FullName&#xA;    #iterate through files from the current folder.&#xA;    $data = Get-Content -Path $files.FullName&#xA;&#xA;    #echo &quot;$data&quot;&#xA;&#xA;    # parse DisabledFeatures.txt file as array of strings (1 string per line of the file)&#xA;    $feature = Get-Content &quot;$path\Disabled_Features.txt&quot;&#xA;    #echo $feature.Count&#xA;    #iterate for each string entry in $feature array (read from txt file)&#xA;    for($counter=0; $counter -lt $feature.Count; $counter++){&#xA;&#xA;        #retrieve array value to use it in the main algorythm&#xA;        $groupID = $feature[$counter]&#xA;        echo $groupID&#xA;        $data | ForEach-Object -Begin { $ignore = $false; $levels = 0 } -Process {&#xA;            #Start ignoring text after we've found the trigger&#xA;            if($_ -match &quot;^#ifdef $groupID&quot;) { &#xA;                $ignore = $true&#xA;                ECHO &quot;TRUE ifdef feature&quot;  &#xA;            } &#xA;&#xA;            #Track nested groups&#xA;            elseif($ignore) {&#xA;                if ($_ -match '^#ifdef') {  &#xA;                    $levels++ &#xA;                    echo &quot;levels++&quot;&#xA;                }&#xA;                elseif ($_ -match '#endif') {&#xA;                    if($levels -ge 1) { $levels-- }&#xA;                    #If no nesting, we've hit the end of our targeted group. Stop ignoring&#xA;                    else { $ignore = $false }&#xA;                    echo &quot;stop ignoring&quot;&#xA;                }&#xA;            }&#xA;            #Write line&#xA;            else { $_ }&#xA;            echo &quot;write line&quot;&#xA;        }  &#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Edit: Updated script.&lt;/p&gt;&#xA;" OwnerUserId="7115106" LastEditorUserId="7115106" LastEditDate="2017-02-16T10:31:18.093" LastActivityDate="2017-02-16T10:49:35.883" Title="PowerShell script to parse files from root folder" Tags="&lt;powershell&gt;&lt;parsing&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="42291816" PostTypeId="1" CreationDate="2017-02-17T07:25:12.927" Score="0" ViewCount="29" Body="&lt;p&gt;I have a script that ignores some blocks of text, but I just don't know how to replace the ignored text into original string, so that it is deleted.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I tried creating an array vector but powershell is doing weird things with assignation, for example $array+=$_ appends more text than it should...&lt;/p&gt;&#xA;&#xA;&lt;p&gt;any help appreciated, here is my script:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#$path = (Get-Item -Path &quot;.\&quot; -Verbose).FullName&#xA;$path = split-path -parent $MyInvocation.MyCommand.Definition&#xA;$files = Get-ChildItem &quot;$path\test&quot; -r # root path $PSScriptRoot&#xA;&#xA;#echo $path&#xA;#echo $files&#xA;#echo $files.Count&#xA;ForEach ($file in $files){&#xA;&#xA;    #echo &quot;the value of i is&quot; $i&#xA;    #echo $file.FullName&#xA;    #iterate through files from the current folder.&#xA;    $data = Get-Content -Path $files.FullName&#xA;&#xA;    #echo &quot;$data&quot;&#xA;&#xA;    # parse DisabledFeatures.txt file as array of strings (1 string per line of the file)&#xA;    $feature = Get-Content &quot;$path\Disabled_Features.txt&quot;&#xA;    echo $feature.Count   &#xA;&#xA;    #[System.Collections.ArrayList]$Modifier&#xA;    $nl=[Environment]::NewLine&#xA;    #iterate for each string entry in $feature array (read from txt file)&#xA;    for($counter=0; $counter -lt $feature.Count; $counter++){&#xA;        #Start ignoring text after we've found the trigger&#xA;        $parse = $feature[$counter]&#xA;        #$Modifier.Clear()&#xA;        $data | ForEach-Object -Begin { &#xA;            $ignore = $false; $levels = 0 &#xA;        } -Process {&#xA;&#xA;            if($_ -match &quot;^#ifdef $parse&quot;) { &#xA;                $ignore = $true &#xA;                #echo &quot;start ignore&quot;&#xA;&#xA;            }if($ignore) { #Track nested groups&#xA;                if ($_ -match &quot;^#ifdef&quot;) {  &#xA;                    $levels++ &#xA;                    #echo &quot;levels++&quot;&#xA;                }elseif ($_ -match &quot;#endif&quot;) {&#xA;                    if($levels -ge 1) { &#xA;                        $levels--&#xA;                        #echo &quot;levels --&quot; &#xA;                    }else { #If no nesting, we've hit the end of our targeted group. Stop ignoring&#xA;                        $ignore = $false &#xA;                        #echo &quot;end ignore&quot;&#xA;                    }&#xA;                }&#xA;            }else {  #Append line&#xA;                $temp=$_&#xA;                $Modifier+=&quot;$temp$nl&quot;&#xA;            }&#xA;        }&#xA;        echo $Modifier &#xA;    }&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="7115106" LastActivityDate="2017-02-17T10:07:55.653" Title="Capture output of Process algo and replace the initial $data string" Tags="&lt;arrays&gt;&lt;string&gt;&lt;powershell&gt;&lt;parsing&gt;&lt;output&gt;" AnswerCount="1" CommentCount="3" />
  <row Id="42298817" PostTypeId="1" AcceptedAnswerId="42299726" CreationDate="2017-02-17T13:08:15.000" Score="0" ViewCount="33" Body="&lt;p&gt;i have the following script but it does never end executing.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;what could be the issue ? I tried to debug it but apparently it works correctly with a single file, but when I throw it against a folder full of content fails.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;$path = split-path -parent $MyInvocation.MyCommand.Definition&#xA;$files = Get-ChildItem &quot;$path\CodeForCertification\5_SourceCode\*&quot; -Include *.c,*.h -Recurse | where{ &#xA;        ! $_.PSIsContainer &#xA;}#$PSScriptRoot&#xA;&#xA;ForEach ($file in $files){&#xA;&#xA;    $data = Get-Content -Path $file.FullName&#xA;    $feature = Get-Content &quot;$path\Disabled_Features.txt&quot;    &#xA;    #[System.ArrayList]$Modifier&#xA;    $nl=[Environment]::NewLine&#xA;    $Modifier=@()&#xA;    $flag=0&#xA;    $data = $data | ForEach-Object -Begin {&#xA;        $ignore = $false; $levels = 0 &#xA;    } -Process {&#xA;        for($counter=0; $counter -lt $feature.Count; $counter++){&#xA;            $parse = $feature[$counter]&#xA;            if($_ -match &quot;^#ifdef $parse&quot; -And $flag -eq '0') {&#xA;                $ignore = $true&#xA;                $flag = 1;&#xA;            }&#xA;        }&#xA;        if($ignore) {&#xA;            if ($_ -match &quot;^#ifdef&quot;) {&#xA;                $levels++ &#xA;            }elseif ($_ -match &quot;#endif&quot;) {&#xA;                if($levels -ge 1) {&#xA;                    $levels--&#xA;                    if($levels -eq '0'){&#xA;                        $ignore = $false&#xA;                    }                        &#xA;                }&#xA;            }&#xA;        }else {&#xA;            $flag=0&#xA;            $temp=$_&#xA;            $_&#xA;            $Modifier+=&quot;$temp&quot;&#xA;        }&#xA;    }&#xA;    $data | Out-File $file.FullName&#xA;}&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="7115106" LastActivityDate="2017-02-17T13:55:34.833" Title="parsing script never ends" Tags="&lt;powershell&gt;&lt;parsing&gt;&lt;infinite-loop&gt;" AnswerCount="1" CommentCount="4" />
  <row Id="42356633" PostTypeId="1" CreationDate="2017-02-21T00:32:52.177" Score="1" ViewCount="59" Body="&lt;p&gt;I am using CMake to generate some build environments:&lt;/p&gt;&#xA;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;p&gt;&lt;code&gt;cmake .. -G &quot;Unix Makefiles&quot; -DCMAKE_BUILD_TYPE=Debug -DBUILD_SHARED_LIBS=TRUE&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;p&gt;&lt;code&gt;cmake .. -G &quot;Unix Makefiles&quot; -DCMAKE_BUILD_TYPE=Release -DBUILD_SHARED_LIBS=TRUE&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;cmake ..  -DCMAKE_WINDOWS_EXPORT_ALL_SYMBOLS=TRUE -DBUILD_SHARED_LIBS=TRUE -G &quot;Visual Studio 14 2015 Win64&quot;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;p&gt;The first and third environments builds successfully (Whether I select &quot;Debug&quot; or &quot;Release&quot;) but the second one has a linker error:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;MakeFiles/Stub_Time.dir/src/TimeStub.cpp.o: In function `NotSet ConvertJSON&amp;lt;NotSet&amp;gt;(std::__cxx11::basic_string&amp;lt;char, std::char_traits&amp;lt;char&amp;gt;, std::allocator&amp;lt;char&amp;gt; &amp;gt;, std::shared_ptr&amp;lt;IMessageLog&amp;gt;)':&#xA;TimeStub.cpp:(.text._Z11ConvertJSONI6NotSetET_NSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESt10shared_ptrI11IMessageLogE[_Z11ConvertJSONI6NotSetET_NSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEESt10shared_ptrI11IMessageLogE]+0xe4): undefined reference to `void load&amp;lt;cereal::JSONInputArchive&amp;gt;(cereal::JSONInputArchive&amp;amp;, NotSet&amp;amp;)'&#xA;../lib/libIO.so: undefined reference to `void save&amp;lt;cereal::JSONOutputArchive&amp;gt;(cereal::JSONOutputArchive&amp;amp;, VehicleBound const&amp;amp;)'&#xA;../lib/libIO.so: undefined reference to `void save&amp;lt;cereal::JSONOutputArchive&amp;gt;(cereal::JSONOutputArchive&amp;amp;, Emissions const&amp;amp;)'&#xA;collect2: error: ld returned 1 exit status&#xA;CMakeFiles/Stub_Time.dir/build.make:111: recipe for target 'bin/Stub_Time' failed&#xA;make[2]: *** [bin/Stub_Time] Error 1&#xA;CMakeFiles/Makefile2:77: recipe for target 'CMakeFiles/Stub_Time.dir/all' failed&#xA;make[1]: *** [CMakeFiles/Stub_Time.dir/all] Error 2&#xA;Makefile:94: recipe for target 'all' failed&#xA;make: *** [all] Error 2&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I tried invoking &lt;code&gt;make VERBOSE=1&lt;/code&gt; and the only differences seemed to be that &lt;code&gt;c++&lt;/code&gt; was being called with the &lt;code&gt;-g&lt;/code&gt; flag in the successful case, and the &lt;code&gt;-O3 -DNDEBUG&lt;/code&gt; flags in the unsuccessful case.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Why would this happen?  &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Is release mode optimizing-away the symbols in &lt;code&gt;libIO.so&lt;/code&gt; that gets referenced in &lt;code&gt;Stub_Time&lt;/code&gt;? If so, how can I stop it?  If not, how can I investigate?&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;h3&gt;Edit:&lt;/h3&gt;&#xA;&#xA;&lt;p&gt;I ran:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;grep -R ifdef | grep DEBUG&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;On the whole project, but none of the files that it came up with seemed at all relevant to the above error (just stuff related to printing the version).&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;h3&gt;Edit 2:&lt;/h3&gt;&#xA;&#xA;&lt;p&gt;I found that I can modify the flags that CMake passes to &lt;code&gt;c++&lt;/code&gt; by adding the following to CMakeLists.txt:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;set(CMAKE_CXX_FLAGS_RELEASE &quot;-O3 -DNDEBUG&quot;) &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Different combinations of these revealed that the error does not occur with&lt;code&gt;-O0&lt;/code&gt; but does occur with &lt;code&gt;-O1&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;hr&gt;&#xA;&#xA;&lt;h3&gt;Edit 3&lt;/h3&gt;&#xA;&#xA;&lt;p&gt;We use a json serialization library: cereal.  It looks for functions that resemble the ones below.  Typically, you'd have code there that called out certain fields to be serialized.  There were some odd cases where we wanted to say: &quot;Serialize Nothing&quot; so we implemented the following serialization calls:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;template &amp;lt;class Archive&amp;gt;                                                                                                                                   &#xA;void save(Archive&amp;amp; archive, const NotSet&amp;amp; object)                                                                   &#xA;{                                                                                                                   &#xA;}                                                                                                                   &#xA;&#xA;template &amp;lt;class Archive&amp;gt;                                                                                            &#xA;void load(Archive&amp;amp; archive, NotSet&amp;amp; object)                                                                         &#xA;{                                                                                                                   &#xA;} &#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I am guessing that &lt;code&gt;-O1&lt;/code&gt; noticed some empty void functions and optimized something away.  Then somebody else tried to link to &lt;code&gt;libIO.so&lt;/code&gt; and found the symbols missing.  I was able to fix this by adding a dummy field to &lt;code&gt;NotSet&lt;/code&gt; and then serializing that field.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Now it builds successfully with &lt;code&gt;-O2&lt;/code&gt; but &lt;code&gt;-O3&lt;/code&gt; causes the following:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;../lib/libIO.so: undefined reference to `void save&amp;lt;cereal::JSONOutputArchive&amp;gt;(cereal::JSONOutputArchive&amp;amp;, Emissions const&amp;amp;)'&#xA;../lib/libIO.so: undefined reference to `void save&amp;lt;cereal::JSONOutputArchive&amp;gt;(cereal::JSONOutputArchive&amp;amp;, VehicleBound const&amp;amp;)'&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Which is similar to the original error, but the reference to &lt;code&gt;NotSet&lt;/code&gt; is not present.  I've been over the two calls that are causing errors repeatedly--they look identical to all of the other well-behaved calls.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;It seems likely to be related to this: &lt;a href=&quot;http://stackoverflow.com/questions/12252907/c-linker-error-undefined-references-only-on-optimized-build&quot;&gt;c++ linker error: undefined references only on optimized build&lt;/a&gt; because the troublesome calls are function templates.  However, their definitions are in a header which is included in a file, which is specified to be built as part of libIO.so.&lt;/p&gt;&#xA;" OwnerUserId="1054322" LastEditorUserId="1054322" LastEditDate="2017-02-21T05:43:04.907" LastActivityDate="2017-02-21T05:43:04.907" Title="Why would a release build have linker errors if the debug build didn't?" Tags="&lt;c++&gt;&lt;cmake&gt;&lt;g++&gt;" AnswerCount="0" CommentCount="6" />
  <row Id="42519814" PostTypeId="1" CreationDate="2017-02-28T22:20:47.683" Score="-1" ViewCount="14" Body="&lt;p&gt;#define S_FUNCTION_NAME  myfunction_sFun &lt;/p&gt;&#xA;&#xA;&lt;p&gt;#define S_FUNCTION_LEVEL 2&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#define MDL_INITIAL_SIZES&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#define MDL_INITIALIZE_SAMPLE_TIMES&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#include &quot;tmwtypes.h&quot;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#include &quot;simstruc_types.h&quot;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#include &quot;mex.h&quot;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#include &quot;simstruc.h&quot;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;void mdlInitializeSizes(SimStruct *S)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;{&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ssPrintf(&quot;Initialize\n&quot;);&#xA;&#xA;  //My code has been removed from here&#xA;&#xA;ssPrintf(&quot;End Initialize\n&quot;);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;}&lt;/p&gt;&#xA;&#xA;&lt;p&gt;void mdlInitializeSampleTimes(SimStruct *S)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;{&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ssPrintf(&quot;Sample Times\n&quot;);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;}&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#define MDL_OUTPUTS&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#ifdef  MDL_OUTPUTS&lt;/p&gt;&#xA;&#xA;&lt;p&gt;void mdlOutputs(SimStruct *S, int_T tid)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;{&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ssPrintf(&quot;Outputs\n&quot;);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;}&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#endif&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#define MDL_START&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#ifdef  MDL_START&lt;/p&gt;&#xA;&#xA;&lt;p&gt;void mdlStart(SimStruct *S)&lt;/p&gt;&#xA;&#xA;&lt;p&gt;{&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;ssPrintf(&quot;Start\n&quot;);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;}&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#endif&lt;/p&gt;&#xA;&#xA;&lt;p&gt;void mdlTerminate(SimStruct *S){}&lt;/p&gt;&#xA;&#xA;&lt;p&gt;/&lt;em&gt;=============================&lt;/em&gt;&lt;/p&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;p&gt;Required S-function trailer *&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;em&gt;=============================&lt;/em&gt;/&lt;/p&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;p&gt;#ifdef  MATLAB_MEX_FILE    /* Is this file being compiled as a MEX-file? */&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#include &quot;simulink.c&quot;      /* MEX-file interface mechanism */&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#else&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#include &quot;cg_sfun.h&quot;       /* Code generation registration function */&lt;/p&gt;&#xA;&#xA;&lt;p&gt;#endif&lt;/p&gt;&#xA;" OwnerUserId="7638078" LastActivityDate="2017-03-01T04:44:00.077" Title="Why does S-Function only execute mdlInitializeSizes() and does not execute mdlOutputs(), mdlStart() etc?" Tags="&lt;matlab&gt;&lt;simulink&gt;&lt;s-function&gt;" AnswerCount="1" CommentCount="2" />
  <row Id="42566232" PostTypeId="1" CreationDate="2017-03-02T21:22:54.780" Score="0" ViewCount="18" Body="&lt;p&gt;I'm using Timer to make the LED on/off for every 1 second (instead of using delay function). However, when I execute this code on IAR IDE, the LED on/off at about 2.5-3 second, not 1 second like I want. I wonder if there is any mistake in the code, or do I have to modify somewhere for the correct clock speed?&lt;/p&gt;&#xA;&#xA;&lt;p&gt;I'm using standard peripheral library, and the IDE I'm using is IAR.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#include &quot;stm32f4xx.h&quot;&#xA;&#xA;GPIO_InitTypeDef  GPIO_InitStructure;&#xA;TIM_TimeBaseInitTypeDef  TIM_BaseStruct;&#xA;&#xA;void GPIO_Configuration(void);&#xA;void TIM_Configuration(void);&#xA;void Delay(__IO uint32_t nCount);&#xA;&#xA;int main(void)&#xA;{&#xA;  GPIO_Configuration();&#xA;  TIM_Configuration();&#xA;  while(1)&#xA;  {&#xA;    if(TIM_GetFlagStatus(TIM2,TIM_FLAG_Update) != RESET)&#xA;    {&#xA;      TIM_ClearFlag(TIM2,TIM_IT_Update);&#xA;      GPIO_ToggleBits(GPIOD,GPIO_Pin_14);&#xA;    }&#xA;  }&#xA;}&#xA;&#xA;void GPIO_Configuration(void)&#xA;{&#xA;  RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOD, ENABLE);&#xA;&#xA;  /* Configure PB0 PB1 in output pushpull mode */&#xA;  GPIO_InitStructure.GPIO_Pin = GPIO_Pin_14;&#xA;  GPIO_InitStructure.GPIO_Mode = GPIO_Mode_OUT;&#xA;  GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;&#xA;  GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;&#xA;  GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL;&#xA;  GPIO_Init(GPIOD, &amp;amp;GPIO_InitStructure);&#xA;}&#xA;&#xA;void TIM_Configuration(void)&#xA;{&#xA;  RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2,ENABLE);&#xA;&#xA;  TIM_BaseStruct.TIM_Prescaler = 42000-1;&#xA;  TIM_BaseStruct.TIM_CounterMode = TIM_CounterMode_Up;&#xA;  TIM_BaseStruct.TIM_Period = 2000-1;&#xA;  TIM_BaseStruct.TIM_ClockDivision = 0;&#xA;  TIM_BaseStruct.TIM_RepetitionCounter = 0;&#xA;&#xA;  TIM_TimeBaseInit(TIM2,&amp;amp;TIM_BaseStruct);&#xA;&#xA;  TIM_Cmd(TIM2,ENABLE);&#xA;}&#xA;&#xA;&#xA;void Delay(__IO uint32_t nCount)&#xA;{&#xA;  while(nCount--)&#xA;  {&#xA;  }&#xA;}&#xA;&#xA;#ifdef  USE_FULL_ASSERT&#xA;void assert_failed(uint8_t* file, uint32_t line)&#xA;{ &#xA;  /* User can add his own implementation to report the file name and line number,&#xA;     ex: printf(&quot;Wrong parameters value: file %s on line %d\r\n&quot;, file, line) */&#xA;&#xA;  /* Infinite loop */&#xA;  while (1)&#xA;  {&#xA;  }&#xA;}&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="7211497" LastActivityDate="2017-03-02T21:22:54.780" Title="My Timer in STM32F4 doesn't perform the delay correctly" Tags="&lt;timer&gt;&lt;delay&gt;&lt;iar&gt;&lt;stm32f4discovery&gt;" AnswerCount="0" CommentCount="3" />
  <row Id="42604745" PostTypeId="1" CreationDate="2017-03-05T05:08:03.303" Score="-2" ViewCount="29" Body="&lt;p&gt;lets say i have a .h and .c file, originally written for kernel space.&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifndef __TREE_H__&#xA;#define __TREE_H__&#xA;&#xA; /* #includes for kernel headers*/&#xA;&#xA;struct tree_node_t{&#xA;  int data;&#xA;  struct tree_node_t *left;&#xA;  struct tree_node_t *right;&#xA;};&#xA;&#xA;struct tree{&#xA; int data;&#xA; struct tree_node_t *root;&#xA;};&#xA;&#xA;void insert_node(struct tree *tree, int data);&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;Lets say, the corresponding .c file contains the definition of void insert_node fn, which create a tree_node using &lt;code&gt;kmalloc()&lt;/code&gt; and insert it into a tree. I am able to compile the code using Makefile to compile the kernel modules as the .h/.c file are part of kernel module.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;Now, i want to use the same data structure and its fns in userspace as well. I need to compile it using new user space specific makefile which takes care to replace the kernel specific calls like &lt;code&gt;kmalloc&lt;/code&gt; and &lt;code&gt;kfree&lt;/code&gt; with &lt;code&gt;malloc&lt;/code&gt; and &lt;code&gt;free&lt;/code&gt; instead ? How can i use various combination of #ifdef #else #endif so that the files are compilable in user space and kernel space by using respective make files.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;pls Nte : &lt;code&gt;kmalloc/kfree&lt;/code&gt; are just simple examples to explain. Files contain other kernel specific APIs which needs to be excluded/replaced at the time compilation of file in user space. &lt;/p&gt;&#xA;" OwnerUserId="756120" LastActivityDate="2017-03-05T21:17:07.450" Title="Compile the same C code for user space as well as kernel space" Tags="&lt;c&gt;&lt;makefile&gt;&lt;kernel&gt;" AnswerCount="1" CommentCount="1" />
  <row Id="42611197" PostTypeId="1" CreationDate="2017-03-05T16:56:20.633" Score="0" ViewCount="21" Body="&lt;p&gt;I am trying to output the following structure via a bus-object in simulink from my c-mex s-function. The following code-snippet is from my main matlab-file and if I run this script, the &lt;code&gt;slBus1&lt;/code&gt;-simulink-bus-object is created and placed in the matlab-workspace.    &lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;a.b = 7;&#xA;a.c = 5;&#xA;a.e(1).d = 1;&#xA;a.e(2).d = 2;&#xA;a.e(3).d = 3;&#xA;&#xA;bus1 = Simulink.Bus.createObject(a);&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I used the simulink s-function-builder to create the follwing code for outputting the structure &lt;code&gt;a&lt;/code&gt; (or &lt;code&gt;slBus1&lt;/code&gt;) via a simulink-bus. The simulink-model looks like this:&lt;/p&gt;&#xA;&#xA;&lt;p&gt;&lt;a href=&quot;https://i.stack.imgur.com/x3KI5.png&quot; rel=&quot;nofollow noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/x3KI5.png&quot; alt=&quot;enter image description here&quot;&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&#xA;&lt;p&gt;As you can see, all outout-ports from the bus-selector-block have strangely the dimension [1x1], but the substructure &lt;code&gt;e&lt;/code&gt; should have the dimension [3x1]. This behaviour also occurs if I use a indexing in my main-strucure, like:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;a(1).b = 1;&#xA;a(2).b = 2;&#xA;a(3).b = 3;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I will only get &lt;code&gt;a(1).b&lt;/code&gt; from the simulink bus-output. &lt;/p&gt;&#xA;&#xA;&lt;p&gt;Do you have any suggestions how to solve this? I didnt find anything about this in the documentation or elsewhere in the internet. Thanks!&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt; /*&#xA; * File: test_build.c&#xA; *&#xA; *&#xA;  *&#xA;  *   --- THIS FILE GENERATED BY S-FUNCTION BUILDER: 3.0 ---&#xA;  *&#xA;  *   This file is an S-function produced by the S-Function&#xA;  *   Builder which only recognizes certain fields.  Changes made&#xA;  *   outside these fields will be lost the next time the block is&#xA;  *   used to load, edit, and resave this file. This file will be overwritten&#xA;  *   by the S-function Builder block. If you want to edit this file by hand, &#xA;  *   you must change it only in the area defined as:  &#xA;  *&#xA;  *        %%%-SFUNWIZ_defines_Changes_BEGIN&#xA;  *        #define NAME 'replacement text' &#xA;  *        %%% SFUNWIZ_defines_Changes_END&#xA;  *&#xA;  *   DO NOT change NAME--Change the 'replacement text' only.&#xA;  *&#xA;  *   For better compatibility with the Simulink Coder, the&#xA;  *   &quot;wrapper&quot; S-function technique is used.  This is discussed&#xA;  *   in the Simulink Coder's Manual in the Chapter titled,&#xA;  *   &quot;Wrapper S-functions&quot;.&#xA;  *&#xA;  *  -------------------------------------------------------------------------&#xA;  * | See matlabroot/simulink/src/sfuntmpl_doc.c for a more detailed template |&#xA;  *  ------------------------------------------------------------------------- &#xA; * Created: Sun Mar  5 17:15:44 2017&#xA; * &#xA; *&#xA; */&#xA;&#xA;#define S_FUNCTION_LEVEL 2&#xA;#define S_FUNCTION_NAME test_build&#xA;/*&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;*/&#xA;/* %%%-SFUNWIZ_defines_Changes_BEGIN --- EDIT HERE TO _END */&#xA;#define NUM_INPUTS           0&#xA;&#xA;#define NUM_OUTPUTS          1&#xA;/* Output Port  0 */&#xA;#define OUT_PORT_0_NAME      y0&#xA;#define OUTPUT_0_WIDTH       1&#xA;#define OUTPUT_DIMS_0_COL    1&#xA;#define OUTPUT_0_DTYPE       real_T&#xA;#define OUTPUT_0_COMPLEX     COMPLEX_NO&#xA;#define OUT_0_FRAME_BASED    FRAME_NO&#xA;#define OUT_0_BUS_BASED      1&#xA;#define OUT_0_BUS_NAME       slBus1&#xA;#define OUT_0_DIMS           1-D&#xA;#define OUT_0_ISSIGNED        1&#xA;#define OUT_0_WORDLENGTH      8&#xA;#define OUT_0_FIXPOINTSCALING 1&#xA;#define OUT_0_FRACTIONLENGTH  3&#xA;#define OUT_0_BIAS            0&#xA;#define OUT_0_SLOPE           0.125&#xA;&#xA;#define NPARAMS              0&#xA;&#xA;#define SAMPLE_TIME_0        INHERITED_SAMPLE_TIME&#xA;#define NUM_DISC_STATES      0&#xA;#define DISC_STATES_IC       [0]&#xA;#define NUM_CONT_STATES      0&#xA;#define CONT_STATES_IC       [0]&#xA;&#xA;#define SFUNWIZ_GENERATE_TLC 1&#xA;#define SOURCEFILES &quot;__SFB__&quot;&#xA;#define PANELINDEX           6&#xA;#define USE_SIMSTRUCT        0&#xA;#define SHOW_COMPILE_STEPS   0                   &#xA;#define CREATE_DEBUG_MEXFILE 0&#xA;#define SAVE_CODE_ONLY       0&#xA;#define SFUNWIZ_REVISION     3.0&#xA;/* %%%-SFUNWIZ_defines_Changes_END --- EDIT HERE TO _BEGIN */&#xA;/*&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;*/&#xA;#include &quot;simstruc.h&quot;&#xA;&#xA;typedef struct {&#xA;  real_T d;&#xA;} e;&#xA;&#xA;typedef struct {&#xA;  real_T b;&#xA;  real_T c;&#xA;  e e;&#xA;} slBus1;&#xA;&#xA;/*&#xA;* Code Generation Environment flag (simulation or standalone target).&#xA; */&#xA;static int_T isSimulationTarget;&#xA;/*  Utility function prototypes. */&#xA;static int_T GetRTWEnvironmentMode(SimStruct *S);&#xA;/* Macro used to check if Simulation mode is set to accelerator */&#xA;#define isDWorkPresent !(ssRTWGenIsCodeGen(S) &amp;amp;&amp;amp; !isSimulationTarget)&#xA;&#xA;&#xA;/*====================*&#xA; * S-function methods *&#xA; *====================*/&#xA;/* Function: mdlInitializeSizes ===============================================&#xA; * Abstract:&#xA; *   Setup sizes of the various vectors.&#xA; */&#xA;static void mdlInitializeSizes(SimStruct *S)&#xA;{&#xA;&#xA;    DECL_AND_INIT_DIMSINFO(outputDimsInfo);&#xA;    ssSetNumSFcnParams(S, NPARAMS);&#xA;     if (ssGetNumSFcnParams(S) != ssGetSFcnParamsCount(S)) {&#xA;     return; /* Parameter mismatch will be reported by Simulink */&#xA;     }&#xA;&#xA;    ssSetNumContStates(S, NUM_CONT_STATES);&#xA;    ssSetNumDiscStates(S, NUM_DISC_STATES);&#xA;&#xA;    if (!ssSetNumInputPorts(S, NUM_INPUTS)) return;&#xA;&#xA;    if (!ssSetNumOutputPorts(S, NUM_OUTPUTS)) return;&#xA;&#xA;  /* Register slBus1 datatype for Output port 0 */&#xA;&#xA;  #if defined(MATLAB_MEX_FILE)&#xA;    if (ssGetSimMode(S) != SS_SIMMODE_SIZES_CALL_ONLY)&#xA;    {&#xA;      DTypeId dataTypeIdReg;&#xA;      ssRegisterTypeFromNamedObject(S, &quot;slBus1&quot;, &amp;amp;dataTypeIdReg);&#xA;      if(dataTypeIdReg == INVALID_DTYPE_ID) return;&#xA;        ssSetOutputPortDataType(S,0, dataTypeIdReg);&#xA;    }&#xA;    #endif&#xA;&#xA;    ssSetBusOutputObjectName(S, 0, (void *) &quot;slBus1&quot;);&#xA;    ssSetOutputPortWidth(S, 0, OUTPUT_0_WIDTH);&#xA;    ssSetOutputPortComplexSignal(S, 0, OUTPUT_0_COMPLEX);&#xA;    ssSetBusOutputAsStruct(S, 0,OUT_0_BUS_BASED);&#xA;    ssSetOutputPortBusMode(S, 0, SL_BUS_MODE);&#xA;    if (ssRTWGenIsCodeGen(S)) {&#xA;       isSimulationTarget = GetRTWEnvironmentMode(S);&#xA;    if (isSimulationTarget==-1) {&#xA;       ssSetErrorStatus(S, &quot; Unable to determine a valid code generation environment mode&quot;);&#xA;       return;&#xA;     }&#xA;       isSimulationTarget |= ssRTWGenIsModelReferenceSimTarget(S);&#xA;    }&#xA;&#xA;    /* Set the number of dworks */&#xA;    if (!isDWorkPresent) {&#xA;      if (!ssSetNumDWork(S, 0)) return;&#xA;    } else {&#xA;      if (!ssSetNumDWork(S, 1)) return;&#xA;    }&#xA;&#xA;&#xA;   if (isDWorkPresent) {&#xA;&#xA;    /*&#xA;     * Configure the dwork 0 (y0BUS)&#xA;     */&#xA;#if defined(MATLAB_MEX_FILE)&#xA;&#xA;    if (ssGetSimMode(S) != SS_SIMMODE_SIZES_CALL_ONLY) {&#xA;      DTypeId dataTypeIdReg;&#xA;      ssRegisterTypeFromNamedObject(S, &quot;slBus1&quot;, &amp;amp;dataTypeIdReg);&#xA;      if (dataTypeIdReg == INVALID_DTYPE_ID) return;&#xA;      ssSetDWorkDataType(S, 0, dataTypeIdReg);&#xA;    }&#xA;&#xA;#endif&#xA;&#xA;    ssSetDWorkUsageType(S, 0, SS_DWORK_USED_AS_DWORK);&#xA;    ssSetDWorkName(S, 0, &quot;y0BUS&quot;);&#xA;    ssSetDWorkWidth(S, 0, DYNAMICALLY_SIZED);&#xA;    ssSetDWorkComplexSignal(S, 0, COMPLEX_NO);&#xA;}&#xA;    ssSetNumSampleTimes(S, 1);&#xA;    ssSetNumRWork(S, 0);&#xA;    ssSetNumIWork(S, 0);&#xA;    ssSetNumPWork(S, 0);&#xA;    ssSetNumModes(S, 0);&#xA;    ssSetNumNonsampledZCs(S, 0);&#xA;&#xA;    /* Take care when specifying exception free code - see sfuntmpl_doc.c */&#xA;    ssSetOptions(S, (SS_OPTION_EXCEPTION_FREE_CODE |&#xA;                     SS_OPTION_USE_TLC_WITH_ACCELERATOR | &#xA;             SS_OPTION_WORKS_WITH_CODE_REUSE));&#xA;}&#xA;&#xA;/* Function: mdlInitializeSampleTimes =========================================&#xA; * Abstract:&#xA; *    Specifiy  the sample time.&#xA; */&#xA;static void mdlInitializeSampleTimes(SimStruct *S)&#xA;{&#xA;    ssSetSampleTime(S, 0, SAMPLE_TIME_0);&#xA;    ssSetOffsetTime(S, 0, 0.0);&#xA;}&#xA;&#xA;&#xA;#define MDL_START  /* Change to #undef to remove function */&#xA;#if defined(MDL_START)&#xA;  /* Function: mdlStart =======================================================&#xA;   * Abstract:&#xA;   *    This function is called once at start of model execution. If you&#xA;   *    have states that should be initialized once, this is the place&#xA;   *    to do it.&#xA;   */&#xA;static void mdlStart(SimStruct *S)&#xA;{&#xA;    /* Bus Information */&#xA;    slDataTypeAccess *dta = ssGetDataTypeAccess(S);&#xA;    const char *bpath = ssGetPath(S);&#xA;    DTypeId eId = ssGetDataTypeId(S, &quot;e&quot;);&#xA;    DTypeId slBus1Id = ssGetDataTypeId(S, &quot;slBus1&quot;);&#xA;&#xA;    int_T *busInfo = (int_T *)malloc(6*sizeof(int_T));&#xA;    if(busInfo==NULL) {&#xA;        ssSetErrorStatus(S, &quot;Memory allocation failure&quot;);&#xA;        return;&#xA;    }&#xA;&#xA;      /* Calculate offsets of all primitive elements of the bus */&#xA;&#xA;    busInfo[0] = dtaGetDataTypeElementOffset(dta, bpath,slBus1Id,0);&#xA;    busInfo[1] = dtaGetDataTypeSize(dta, bpath, ssGetDataTypeId(S, &quot;double&quot;));&#xA;    busInfo[2] = dtaGetDataTypeElementOffset(dta, bpath,slBus1Id,1);&#xA;    busInfo[3] = dtaGetDataTypeSize(dta, bpath, ssGetDataTypeId(S, &quot;double&quot;));&#xA;    busInfo[4] = dtaGetDataTypeElementOffset(dta, bpath,slBus1Id,2) +dtaGetDataTypeElementOffset(dta, bpath,eId,0);&#xA;    busInfo[5] = dtaGetDataTypeSize(dta, bpath, ssGetDataTypeId(S, &quot;double&quot;));&#xA;    ssSetUserData(S, busInfo);&#xA;}&#xA;#endif /*  MDL_START */&#xA;&#xA;#define MDL_SET_OUTPUT_PORT_DATA_TYPE&#xA;static void mdlSetOutputPortDataType(SimStruct *S, int port, DTypeId dType)&#xA;{&#xA;    ssSetOutputPortDataType(S, 0, dType);&#xA;}&#xA;&#xA;#define MDL_SET_DEFAULT_PORT_DATA_TYPES&#xA;static void mdlSetDefaultPortDataTypes(SimStruct *S)&#xA;{&#xA;   ssSetOutputPortDataType(S, 0, SS_DOUBLE);&#xA;}&#xA;&#xA;#define MDL_SET_WORK_WIDTHS&#xA;#if defined(MDL_SET_WORK_WIDTHS) &amp;amp;&amp;amp; defined(MATLAB_MEX_FILE)&#xA;&#xA;static void mdlSetWorkWidths(SimStruct *S)&#xA;{&#xA;  /* Set the width of DWork(s) used for marshalling the IOs */&#xA;  if (isDWorkPresent) {&#xA;&#xA;     /* Update dwork 0 */&#xA;     ssSetDWorkWidth(S, 0, ssGetOutputPortWidth(S, 0));&#xA;&#xA;    }&#xA;}&#xA;&#xA;#endif&#xA;void sete(e *out)&#xA;{&#xA;    out[0].d=1;&#xA;    out[1].d=2;   &#xA;    out[2].d=2; &#xA;}&#xA;&#xA;void test_build_Outputs_wrapper(slBus1 *y0)&#xA;{&#xA;    y0[0].b=3;&#xA;    y0[0].c=4;&#xA;    sete(&amp;amp;y0[0].e);&#xA;}&#xA;&#xA;/* Function: mdlOutputs =======================================================&#xA; *&#xA;*/&#xA;static void mdlOutputs(SimStruct *S, int_T tid)&#xA;{&#xA;    char *y0 = (char *) ssGetOutputPortSignal(S,0);&#xA;&#xA;    int_T* busInfo = (int_T *) ssGetUserData(S);&#xA;&#xA;    /* Temporary bus copy declarations */&#xA;    slBus1 _y0BUS;&#xA;&#xA;    /*Copy input bus into temporary structure*/&#xA;&#xA;    test_build_Outputs_wrapper(&amp;amp;_y0BUS);&#xA;&#xA;    /*Copy temporary structure into output bus*/&#xA;    (void) memcpy(y0+ busInfo[0], &amp;amp;_y0BUS.b, busInfo[1]);&#xA;    (void) memcpy(y0+ busInfo[2], &amp;amp;_y0BUS.c, busInfo[3]);&#xA;    (void) memcpy(y0+ busInfo[4], &amp;amp;_y0BUS.e.d, busInfo[5]);&#xA;}&#xA;&#xA;&#xA;&#xA;/* Function: mdlTerminate =====================================================&#xA; * Abstract:&#xA; *    In this function, you should perform any actions that are necessary&#xA; *    at the termination of a simulation.  For example, if memory was&#xA; *    allocated in mdlStart, this is the place to free it.&#xA; */&#xA;static void mdlTerminate(SimStruct *S)&#xA;{&#xA;    /*Free stored bus information*/&#xA;    int_T *busInfo = (int_T *) ssGetUserData(S);&#xA;    if(busInfo!=NULL) {&#xA;      free(busInfo);&#xA;    }&#xA;}&#xA;&#xA;&#xA;static int_T GetRTWEnvironmentMode(SimStruct *S)&#xA;{&#xA;    int_T status;&#xA;    mxArray *plhs[1];&#xA;    mxArray *prhs[1];&#xA;    int_T err;&#xA;&#xA;    /*&#xA;      * Get the name of the Simulink block diagram&#xA;    */&#xA;    prhs[0] = mxCreateString(ssGetModelName(ssGetRootSS(S)));&#xA;    plhs[0] = NULL;&#xA;&#xA;    /*&#xA;      * Call &quot;isSimulationTarget = rtwenvironmentmode(modelName)&quot; in MATLAB&#xA;    */&#xA;    mexSetTrapFlag(1);&#xA;    err = mexCallMATLAB(1, plhs, 1, prhs, &quot;rtwenvironmentmode&quot;);&#xA;    mexSetTrapFlag(0);&#xA;    mxDestroyArray(prhs[0]);&#xA;&#xA;    /*&#xA;     * Set the error status if an error occurred&#xA;    */&#xA;    if (err) {&#xA;        if (plhs[0]) {&#xA;            mxDestroyArray(plhs[0]);&#xA;            plhs[0] = NULL;&#xA;        }&#xA;        ssSetErrorStatus(S, &quot;Unknow error during call to 'rtwenvironmentmode'.&quot;);&#xA;        return -1;&#xA;    }&#xA;&#xA;    /*&#xA;      * Get the value returned by rtwenvironmentmode(modelName)&#xA;    */&#xA;   if (plhs[0]) {&#xA;       status = (int_T) (mxGetScalar(plhs[0]) != 0);&#xA;       mxDestroyArray(plhs[0]);&#xA;       plhs[0] = NULL;&#xA;   }&#xA;&#xA;    return (status);&#xA;}&#xA;&#xA;#ifdef  MATLAB_MEX_FILE    /* Is this file being compiled as a MEX-file? */&#xA;#include &quot;simulink.c&quot;      /* MEX-file interface mechanism */&#xA;#else&#xA;#include &quot;cg_sfun.h&quot;       /* Code generation registration function */&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;" OwnerUserId="7217855" LastEditorUserId="7217855" LastEditDate="2017-03-05T17:06:18.987" LastActivityDate="2017-03-05T17:06:18.987" Title="Output structure-array from c-mex s-functions" Tags="&lt;matlab&gt;&lt;simulink&gt;&lt;bus&gt;&lt;s-function&gt;" AnswerCount="0" CommentCount="3" />
  <row Id="42712240" PostTypeId="1" CreationDate="2017-03-10T07:01:16.467" Score="1" ViewCount="28" Body="&lt;p&gt;&lt;strong&gt;To build a Eclipse plugin upon Eclipse CDT(NOT developing CXX using CDT)&lt;/strong&gt;, by using the API provided by Eclipse CDT, for the following code snippet, in Eclipse CDT, we can detect the ifdef statement(See IASTPressorIfStatement), but how can we obtain the statements under this ifdef directive. Specifically, in this example, we want to get the code &quot;#include &quot;. Or is there any other tools could do this?&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef HAVE_SYS_PRCTL_H&#xA;#include &amp;lt;sys/prctl.h&amp;gt;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;For example, in the code snippet, we want to get statements within the structure &amp;lt;#ifdef ...,#endif&gt;. The return should be &quot;#include&quot;.&lt;/p&gt;&#xA;&#xA;&lt;p&gt;For a normal case, let have the code snippet like:&lt;/p&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;#ifdef  condition&#xA; statement A;&#xA; statement B;&#xA; .....&#xA; statement Z;&#xA;#endif&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&#xA;&lt;p&gt;I want to get the statement A, statement B,... and statement Z.*Note in the preprocessor statement, like IASTPreprocessorIfdefStatement, we can extract the macro name but not the statements I mentioned.  &lt;/p&gt;&#xA;" OwnerUserId="4485156" LastEditorUserId="4485156" LastEditDate="2017-03-10T12:21:22.517" LastActivityDate="2017-03-11T08:47:38.047" Title="Eclipse CDT preprocessor get statement under condition" Tags="&lt;c&gt;&lt;eclipse&gt;&lt;c-preprocessor&gt;&lt;eclipse-cdt&gt;&lt;preprocessor&gt;" AnswerCount="1" CommentCount="3" />
</rows>
